const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/angular-html-LfdN0zeE.js","assets/html-C2L_23MC.js","assets/javascript-ySlJ1b_l.js","assets/css-BPhBrDlE.js","assets/angular-ts-CKsD7JZE.js","assets/scss-C31hgJw-.js","assets/apl-BBq3IX1j.js","assets/xml-e3z08dGr.js","assets/java-xI-RfyKK.js","assets/json-BQoSv7ci.js","assets/astro-CqkE3fuf.js","assets/typescript-Dj6nwHGl.js","assets/postcss-B3ZDOciz.js","assets/blade-a8OxSdnT.js","assets/sql-COK4E0Yg.js","assets/bsl-Dgyn0ogV.js","assets/sdbl-BLhTXw86.js","assets/cairo--RitsXJZ.js","assets/python-DhUJRlN_.js","assets/cobol-PTqiYgYu.js","assets/coffee-dyiR41kL.js","assets/cpp-BksuvNSY.js","assets/regexp-DWJ3fJO_.js","assets/glsl-DBO2IWDn.js","assets/c-C3t2pwGQ.js","assets/crystal-DtDmRg-F.js","assets/shellscript-atvbtKCR.js","assets/dotenv-BI07GJ_i.js","assets/components-Btvo8uln.js","assets/index-iO3TVDqP.js","assets/edge-D5gP-w-T.js","assets/html-derivative-CSfWNPLT.js","assets/elixir-CLiX3zqd.js","assets/elm-CmHSxxaM.js","assets/erb-BYTLMnw6.js","assets/ruby-DeZ3UC14.js","assets/haml-B2EZWmdv.js","assets/graphql-cDcHW_If.js","assets/jsx-BAng5TT0.js","assets/tsx-B6W0miNI.js","assets/lua-CvWAzNxB.js","assets/yaml-CVw76BM1.js","assets/fortran-fixed-form-TqA4NnZg.js","assets/fortran-free-form-DKXYxT9g.js","assets/fsharp-XplgxFYe.js","assets/markdown-UIAJJxZW.js","assets/gdresource-BHYsBjWJ.js","assets/gdshader-SKMF96pI.js","assets/gdscript-DfxzS6Rs.js","assets/git-commit-i4q6IMui.js","assets/diff-BgYniUM_.js","assets/git-rebase-B-v9cOL2.js","assets/glimmer-js-D-cwc0-E.js","assets/glimmer-ts-pgjy16dm.js","assets/hack-D1yCygmZ.js","assets/handlebars-BQGss363.js","assets/http-FRrOvY1W.js","assets/hxml-TIA70rKU.js","assets/haxe-C5wWYbrZ.js","assets/imba-bv_oIlVt.js","assets/jinja-DGy0s7-h.js","assets/jison-BqZprYcd.js","assets/julia-BBuGR-5E.js","assets/r-CwjWoCRV.js","assets/latex-C-cWTeAZ.js","assets/tex-rYs2v40G.js","assets/liquid-D3W5UaiH.js","assets/marko-z0MBrx5-.js","assets/less-BfCpw3nA.js","assets/mdc-DB_EDNY_.js","assets/nginx-D_VnBJ67.js","assets/nim-ZlGxZxc3.js","assets/perl-CHQXSrWU.js","assets/php-B5ebYQev.js","assets/pug-CM9l7STV.js","assets/qml-D8XfuvdV.js","assets/razor-CNLDkMZG.js","assets/csharp-D9R-vmeu.js","assets/rst-4NLicBqY.js","assets/cmake-DbXoA79R.js","assets/sas-BmTFh92c.js","assets/shaderlab-B7qAK45m.js","assets/hlsl-ifBTmRxC.js","assets/shellsession-C_rIy8kc.js","assets/soy-C-lX7w71.js","assets/sparql-bYkjHRlG.js","assets/turtle-BMR_PYu6.js","assets/stata-DorPZHa4.js","assets/svelte-MSaWC3Je.js","assets/templ-dwX3ZSMB.js","assets/go-B1SYOhNW.js","assets/ts-tags-CipyTH0X.js","assets/twig-NC5TFiHP.js","assets/vue-BuYVFjOK.js","assets/vue-html-xdeiXROB.js","assets/xsl-Dd0NUgwM.js","assets/index-SqehUPdz.js","assets/index-BIdaEGAo.js","assets/index-B8F5eF7V.js","assets/index-C2ln8tH6.js","assets/index-T6vtev0h.js","assets/index-CTjSYwf9.js","assets/index-DyLHor89.js","assets/index-r-rZF91s.js","assets/index-D72bIYZz.js","assets/index-GzxnQwyo.js","assets/index-DUVexiE2.js"])))=>i.map(i=>d[i]);
import{v as Ql,r as k,w as Re,n as C,x as $t,y as uU,z as dU,A as l2,l as Tl,B as Al,C as hU}from"./components-Btvo8uln.js";import{a as jt,p as xt,c as en,m as bo,b as c2,d as Sr,e as fU,u as at,l as ln,t as up,r as ec,C as Wa}from"./index-iO3TVDqP.js";const pU=5,wh=6,xh=10;let mU=(t,e,r,n)=>(t.events=t.events||{},t.events[r+xh]||(t.events[r+xh]=n(s=>{t.events[r].reduceRight((i,o)=>(o(i),i),{shared:{},...s})})),t.events[r]=t.events[r]||[],t.events[r].push(e),()=>{let s=t.events[r],i=s.indexOf(e);s.splice(i,1),s.length||(delete t.events[r],t.events[r+xh](),delete t.events[r+xh])}),gU=1e3,vU=(t,e)=>mU(t,n=>{let s=e(n);s&&t.events[wh].push(s)},pU,n=>{let s=t.listen;t.listen=(...o)=>(!t.lc&&!t.active&&(t.active=!0,n()),s(...o));let i=t.off;return t.events[wh]=[],t.off=()=>{i(),setTimeout(()=>{if(t.active&&!t.lc){t.active=!1;for(let o of t.events[wh])o();t.events[wh]=[]}},gU)},()=>{t.listen=s,t.off=i}}),yU=(t,e,r)=>{Array.isArray(t)||(t=[t]);let n,s=0,i=()=>{let l=t.map(c=>c.get());if(n===void 0||l.some((c,u)=>c!==n[u])){let c=++s;n=l;let u=e(...l);u&&u.then&&u.t?u.then(d=>{c===s&&o.set(d)}):o.set(u)}},o=jt(void 0,Math.max(...t.map(l=>l.l))+1),a=i;return vU(o,()=>{let l=t.map(c=>c.listen(a,-1/o.l));return i(),()=>{for(let c of l)c()}}),o},u2=(t,e)=>yU(t,e);var d2="vercel.ai.error",_U=Symbol.for(d2),h2,bU=class f2 extends Error{constructor({name:e,message:r,cause:n}){super(r),this[h2]=!0,this.name=e,this.cause=n}static isInstance(e){return f2.hasMarker(e,d2)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};h2=_U;var Nt=bU,p2="AI_APICallError",m2=`vercel.ai.error.${p2}`,wU=Symbol.for(m2),g2,ei=class extends Nt{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:p2,message:e,cause:a}),this[g2]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return Nt.hasMarker(e,m2)}};g2=wU;var v2="AI_EmptyResponseBodyError",y2=`vercel.ai.error.${v2}`,xU=Symbol.for(y2),_2,SU=class extends Nt{constructor({message:e="Empty response body"}={}){super({name:v2,message:e}),this[_2]=!0}static isInstance(e){return Nt.hasMarker(e,y2)}};_2=xU;function b2(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var w2="AI_InvalidArgumentError",x2=`vercel.ai.error.${w2}`,EU=Symbol.for(x2),S2,CU=class extends Nt{constructor({message:e,cause:r,argument:n}){super({name:w2,message:e,cause:r}),this[S2]=!0,this.argument=n}static isInstance(e){return Nt.hasMarker(e,x2)}};S2=EU;var E2="AI_InvalidPromptError",C2=`vercel.ai.error.${E2}`,kU=Symbol.for(C2),k2,TU=class extends Nt{constructor({prompt:e,message:r,cause:n}){super({name:E2,message:`Invalid prompt: ${r}`,cause:n}),this[k2]=!0,this.prompt=e}static isInstance(e){return Nt.hasMarker(e,C2)}};k2=kU;var T2="AI_InvalidResponseDataError",A2=`vercel.ai.error.${T2}`,AU=Symbol.for(A2),R2,ul=class extends Nt{constructor({data:e,message:r=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:T2,message:r}),this[R2]=!0,this.data=e}static isInstance(e){return Nt.hasMarker(e,A2)}};R2=AU;var P2="AI_JSONParseError",I2=`vercel.ai.error.${P2}`,RU=Symbol.for(I2),O2,dp=class extends Nt{constructor({text:e,cause:r}){super({name:P2,message:`JSON parsing failed: Text: ${e}.
Error message: ${b2(r)}`,cause:r}),this[O2]=!0,this.text=e}static isInstance(e){return Nt.hasMarker(e,I2)}};O2=RU;var D2="AI_LoadAPIKeyError",M2=`vercel.ai.error.${D2}`,PU=Symbol.for(M2),L2,Sh=class extends Nt{constructor({message:e}){super({name:D2,message:e}),this[L2]=!0}static isInstance(e){return Nt.hasMarker(e,M2)}};L2=PU;var N2="AI_NoSuchModelError",B2=`vercel.ai.error.${N2}`,IU=Symbol.for(B2),F2,OU=class extends Nt{constructor({errorName:t=N2,modelId:e,modelType:r,message:n=`No such ${r}: ${e}`}){super({name:t,message:n}),this[F2]=!0,this.modelId=e,this.modelType=r}static isInstance(t){return Nt.hasMarker(t,B2)}};F2=IU;var j2="AI_TooManyEmbeddingValuesForCallError",$2=`vercel.ai.error.${j2}`,DU=Symbol.for($2),U2,MU=class extends Nt{constructor(e){super({name:j2,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[U2]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return Nt.hasMarker(e,$2)}};U2=DU;var H2="AI_TypeValidationError",V2=`vercel.ai.error.${H2}`,LU=Symbol.for(V2),G2,NU=class E0 extends Nt{constructor({value:e,cause:r}){super({name:H2,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${b2(r)}`,cause:r}),this[G2]=!0,this.value=e}static isInstance(e){return Nt.hasMarker(e,V2)}static wrap({value:e,cause:r}){return E0.isInstance(r)&&r.value===e?r:new E0({value:e,cause:r})}};G2=LU;var hp=NU,z2="AI_UnsupportedFunctionalityError",W2=`vercel.ai.error.${z2}`,BU=Symbol.for(W2),K2,Ar=class extends Nt{constructor({functionality:e,message:r=`'${e}' functionality not supported.`}){super({name:z2,message:r}),this[K2]=!0,this.functionality=e}static isInstance(e){return Nt.hasMarker(e,W2)}};K2=BU;let Iw=(t,e=21)=>(r=e)=>{let n="",s=r|0;for(;s--;)n+=t[Math.random()*t.length|0];return n};var Ow={},eg={};eg.byteLength=$U;eg.toByteArray=HU;eg.fromByteArray=zU;var ys=[],Tn=[],FU=typeof Uint8Array<"u"?Uint8Array:Array,bv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ma=0,jU=bv.length;Ma<jU;++Ma)ys[Ma]=bv[Ma],Tn[bv.charCodeAt(Ma)]=Ma;Tn[45]=62;Tn[95]=63;function q2(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function $U(t){var e=q2(t),r=e[0],n=e[1];return(r+n)*3/4-n}function UU(t,e,r){return(e+r)*3/4-r}function HU(t){var e,r=q2(t),n=r[0],s=r[1],i=new FU(UU(t,n,s)),o=0,a=s>0?n-4:n,l;for(l=0;l<a;l+=4)e=Tn[t.charCodeAt(l)]<<18|Tn[t.charCodeAt(l+1)]<<12|Tn[t.charCodeAt(l+2)]<<6|Tn[t.charCodeAt(l+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return s===2&&(e=Tn[t.charCodeAt(l)]<<2|Tn[t.charCodeAt(l+1)]>>4,i[o++]=e&255),s===1&&(e=Tn[t.charCodeAt(l)]<<10|Tn[t.charCodeAt(l+1)]<<4|Tn[t.charCodeAt(l+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function VU(t){return ys[t>>18&63]+ys[t>>12&63]+ys[t>>6&63]+ys[t&63]}function GU(t,e,r){for(var n,s=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(VU(n));return s.join("")}function zU(t){for(var e,r=t.length,n=r%3,s=[],i=16383,o=0,a=r-n;o<a;o+=i)s.push(GU(t,o,o+i>a?a:o+i));return n===1?(e=t[r-1],s.push(ys[e>>2]+ys[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],s.push(ys[e>>10]+ys[e>>4&63]+ys[e<<2&63]+"=")),s.join("")}var Dw={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Dw.read=function(t,e,r,n,s){var i,o,a=s*8-n-1,l=(1<<a)-1,c=l>>1,u=-7,d=r?s-1:0,h=r?-1:1,f=t[e+d];for(d+=h,i=f&(1<<-u)-1,f>>=-u,u+=a;u>0;i=i*256+t[e+d],d+=h,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=o*256+t[e+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-c}return(f?-1:1)*o*Math.pow(2,i-n)};Dw.write=function(t,e,r,n,s,i){var o,a,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,v=n?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?e+=h/l:e+=h*Math.pow(2,1-d),e*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*l-1)*Math.pow(2,s),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[r+f]=a&255,f+=v,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;t[r+f]=o&255,f+=v,o/=256,c-=8);t[r+f-v]|=m*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=eg,r=Dw,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=w,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:o,SharedArrayBuffer:a}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const G=new i(1),M={foo:function(){return 42}};return Object.setPrototypeOf(M,i.prototype),Object.setPrototypeOf(G,M),G.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(G){if(G>s)throw new RangeError('The value "'+G+'" is invalid for option "size"');const M=new i(G);return Object.setPrototypeOf(M,u.prototype),M}function u(G,M,B){if(typeof G=="number"){if(typeof M=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(G)}return d(G,M,B)}u.poolSize=8192;function d(G,M,B){if(typeof G=="string")return m(G,M);if(o.isView(G))return g(G);if(G==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G);if(_e(G,o)||G&&_e(G.buffer,o)||typeof a<"u"&&(_e(G,a)||G&&_e(G.buffer,a)))return y(G,M,B);if(typeof G=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Q=G.valueOf&&G.valueOf();if(Q!=null&&Q!==G)return u.from(Q,M,B);const he=_(G);if(he)return he;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof G[Symbol.toPrimitive]=="function")return u.from(G[Symbol.toPrimitive]("string"),M,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G)}u.from=function(G,M,B){return d(G,M,B)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(G){if(typeof G!="number")throw new TypeError('"size" argument must be of type number');if(G<0)throw new RangeError('The value "'+G+'" is invalid for option "size"')}function f(G,M,B){return h(G),G<=0?c(G):M!==void 0?typeof B=="string"?c(G).fill(M,B):c(G).fill(M):c(G)}u.alloc=function(G,M,B){return f(G,M,B)};function v(G){return h(G),c(G<0?0:b(G)|0)}u.allocUnsafe=function(G){return v(G)},u.allocUnsafeSlow=function(G){return v(G)};function m(G,M){if((typeof M!="string"||M==="")&&(M="utf8"),!u.isEncoding(M))throw new TypeError("Unknown encoding: "+M);const B=E(G,M)|0;let Q=c(B);const he=Q.write(G,M);return he!==B&&(Q=Q.slice(0,he)),Q}function p(G){const M=G.length<0?0:b(G.length)|0,B=c(M);for(let Q=0;Q<M;Q+=1)B[Q]=G[Q]&255;return B}function g(G){if(_e(G,i)){const M=new i(G);return y(M.buffer,M.byteOffset,M.byteLength)}return p(G)}function y(G,M,B){if(M<0||G.byteLength<M)throw new RangeError('"offset" is outside of buffer bounds');if(G.byteLength<M+(B||0))throw new RangeError('"length" is outside of buffer bounds');let Q;return M===void 0&&B===void 0?Q=new i(G):B===void 0?Q=new i(G,M):Q=new i(G,M,B),Object.setPrototypeOf(Q,u.prototype),Q}function _(G){if(u.isBuffer(G)){const M=b(G.length)|0,B=c(M);return B.length===0||G.copy(B,0,0,M),B}if(G.length!==void 0)return typeof G.length!="number"||Ae(G.length)?c(0):p(G);if(G.type==="Buffer"&&Array.isArray(G.data))return p(G.data)}function b(G){if(G>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return G|0}function w(G){return+G!=G&&(G=0),u.alloc(+G)}u.isBuffer=function(M){return M!=null&&M._isBuffer===!0&&M!==u.prototype},u.compare=function(M,B){if(_e(M,i)&&(M=u.from(M,M.offset,M.byteLength)),_e(B,i)&&(B=u.from(B,B.offset,B.byteLength)),!u.isBuffer(M)||!u.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(M===B)return 0;let Q=M.length,he=B.length;for(let ye=0,be=Math.min(Q,he);ye<be;++ye)if(M[ye]!==B[ye]){Q=M[ye],he=B[ye];break}return Q<he?-1:he<Q?1:0},u.isEncoding=function(M){switch(String(M).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(M,B){if(!Array.isArray(M))throw new TypeError('"list" argument must be an Array of Buffers');if(M.length===0)return u.alloc(0);let Q;if(B===void 0)for(B=0,Q=0;Q<M.length;++Q)B+=M[Q].length;const he=u.allocUnsafe(B);let ye=0;for(Q=0;Q<M.length;++Q){let be=M[Q];if(_e(be,i))ye+be.length>he.length?(u.isBuffer(be)||(be=u.from(be)),be.copy(he,ye)):i.prototype.set.call(he,be,ye);else if(u.isBuffer(be))be.copy(he,ye);else throw new TypeError('"list" argument must be an Array of Buffers');ye+=be.length}return he};function E(G,M){if(u.isBuffer(G))return G.length;if(o.isView(G)||_e(G,o))return G.byteLength;if(typeof G!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof G);const B=G.length,Q=arguments.length>2&&arguments[2]===!0;if(!Q&&B===0)return 0;let he=!1;for(;;)switch(M){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return ce(G).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B*2;case"hex":return B>>>1;case"base64":return fe(G).length;default:if(he)return Q?-1:ce(G).length;M=(""+M).toLowerCase(),he=!0}}u.byteLength=E;function S(G,M,B){let Q=!1;if((M===void 0||M<0)&&(M=0),M>this.length||((B===void 0||B>this.length)&&(B=this.length),B<=0)||(B>>>=0,M>>>=0,B<=M))return"";for(G||(G="utf8");;)switch(G){case"hex":return U(this,M,B);case"utf8":case"utf-8":return V(this,M,B);case"ascii":return $(this,M,B);case"latin1":case"binary":return j(this,M,B);case"base64":return K(this,M,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,M,B);default:if(Q)throw new TypeError("Unknown encoding: "+G);G=(G+"").toLowerCase(),Q=!0}}u.prototype._isBuffer=!0;function x(G,M,B){const Q=G[M];G[M]=G[B],G[B]=Q}u.prototype.swap16=function(){const M=this.length;if(M%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let B=0;B<M;B+=2)x(this,B,B+1);return this},u.prototype.swap32=function(){const M=this.length;if(M%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let B=0;B<M;B+=4)x(this,B,B+3),x(this,B+1,B+2);return this},u.prototype.swap64=function(){const M=this.length;if(M%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let B=0;B<M;B+=8)x(this,B,B+7),x(this,B+1,B+6),x(this,B+2,B+5),x(this,B+3,B+4);return this},u.prototype.toString=function(){const M=this.length;return M===0?"":arguments.length===0?V(this,0,M):S.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(M){if(!u.isBuffer(M))throw new TypeError("Argument must be a Buffer");return this===M?!0:u.compare(this,M)===0},u.prototype.inspect=function(){let M="";const B=t.INSPECT_MAX_BYTES;return M=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(M+=" ... "),"<Buffer "+M+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(M,B,Q,he,ye){if(_e(M,i)&&(M=u.from(M,M.offset,M.byteLength)),!u.isBuffer(M))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof M);if(B===void 0&&(B=0),Q===void 0&&(Q=M?M.length:0),he===void 0&&(he=0),ye===void 0&&(ye=this.length),B<0||Q>M.length||he<0||ye>this.length)throw new RangeError("out of range index");if(he>=ye&&B>=Q)return 0;if(he>=ye)return-1;if(B>=Q)return 1;if(B>>>=0,Q>>>=0,he>>>=0,ye>>>=0,this===M)return 0;let be=ye-he,We=Q-B;const bt=Math.min(be,We),it=this.slice(he,ye),gt=M.slice(B,Q);for(let dt=0;dt<bt;++dt)if(it[dt]!==gt[dt]){be=it[dt],We=gt[dt];break}return be<We?-1:We<be?1:0};function T(G,M,B,Q,he){if(G.length===0)return-1;if(typeof B=="string"?(Q=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),B=+B,Ae(B)&&(B=he?0:G.length-1),B<0&&(B=G.length+B),B>=G.length){if(he)return-1;B=G.length-1}else if(B<0)if(he)B=0;else return-1;if(typeof M=="string"&&(M=u.from(M,Q)),u.isBuffer(M))return M.length===0?-1:D(G,M,B,Q,he);if(typeof M=="number")return M=M&255,typeof i.prototype.indexOf=="function"?he?i.prototype.indexOf.call(G,M,B):i.prototype.lastIndexOf.call(G,M,B):D(G,[M],B,Q,he);throw new TypeError("val must be string, number or Buffer")}function D(G,M,B,Q,he){let ye=1,be=G.length,We=M.length;if(Q!==void 0&&(Q=String(Q).toLowerCase(),Q==="ucs2"||Q==="ucs-2"||Q==="utf16le"||Q==="utf-16le")){if(G.length<2||M.length<2)return-1;ye=2,be/=2,We/=2,B/=2}function bt(gt,dt){return ye===1?gt[dt]:gt.readUInt16BE(dt*ye)}let it;if(he){let gt=-1;for(it=B;it<be;it++)if(bt(G,it)===bt(M,gt===-1?0:it-gt)){if(gt===-1&&(gt=it),it-gt+1===We)return gt*ye}else gt!==-1&&(it-=it-gt),gt=-1}else for(B+We>be&&(B=be-We),it=B;it>=0;it--){let gt=!0;for(let dt=0;dt<We;dt++)if(bt(G,it+dt)!==bt(M,dt)){gt=!1;break}if(gt)return it}return-1}u.prototype.includes=function(M,B,Q){return this.indexOf(M,B,Q)!==-1},u.prototype.indexOf=function(M,B,Q){return T(this,M,B,Q,!0)},u.prototype.lastIndexOf=function(M,B,Q){return T(this,M,B,Q,!1)};function O(G,M,B,Q){B=Number(B)||0;const he=G.length-B;Q?(Q=Number(Q),Q>he&&(Q=he)):Q=he;const ye=M.length;Q>ye/2&&(Q=ye/2);let be;for(be=0;be<Q;++be){const We=parseInt(M.substr(be*2,2),16);if(Ae(We))return be;G[B+be]=We}return be}function R(G,M,B,Q){return we(ce(M,G.length-B),G,B,Q)}function P(G,M,B,Q){return we(ge(M),G,B,Q)}function A(G,M,B,Q){return we(fe(M),G,B,Q)}function H(G,M,B,Q){return we(de(M,G.length-B),G,B,Q)}u.prototype.write=function(M,B,Q,he){if(B===void 0)he="utf8",Q=this.length,B=0;else if(Q===void 0&&typeof B=="string")he=B,Q=this.length,B=0;else if(isFinite(B))B=B>>>0,isFinite(Q)?(Q=Q>>>0,he===void 0&&(he="utf8")):(he=Q,Q=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ye=this.length-B;if((Q===void 0||Q>ye)&&(Q=ye),M.length>0&&(Q<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");he||(he="utf8");let be=!1;for(;;)switch(he){case"hex":return O(this,M,B,Q);case"utf8":case"utf-8":return R(this,M,B,Q);case"ascii":case"latin1":case"binary":return P(this,M,B,Q);case"base64":return A(this,M,B,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,M,B,Q);default:if(be)throw new TypeError("Unknown encoding: "+he);he=(""+he).toLowerCase(),be=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(G,M,B){return M===0&&B===G.length?e.fromByteArray(G):e.fromByteArray(G.slice(M,B))}function V(G,M,B){B=Math.min(G.length,B);const Q=[];let he=M;for(;he<B;){const ye=G[he];let be=null,We=ye>239?4:ye>223?3:ye>191?2:1;if(he+We<=B){let bt,it,gt,dt;switch(We){case 1:ye<128&&(be=ye);break;case 2:bt=G[he+1],(bt&192)===128&&(dt=(ye&31)<<6|bt&63,dt>127&&(be=dt));break;case 3:bt=G[he+1],it=G[he+2],(bt&192)===128&&(it&192)===128&&(dt=(ye&15)<<12|(bt&63)<<6|it&63,dt>2047&&(dt<55296||dt>57343)&&(be=dt));break;case 4:bt=G[he+1],it=G[he+2],gt=G[he+3],(bt&192)===128&&(it&192)===128&&(gt&192)===128&&(dt=(ye&15)<<18|(bt&63)<<12|(it&63)<<6|gt&63,dt>65535&&dt<1114112&&(be=dt))}}be===null?(be=65533,We=1):be>65535&&(be-=65536,Q.push(be>>>10&1023|55296),be=56320|be&1023),Q.push(be),he+=We}return I(Q)}const q=4096;function I(G){const M=G.length;if(M<=q)return String.fromCharCode.apply(String,G);let B="",Q=0;for(;Q<M;)B+=String.fromCharCode.apply(String,G.slice(Q,Q+=q));return B}function $(G,M,B){let Q="";B=Math.min(G.length,B);for(let he=M;he<B;++he)Q+=String.fromCharCode(G[he]&127);return Q}function j(G,M,B){let Q="";B=Math.min(G.length,B);for(let he=M;he<B;++he)Q+=String.fromCharCode(G[he]);return Q}function U(G,M,B){const Q=G.length;(!M||M<0)&&(M=0),(!B||B<0||B>Q)&&(B=Q);let he="";for(let ye=M;ye<B;++ye)he+=ze[G[ye]];return he}function J(G,M,B){const Q=G.slice(M,B);let he="";for(let ye=0;ye<Q.length-1;ye+=2)he+=String.fromCharCode(Q[ye]+Q[ye+1]*256);return he}u.prototype.slice=function(M,B){const Q=this.length;M=~~M,B=B===void 0?Q:~~B,M<0?(M+=Q,M<0&&(M=0)):M>Q&&(M=Q),B<0?(B+=Q,B<0&&(B=0)):B>Q&&(B=Q),B<M&&(B=M);const he=this.subarray(M,B);return Object.setPrototypeOf(he,u.prototype),he};function ne(G,M,B){if(G%1!==0||G<0)throw new RangeError("offset is not uint");if(G+M>B)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(M,B,Q){M=M>>>0,B=B>>>0,Q||ne(M,B,this.length);let he=this[M],ye=1,be=0;for(;++be<B&&(ye*=256);)he+=this[M+be]*ye;return he},u.prototype.readUintBE=u.prototype.readUIntBE=function(M,B,Q){M=M>>>0,B=B>>>0,Q||ne(M,B,this.length);let he=this[M+--B],ye=1;for(;B>0&&(ye*=256);)he+=this[M+--B]*ye;return he},u.prototype.readUint8=u.prototype.readUInt8=function(M,B){return M=M>>>0,B||ne(M,1,this.length),this[M]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(M,B){return M=M>>>0,B||ne(M,2,this.length),this[M]|this[M+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(M,B){return M=M>>>0,B||ne(M,2,this.length),this[M]<<8|this[M+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(M,B){return M=M>>>0,B||ne(M,4,this.length),(this[M]|this[M+1]<<8|this[M+2]<<16)+this[M+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(M,B){return M=M>>>0,B||ne(M,4,this.length),this[M]*16777216+(this[M+1]<<16|this[M+2]<<8|this[M+3])},u.prototype.readBigUInt64LE=Ne(function(M){M=M>>>0,ie(M,"offset");const B=this[M],Q=this[M+7];(B===void 0||Q===void 0)&&W(M,this.length-8);const he=B+this[++M]*2**8+this[++M]*2**16+this[++M]*2**24,ye=this[++M]+this[++M]*2**8+this[++M]*2**16+Q*2**24;return BigInt(he)+(BigInt(ye)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ne(function(M){M=M>>>0,ie(M,"offset");const B=this[M],Q=this[M+7];(B===void 0||Q===void 0)&&W(M,this.length-8);const he=B*2**24+this[++M]*2**16+this[++M]*2**8+this[++M],ye=this[++M]*2**24+this[++M]*2**16+this[++M]*2**8+Q;return(BigInt(he)<<BigInt(32))+BigInt(ye)}),u.prototype.readIntLE=function(M,B,Q){M=M>>>0,B=B>>>0,Q||ne(M,B,this.length);let he=this[M],ye=1,be=0;for(;++be<B&&(ye*=256);)he+=this[M+be]*ye;return ye*=128,he>=ye&&(he-=Math.pow(2,8*B)),he},u.prototype.readIntBE=function(M,B,Q){M=M>>>0,B=B>>>0,Q||ne(M,B,this.length);let he=B,ye=1,be=this[M+--he];for(;he>0&&(ye*=256);)be+=this[M+--he]*ye;return ye*=128,be>=ye&&(be-=Math.pow(2,8*B)),be},u.prototype.readInt8=function(M,B){return M=M>>>0,B||ne(M,1,this.length),this[M]&128?(255-this[M]+1)*-1:this[M]},u.prototype.readInt16LE=function(M,B){M=M>>>0,B||ne(M,2,this.length);const Q=this[M]|this[M+1]<<8;return Q&32768?Q|4294901760:Q},u.prototype.readInt16BE=function(M,B){M=M>>>0,B||ne(M,2,this.length);const Q=this[M+1]|this[M]<<8;return Q&32768?Q|4294901760:Q},u.prototype.readInt32LE=function(M,B){return M=M>>>0,B||ne(M,4,this.length),this[M]|this[M+1]<<8|this[M+2]<<16|this[M+3]<<24},u.prototype.readInt32BE=function(M,B){return M=M>>>0,B||ne(M,4,this.length),this[M]<<24|this[M+1]<<16|this[M+2]<<8|this[M+3]},u.prototype.readBigInt64LE=Ne(function(M){M=M>>>0,ie(M,"offset");const B=this[M],Q=this[M+7];(B===void 0||Q===void 0)&&W(M,this.length-8);const he=this[M+4]+this[M+5]*2**8+this[M+6]*2**16+(Q<<24);return(BigInt(he)<<BigInt(32))+BigInt(B+this[++M]*2**8+this[++M]*2**16+this[++M]*2**24)}),u.prototype.readBigInt64BE=Ne(function(M){M=M>>>0,ie(M,"offset");const B=this[M],Q=this[M+7];(B===void 0||Q===void 0)&&W(M,this.length-8);const he=(B<<24)+this[++M]*2**16+this[++M]*2**8+this[++M];return(BigInt(he)<<BigInt(32))+BigInt(this[++M]*2**24+this[++M]*2**16+this[++M]*2**8+Q)}),u.prototype.readFloatLE=function(M,B){return M=M>>>0,B||ne(M,4,this.length),r.read(this,M,!0,23,4)},u.prototype.readFloatBE=function(M,B){return M=M>>>0,B||ne(M,4,this.length),r.read(this,M,!1,23,4)},u.prototype.readDoubleLE=function(M,B){return M=M>>>0,B||ne(M,8,this.length),r.read(this,M,!0,52,8)},u.prototype.readDoubleBE=function(M,B){return M=M>>>0,B||ne(M,8,this.length),r.read(this,M,!1,52,8)};function te(G,M,B,Q,he,ye){if(!u.isBuffer(G))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>he||M<ye)throw new RangeError('"value" argument is out of bounds');if(B+Q>G.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(M,B,Q,he){if(M=+M,B=B>>>0,Q=Q>>>0,!he){const We=Math.pow(2,8*Q)-1;te(this,M,B,Q,We,0)}let ye=1,be=0;for(this[B]=M&255;++be<Q&&(ye*=256);)this[B+be]=M/ye&255;return B+Q},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(M,B,Q,he){if(M=+M,B=B>>>0,Q=Q>>>0,!he){const We=Math.pow(2,8*Q)-1;te(this,M,B,Q,We,0)}let ye=Q-1,be=1;for(this[B+ye]=M&255;--ye>=0&&(be*=256);)this[B+ye]=M/be&255;return B+Q},u.prototype.writeUint8=u.prototype.writeUInt8=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,1,255,0),this[B]=M&255,B+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,2,65535,0),this[B]=M&255,this[B+1]=M>>>8,B+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,2,65535,0),this[B]=M>>>8,this[B+1]=M&255,B+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,4,4294967295,0),this[B+3]=M>>>24,this[B+2]=M>>>16,this[B+1]=M>>>8,this[B]=M&255,B+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,4,4294967295,0),this[B]=M>>>24,this[B+1]=M>>>16,this[B+2]=M>>>8,this[B+3]=M&255,B+4};function me(G,M,B,Q,he){Z(M,Q,he,G,B,7);let ye=Number(M&BigInt(4294967295));G[B++]=ye,ye=ye>>8,G[B++]=ye,ye=ye>>8,G[B++]=ye,ye=ye>>8,G[B++]=ye;let be=Number(M>>BigInt(32)&BigInt(4294967295));return G[B++]=be,be=be>>8,G[B++]=be,be=be>>8,G[B++]=be,be=be>>8,G[B++]=be,B}function re(G,M,B,Q,he){Z(M,Q,he,G,B,7);let ye=Number(M&BigInt(4294967295));G[B+7]=ye,ye=ye>>8,G[B+6]=ye,ye=ye>>8,G[B+5]=ye,ye=ye>>8,G[B+4]=ye;let be=Number(M>>BigInt(32)&BigInt(4294967295));return G[B+3]=be,be=be>>8,G[B+2]=be,be=be>>8,G[B+1]=be,be=be>>8,G[B]=be,B+8}u.prototype.writeBigUInt64LE=Ne(function(M,B=0){return me(this,M,B,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ne(function(M,B=0){return re(this,M,B,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(M,B,Q,he){if(M=+M,B=B>>>0,!he){const bt=Math.pow(2,8*Q-1);te(this,M,B,Q,bt-1,-bt)}let ye=0,be=1,We=0;for(this[B]=M&255;++ye<Q&&(be*=256);)M<0&&We===0&&this[B+ye-1]!==0&&(We=1),this[B+ye]=(M/be>>0)-We&255;return B+Q},u.prototype.writeIntBE=function(M,B,Q,he){if(M=+M,B=B>>>0,!he){const bt=Math.pow(2,8*Q-1);te(this,M,B,Q,bt-1,-bt)}let ye=Q-1,be=1,We=0;for(this[B+ye]=M&255;--ye>=0&&(be*=256);)M<0&&We===0&&this[B+ye+1]!==0&&(We=1),this[B+ye]=(M/be>>0)-We&255;return B+Q},u.prototype.writeInt8=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,1,127,-128),M<0&&(M=255+M+1),this[B]=M&255,B+1},u.prototype.writeInt16LE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,2,32767,-32768),this[B]=M&255,this[B+1]=M>>>8,B+2},u.prototype.writeInt16BE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,2,32767,-32768),this[B]=M>>>8,this[B+1]=M&255,B+2},u.prototype.writeInt32LE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,4,2147483647,-2147483648),this[B]=M&255,this[B+1]=M>>>8,this[B+2]=M>>>16,this[B+3]=M>>>24,B+4},u.prototype.writeInt32BE=function(M,B,Q){return M=+M,B=B>>>0,Q||te(this,M,B,4,2147483647,-2147483648),M<0&&(M=4294967295+M+1),this[B]=M>>>24,this[B+1]=M>>>16,this[B+2]=M>>>8,this[B+3]=M&255,B+4},u.prototype.writeBigInt64LE=Ne(function(M,B=0){return me(this,M,B,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ne(function(M,B=0){return re(this,M,B,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function F(G,M,B,Q,he,ye){if(B+Q>G.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function X(G,M,B,Q,he){return M=+M,B=B>>>0,he||F(G,M,B,4),r.write(G,M,B,Q,23,4),B+4}u.prototype.writeFloatLE=function(M,B,Q){return X(this,M,B,!0,Q)},u.prototype.writeFloatBE=function(M,B,Q){return X(this,M,B,!1,Q)};function Y(G,M,B,Q,he){return M=+M,B=B>>>0,he||F(G,M,B,8),r.write(G,M,B,Q,52,8),B+8}u.prototype.writeDoubleLE=function(M,B,Q){return Y(this,M,B,!0,Q)},u.prototype.writeDoubleBE=function(M,B,Q){return Y(this,M,B,!1,Q)},u.prototype.copy=function(M,B,Q,he){if(!u.isBuffer(M))throw new TypeError("argument should be a Buffer");if(Q||(Q=0),!he&&he!==0&&(he=this.length),B>=M.length&&(B=M.length),B||(B=0),he>0&&he<Q&&(he=Q),he===Q||M.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(Q<0||Q>=this.length)throw new RangeError("Index out of range");if(he<0)throw new RangeError("sourceEnd out of bounds");he>this.length&&(he=this.length),M.length-B<he-Q&&(he=M.length-B+Q);const ye=he-Q;return this===M&&typeof i.prototype.copyWithin=="function"?this.copyWithin(B,Q,he):i.prototype.set.call(M,this.subarray(Q,he),B),ye},u.prototype.fill=function(M,B,Q,he){if(typeof M=="string"){if(typeof B=="string"?(he=B,B=0,Q=this.length):typeof Q=="string"&&(he=Q,Q=this.length),he!==void 0&&typeof he!="string")throw new TypeError("encoding must be a string");if(typeof he=="string"&&!u.isEncoding(he))throw new TypeError("Unknown encoding: "+he);if(M.length===1){const be=M.charCodeAt(0);(he==="utf8"&&be<128||he==="latin1")&&(M=be)}}else typeof M=="number"?M=M&255:typeof M=="boolean"&&(M=Number(M));if(B<0||this.length<B||this.length<Q)throw new RangeError("Out of range index");if(Q<=B)return this;B=B>>>0,Q=Q===void 0?this.length:Q>>>0,M||(M=0);let ye;if(typeof M=="number")for(ye=B;ye<Q;++ye)this[ye]=M;else{const be=u.isBuffer(M)?M:u.from(M,he),We=be.length;if(We===0)throw new TypeError('The value "'+M+'" is invalid for argument "value"');for(ye=0;ye<Q-B;++ye)this[ye+B]=be[ye%We]}return this};const oe={};function le(G,M,B){oe[G]=class extends B{constructor(){super(),Object.defineProperty(this,"message",{value:M.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${G}]`,this.stack,delete this.name}get code(){return G}set code(he){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:he,writable:!0})}toString(){return`${this.name} [${G}]: ${this.message}`}}}le("ERR_BUFFER_OUT_OF_BOUNDS",function(G){return G?`${G} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),le("ERR_INVALID_ARG_TYPE",function(G,M){return`The "${G}" argument must be of type number. Received type ${typeof M}`},TypeError),le("ERR_OUT_OF_RANGE",function(G,M,B){let Q=`The value of "${G}" is out of range.`,he=B;return Number.isInteger(B)&&Math.abs(B)>2**32?he=ue(String(B)):typeof B=="bigint"&&(he=String(B),(B>BigInt(2)**BigInt(32)||B<-(BigInt(2)**BigInt(32)))&&(he=ue(he)),he+="n"),Q+=` It must be ${M}. Received ${he}`,Q},RangeError);function ue(G){let M="",B=G.length;const Q=G[0]==="-"?1:0;for(;B>=Q+4;B-=3)M=`_${G.slice(B-3,B)}${M}`;return`${G.slice(0,B)}${M}`}function N(G,M,B){ie(M,"offset"),(G[M]===void 0||G[M+B]===void 0)&&W(M,G.length-(B+1))}function Z(G,M,B,Q,he,ye){if(G>B||G<M){const be=typeof M=="bigint"?"n":"";let We;throw M===0||M===BigInt(0)?We=`>= 0${be} and < 2${be} ** ${(ye+1)*8}${be}`:We=`>= -(2${be} ** ${(ye+1)*8-1}${be}) and < 2 ** ${(ye+1)*8-1}${be}`,new oe.ERR_OUT_OF_RANGE("value",We,G)}N(Q,he,ye)}function ie(G,M){if(typeof G!="number")throw new oe.ERR_INVALID_ARG_TYPE(M,"number",G)}function W(G,M,B){throw Math.floor(G)!==G?(ie(G,B),new oe.ERR_OUT_OF_RANGE("offset","an integer",G)):M<0?new oe.ERR_BUFFER_OUT_OF_BOUNDS:new oe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${M}`,G)}const z=/[^+/0-9A-Za-z-_]/g;function ae(G){if(G=G.split("=")[0],G=G.trim().replace(z,""),G.length<2)return"";for(;G.length%4!==0;)G=G+"=";return G}function ce(G,M){M=M||1/0;let B;const Q=G.length;let he=null;const ye=[];for(let be=0;be<Q;++be){if(B=G.charCodeAt(be),B>55295&&B<57344){if(!he){if(B>56319){(M-=3)>-1&&ye.push(239,191,189);continue}else if(be+1===Q){(M-=3)>-1&&ye.push(239,191,189);continue}he=B;continue}if(B<56320){(M-=3)>-1&&ye.push(239,191,189),he=B;continue}B=(he-55296<<10|B-56320)+65536}else he&&(M-=3)>-1&&ye.push(239,191,189);if(he=null,B<128){if((M-=1)<0)break;ye.push(B)}else if(B<2048){if((M-=2)<0)break;ye.push(B>>6|192,B&63|128)}else if(B<65536){if((M-=3)<0)break;ye.push(B>>12|224,B>>6&63|128,B&63|128)}else if(B<1114112){if((M-=4)<0)break;ye.push(B>>18|240,B>>12&63|128,B>>6&63|128,B&63|128)}else throw new Error("Invalid code point")}return ye}function ge(G){const M=[];for(let B=0;B<G.length;++B)M.push(G.charCodeAt(B)&255);return M}function de(G,M){let B,Q,he;const ye=[];for(let be=0;be<G.length&&!((M-=2)<0);++be)B=G.charCodeAt(be),Q=B>>8,he=B%256,ye.push(he),ye.push(Q);return ye}function fe(G){return e.toByteArray(ae(G))}function we(G,M,B,Q){let he;for(he=0;he<Q&&!(he+B>=M.length||he>=G.length);++he)M[he+B]=G[he];return he}function _e(G,M){return G instanceof M||G!=null&&G.constructor!=null&&G.constructor.name!=null&&G.constructor.name===M.name}function Ae(G){return G!==G}const ze=function(){const G="0123456789abcdef",M=new Array(256);for(let B=0;B<16;++B){const Q=B*16;for(let he=0;he<16;++he)M[Q+he]=G[B]+G[he]}return M}();function Ne(G){return typeof BigInt>"u"?ft:G}function ft(){throw new Error("BigInt not supported")}})(Ow);const Ht=Ow.Buffer,Of=Ow.Buffer;var tc={exports:{}};const WU=typeof Ht<"u",cE=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,uE=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function J2(t,e,r){r==null&&e!==null&&typeof e=="object"&&(r=e,e=void 0),WU&&Ht.isBuffer(t)&&(t=t.toString()),t&&t.charCodeAt(0)===65279&&(t=t.slice(1));const n=JSON.parse(t,e);if(n===null||typeof n!="object")return n;const s=r&&r.protoAction||"error",i=r&&r.constructorAction||"error";if(s==="ignore"&&i==="ignore")return n;if(s!=="ignore"&&i!=="ignore"){if(cE.test(t)===!1&&uE.test(t)===!1)return n}else if(s!=="ignore"&&i==="ignore"){if(cE.test(t)===!1)return n}else if(uE.test(t)===!1)return n;return Y2(n,{protoAction:s,constructorAction:i,safe:r&&r.safe})}function Y2(t,{protoAction:e="error",constructorAction:r="error",safe:n}={}){let s=[t];for(;s.length;){const i=s;s=[];for(const o of i){if(e!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"__proto__")){if(n===!0)return null;if(e==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.__proto__}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"constructor")&&Object.prototype.hasOwnProperty.call(o.constructor,"prototype")){if(n===!0)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.constructor}for(const a in o){const l=o[a];l&&typeof l=="object"&&s.push(l)}}}return t}function Mw(t,e,r){const n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return J2(t,e,r)}finally{Error.stackTraceLimit=n}}function KU(t,e){const r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return J2(t,e,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=r}}tc.exports=Mw;tc.exports.default=Mw;tc.exports.parse=Mw;tc.exports.safeParse=KU;tc.exports.scan=Y2;var qU=tc.exports;const Un=Ql(qU);class dE extends Error{constructor(e,r){super(e),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function wv(t){}function JU(t){if(typeof t=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:e=wv,onError:r=wv,onRetry:n=wv,onComment:s}=t;let i="",o=!0,a,l="",c="";function u(m){const p=o?m.replace(/^\xEF\xBB\xBF/,""):m,[g,y]=YU(`${i}${p}`);for(const _ of g)d(_);i=y,o=!1}function d(m){if(m===""){f();return}if(m.startsWith(":")){s&&s(m.slice(m.startsWith(": ")?2:1));return}const p=m.indexOf(":");if(p!==-1){const g=m.slice(0,p),y=m[p+1]===" "?2:1,_=m.slice(p+y);h(g,_,m);return}h(m,"",m)}function h(m,p,g){switch(m){case"event":c=p;break;case"data":l=`${l}${p}
`;break;case"id":a=p.includes("\0")?void 0:p;break;case"retry":/^\d+$/.test(p)?n(parseInt(p,10)):r(new dE(`Invalid \`retry\` value: "${p}"`,{type:"invalid-retry",value:p,line:g}));break;default:r(new dE(`Unknown field "${m.length>20?`${m.slice(0,20)}…`:m}"`,{type:"unknown-field",field:m,value:p,line:g}));break}}function f(){l.length>0&&e({id:a,event:c||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),a=void 0,l="",c=""}function v(m={}){i&&m.consume&&d(i),o=!0,a=void 0,l="",c="",i=""}return{feed:u,reset:v}}function YU(t){const e=[];let r="",n=0;for(;n<t.length;){const s=t.indexOf("\r",n),i=t.indexOf(`
`,n);let o=-1;if(s!==-1&&i!==-1?o=Math.min(s,i):s!==-1?o=s:i!==-1&&(o=i),o===-1){r=t.slice(n);break}else{const a=t.slice(n,o);e.push(a),n=o+1,t[n-1]==="\r"&&t[n]===`
`&&n++}}return[e,r]}let Z2=class extends TransformStream{constructor({onError:e,onRetry:r,onComment:n}={}){let s;super({start(i){s=JU({onEvent:o=>{i.enqueue(o)},onError(o){e==="terminate"?i.error(o):typeof e=="function"&&e(o)},onRetry:r,onComment:n})},transform(i){s.feed(i)}})}};var ZU={};function Xi(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function tg(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var XU=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const s=Iw(r,e);if(t==null)return s;if(r.includes(n))throw new CU({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return i=>`${t}${n}${s(i)}`},_s=XU();function xv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function X2({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Sh({message:`${n} API key must be a string.`});if(typeof xt>"u")throw new Sh({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=ZU[e],t==null)throw new Sh({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Sh({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var C0=Symbol.for("vercel.ai.validator");function QU(t){return{[C0]:!0,validate:t}}function eH(t){return typeof t=="object"&&t!==null&&C0 in t&&t[C0]===!0&&"validate"in t}function tH(t){return eH(t)?t:rH(t)}function rH(t){return QU(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function nH({value:t,schema:e}){const r=fp({value:t,schema:e});if(!r.success)throw hp.wrap({value:t,cause:r.error});return r.value}function fp({value:t,schema:e}){const r=tH(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:hp.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:hp.wrap({value:t,cause:n})}}}function sH({text:t,schema:e}){try{const r=Un.parse(t);return e==null?r:nH({value:r,schema:e})}catch(r){throw dp.isInstance(r)||hp.isInstance(r)?r:new dp({text:t,cause:r})}}function pp({text:t,schema:e}){try{const r=Un.parse(t);if(e==null)return{success:!0,value:r,rawValue:r};const n=fp({value:r,schema:e});return n.success?{...n,rawValue:r}:n}catch(r){return{success:!1,error:dp.isInstance(r)?r:new dp({text:t,cause:r})}}}function mp(t){try{return Un.parse(t),!0}catch{return!1}}function iH(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var oH=()=>globalThis.fetch,Qi=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>aH({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),aH=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=oH()})=>{try{const a=await o(t,{method:"POST",headers:iH(e),body:r.content,signal:i}),l=tg(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw xv(u)||ei.isInstance(u)?u:new ei({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(xv(c)||ei.isInstance(c))?c:new ei({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(xv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new ei({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},Q2=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=tg(n);if(o.trim()==="")return{responseHeaders:a,value:new ei({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=sH({text:o,schema:t});return{responseHeaders:a,value:new ei({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new ei({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},Lw=t=>async({response:e})=>{const r=tg(e);if(e.body==null)throw new SU({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new Z2).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(pp({text:n,schema:t}))}}))}},Hd=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=pp({text:s,schema:t}),o=tg(e);if(!i.success)throw new ei({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value,rawValue:i.rawValue}},{btoa:lH}=globalThis;function eI(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return lH(e)}function tI(t){return t?.replace(/\/$/,"")}var lt;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(lt||(lt={}));var k0;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(k0||(k0={}));const Me=lt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ys=t=>{switch(typeof t){case"undefined":return Me.undefined;case"string":return Me.string;case"number":return isNaN(t)?Me.nan:Me.number;case"boolean":return Me.boolean;case"function":return Me.function;case"bigint":return Me.bigint;case"symbol":return Me.symbol;case"object":return Array.isArray(t)?Me.array:t===null?Me.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Me.promise:typeof Map<"u"&&t instanceof Map?Me.map:typeof Set<"u"&&t instanceof Set?Me.set:typeof Date<"u"&&t instanceof Date?Me.date:Me.object;default:return Me.unknown}},Ce=lt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),cH=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class fn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let a=n,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(r(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return s(this),n}static assert(e){if(!(e instanceof fn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,lt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}fn.create=t=>new fn(t);const Rl=(t,e)=>{let r;switch(t.code){case Ce.invalid_type:t.received===Me.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case Ce.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,lt.jsonStringifyReplacer)}`;break;case Ce.unrecognized_keys:r=`Unrecognized key(s) in object: ${lt.joinValues(t.keys,", ")}`;break;case Ce.invalid_union:r="Invalid input";break;case Ce.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${lt.joinValues(t.options)}`;break;case Ce.invalid_enum_value:r=`Invalid enum value. Expected ${lt.joinValues(t.options)}, received '${t.received}'`;break;case Ce.invalid_arguments:r="Invalid function arguments";break;case Ce.invalid_return_type:r="Invalid function return type";break;case Ce.invalid_date:r="Invalid date";break;case Ce.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:lt.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case Ce.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case Ce.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case Ce.custom:r="Invalid input";break;case Ce.invalid_intersection_types:r="Intersection results could not be merged";break;case Ce.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case Ce.not_finite:r="Number must be finite";break;default:r=e.defaultError,lt.assertNever(t)}return{message:r}};let rI=Rl;function uH(t){rI=t}function gp(){return rI}const vp=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,i=[...r,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let a="";const l=n.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...s,path:i,message:a}},dH=[];function Oe(t,e){const r=gp(),n=vp({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Rl?void 0:Rl].filter(s=>!!s)});t.common.issues.push(n)}class Pr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return Ge;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r){const i=await s.key,o=await s.value;n.push({key:i,value:o})}return Pr.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ge;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const Ge=Object.freeze({status:"aborted"}),Za=t=>({status:"dirty",value:t}),Ur=t=>({status:"valid",value:t}),T0=t=>t.status==="aborted",A0=t=>t.status==="dirty",da=t=>t.status==="valid",ku=t=>typeof Promise<"u"&&t instanceof Promise;function yp(t,e,r,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function nI(t,e,r,n,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r}var $e;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})($e||($e={}));var jc,$c;class Ns{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const hE=(t,e)=>{if(da(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new fn(t.common.issues);return this._error=r,this._error}}};function qe(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>{var l,c;const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??n)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(c=u??r)!==null&&c!==void 0?c:a.defaultError}},description:s}}class Xe{get description(){return this._def.description}_getType(e){return Ys(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ys(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Pr,ctx:{common:e.parent.common,data:e.data,parsedType:Ys(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(ku(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const s={common:{issues:[],async:(n=r?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ys(e)},i=this._parseSync({data:e,path:s.path,parent:s});return hE(s,i)}"~validate"(e){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ys(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:s});return da(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(r=i?.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(i=>da(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ys(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(ku(s)?s:Promise.resolve(s));return hE(n,i)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Ce.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new Zn({schema:this,typeName:Ve.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Rs.create(this,this._def)}nullable(){return no.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Jn.create(this)}promise(){return Il.create(this,this._def)}or(e){return Pu.create([this,e],this._def)}and(e){return Iu.create(this,e,this._def)}transform(e){return new Zn({...qe(this._def),schema:this,typeName:Ve.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new Nu({...qe(this._def),innerType:this,defaultValue:r,typeName:Ve.ZodDefault})}brand(){return new Nw({typeName:Ve.ZodBranded,type:this,...qe(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new Bu({...qe(this._def),innerType:this,catchValue:r,typeName:Ve.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Vd.create(this,e)}readonly(){return Fu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const hH=/^c[^\s-]{8,}$/i,fH=/^[0-9a-z]+$/,pH=/^[0-9A-HJKMNP-TV-Z]{26}$/i,mH=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,gH=/^[a-z0-9_-]{21}$/i,vH=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,yH=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_H=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,bH="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Sv;const wH=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,xH=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,SH=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,EH=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,CH=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,kH=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,sI="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",TH=new RegExp(`^${sI}$`);function iI(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function AH(t){return new RegExp(`^${iI(t)}$`)}function oI(t){let e=`${sI}T${iI(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function RH(t,e){return!!((e==="v4"||!e)&&wH.test(t)||(e==="v6"||!e)&&SH.test(t))}function PH(t,e){if(!vH.test(t))return!1;try{const[r]=t.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function IH(t,e){return!!((e==="v4"||!e)&&xH.test(t)||(e==="v6"||!e)&&EH.test(t))}class Kn extends Xe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Me.string){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ce.invalid_type,expected:Me.string,received:i.parsedType}),Ge}const n=new Pr;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?Oe(s,{code:Ce.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Oe(s,{code:Ce.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")_H.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"email",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Sv||(Sv=new RegExp(bH,"u")),Sv.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"emoji",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")mH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"uuid",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")gH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"nanoid",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")hH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"cuid",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")fH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"cuid2",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")pH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"ulid",code:Ce.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Oe(s,{validation:"url",code:Ce.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"regex",code:Ce.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?oI(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?TH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?AH(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?yH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"duration",code:Ce.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?RH(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"ip",code:Ce.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?PH(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"jwt",code:Ce.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?IH(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"cidr",code:Ce.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?CH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"base64",code:Ce.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?kH.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"base64url",code:Ce.invalid_string,message:i.message}),n.dirty()):lt.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:Ce.invalid_string,...$e.errToObj(n)})}_addCheck(e){return new Kn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...$e.errToObj(e)})}url(e){return this._addCheck({kind:"url",...$e.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...$e.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...$e.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...$e.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...$e.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...$e.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...$e.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...$e.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...$e.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...$e.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...$e.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...$e.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...$e.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...$e.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...$e.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...$e.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...$e.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...$e.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...$e.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...$e.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...$e.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...$e.errToObj(r)})}nonempty(e){return this.min(1,$e.errToObj(e))}trim(){return new Kn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Kn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Kn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Kn.create=t=>{var e;return new Kn({checks:[],typeName:Ve.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...qe(t)})};function OH(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class eo extends Xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Me.number){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ce.invalid_type,expected:Me.number,received:i.parsedType}),Ge}let n;const s=new Pr;for(const i of this._def.checks)i.kind==="int"?lt.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?OH(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.not_finite,message:i.message}),s.dirty()):lt.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,$e.toString(r))}gt(e,r){return this.setLimit("min",e,!1,$e.toString(r))}lte(e,r){return this.setLimit("max",e,!0,$e.toString(r))}lt(e,r){return this.setLimit("max",e,!1,$e.toString(r))}setLimit(e,r,n,s){return new eo({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:$e.toString(s)}]})}_addCheck(e){return new eo({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:$e.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:$e.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:$e.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:$e.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:$e.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:$e.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:$e.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:$e.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:$e.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&lt.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}eo.create=t=>new eo({checks:[],typeName:Ve.ZodNumber,coerce:t?.coerce||!1,...qe(t)});class to extends Xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Me.bigint)return this._getInvalidInput(e);let n;const s=new Pr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),Oe(n,{code:Ce.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):lt.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ce.invalid_type,expected:Me.bigint,received:r.parsedType}),Ge}gte(e,r){return this.setLimit("min",e,!0,$e.toString(r))}gt(e,r){return this.setLimit("min",e,!1,$e.toString(r))}lte(e,r){return this.setLimit("max",e,!0,$e.toString(r))}lt(e,r){return this.setLimit("max",e,!1,$e.toString(r))}setLimit(e,r,n,s){return new to({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:$e.toString(s)}]})}_addCheck(e){return new to({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:$e.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:$e.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:$e.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:$e.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:$e.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}to.create=t=>{var e;return new to({checks:[],typeName:Ve.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...qe(t)})};class Tu extends Xe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Me.boolean){const n=this._getOrReturnCtx(e);return Oe(n,{code:Ce.invalid_type,expected:Me.boolean,received:n.parsedType}),Ge}return Ur(e.data)}}Tu.create=t=>new Tu({typeName:Ve.ZodBoolean,coerce:t?.coerce||!1,...qe(t)});class ha extends Xe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Me.date){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ce.invalid_type,expected:Me.date,received:i.parsedType}),Ge}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ce.invalid_date}),Ge}const n=new Pr;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ce.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):lt.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ha({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:$e.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:$e.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}ha.create=t=>new ha({checks:[],coerce:t?.coerce||!1,typeName:Ve.ZodDate,...qe(t)});class _p extends Xe{_parse(e){if(this._getType(e)!==Me.symbol){const n=this._getOrReturnCtx(e);return Oe(n,{code:Ce.invalid_type,expected:Me.symbol,received:n.parsedType}),Ge}return Ur(e.data)}}_p.create=t=>new _p({typeName:Ve.ZodSymbol,...qe(t)});class Au extends Xe{_parse(e){if(this._getType(e)!==Me.undefined){const n=this._getOrReturnCtx(e);return Oe(n,{code:Ce.invalid_type,expected:Me.undefined,received:n.parsedType}),Ge}return Ur(e.data)}}Au.create=t=>new Au({typeName:Ve.ZodUndefined,...qe(t)});class Ru extends Xe{_parse(e){if(this._getType(e)!==Me.null){const n=this._getOrReturnCtx(e);return Oe(n,{code:Ce.invalid_type,expected:Me.null,received:n.parsedType}),Ge}return Ur(e.data)}}Ru.create=t=>new Ru({typeName:Ve.ZodNull,...qe(t)});class Pl extends Xe{constructor(){super(...arguments),this._any=!0}_parse(e){return Ur(e.data)}}Pl.create=t=>new Pl({typeName:Ve.ZodAny,...qe(t)});class ea extends Xe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ur(e.data)}}ea.create=t=>new ea({typeName:Ve.ZodUnknown,...qe(t)});class yi extends Xe{_parse(e){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ce.invalid_type,expected:Me.never,received:r.parsedType}),Ge}}yi.create=t=>new yi({typeName:Ve.ZodNever,...qe(t)});class bp extends Xe{_parse(e){if(this._getType(e)!==Me.undefined){const n=this._getOrReturnCtx(e);return Oe(n,{code:Ce.invalid_type,expected:Me.void,received:n.parsedType}),Ge}return Ur(e.data)}}bp.create=t=>new bp({typeName:Ve.ZodVoid,...qe(t)});class Jn extends Xe{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==Me.array)return Oe(r,{code:Ce.invalid_type,expected:Me.array,received:r.parsedType}),Ge;if(s.exactLength!==null){const o=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(o||a)&&(Oe(r,{code:o?Ce.too_big:Ce.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(Oe(r,{code:Ce.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(Oe(r,{code:Ce.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>s.type._parseAsync(new Ns(r,o,r.path,a)))).then(o=>Pr.mergeArray(n,o));const i=[...r.data].map((o,a)=>s.type._parseSync(new Ns(r,o,r.path,a)));return Pr.mergeArray(n,i)}get element(){return this._def.type}min(e,r){return new Jn({...this._def,minLength:{value:e,message:$e.toString(r)}})}max(e,r){return new Jn({...this._def,maxLength:{value:e,message:$e.toString(r)}})}length(e,r){return new Jn({...this._def,exactLength:{value:e,message:$e.toString(r)}})}nonempty(e){return this.min(1,e)}}Jn.create=(t,e)=>new Jn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ve.ZodArray,...qe(e)});function Ka(t){if(t instanceof It){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Rs.create(Ka(n))}return new It({...t._def,shape:()=>e})}else return t instanceof Jn?new Jn({...t._def,type:Ka(t.element)}):t instanceof Rs?Rs.create(Ka(t.unwrap())):t instanceof no?no.create(Ka(t.unwrap())):t instanceof Bs?Bs.create(t.items.map(e=>Ka(e))):t}class It extends Xe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=lt.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==Me.object){const c=this._getOrReturnCtx(e);return Oe(c,{code:Ce.invalid_type,expected:Me.object,received:c.parsedType}),Ge}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof yi&&this._def.unknownKeys==="strip"))for(const c in s.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ns(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof yi){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")a.length>0&&(Oe(s,{code:Ce.unrecognized_keys,keys:a}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ns(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>Pr.mergeObjectSync(n,c)):Pr.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return $e.errToObj,new It({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,i,o,a;const l=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&o!==void 0?o:n.defaultError;return r.code==="unrecognized_keys"?{message:(a=$e.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new It({...this._def,unknownKeys:"strip"})}passthrough(){return new It({...this._def,unknownKeys:"passthrough"})}extend(e){return new It({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new It({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ve.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new It({...this._def,catchall:e})}pick(e){const r={};return lt.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new It({...this._def,shape:()=>r})}omit(e){const r={};return lt.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new It({...this._def,shape:()=>r})}deepPartial(){return Ka(this)}partial(e){const r={};return lt.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}),new It({...this._def,shape:()=>r})}required(e){const r={};return lt.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Rs;)i=i._def.innerType;r[n]=i}}),new It({...this._def,shape:()=>r})}keyof(){return aI(lt.objectKeys(this.shape))}}It.create=(t,e)=>new It({shape:()=>t,unknownKeys:"strip",catchall:yi.create(),typeName:Ve.ZodObject,...qe(e)});It.strictCreate=(t,e)=>new It({shape:()=>t,unknownKeys:"strict",catchall:yi.create(),typeName:Ve.ZodObject,...qe(e)});It.lazycreate=(t,e)=>new It({shape:t,unknownKeys:"strip",catchall:yi.create(),typeName:Ve.ZodObject,...qe(e)});class Pu extends Xe{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new fn(a.ctx.common.issues));return Oe(r,{code:Ce.invalid_union,unionErrors:o}),Ge}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const l of n){const c={...r,common:{...r.common,issues:[]},parent:null},u=l._parseSync({data:r.data,path:r.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(l=>new fn(l));return Oe(r,{code:Ce.invalid_union,unionErrors:a}),Ge}}get options(){return this._def.options}}Pu.create=(t,e)=>new Pu({options:t,typeName:Ve.ZodUnion,...qe(e)});const Js=t=>t instanceof Du?Js(t.schema):t instanceof Zn?Js(t.innerType()):t instanceof Mu?[t.value]:t instanceof ro?t.options:t instanceof Lu?lt.objectValues(t.enum):t instanceof Nu?Js(t._def.innerType):t instanceof Au?[void 0]:t instanceof Ru?[null]:t instanceof Rs?[void 0,...Js(t.unwrap())]:t instanceof no?[null,...Js(t.unwrap())]:t instanceof Nw||t instanceof Fu?Js(t.unwrap()):t instanceof Bu?Js(t._def.innerType):[];class rg extends Xe{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==Me.object)return Oe(r,{code:Ce.invalid_type,expected:Me.object,received:r.parsedType}),Ge;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(Oe(r,{code:Ce.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ge)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const s=new Map;for(const i of r){const o=Js(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new rg({typeName:Ve.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...qe(n)})}}function R0(t,e){const r=Ys(t),n=Ys(e);if(t===e)return{valid:!0,data:t};if(r===Me.object&&n===Me.object){const s=lt.objectKeys(e),i=lt.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const l=R0(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(r===Me.array&&n===Me.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],l=R0(o,a);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return r===Me.date&&n===Me.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Iu extends Xe{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(T0(i)||T0(o))return Ge;const a=R0(i.value,o.value);return a.valid?((A0(i)||A0(o))&&r.dirty(),{status:r.value,value:a.data}):(Oe(n,{code:Ce.invalid_intersection_types}),Ge)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Iu.create=(t,e,r)=>new Iu({left:t,right:e,typeName:Ve.ZodIntersection,...qe(r)});class Bs extends Xe{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.array)return Oe(n,{code:Ce.invalid_type,expected:Me.array,received:n.parsedType}),Ge;if(n.data.length<this._def.items.length)return Oe(n,{code:Ce.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ge;!this._def.rest&&n.data.length>this._def.items.length&&(Oe(n,{code:Ce.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Ns(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Pr.mergeArray(r,o)):Pr.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new Bs({...this._def,rest:e})}}Bs.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Bs({items:t,typeName:Ve.ZodTuple,rest:null,...qe(e)})};class Ou extends Xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.object)return Oe(n,{code:Ce.invalid_type,expected:Me.object,received:n.parsedType}),Ge;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new Ns(n,a,n.path,a)),value:o._parse(new Ns(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Pr.mergeObjectAsync(r,s):Pr.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof Xe?new Ou({keyType:e,valueType:r,typeName:Ve.ZodRecord,...qe(n)}):new Ou({keyType:Kn.create(),valueType:e,typeName:Ve.ZodRecord,...qe(r)})}}class wp extends Xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.map)return Oe(n,{code:Ce.invalid_type,expected:Me.map,received:n.parsedType}),Ge;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,l],c)=>({key:s._parse(new Ns(n,a,n.path,[c,"key"])),value:i._parse(new Ns(n,l,n.path,[c,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return Ge;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(c.value,u.value)}return{status:r.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return Ge;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(c.value,u.value)}return{status:r.value,value:a}}}}wp.create=(t,e,r)=>new wp({valueType:e,keyType:t,typeName:Ve.ZodMap,...qe(r)});class fa extends Xe{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.set)return Oe(n,{code:Ce.invalid_type,expected:Me.set,received:n.parsedType}),Ge;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(Oe(n,{code:Ce.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(Oe(n,{code:Ce.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return Ge;u.status==="dirty"&&r.dirty(),c.add(u.value)}return{status:r.value,value:c}}const a=[...n.data.values()].map((l,c)=>i._parse(new Ns(n,l,n.path,c)));return n.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,r){return new fa({...this._def,minSize:{value:e,message:$e.toString(r)}})}max(e,r){return new fa({...this._def,maxSize:{value:e,message:$e.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}fa.create=(t,e)=>new fa({valueType:t,minSize:null,maxSize:null,typeName:Ve.ZodSet,...qe(e)});class dl extends Xe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==Me.function)return Oe(r,{code:Ce.invalid_type,expected:Me.function,received:r.parsedType}),Ge;function n(a,l){return vp({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,gp(),Rl].filter(c=>!!c),issueData:{code:Ce.invalid_arguments,argumentsError:l}})}function s(a,l){return vp({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,gp(),Rl].filter(c=>!!c),issueData:{code:Ce.invalid_return_type,returnTypeError:l}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof Il){const a=this;return Ur(async function(...l){const c=new fn([]),u=await a._def.args.parseAsync(l,i).catch(f=>{throw c.addIssue(n(l,f)),c}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw c.addIssue(s(d,f)),c})})}else{const a=this;return Ur(function(...l){const c=a._def.args.safeParse(l,i);if(!c.success)throw new fn([n(l,c.error)]);const u=Reflect.apply(o,this,c.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new fn([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new dl({...this._def,args:Bs.create(e).rest(ea.create())})}returns(e){return new dl({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new dl({args:e||Bs.create([]).rest(ea.create()),returns:r||ea.create(),typeName:Ve.ZodFunction,...qe(n)})}}class Du extends Xe{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Du.create=(t,e)=>new Du({getter:t,typeName:Ve.ZodLazy,...qe(e)});class Mu extends Xe{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return Oe(r,{received:r.data,code:Ce.invalid_literal,expected:this._def.value}),Ge}return{status:"valid",value:e.data}}get value(){return this._def.value}}Mu.create=(t,e)=>new Mu({value:t,typeName:Ve.ZodLiteral,...qe(e)});function aI(t,e){return new ro({values:t,typeName:Ve.ZodEnum,...qe(e)})}class ro extends Xe{constructor(){super(...arguments),jc.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return Oe(r,{expected:lt.joinValues(n),received:r.parsedType,code:Ce.invalid_type}),Ge}if(yp(this,jc)||nI(this,jc,new Set(this._def.values)),!yp(this,jc).has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return Oe(r,{received:r.data,code:Ce.invalid_enum_value,options:n}),Ge}return Ur(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return ro.create(e,{...this._def,...r})}exclude(e,r=this._def){return ro.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}jc=new WeakMap;ro.create=aI;class Lu extends Xe{constructor(){super(...arguments),$c.set(this,void 0)}_parse(e){const r=lt.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Me.string&&n.parsedType!==Me.number){const s=lt.objectValues(r);return Oe(n,{expected:lt.joinValues(s),received:n.parsedType,code:Ce.invalid_type}),Ge}if(yp(this,$c)||nI(this,$c,new Set(lt.getValidEnumValues(this._def.values))),!yp(this,$c).has(e.data)){const s=lt.objectValues(r);return Oe(n,{received:n.data,code:Ce.invalid_enum_value,options:s}),Ge}return Ur(e.data)}get enum(){return this._def.values}}$c=new WeakMap;Lu.create=(t,e)=>new Lu({values:t,typeName:Ve.ZodNativeEnum,...qe(e)});class Il extends Xe{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==Me.promise&&r.common.async===!1)return Oe(r,{code:Ce.invalid_type,expected:Me.promise,received:r.parsedType}),Ge;const n=r.parsedType===Me.promise?r.data:Promise.resolve(r.data);return Ur(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Il.create=(t,e)=>new Il({type:t,typeName:Ve.ZodPromise,...qe(e)});class Zn extends Xe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ve.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{Oe(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async a=>{if(r.value==="aborted")return Ge;const l=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return l.status==="aborted"?Ge:l.status==="dirty"||r.value==="dirty"?Za(l.value):l});{if(r.value==="aborted")return Ge;const a=this._def.schema._parseSync({data:o,path:n.path,parent:n});return a.status==="aborted"?Ge:a.status==="dirty"||r.value==="dirty"?Za(a.value):a}}if(s.type==="refinement"){const o=a=>{const l=s.refinement(a,i);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Ge:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?Ge:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!da(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>da(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:r.value,value:a})):o);lt.assertNever(s)}}Zn.create=(t,e,r)=>new Zn({schema:t,typeName:Ve.ZodEffects,effect:e,...qe(r)});Zn.createWithPreprocess=(t,e,r)=>new Zn({schema:e,effect:{type:"preprocess",transform:t},typeName:Ve.ZodEffects,...qe(r)});class Rs extends Xe{_parse(e){return this._getType(e)===Me.undefined?Ur(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Rs.create=(t,e)=>new Rs({innerType:t,typeName:Ve.ZodOptional,...qe(e)});class no extends Xe{_parse(e){return this._getType(e)===Me.null?Ur(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}no.create=(t,e)=>new no({innerType:t,typeName:Ve.ZodNullable,...qe(e)});class Nu extends Xe{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===Me.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Nu.create=(t,e)=>new Nu({innerType:t,typeName:Ve.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...qe(e)});class Bu extends Xe{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return ku(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new fn(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new fn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Bu.create=(t,e)=>new Bu({innerType:t,typeName:Ve.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...qe(e)});class xp extends Xe{_parse(e){if(this._getType(e)!==Me.nan){const n=this._getOrReturnCtx(e);return Oe(n,{code:Ce.invalid_type,expected:Me.nan,received:n.parsedType}),Ge}return{status:"valid",value:e.data}}}xp.create=t=>new xp({typeName:Ve.ZodNaN,...qe(t)});const DH=Symbol("zod_brand");class Nw extends Xe{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Vd extends Xe{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ge:i.status==="dirty"?(r.dirty(),Za(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ge:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new Vd({in:e,out:r,typeName:Ve.ZodPipeline})}}class Fu extends Xe{_parse(e){const r=this._def.innerType._parse(e),n=s=>(da(s)&&(s.value=Object.freeze(s.value)),s);return ku(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}Fu.create=(t,e)=>new Fu({innerType:t,typeName:Ve.ZodReadonly,...qe(e)});function fE(t,e){const r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function lI(t,e={},r){return t?Pl.create().superRefine((n,s)=>{var i,o;const a=t(n);if(a instanceof Promise)return a.then(l=>{var c,u;if(!l){const d=fE(e,n),h=(u=(c=d.fatal)!==null&&c!==void 0?c:r)!==null&&u!==void 0?u:!0;s.addIssue({code:"custom",...d,fatal:h})}});if(!a){const l=fE(e,n),c=(o=(i=l.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0;s.addIssue({code:"custom",...l,fatal:c})}}):Pl.create()}const MH={object:It.lazycreate};var Ve;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ve||(Ve={}));const LH=(t,e={message:`Input not instance of ${t.name}`})=>lI(r=>r instanceof t,e),cI=Kn.create,uI=eo.create,NH=xp.create,BH=to.create,dI=Tu.create,FH=ha.create,jH=_p.create,$H=Au.create,UH=Ru.create,HH=Pl.create,VH=ea.create,GH=yi.create,zH=bp.create,WH=Jn.create,KH=It.create,qH=It.strictCreate,JH=Pu.create,YH=rg.create,ZH=Iu.create,XH=Bs.create,QH=Ou.create,eV=wp.create,tV=fa.create,rV=dl.create,nV=Du.create,sV=Mu.create,iV=ro.create,oV=Lu.create,aV=Il.create,pE=Zn.create,lV=Rs.create,cV=no.create,uV=Zn.createWithPreprocess,dV=Vd.create,hV=()=>cI().optional(),fV=()=>uI().optional(),pV=()=>dI().optional(),mV={string:t=>Kn.create({...t,coerce:!0}),number:t=>eo.create({...t,coerce:!0}),boolean:t=>Tu.create({...t,coerce:!0}),bigint:t=>to.create({...t,coerce:!0}),date:t=>ha.create({...t,coerce:!0})},gV=Ge;var L=Object.freeze({__proto__:null,defaultErrorMap:Rl,setErrorMap:uH,getErrorMap:gp,makeIssue:vp,EMPTY_PATH:dH,addIssueToContext:Oe,ParseStatus:Pr,INVALID:Ge,DIRTY:Za,OK:Ur,isAborted:T0,isDirty:A0,isValid:da,isAsync:ku,get util(){return lt},get objectUtil(){return k0},ZodParsedType:Me,getParsedType:Ys,ZodType:Xe,datetimeRegex:oI,ZodString:Kn,ZodNumber:eo,ZodBigInt:to,ZodBoolean:Tu,ZodDate:ha,ZodSymbol:_p,ZodUndefined:Au,ZodNull:Ru,ZodAny:Pl,ZodUnknown:ea,ZodNever:yi,ZodVoid:bp,ZodArray:Jn,ZodObject:It,ZodUnion:Pu,ZodDiscriminatedUnion:rg,ZodIntersection:Iu,ZodTuple:Bs,ZodRecord:Ou,ZodMap:wp,ZodSet:fa,ZodFunction:dl,ZodLazy:Du,ZodLiteral:Mu,ZodEnum:ro,ZodNativeEnum:Lu,ZodPromise:Il,ZodEffects:Zn,ZodTransformer:Zn,ZodOptional:Rs,ZodNullable:no,ZodDefault:Nu,ZodCatch:Bu,ZodNaN:xp,BRAND:DH,ZodBranded:Nw,ZodPipeline:Vd,ZodReadonly:Fu,custom:lI,Schema:Xe,ZodSchema:Xe,late:MH,get ZodFirstPartyTypeKind(){return Ve},coerce:mV,any:HH,array:WH,bigint:BH,boolean:dI,date:FH,discriminatedUnion:YH,effect:pE,enum:iV,function:rV,instanceof:LH,intersection:ZH,lazy:nV,literal:sV,map:eV,nan:NH,nativeEnum:oV,never:GH,null:UH,nullable:cV,number:uI,object:KH,oboolean:pV,onumber:fV,optional:lV,ostring:hV,pipeline:dV,preprocess:uV,promise:aV,record:QH,set:tV,strictObject:qH,string:cI,symbol:jH,transformer:pE,tuple:XH,undefined:$H,union:JH,unknown:VH,void:zH,NEVER:gV,ZodIssueCode:Ce,quotelessJson:cH,ZodError:fn});new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");var ju={code:"0",name:"text",parse:t=>{if(typeof t!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:t}}},$u={code:"3",name:"error",parse:t=>{if(typeof t!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:t}}},Uu={code:"4",name:"assistant_message",parse:t=>{if(t==null||typeof t!="object"||!("id"in t)||!("role"in t)||!("content"in t)||typeof t.id!="string"||typeof t.role!="string"||t.role!=="assistant"||!Array.isArray(t.content)||!t.content.every(e=>e!=null&&typeof e=="object"&&"type"in e&&e.type==="text"&&"text"in e&&e.text!=null&&typeof e.text=="object"&&"value"in e.text&&typeof e.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:t}}},Hu={code:"5",name:"assistant_control_data",parse:t=>{if(t==null||typeof t!="object"||!("threadId"in t)||!("messageId"in t)||typeof t.threadId!="string"||typeof t.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:t.threadId,messageId:t.messageId}}}},Vu={code:"6",name:"data_message",parse:t=>{if(t==null||typeof t!="object"||!("role"in t)||!("data"in t)||typeof t.role!="string"||t.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:t}}},vV=[ju,$u,Uu,Hu,Vu];ju.code+"",$u.code+"",Uu.code+"",Hu.code+"",Vu.code+"";ju.name+"",ju.code,$u.name+"",$u.code,Uu.name+"",Uu.code,Hu.name+"",Hu.code,Vu.name+"",Vu.code;vV.map(t=>t.code);function yV(t){const e=["ROOT"];let r=-1,n=null;function s(l,c,u){switch(l){case'"':{r=c,e.pop(),e.push(u),e.push("INSIDE_STRING");break}case"f":case"t":case"n":{r=c,n=c,e.pop(),e.push(u),e.push("INSIDE_LITERAL");break}case"-":{e.pop(),e.push(u),e.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{r=c,e.pop(),e.push(u),e.push("INSIDE_NUMBER");break}case"{":{r=c,e.pop(),e.push(u),e.push("INSIDE_OBJECT_START");break}case"[":{r=c,e.pop(),e.push(u),e.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{e.pop(),e.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{r=c,e.pop();break}}}function o(l,c){switch(l){case",":{e.pop(),e.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{r=c,e.pop();break}}}for(let l=0;l<t.length;l++){const c=t[l];switch(e[e.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{e.pop(),e.push("INSIDE_OBJECT_KEY");break}case"}":{r=l,e.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{e.pop(),e.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{e.pop(),e.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{e.pop(),e.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{e.pop(),r=l;break}case"\\":{e.push("INSIDE_STRING_ESCAPE");break}default:r=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{r=l,e.pop();break}default:{r=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{e.pop(),e.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{r=l,e.pop();break}default:{r=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{e.pop(),r=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{r=l;break}case"e":case"E":case"-":case".":break;case",":{e.pop(),e[e.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&o(c,l),e[e.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{e.pop(),e[e.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{e.pop(),e[e.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&o(c,l);break}default:{e.pop();break}}break}case"INSIDE_LITERAL":{const d=t.substring(n,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(e.pop(),e[e.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):e[e.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&o(c,l)):r=l;break}}}let a=t.slice(0,r+1);for(let l=e.length-1;l>=0;l--)switch(e[l]){case"INSIDE_STRING":{a+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{a+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{a+="]";break}case"INSIDE_LITERAL":{const u=t.substring(n,t.length);"true".startsWith(u)?a+="true".slice(u.length):"false".startsWith(u)?a+="false".slice(u.length):"null".startsWith(u)&&(a+="null".slice(u.length))}}return a}function _V(t){if(t===void 0)return{value:void 0,state:"undefined-input"};let e=pp({text:t});return e.success?{value:e.value,state:"successful-parse"}:(e=pp({text:yV(t)}),e.success?{value:e.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Gu={code:"0",name:"text",parse:t=>{if(typeof t!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:t}}},zu={code:"2",name:"data",parse:t=>{if(!Array.isArray(t))throw new Error('"data" parts expect an array value.');return{type:"data",value:t}}},Wu={code:"3",name:"error",parse:t=>{if(typeof t!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:t}}},Ku={code:"8",name:"message_annotations",parse:t=>{if(!Array.isArray(t))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:t}}},qu={code:"9",name:"tool_call",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("toolName"in t)||typeof t.toolName!="string"||!("args"in t)||typeof t.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:t}}},Ju={code:"a",name:"tool_result",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("result"in t))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:t}}},Yu={code:"b",name:"tool_call_streaming_start",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("toolName"in t)||typeof t.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:t}}},Zu={code:"c",name:"tool_call_delta",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("argsTextDelta"in t)||typeof t.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:t}}},Xu={code:"d",name:"finish_message",parse:t=>{if(t==null||typeof t!="object"||!("finishReason"in t)||typeof t.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const e={finishReason:t.finishReason};return"usage"in t&&t.usage!=null&&typeof t.usage=="object"&&"promptTokens"in t.usage&&"completionTokens"in t.usage&&(e.usage={promptTokens:typeof t.usage.promptTokens=="number"?t.usage.promptTokens:Number.NaN,completionTokens:typeof t.usage.completionTokens=="number"?t.usage.completionTokens:Number.NaN}),{type:"finish_message",value:e}}},Qu={code:"e",name:"finish_step",parse:t=>{if(t==null||typeof t!="object"||!("finishReason"in t)||typeof t.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const e={finishReason:t.finishReason,isContinued:!1};return"usage"in t&&t.usage!=null&&typeof t.usage=="object"&&"promptTokens"in t.usage&&"completionTokens"in t.usage&&(e.usage={promptTokens:typeof t.usage.promptTokens=="number"?t.usage.promptTokens:Number.NaN,completionTokens:typeof t.usage.completionTokens=="number"?t.usage.completionTokens:Number.NaN}),"isContinued"in t&&typeof t.isContinued=="boolean"&&(e.isContinued=t.isContinued),{type:"finish_step",value:e}}},ed={code:"f",name:"start_step",parse:t=>{if(t==null||typeof t!="object"||!("messageId"in t)||typeof t.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:t.messageId}}}},td={code:"g",name:"reasoning",parse:t=>{if(typeof t!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:t}}},bV=[Gu,zu,Wu,Ku,qu,Ju,Yu,Zu,Xu,Qu,ed,td],wV={[Gu.code]:Gu,[zu.code]:zu,[Wu.code]:Wu,[Ku.code]:Ku,[qu.code]:qu,[Ju.code]:Ju,[Yu.code]:Yu,[Zu.code]:Zu,[Xu.code]:Xu,[Qu.code]:Qu,[ed.code]:ed,[td.code]:td};Gu.name+"",Gu.code,zu.name+"",zu.code,Wu.name+"",Wu.code,Ku.name+"",Ku.code,qu.name+"",qu.code,Ju.name+"",Ju.code,Yu.name+"",Yu.code,Zu.name+"",Zu.code,Xu.name+"",Xu.code,Qu.name+"",Qu.code,ed.name+"",ed.code,td.name+"",td.code;var xV=bV.map(t=>t.code),SV=t=>{const e=t.indexOf(":");if(e===-1)throw new Error("Failed to parse stream string. No separator found.");const r=t.slice(0,e);if(!xV.includes(r))throw new Error(`Failed to parse stream string. Invalid code ${r}.`);const n=r,s=t.slice(e+1),i=JSON.parse(s);return wV[n].parse(i)},EV=10;function CV(t,e){const r=new Uint8Array(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return t.length=0,r}async function kV({stream:t,onTextPart:e,onReasoningPart:r,onDataPart:n,onErrorPart:s,onToolCallStreamingStartPart:i,onToolCallDeltaPart:o,onToolCallPart:a,onToolResultPart:l,onMessageAnnotationsPart:c,onFinishMessagePart:u,onFinishStepPart:d,onStartStepPart:h}){const f=t.getReader(),v=new TextDecoder,m=[];let p=0;for(;;){const{value:g}=await f.read();if(g&&(m.push(g),p+=g.length,g[g.length-1]!==EV))continue;if(m.length===0)break;const y=CV(m,p);p=0;const _=v.decode(y,{stream:!0}).split(`
`).filter(b=>b!=="").map(SV);for(const{type:b,value:w}of _)switch(b){case"text":await e?.(w);break;case"reasoning":await r?.(w);break;case"data":await n?.(w);break;case"error":await s?.(w);break;case"message_annotations":await c?.(w);break;case"tool_call_streaming_start":await i?.(w);break;case"tool_call_delta":await o?.(w);break;case"tool_call":await a?.(w);break;case"tool_result":await l?.(w);break;case"finish_message":await u?.(w);break;case"finish_step":await d?.(w);break;case"start_step":await h?.(w);break;default:{const E=b;throw new Error(`Unknown stream part type: ${E}`)}}}}function TV({promptTokens:t,completionTokens:e}){return{promptTokens:t,completionTokens:e,totalTokens:t+e}}async function AV({stream:t,update:e,onToolCall:r,onFinish:n,generateId:s=_s,getCurrentDate:i=()=>new Date}){const o=i();let a,l=!0,c;const u=[],d=[];let h;const f={};let v={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},m="unknown";function p(){const y=[...d];if(a==null){e(u,y);return}h?.length&&(a.annotations=h);const _={...JSON.parse(JSON.stringify(a)),revisionId:s(),createdAt:a.createdAt};e([...u,_],y)}function g(){return(l||a==null)&&(a!=null&&u.push(a),a={id:c??s(),role:"assistant",content:"",createdAt:o},l=!1,c=void 0),a}await kV({stream:t,onTextPart(y){const _=g();a={..._,content:_.content+y},p()},onToolCallStreamingStartPart(y){const _=g();_.toolInvocations==null&&(_.toolInvocations=[]),f[y.toolCallId]={text:"",toolName:y.toolName,index:_.toolInvocations.length},_.toolInvocations.push({state:"partial-call",toolCallId:y.toolCallId,toolName:y.toolName,args:void 0}),p()},onToolCallDeltaPart(y){const _=g(),b=f[y.toolCallId];b.text+=y.argsTextDelta;const{value:w}=_V(b.text);_.toolInvocations[b.index]={state:"partial-call",toolCallId:y.toolCallId,toolName:b.toolName,args:w},p()},async onToolCallPart(y){const _=g();if(f[y.toolCallId]!=null?_.toolInvocations[f[y.toolCallId].index]={state:"call",...y}:(_.toolInvocations==null&&(_.toolInvocations=[]),_.toolInvocations.push({state:"call",...y})),r){const b=await r({toolCall:y});b!=null&&(_.toolInvocations[_.toolInvocations.length-1]={state:"result",...y,result:b})}p()},onToolResultPart(y){const b=g().toolInvocations;if(b==null)throw new Error("tool_result must be preceded by a tool_call");const w=b.findIndex(E=>E.toolCallId===y.toolCallId);if(w===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");b[w]={...b[w],state:"result",...y},p()},onDataPart(y){d.push(...y),p()},onMessageAnnotationsPart(y){h==null?h=[...y]:h.push(...y),p()},onFinishStepPart(y){l=!y.isContinued},onStartStepPart(y){c=y.messageId},onFinishMessagePart(y){m=y.finishReason,y.usage!=null&&(v=TV(y.usage))},onErrorPart(y){throw new Error(y)}}),n?.({message:a,finishReason:m,usage:v})}async function RV({stream:t,onTextPart:e}){const r=t.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:n,value:s}=await r.read();if(n)break;await e(s)}}var PV=()=>fetch;async function IV({api:t,body:e,streamProtocol:r="data",credentials:n,headers:s,abortController:i,restoreMessagesOnFailure:o,onResponse:a,onUpdate:l,onFinish:c,onToolCall:u,generateId:d,fetch:h=PV()}){var f,v;const m=await h(t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",...s},signal:(f=i?.())==null?void 0:f.signal,credentials:n}).catch(p=>{throw o(),p});if(a)try{await a(m)}catch(p){throw p}if(!m.ok)throw o(),new Error((v=await m.text())!=null?v:"Failed to fetch the chat response.");if(!m.body)throw new Error("The response body is empty.");switch(r){case"text":{const p={id:d(),createdAt:new Date,role:"assistant",content:""};await RV({stream:m.body,onTextPart:g=>{p.content+=g,l([{...p}],[])}}),c?.(p,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await AV({stream:m.body,update:l,onToolCall:u,onFinish({message:p,finishReason:g,usage:y}){c&&p!=null&&c(p,{usage:y,finishReason:g})},generateId:d});return}default:{const p=r;throw new Error(`Unknown stream protocol: ${p}`)}}}async function mE(t){if(!t)return[];if(t instanceof FileList)return Promise.all(Array.from(t).map(async e=>{const{name:r,type:n}=e,s=await new Promise((i,o)=>{const a=new FileReader;a.onload=l=>{var c;i((c=l.target)==null?void 0:c.result)},a.onerror=l=>o(l),a.readAsDataURL(e)});return{name:r,contentType:n,url:s}}));if(Array.isArray(t))return t;throw new Error("Invalid attachments type")}var hI={exports:{}},fI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ol=k;function OV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var DV=typeof Object.is=="function"?Object.is:OV,MV=Ol.useState,LV=Ol.useEffect,NV=Ol.useLayoutEffect,BV=Ol.useDebugValue;function FV(t,e){var r=e(),n=MV({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return NV(function(){s.value=r,s.getSnapshot=e,Ev(s)&&i({inst:s})},[t,r,e]),LV(function(){return Ev(s)&&i({inst:s}),t(function(){Ev(s)&&i({inst:s})})},[t]),BV(r),r}function Ev(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!DV(t,r)}catch{return!0}}function jV(t,e){return e()}var $V=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?jV:FV;fI.useSyncExternalStore=Ol.useSyncExternalStore!==void 0?Ol.useSyncExternalStore:$V;hI.exports=fI;var UV=hI.exports;const pI=0,mI=1,gI=2,gE=3;var vE=Object.prototype.hasOwnProperty;function P0(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&P0(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(vE.call(t,r)&&++n&&!vE.call(e,r)||!(r in e)||!P0(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}const ti=new WeakMap,Gi=()=>{},Lr=Gi(),I0=Object,ct=t=>t===Lr,bs=t=>typeof t=="function",so=(t,e)=>({...t,...e}),vI=t=>bs(t.then),Cv={},Eh={},Bw="undefined",Gd=typeof window!=Bw,O0=typeof document!=Bw,HV=Gd&&"Deno"in window,VV=()=>Gd&&typeof window.requestAnimationFrame!=Bw,yI=(t,e)=>{const r=ti.get(t);return[()=>!ct(e)&&t.get(e)||Cv,n=>{if(!ct(e)){const s=t.get(e);e in Eh||(Eh[e]=s),r[5](e,so(s,n),s||Cv)}},r[6],()=>!ct(e)&&e in Eh?Eh[e]:!ct(e)&&t.get(e)||Cv]};let D0=!0;const GV=()=>D0,[M0,L0]=Gd&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Gi,Gi],zV=()=>{const t=O0&&document.visibilityState;return ct(t)||t!=="hidden"},WV=t=>(O0&&document.addEventListener("visibilitychange",t),M0("focus",t),()=>{O0&&document.removeEventListener("visibilitychange",t),L0("focus",t)}),KV=t=>{const e=()=>{D0=!0,t()},r=()=>{D0=!1};return M0("online",e),M0("offline",r),()=>{L0("online",e),L0("offline",r)}},qV={isOnline:GV,isVisible:zV},JV={initFocus:WV,initReconnect:KV},yE=!Re.useId,rd=!Gd||HV,YV=t=>VV()?window.requestAnimationFrame(t):setTimeout(t,1),kv=rd?k.useEffect:k.useLayoutEffect,Tv=typeof navigator<"u"&&navigator.connection,_E=!rd&&Tv&&(["slow-2g","2g"].includes(Tv.effectiveType)||Tv.saveData),Ch=new WeakMap,Av=(t,e)=>I0.prototype.toString.call(t)===`[object ${e}]`;let ZV=0;const N0=t=>{const e=typeof t,r=Av(t,"Date"),n=Av(t,"RegExp"),s=Av(t,"Object");let i,o;if(I0(t)===t&&!r&&!n){if(i=Ch.get(t),i)return i;if(i=++ZV+"~",Ch.set(t,i),Array.isArray(t)){for(i="@",o=0;o<t.length;o++)i+=N0(t[o])+",";Ch.set(t,i)}if(s){i="#";const a=I0.keys(t).sort();for(;!ct(o=a.pop());)ct(t[o])||(i+=o+":"+N0(t[o])+",");Ch.set(t,i)}}else i=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return i},Fw=t=>{if(bs(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?N0(t):"",[t,e]};let XV=0;const B0=()=>++XV;async function _I(...t){const[e,r,n,s]=t,i=so({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let o=i.populateCache;const a=i.rollbackOnError;let l=i.optimisticData;const c=h=>typeof a=="function"?a(h):a!==!1,u=i.throwOnError;if(bs(r)){const h=r,f=[],v=e.keys();for(const m of v)!/^\$(inf|sub)\$/.test(m)&&h(e.get(m)._k)&&f.push(m);return Promise.all(f.map(d))}return d(r);async function d(h){const[f]=Fw(h);if(!f)return;const[v,m]=yI(e,f),[p,g,y,_]=ti.get(e),b=()=>{const P=p[f];return(bs(i.revalidate)?i.revalidate(v().data,h):i.revalidate!==!1)&&(delete y[f],delete _[f],P&&P[0])?P[0](gI).then(()=>v().data):v().data};if(t.length<3)return b();let w=n,E;const S=B0();g[f]=[S,0];const x=!ct(l),T=v(),D=T.data,O=T._c,R=ct(O)?D:O;if(x&&(l=bs(l)?l(R,D):l,m({data:l,_c:R})),bs(w))try{w=w(R)}catch(P){E=P}if(w&&vI(w))if(w=await w.catch(P=>{E=P}),S!==g[f][0]){if(E)throw E;return w}else E&&x&&c(E)&&(o=!0,m({data:R,_c:Lr}));if(o&&!E)if(bs(o)){const P=o(w,R);m({data:P,error:Lr,_c:Lr})}else m({data:w,error:Lr,_c:Lr});if(g[f][1]=B0(),Promise.resolve(b()).then(()=>{m({_c:Lr})}),E){if(u)throw E;return}return w}}const bE=(t,e)=>{for(const r in t)t[r][0]&&t[r][0](e)},QV=(t,e)=>{if(!ti.has(t)){const r=so(JV,e),n=Object.create(null),s=_I.bind(Lr,t);let i=Gi;const o=Object.create(null),a=(u,d)=>{const h=o[u]||[];return o[u]=h,h.push(d),()=>h.splice(h.indexOf(d),1)},l=(u,d,h)=>{t.set(u,d);const f=o[u];if(f)for(const v of f)v(d,h)},c=()=>{if(!ti.has(t)&&(ti.set(t,[n,Object.create(null),Object.create(null),Object.create(null),s,l,a]),!rd)){const u=r.initFocus(setTimeout.bind(Lr,bE.bind(Lr,n,pI))),d=r.initReconnect(setTimeout.bind(Lr,bE.bind(Lr,n,mI)));i=()=>{u&&u(),d&&d(),ti.delete(t)}}};return c(),[t,s,c,i]}return[t,ti.get(t)[4]]},eG=(t,e,r,n,s)=>{const i=r.errorRetryCount,o=s.retryCount,a=~~((Math.random()+.5)*(1<<(o<8?o:8)))*r.errorRetryInterval;!ct(i)&&o>i||setTimeout(n,a,s)},tG=P0,[bI,rG]=QV(new Map),nG=so({onLoadingSlow:Gi,onSuccess:Gi,onError:Gi,onErrorRetry:eG,onDiscarded:Gi,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:_E?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:_E?5e3:3e3,compare:tG,isPaused:()=>!1,cache:bI,mutate:rG,fallback:{}},qV),sG=(t,e)=>{const r=so(t,e);if(e){const{use:n,fallback:s}=t,{use:i,fallback:o}=e;n&&i&&(r.use=n.concat(i)),s&&o&&(r.fallback=so(s,o))}return r},iG=k.createContext({}),oG="$inf$",wI=Gd&&window.__SWR_DEVTOOLS_USE__,aG=wI?window.__SWR_DEVTOOLS_USE__:[],lG=()=>{wI&&(window.__SWR_DEVTOOLS_REACT__=Re)},cG=t=>bs(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],uG=()=>so(nG,k.useContext(iG)),dG=t=>(e,r,n)=>t(e,r&&((...i)=>{const[o]=Fw(e),[,,,a]=ti.get(bI);if(o.startsWith(oG))return r(...i);const l=a[o];return ct(l)?r(...i):(delete a[o],l)}),n),hG=aG.concat(dG),fG=t=>function(...r){const n=uG(),[s,i,o]=cG(r),a=sG(n,o);let l=t;const{use:c}=a,u=(c||[]).concat(hG);for(let d=u.length;d--;)l=u[d](l);return l(s,i||a.fetcher||null,a)},pG=(t,e,r)=>{const n=e[t]||(e[t]=[]);return n.push(r),()=>{const s=n.indexOf(r);s>=0&&(n[s]=n[n.length-1],n.pop())}};lG();const Rv=Re.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Pv={dedupe:!0},mG=(t,e,r)=>{const{cache:n,compare:s,suspense:i,fallbackData:o,revalidateOnMount:a,revalidateIfStale:l,refreshInterval:c,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:h}=r,[f,v,m,p]=ti.get(n),[g,y]=Fw(t),_=k.useRef(!1),b=k.useRef(!1),w=k.useRef(g),E=k.useRef(e),S=k.useRef(r),x=()=>S.current,T=()=>x().isVisible()&&x().isOnline(),[D,O,R,P]=yI(n,g),A=k.useRef({}).current,H=ct(o)?ct(r.fallback)?Lr:r.fallback[g]:o,K=(ue,N)=>{for(const Z in A){const ie=Z;if(ie==="data"){if(!s(ue[ie],N[ie])&&(!ct(ue[ie])||!s(te,N[ie])))return!1}else if(N[ie]!==ue[ie])return!1}return!0},V=k.useMemo(()=>{const ue=!g||!e?!1:ct(a)?x().isPaused()||i?!1:l!==!1:a,N=ce=>{const ge=so(ce);return delete ge._k,ue?{isValidating:!0,isLoading:!0,...ge}:ge},Z=D(),ie=P(),W=N(Z),z=Z===ie?W:N(ie);let ae=W;return[()=>{const ce=N(D());return K(ce,ae)?(ae.data=ce.data,ae.isLoading=ce.isLoading,ae.isValidating=ce.isValidating,ae.error=ce.error,ae):(ae=ce,ce)},()=>z]},[n,g]),q=UV.useSyncExternalStore(k.useCallback(ue=>R(g,(N,Z)=>{K(Z,N)||ue()}),[n,g]),V[0],V[1]),I=!_.current,$=f[g]&&f[g].length>0,j=q.data,U=ct(j)?H&&vI(H)?Rv(H):H:j,J=q.error,ne=k.useRef(U),te=h?ct(j)?ct(ne.current)?U:ne.current:j:U,me=$&&!ct(J)?!1:I&&!ct(a)?a:x().isPaused()?!1:i?ct(U)?!1:l:ct(U)||l,re=!!(g&&e&&I&&me),F=ct(q.isValidating)?re:q.isValidating,X=ct(q.isLoading)?re:q.isLoading,Y=k.useCallback(async ue=>{const N=E.current;if(!g||!N||b.current||x().isPaused())return!1;let Z,ie,W=!0;const z=ue||{},ae=!m[g]||!z.dedupe,ce=()=>yE?!b.current&&g===w.current&&_.current:g===w.current,ge={isValidating:!1,isLoading:!1},de=()=>{O(ge)},fe=()=>{const _e=m[g];_e&&_e[1]===ie&&delete m[g]},we={isValidating:!0};ct(D().data)&&(we.isLoading=!0);try{if(ae&&(O(we),r.loadingTimeout&&ct(D().data)&&setTimeout(()=>{W&&ce()&&x().onLoadingSlow(g,r)},r.loadingTimeout),m[g]=[N(y),B0()]),[Z,ie]=m[g],Z=await Z,ae&&setTimeout(fe,r.dedupingInterval),!m[g]||m[g][1]!==ie)return ae&&ce()&&x().onDiscarded(g),!1;ge.error=Lr;const _e=v[g];if(!ct(_e)&&(ie<=_e[0]||ie<=_e[1]||_e[1]===0))return de(),ae&&ce()&&x().onDiscarded(g),!1;const Ae=D().data;ge.data=s(Ae,Z)?Ae:Z,ae&&ce()&&x().onSuccess(Z,g,r)}catch(_e){fe();const Ae=x(),{shouldRetryOnError:ze}=Ae;Ae.isPaused()||(ge.error=_e,ae&&ce()&&(Ae.onError(_e,g,Ae),(ze===!0||bs(ze)&&ze(_e))&&(!x().revalidateOnFocus||!x().revalidateOnReconnect||T())&&Ae.onErrorRetry(_e,g,Ae,Ne=>{const ft=f[g];ft&&ft[0]&&ft[0](gE,Ne)},{retryCount:(z.retryCount||0)+1,dedupe:!0})))}return W=!1,de(),!0},[g,n]),oe=k.useCallback((...ue)=>_I(n,w.current,...ue),[]);if(kv(()=>{E.current=e,S.current=r,ct(j)||(ne.current=j)}),kv(()=>{if(!g)return;const ue=Y.bind(Lr,Pv);let N=0;x().revalidateOnFocus&&(N=Date.now()+x().focusThrottleInterval);const ie=pG(g,f,(W,z={})=>{if(W==pI){const ae=Date.now();x().revalidateOnFocus&&ae>N&&T()&&(N=ae+x().focusThrottleInterval,ue())}else if(W==mI)x().revalidateOnReconnect&&T()&&ue();else{if(W==gI)return Y();if(W==gE)return Y(z)}});return b.current=!1,w.current=g,_.current=!0,O({_k:y}),me&&(ct(U)||rd?ue():YV(ue)),()=>{b.current=!0,ie()}},[g]),kv(()=>{let ue;function N(){const ie=bs(c)?c(D().data):c;ie&&ue!==-1&&(ue=setTimeout(Z,ie))}function Z(){!D().error&&(u||x().isVisible())&&(d||x().isOnline())?Y(Pv).then(N):N()}return N(),()=>{ue&&(clearTimeout(ue),ue=-1)}},[c,u,d,g]),k.useDebugValue(te),i&&ct(U)&&g){if(!yE&&rd)throw new Error("Fallback data is required when using Suspense in SSR.");E.current=e,S.current=r,b.current=!1;const ue=p[g];if(!ct(ue)){const N=oe(ue);Rv(N)}if(ct(J)){const N=Y(Pv);ct(te)||(N.status="fulfilled",N.value=!0),Rv(N)}else throw J}return{mutate:oe,get data(){return A.data=!0,te},get error(){return A.error=!0,J},get isValidating(){return A.isValidating=!0,F},get isLoading(){return A.isLoading=!0,X}}},kh=fG(mG);function gG(t,e){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,n=0;return function(...i){clearTimeout(r);const o=Date.now(),a=o-n,l=e-a;l<=0?(n=o,t.apply(this,i)):r=setTimeout(()=>{n=Date.now(),t.apply(this,i)},l)}}var vG=gG;const yG=Ql(vG);function wE(t,e){return e!=null?yG(t,e):t}var _G=async(t,e,r,n,s,i,o,a,l,c,u,d,h,f,v,m,p,g)=>{var y;const _=o.current;r(e.messages,!1);const b=f?e.messages:e.messages.map(({role:E,content:S,experimental_attachments:x,data:T,annotations:D,toolInvocations:O})=>({role:E,content:S,...x!==void 0&&{experimental_attachments:x},...T!==void 0&&{data:T},...D!==void 0&&{annotations:D},...O!==void 0&&{toolInvocations:O}})),w=s.current;return await IV({api:t,body:(y=v?.({id:g,messages:e.messages,requestData:e.data,requestBody:e.body}))!=null?y:{id:g,messages:b,data:e.data,...i.current.body,...e.body},streamProtocol:c,credentials:i.current.credentials,headers:{...i.current.headers,...e.headers},abortController:()=>a.current,restoreMessagesOnFailure(){p||r(_,!1)},onResponse:d,onUpdate(E,S){r([...e.messages,...E],!1),S?.length&&n([...w??[],...S],!1)},onToolCall:h,onFinish:u,generateId:l,fetch:m})};function bG({api:t="/api/chat",id:e,initialMessages:r,initialInput:n="",sendExtraMessageFields:s,onToolCall:i,experimental_prepareRequestBody:o,maxSteps:a=1,streamProtocol:l="data",onResponse:c,onFinish:u,onError:d,credentials:h,headers:f,body:v,generateId:m=_s,fetch:p,keepLastMessageOnError:g=!0,experimental_throttle:y}={}){const[_]=k.useState(m),b=e??_,w=typeof t=="string"?[t,b]:b,[E]=k.useState([]),{data:S,mutate:x}=kh([w,"messages"],null,{fallbackData:r??E}),T=k.useRef(S||[]);k.useEffect(()=>{T.current=S||[]},[S]);const{data:D,mutate:O}=kh([w,"streamData"],null),R=k.useRef(D);k.useEffect(()=>{R.current=D},[D]);const{data:P=!1,mutate:A}=kh([w,"loading"],null),{data:H=void 0,mutate:K}=kh([w,"error"],null),V=k.useRef(null),q=k.useRef({credentials:h,headers:f,body:v});k.useEffect(()=>{q.current={credentials:h,headers:f,body:v}},[h,f,v]);const I=k.useCallback(async Y=>{const oe=T.current.length;try{A(!0),K(void 0);const N=new AbortController;V.current=N,await _G(t,Y,wE(x,y),wE(O,y),R,q,T,V,m,l,u,c,i,s,o,p,g,b),V.current=null}catch(N){if(N.name==="AbortError")return V.current=null,null;d&&N instanceof Error&&d(N),K(N)}finally{A(!1)}const le=T.current,ue=le[le.length-1];le.length>oe&&ue!=null&&a>1&&xE(ue)&&wG(le)<a&&await I({messages:le})},[x,A,t,q,c,u,d,K,O,R,l,s,o,i,a,T,V,m,p,g,y,b]),$=k.useCallback(async(Y,{data:oe,headers:le,body:ue,experimental_attachments:N}={})=>{var Z,ie;const W=await mE(N),z=T.current.concat({...Y,id:(Z=Y.id)!=null?Z:m(),createdAt:(ie=Y.createdAt)!=null?ie:new Date,experimental_attachments:W.length>0?W:void 0});return I({messages:z,headers:le,body:ue,data:oe})},[I,m]),j=k.useCallback(async({data:Y,headers:oe,body:le}={})=>{const ue=T.current;if(ue.length===0)return null;const N=ue[ue.length-1];return I({messages:N.role==="assistant"?ue.slice(0,-1):ue,headers:oe,body:le,data:Y})},[I]),U=k.useCallback(()=>{V.current&&(V.current.abort(),V.current=null)},[]),J=k.useCallback(Y=>{typeof Y=="function"&&(Y=Y(T.current)),x(Y,!1),T.current=Y},[x]),ne=k.useCallback(Y=>{typeof Y=="function"&&(Y=Y(R.current)),O(Y,!1),R.current=Y},[O]),[te,me]=k.useState(n),re=k.useCallback(async(Y,oe={},le)=>{var ue;if((ue=Y?.preventDefault)==null||ue.call(Y),!te&&!oe.allowEmptySubmit)return;le&&(q.current={...q.current,...le});const N=await mE(oe.experimental_attachments),ie={messages:!te&&!N.length&&oe.allowEmptySubmit?T.current:T.current.concat({id:m(),createdAt:new Date,role:"user",content:te,experimental_attachments:N.length>0?N:void 0}),headers:oe.headers,body:oe.body,data:oe.data};I(ie),me("")},[te,m,I]),F=Y=>{me(Y.target.value)},X=k.useCallback(({toolCallId:Y,result:oe})=>{const le=T.current.map((N,Z,ie)=>Z===ie.length-1&&N.role==="assistant"&&N.toolInvocations?{...N,toolInvocations:N.toolInvocations.map(W=>W.toolCallId===Y?{...W,result:oe,state:"result"}:W)}:N);x(le,!1);const ue=le[le.length-1];xE(ue)&&I({messages:le})},[x,I]);return{messages:S||[],id:b,setMessages:J,data:D,setData:ne,error:H,append:$,reload:j,stop:U,input:te,setInput:me,handleInputChange:F,handleSubmit:re,isLoading:P,addToolResult:X}}function xE(t){return t.role==="assistant"&&t.toolInvocations&&t.toolInvocations.length>0&&t.toolInvocations.every(e=>"result"in e)}function wG(t){let e=0;for(let r=t.length-1;r>=0&&t[r].role==="assistant";r--)e++;return e}var xG=bG;const jw=k.createContext({});function nd(t){const e=k.useRef(null);return e.current===null&&(e.current=t()),e.current}const ng=k.createContext(null),$w=k.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class SG extends k.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function EG({children:t,isPresent:e}){const r=k.useId(),n=k.useRef(null),s=k.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=k.useContext($w);return k.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=s.current;if(e||!n.current||!o||!a)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return i&&(u.nonce=i),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),C.jsx(SG,{isPresent:e,childRef:n,sizeRef:s,children:k.cloneElement(t,{ref:n})})}const CG=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:o})=>{const a=nd(kG),l=k.useId(),c=k.useCallback(d=>{a.set(d,!0);for(const h of a.values())if(!h)return;n&&n()},[a,n]),u=k.useMemo(()=>({id:l,initial:e,isPresent:r,custom:s,onExitComplete:c,register:d=>(a.set(d,!1),()=>a.delete(d))}),i?[Math.random(),c]:[r,c]);return k.useMemo(()=>{a.forEach((d,h)=>a.set(h,!1))},[r]),k.useEffect(()=>{!r&&!a.size&&n&&n()},[r]),o==="popLayout"&&(t=C.jsx(EG,{isPresent:r,children:t})),C.jsx(ng.Provider,{value:u,children:t})};function kG(){return new Map}function xI(t=!0){const e=k.useContext(ng);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,i=k.useId();k.useEffect(()=>{t&&s(i)},[t]);const o=k.useCallback(()=>t&&n&&n(i),[i,n,t]);return!r&&n?[!1,o]:[!0]}const Th=t=>t.key||"";function SE(t){const e=[];return k.Children.forEach(t,r=>{k.isValidElement(r)&&e.push(r)}),e}const Uw=typeof window<"u",SI=Uw?k.useLayoutEffect:k.useEffect,Hw=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1})=>{const[a,l]=xI(o),c=k.useMemo(()=>SE(t),[t]),u=o&&!a?[]:c.map(Th),d=k.useRef(!0),h=k.useRef(c),f=nd(()=>new Map),[v,m]=k.useState(c),[p,g]=k.useState(c);SI(()=>{d.current=!1,h.current=c;for(let b=0;b<p.length;b++){const w=Th(p[b]);u.includes(w)?f.delete(w):f.get(w)!==!0&&f.set(w,!1)}},[p,u.length,u.join("-")]);const y=[];if(c!==v){let b=[...c];for(let w=0;w<p.length;w++){const E=p[w],S=Th(E);u.includes(S)||(b.splice(w,0,E),y.push(E))}i==="wait"&&y.length&&(b=y),g(SE(b)),m(c);return}const{forceRender:_}=k.useContext(jw);return C.jsx(C.Fragment,{children:p.map(b=>{const w=Th(b),E=o&&!a?!1:c===p||u.includes(w),S=()=>{if(f.has(w))f.set(w,!0);else return;let x=!0;f.forEach(T=>{T||(x=!1)}),x&&(_?.(),g(h.current),o&&l?.(),n&&n())};return C.jsx(CG,{isPresent:E,initial:!d.current||r?void 0:!1,custom:E?void 0:e,presenceAffectsLayout:s,mode:i,onExitComplete:E?void 0:S,children:b},w)})})},pn=t=>t;let EI=pn;function Vw(t){let e;return()=>(e===void 0&&(e=t()),e)}const pa=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n},Ps=t=>t*1e3,Is=t=>t/1e3,TG={useManualTiming:!1};function AG(t){let e=new Set,r=new Set,n=!1,s=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,d=!1)=>{const f=d&&n?e:r;return u&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{r.delete(c),i.delete(c)},process:c=>{if(o=c,n){s=!0;return}n=!0,[e,r]=[r,e],e.forEach(a),e.clear(),n=!1,s&&(s=!1,l.process(c))}};return l}const Ah=["read","resolveKeyframes","update","preRender","render","postRender"],RG=40;function CI(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=Ah.reduce((g,y)=>(g[y]=AG(i),g),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:d,postRender:h}=o,f=()=>{const g=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(g-s.timestamp,RG),1),s.timestamp=g,s.isProcessing=!0,a.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(f))},v=()=>{r=!0,n=!0,s.isProcessing||t(f)};return{schedule:Ah.reduce((g,y)=>{const _=o[y];return g[y]=(b,w=!1,E=!1)=>(r||v(),_.schedule(b,w,E)),g},{}),cancel:g=>{for(let y=0;y<Ah.length;y++)o[Ah[y]].cancel(g)},state:s,steps:o}}const{schedule:kt,cancel:io,state:ur,steps:Iv}=CI(typeof requestAnimationFrame<"u"?requestAnimationFrame:pn,!0),kI=k.createContext({strict:!1}),EE={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Dl={};for(const t in EE)Dl[t]={isEnabled:e=>EE[t].some(r=>!!e[r])};function PG(t){for(const e in t)Dl[e]={...Dl[e],...t[e]}}const IG=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Sp(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||IG.has(t)}let TI=t=>!Sp(t);function OG(t){t&&(TI=e=>e.startsWith("on")?!Sp(e):t(e))}try{OG(require("@emotion/is-prop-valid").default)}catch{}function DG(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(TI(s)||r===!0&&Sp(s)||!e&&!Sp(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}function MG(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...n)=>t(...n);return new Proxy(r,{get:(n,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}const sg=k.createContext({});function sd(t){return typeof t=="string"||Array.isArray(t)}function ig(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Gw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],zw=["initial",...Gw];function og(t){return ig(t.animate)||zw.some(e=>sd(t[e]))}function AI(t){return!!(og(t)||t.variants)}function LG(t,e){if(og(t)){const{initial:r,animate:n}=t;return{initial:r===!1||sd(r)?r:void 0,animate:sd(n)?n:void 0}}return t.inherit!==!1?e:{}}function NG(t){const{initial:e,animate:r}=LG(t,k.useContext(sg));return k.useMemo(()=>({initial:e,animate:r}),[CE(e),CE(r)])}function CE(t){return Array.isArray(t)?t.join(" "):t}const BG=Symbol.for("motionComponentSymbol");function Xa(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function FG(t,e,r){return k.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):Xa(r)&&(r.current=n))},[e])}const Ww=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),jG="framerAppearId",RI="data-"+Ww(jG),{schedule:Kw}=CI(queueMicrotask,!1),PI=k.createContext({});function $G(t,e,r,n,s){var i,o;const{visualElement:a}=k.useContext(sg),l=k.useContext(kI),c=k.useContext(ng),u=k.useContext($w).reducedMotion,d=k.useRef(null);n=n||l.renderer,!d.current&&n&&(d.current=n(t,{visualState:e,parent:a,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,f=k.useContext(PI);h&&!h.projection&&s&&(h.type==="html"||h.type==="svg")&&UG(d.current,r,s,f);const v=k.useRef(!1);k.useInsertionEffect(()=>{h&&v.current&&h.update(r,c)});const m=r[RI],p=k.useRef(!!m&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,m))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,m)));return SI(()=>{h&&(v.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),Kw.render(h.render),p.current&&h.animationState&&h.animationState.animateChanges())}),k.useEffect(()=>{h&&(!p.current&&h.animationState&&h.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,m)}),p.current=!1))}),h}function UG(t,e,r,n){const{layoutId:s,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:II(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||a&&Xa(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,layoutScroll:l,layoutRoot:c})}function II(t){if(t)return t.options.allowProjection!==!1?t.projection:II(t.parent)}function HG({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:s}){var i,o;t&&PG(t);function a(c,u){let d;const h={...k.useContext($w),...c,layoutId:VG(c)},{isStatic:f}=h,v=NG(c),m=n(c,f);if(!f&&Uw){GG();const p=zG(h);d=p.MeasureLayout,v.visualElement=$G(s,m,h,e,p.ProjectionNode)}return C.jsxs(sg.Provider,{value:v,children:[d&&v.visualElement?C.jsx(d,{visualElement:v.visualElement,...h}):null,r(s,c,FG(m,v.visualElement,u),m,f,v.visualElement)]})}a.displayName=`motion.${typeof s=="string"?s:`create(${(o=(i=s.displayName)!==null&&i!==void 0?i:s.name)!==null&&o!==void 0?o:""})`}`;const l=k.forwardRef(a);return l[BG]=s,l}function VG({layoutId:t}){const e=k.useContext(jw).id;return e&&t!==void 0?e+"-"+t:t}function GG(t,e){k.useContext(kI).strict}function zG(t){const{drag:e,layout:r}=Dl;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e?.isEnabled(t)||r?.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const WG=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function qw(t){return typeof t!="string"||t.includes("-")?!1:!!(WG.indexOf(t)>-1||/[A-Z]/u.test(t))}function kE(t){const e=[{},{}];return t?.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function Jw(t,e,r,n){if(typeof e=="function"){const[s,i]=kE(n);e=e(r!==void 0?r:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=kE(n);e=e(r!==void 0?r:t.custom,s,i)}return e}const F0=t=>Array.isArray(t),KG=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),qG=t=>F0(t)?t[t.length-1]||0:t,tr=t=>!!(t&&t.getVelocity);function Df(t){const e=tr(t)?t.get():t;return KG(e)?e.toValue():e}function JG({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:r},n,s,i){const o={latestValues:YG(n,s,i,t),renderState:e()};return r&&(o.onMount=a=>r({props:n,current:a,...o}),o.onUpdate=a=>r(a)),o}const OI=t=>(e,r)=>{const n=k.useContext(sg),s=k.useContext(ng),i=()=>JG(t,e,n,s);return r?i():nd(i)};function YG(t,e,r,n){const s={},i=n(t,{});for(const h in i)s[h]=Df(i[h]);let{initial:o,animate:a}=t;const l=og(t),c=AI(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=r?r.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!ig(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const v=Jw(t,h[f]);if(v){const{transitionEnd:m,transition:p,...g}=v;for(const y in g){let _=g[y];if(Array.isArray(_)){const b=u?_.length-1:0;_=_[b]}_!==null&&(s[y]=_)}for(const y in m)s[y]=m[y]}}}return s}const rc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ka=new Set(rc),DI=t=>e=>typeof e=="string"&&e.startsWith(t),MI=DI("--"),ZG=DI("var(--"),Yw=t=>ZG(t)?XG.test(t.split("/*")[0].trim()):!1,XG=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,LI=(t,e)=>e&&typeof t=="number"?e.transform(t):t,_i=(t,e,r)=>r>e?e:r<t?t:r,nc={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},id={...nc,transform:t=>_i(0,1,t)},Rh={...nc,default:1},zd=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Mi=zd("deg"),Os=zd("%"),He=zd("px"),QG=zd("vh"),ez=zd("vw"),TE={...Os,parse:t=>Os.parse(t)/100,transform:t=>Os.transform(t*100)},tz={borderWidth:He,borderTopWidth:He,borderRightWidth:He,borderBottomWidth:He,borderLeftWidth:He,borderRadius:He,radius:He,borderTopLeftRadius:He,borderTopRightRadius:He,borderBottomRightRadius:He,borderBottomLeftRadius:He,width:He,maxWidth:He,height:He,maxHeight:He,top:He,right:He,bottom:He,left:He,padding:He,paddingTop:He,paddingRight:He,paddingBottom:He,paddingLeft:He,margin:He,marginTop:He,marginRight:He,marginBottom:He,marginLeft:He,backgroundPositionX:He,backgroundPositionY:He},rz={rotate:Mi,rotateX:Mi,rotateY:Mi,rotateZ:Mi,scale:Rh,scaleX:Rh,scaleY:Rh,scaleZ:Rh,skew:Mi,skewX:Mi,skewY:Mi,distance:He,translateX:He,translateY:He,translateZ:He,x:He,y:He,z:He,perspective:He,transformPerspective:He,opacity:id,originX:TE,originY:TE,originZ:He},AE={...nc,transform:Math.round},Zw={...tz,...rz,zIndex:AE,size:He,fillOpacity:id,strokeOpacity:id,numOctaves:AE},nz={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},sz=rc.length;function iz(t,e,r){let n="",s=!0;for(let i=0;i<sz;i++){const o=rc[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||r){const c=LI(a,Zw[o]);if(!l){s=!1;const u=nz[o]||o;n+=`${u}(${c}) `}r&&(e[o]=c)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function Xw(t,e,r){const{style:n,vars:s,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(ka.has(l)){o=!0;continue}else if(MI(l)){s[l]=c;continue}else{const u=LI(c,Zw[l]);l.startsWith("origin")?(a=!0,i[l]=u):n[l]=u}}if(e.transform||(o||r?n.transform=iz(e,t.transform,r):n.transform&&(n.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;n.transformOrigin=`${l} ${c} ${u}`}}const oz={offset:"stroke-dashoffset",array:"stroke-dasharray"},az={offset:"strokeDashoffset",array:"strokeDasharray"};function lz(t,e,r=1,n=0,s=!0){t.pathLength=1;const i=s?oz:az;t[i.offset]=He.transform(-n);const o=He.transform(e),a=He.transform(r);t[i.array]=`${o} ${a}`}function RE(t,e,r){return typeof t=="string"?t:He.transform(e+r*t)}function cz(t,e,r){const n=RE(e,t.x,t.width),s=RE(r,t.y,t.height);return`${n} ${s}`}function Qw(t,{attrX:e,attrY:r,attrScale:n,originX:s,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,d){if(Xw(t,c,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f,dimensions:v}=t;h.transform&&(v&&(f.transform=h.transform),delete h.transform),v&&(s!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=cz(v,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(h.x=e),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),o!==void 0&&lz(h,o,a,l,!1)}const ex=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),NI=()=>({...ex(),attrs:{}}),tx=t=>typeof t=="string"&&t.toLowerCase()==="svg";function BI(t,{style:e,vars:r},n,s){Object.assign(t.style,e,s&&s.getProjectionStyles(n));for(const i in r)t.style.setProperty(i,r[i])}const FI=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jI(t,e,r,n){BI(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(FI.has(s)?s:Ww(s),e.attrs[s])}const Ep={};function uz(t){Object.assign(Ep,t)}function $I(t,{layout:e,layoutId:r}){return ka.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Ep[t]||t==="opacity")}function rx(t,e,r){var n;const{style:s}=t,i={};for(const o in s)(tr(s[o])||e.style&&tr(e.style[o])||$I(o,t)||((n=r?.getValue(o))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(i[o]=s[o]);return i}function UI(t,e,r){const n=rx(t,e,r);for(const s in t)if(tr(t[s])||tr(e[s])){const i=rc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[i]=t[s]}return n}function dz(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const PE=["x","y","width","height","cx","cy","r"],hz={useVisualState:OI({scrapeMotionValuesFromProps:UI,createRenderState:NI,onUpdate:({props:t,prevProps:e,current:r,renderState:n,latestValues:s})=>{if(!r)return;let i=!!t.drag;if(!i){for(const a in s)if(ka.has(a)){i=!0;break}}if(!i)return;let o=!e;if(e)for(let a=0;a<PE.length;a++){const l=PE[a];t[l]!==e[l]&&(o=!0)}o&&kt.read(()=>{dz(r,n),kt.render(()=>{Qw(n,s,tx(r.tagName),t.transformTemplate),jI(r,n)})})}})},fz={useVisualState:OI({scrapeMotionValuesFromProps:rx,createRenderState:ex})};function HI(t,e,r){for(const n in e)!tr(e[n])&&!$I(n,r)&&(t[n]=e[n])}function pz({transformTemplate:t},e){return k.useMemo(()=>{const r=ex();return Xw(r,e,t),Object.assign({},r.vars,r.style)},[e])}function mz(t,e){const r=t.style||{},n={};return HI(n,r,t),Object.assign(n,pz(t,e)),n}function gz(t,e){const r={},n=mz(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}function vz(t,e,r,n){const s=k.useMemo(()=>{const i=NI();return Qw(i,e,tx(n),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};HI(i,t.style,t),s.style={...i,...s.style}}return s}function yz(t=!1){return(r,n,s,{latestValues:i},o)=>{const l=(qw(r)?vz:gz)(n,i,o,r),c=DG(n,typeof r=="string",t),u=r!==k.Fragment?{...c,...l,ref:s}:{},{children:d}=n,h=k.useMemo(()=>tr(d)?d.get():d,[d]);return k.createElement(r,{...u,children:h})}}function _z(t,e){return function(n,{forwardMotionProps:s}={forwardMotionProps:!1}){const o={...qw(n)?hz:fz,preloadedFeatures:t,useRender:yz(s),createVisualElement:e,Component:n};return HG(o)}}function VI(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ag(t,e,r){const n=t.getProps();return Jw(n,e,r!==void 0?r:n.custom,t)}const bz=Vw(()=>window.ScrollTimeline!==void 0);class wz{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,r){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=r}attachTimeline(e,r){const n=this.animations.map(s=>{if(bz()&&s.attachTimeline)return s.attachTimeline(e);if(typeof r=="function")return r(s)});return()=>{n.forEach((s,i)=>{s&&s(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let r=0;r<this.animations.length;r++)e=Math.max(e,this.animations[r].duration);return e}runAll(e){this.animations.forEach(r=>r[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class GI extends wz{then(e,r){return Promise.all(this.animations).then(e).catch(r)}}function nx(t,e){return t?t[e]||t.default||t:void 0}const Cp=2e4;function sx(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<Cp;)e+=r,n=t.next(e);return e>=Cp?1/0:e}function xz(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(sx(n),Cp);return{type:"keyframes",ease:i=>n.next(s*i).value/e,duration:Is(s)}}function lg(t){return typeof t=="function"}function IE(t,e){t.timeline=e,t.onfinish=null}const ix=t=>Array.isArray(t)&&typeof t[0]=="number",Sz={linearEasing:void 0};function Ez(t,e){const r=Vw(t);return()=>{var n;return(n=Sz[e])!==null&&n!==void 0?n:r()}}const kp=Ez(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),zI=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let i=0;i<s;i++)n+=t(pa(0,s-1,i))+", ";return`linear(${n.substring(0,n.length-2)})`};function WI(t){return!!(typeof t=="function"&&kp()||!t||typeof t=="string"&&(t in j0||kp())||ix(t)||Array.isArray(t)&&t.every(WI))}const Uc=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,j0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Uc([0,.65,.55,1]),circOut:Uc([.55,0,1,.45]),backIn:Uc([.31,.01,.66,-.59]),backOut:Uc([.33,1.53,.69,.99])};function KI(t,e){if(t)return typeof t=="function"&&kp()?zI(t,e):ix(t)?Uc(t):Array.isArray(t)?t.map(r=>KI(r,e)||j0.easeOut):j0[t]}const Gn={x:!1,y:!1};function qI(){return Gn.x||Gn.y}function JI(t,e,r){var n;if(t instanceof Element)return[t];if(typeof t=="string"){let s=document;e&&(s=e.current);const i=(n=r?.[t])!==null&&n!==void 0?n:s.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}function YI(t,e){const r=JI(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function OE(t){return e=>{e.pointerType==="touch"||qI()||t(e)}}function Cz(t,e,r={}){const[n,s,i]=YI(t,r),o=OE(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=OE(d=>{c(d),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,s)});return n.forEach(a=>{a.addEventListener("pointerenter",o,s)}),i}const ZI=(t,e)=>e?t===e?!0:ZI(t,e.parentElement):!1,ox=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,kz=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Tz(t){return kz.has(t.tagName)||t.tabIndex!==-1}const Hc=new WeakSet;function DE(t){return e=>{e.key==="Enter"&&t(e)}}function Ov(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Az=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=DE(()=>{if(Hc.has(r))return;Ov(r,"down");const s=DE(()=>{Ov(r,"up")}),i=()=>Ov(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",i,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function ME(t){return ox(t)&&!qI()}function Rz(t,e,r={}){const[n,s,i]=YI(t,r),o=a=>{const l=a.currentTarget;if(!ME(a)||Hc.has(l))return;Hc.add(l);const c=e(a),u=(f,v)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!ME(f)||!Hc.has(l))&&(Hc.delete(l),typeof c=="function"&&c(f,{success:v}))},d=f=>{u(f,r.useGlobalTarget||ZI(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return n.forEach(a=>{!Tz(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(r.useGlobalTarget?window:a).addEventListener("pointerdown",o,s),a.addEventListener("focus",c=>Az(c,s),s)}),i}function Pz(t){return t==="x"||t==="y"?Gn[t]?null:(Gn[t]=!0,()=>{Gn[t]=!1}):Gn.x||Gn.y?null:(Gn.x=Gn.y=!0,()=>{Gn.x=Gn.y=!1})}const XI=new Set(["width","height","top","left","right","bottom",...rc]);let Mf;function Iz(){Mf=void 0}const Ds={now:()=>(Mf===void 0&&Ds.set(ur.isProcessing||TG.useManualTiming?ur.timestamp:performance.now()),Mf),set:t=>{Mf=t,queueMicrotask(Iz)}};function ax(t,e){t.indexOf(e)===-1&&t.push(e)}function cg(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}class lx{constructor(){this.subscriptions=[]}add(e){return ax(this.subscriptions,e),()=>cg(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function QI(t,e){return e?t*(1e3/e):0}const LE=30,Oz=t=>!isNaN(parseFloat(t));class Dz{constructor(e,r={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,s=!0)=>{const i=Ds.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Ds.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Oz(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new lx);const n=this.events[e].add(r);return e==="change"?()=>{n(),kt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ds.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>LE)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,LE);return QI(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function od(t,e){return new Dz(t,e)}function Mz(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,od(r))}function Lz(t,e){const r=ag(t,e);let{transitionEnd:n={},transition:s={},...i}=r||{};i={...i,...n};for(const o in i){const a=qG(i[o]);Mz(t,o,a)}}function Nz(t){return!!(tr(t)&&t.add)}function $0(t,e){const r=t.getValue("willChange");if(Nz(r))return r.add(e)}function eO(t){return t.props[RI]}const tO=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,Bz=1e-7,Fz=12;function jz(t,e,r,n,s){let i,o,a=0;do o=e+(r-e)/2,i=tO(o,n,s)-t,i>0?r=o:e=o;while(Math.abs(i)>Bz&&++a<Fz);return o}function sc(t,e,r,n){if(t===e&&r===n)return pn;const s=i=>jz(i,0,1,t,r);return i=>i===0||i===1?i:tO(s(i),e,n)}const rO=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,nO=t=>e=>1-t(1-e),sO=sc(.33,1.53,.69,.99),cx=nO(sO),iO=rO(cx),oO=t=>(t*=2)<1?.5*cx(t):.5*(2-Math.pow(2,-10*(t-1))),ux=t=>1-Math.sin(Math.acos(t)),aO=nO(ux),lO=rO(ux),cO=t=>/^0[^.\s]+$/u.test(t);function $z(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||cO(t):!0}const Qc=t=>Math.round(t*1e5)/1e5,dx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Uz(t){return t==null}const Hz=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,hx=(t,e)=>r=>!!(typeof r=="string"&&Hz.test(r)&&r.startsWith(t)||e&&!Uz(r)&&Object.prototype.hasOwnProperty.call(r,e)),uO=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,i,o,a]=n.match(dx);return{[t]:parseFloat(s),[e]:parseFloat(i),[r]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Vz=t=>_i(0,255,t),Dv={...nc,transform:t=>Math.round(Vz(t))},Vo={test:hx("rgb","red"),parse:uO("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+Dv.transform(t)+", "+Dv.transform(e)+", "+Dv.transform(r)+", "+Qc(id.transform(n))+")"};function Gz(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const U0={test:hx("#"),parse:Gz,transform:Vo.transform},Qa={test:hx("hsl","hue"),parse:uO("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Os.transform(Qc(e))+", "+Os.transform(Qc(r))+", "+Qc(id.transform(n))+")"},xr={test:t=>Vo.test(t)||U0.test(t)||Qa.test(t),parse:t=>Vo.test(t)?Vo.parse(t):Qa.test(t)?Qa.parse(t):U0.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Vo.transform(t):Qa.transform(t)},zz=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Wz(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(dx))===null||e===void 0?void 0:e.length)||0)+(((r=t.match(zz))===null||r===void 0?void 0:r.length)||0)>0}const dO="number",hO="color",Kz="var",qz="var(",NE="${}",Jz=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ad(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let i=0;const a=e.replace(Jz,l=>(xr.test(l)?(n.color.push(i),s.push(hO),r.push(xr.parse(l))):l.startsWith(qz)?(n.var.push(i),s.push(Kz),r.push(l)):(n.number.push(i),s.push(dO),r.push(parseFloat(l))),++i,NE)).split(NE);return{values:r,split:a,indexes:n,types:s}}function fO(t){return ad(t).values}function pO(t){const{split:e,types:r}=ad(t),n=e.length;return s=>{let i="";for(let o=0;o<n;o++)if(i+=e[o],s[o]!==void 0){const a=r[o];a===dO?i+=Qc(s[o]):a===hO?i+=xr.transform(s[o]):i+=s[o]}return i}}const Yz=t=>typeof t=="number"?0:t;function Zz(t){const e=fO(t);return pO(t)(e.map(Yz))}const oo={test:Wz,parse:fO,createTransformer:pO,getAnimatableNone:Zz},Xz=new Set(["brightness","contrast","saturate","opacity"]);function Qz(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(dx)||[];if(!n)return t;const s=r.replace(n,"");let i=Xz.has(e)?1:0;return n!==r&&(i*=100),e+"("+i+s+")"}const e7=/\b([a-z-]*)\(.*?\)/gu,H0={...oo,getAnimatableNone:t=>{const e=t.match(e7);return e?e.map(Qz).join(" "):t}},t7={...Zw,color:xr,backgroundColor:xr,outlineColor:xr,fill:xr,stroke:xr,borderColor:xr,borderTopColor:xr,borderRightColor:xr,borderBottomColor:xr,borderLeftColor:xr,filter:H0,WebkitFilter:H0},fx=t=>t7[t];function mO(t,e){let r=fx(t);return r!==H0&&(r=oo),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const r7=new Set(["auto","none","0"]);function n7(t,e,r){let n=0,s;for(;n<t.length&&!s;){const i=t[n];typeof i=="string"&&!r7.has(i)&&ad(i).values.length&&(s=t[n]),n++}if(s&&r)for(const i of e)t[i]=mO(r,s)}const BE=t=>t===nc||t===He,FE=(t,e)=>parseFloat(t.split(", ")[e]),jE=(t,e)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/u);if(s)return FE(s[1],e);{const i=n.match(/^matrix\((.+)\)$/u);return i?FE(i[1],t):0}},s7=new Set(["x","y","z"]),i7=rc.filter(t=>!s7.has(t));function o7(t){const e=[];return i7.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const Ml={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:jE(4,13),y:jE(5,14)};Ml.translateX=Ml.x;Ml.translateY=Ml.y;const ta=new Set;let V0=!1,G0=!1;function gO(){if(G0){const t=Array.from(ta).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=o7(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([i,o])=>{var a;(a=n.getValue(i))===null||a===void 0||a.set(o)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}G0=!1,V0=!1,ta.forEach(t=>t.complete()),ta.clear()}function vO(){ta.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(G0=!0)})}function a7(){vO(),gO()}class px{constructor(e,r,n,s,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ta.add(this),V0||(V0=!0,kt.read(vO),kt.resolveKeyframes(gO))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=s?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(n&&r){const l=n.readValue(r,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&o===void 0&&s.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ta.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ta.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const yO=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),l7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function c7(t){const e=l7.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function _O(t,e,r=1){const[n,s]=c7(t);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const o=i.trim();return yO(o)?parseFloat(o):o}return Yw(s)?_O(s,e,r+1):s}const bO=t=>e=>e.test(t),u7={test:t=>t==="auto",parse:t=>t},wO=[nc,He,Os,Mi,ez,QG,u7],$E=t=>wO.find(bO(t));class xO extends px{constructor(e,r,n,s,i){super(e,r,n,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),Yw(c))){const u=_O(c,r.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!XI.has(n)||e.length!==2)return;const[s,i]=e,o=$E(s),a=$E(i);if(o!==a)if(BE(o)&&BE(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)$z(e[s])&&n.push(s);n.length&&n7(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ml[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var e;const{element:r,name:n,unresolvedKeyframes:s}=this;if(!r||!r.current)return;const i=r.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=s.length-1,a=s[o];s[o]=Ml[n](r.measureViewportBox(),window.getComputedStyle(r.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{r.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const UE=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(oo.test(t)||t==="0")&&!t.startsWith("url("));function d7(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function h7(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=UE(s,e),a=UE(i,e);return!o||!a?!1:d7(t)||(r==="spring"||lg(r))&&n}const f7=t=>t!==null;function ug(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(f7),i=e&&r!=="loop"&&e%2===1?0:s.length-1;return!i||n===void 0?s[i]:n}const p7=40;class SO{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ds.now(),this.options={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>p7?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&a7(),this._resolved}onKeyframesResolved(e,r){this.resolvedAt=Ds.now(),this.hasAttemptedResolve=!0;const{name:n,type:s,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!h7(e,n,s,i))if(o)this.options.duration=0;else{l&&l(ug(e,this.options,r)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,r);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:r,...u},this.onPostResolved())}onPostResolved(){}then(e,r){return this.currentFinishedPromise.then(e,r)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Tt=(t,e,r)=>t+(e-t)*r;function Mv(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function m7({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,i=0,o=0;if(!e)s=i=o=r;else{const a=r<.5?r*(1+e):r+e-r*e,l=2*r-a;s=Mv(l,a,t+1/3),i=Mv(l,a,t),o=Mv(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}function Tp(t,e){return r=>r>0?e:t}const Lv=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},g7=[U0,Vo,Qa],v7=t=>g7.find(e=>e.test(t));function HE(t){const e=v7(t);if(!e)return!1;let r=e.parse(t);return e===Qa&&(r=m7(r)),r}const VE=(t,e)=>{const r=HE(t),n=HE(e);if(!r||!n)return Tp(t,e);const s={...r};return i=>(s.red=Lv(r.red,n.red,i),s.green=Lv(r.green,n.green,i),s.blue=Lv(r.blue,n.blue,i),s.alpha=Tt(r.alpha,n.alpha,i),Vo.transform(s))},y7=(t,e)=>r=>e(t(r)),Wd=(...t)=>t.reduce(y7),z0=new Set(["none","hidden"]);function _7(t,e){return z0.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function b7(t,e){return r=>Tt(t,e,r)}function mx(t){return typeof t=="number"?b7:typeof t=="string"?Yw(t)?Tp:xr.test(t)?VE:S7:Array.isArray(t)?EO:typeof t=="object"?xr.test(t)?VE:w7:Tp}function EO(t,e){const r=[...t],n=r.length,s=t.map((i,o)=>mx(i)(i,e[o]));return i=>{for(let o=0;o<n;o++)r[o]=s[o](i);return r}}function w7(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=mx(t[s])(t[s],e[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}}function x7(t,e){var r;const n=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],a=t.indexes[o][s[o]],l=(r=t.values[a])!==null&&r!==void 0?r:0;n[i]=l,s[o]++}return n}const S7=(t,e)=>{const r=oo.createTransformer(e),n=ad(t),s=ad(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?z0.has(t)&&!s.values.length||z0.has(e)&&!n.values.length?_7(t,e):Wd(EO(x7(n,s),s.values),r):Tp(t,e)};function CO(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Tt(t,e,r):mx(t)(t,e)}const E7=5;function kO(t,e,r){const n=Math.max(e-E7,0);return QI(r-t(n),e-n)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},GE=.001;function C7({duration:t=Lt.duration,bounce:e=Lt.bounce,velocity:r=Lt.velocity,mass:n=Lt.mass}){let s,i,o=1-e;o=_i(Lt.minDamping,Lt.maxDamping,o),t=_i(Lt.minDuration,Lt.maxDuration,Is(t)),o<1?(s=c=>{const u=c*o,d=u*t,h=u-r,f=W0(c,o),v=Math.exp(-d);return GE-h/f*v},i=c=>{const d=c*o*t,h=d*r+r,f=Math.pow(o,2)*Math.pow(c,2)*t,v=Math.exp(-d),m=W0(Math.pow(c,2),o);return(-s(c)+GE>0?-1:1)*((h-f)*v)/m}):(s=c=>{const u=Math.exp(-c*t),d=(c-r)*t+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*t),d=(r-c)*(t*t);return u*d});const a=5/t,l=T7(s,i,a);if(t=Ps(t),isNaN(l))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:t};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:t}}}const k7=12;function T7(t,e,r){let n=r;for(let s=1;s<k7;s++)n=n-t(n)/e(n);return n}function W0(t,e){return t*Math.sqrt(1-e*e)}const A7=["duration","bounce"],R7=["stiffness","damping","mass"];function zE(t,e){return e.some(r=>t[r]!==void 0)}function P7(t){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...t};if(!zE(t,R7)&&zE(t,A7))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,i=2*_i(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Lt.mass,stiffness:s,damping:i}}else{const r=C7(t);e={...e,...r,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function gx(t=Lt.visualDuration,e=Lt.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=P7({...r,velocity:-Is(r.velocity||0)}),v=h||0,m=c/(2*Math.sqrt(l*u)),p=o-i,g=Is(Math.sqrt(l/u)),y=Math.abs(p)<5;n||(n=y?Lt.restSpeed.granular:Lt.restSpeed.default),s||(s=y?Lt.restDelta.granular:Lt.restDelta.default);let _;if(m<1){const w=W0(g,m);_=E=>{const S=Math.exp(-m*g*E);return o-S*((v+m*g*p)/w*Math.sin(w*E)+p*Math.cos(w*E))}}else if(m===1)_=w=>o-Math.exp(-g*w)*(p+(v+g*p)*w);else{const w=g*Math.sqrt(m*m-1);_=E=>{const S=Math.exp(-m*g*E),x=Math.min(w*E,300);return o-S*((v+m*g*p)*Math.sinh(x)+w*p*Math.cosh(x))/w}}const b={calculatedDuration:f&&d||null,next:w=>{const E=_(w);if(f)a.done=w>=d;else{let S=0;m<1&&(S=w===0?Ps(v):kO(_,w,E));const x=Math.abs(S)<=n,T=Math.abs(o-E)<=s;a.done=x&&T}return a.value=a.done?o:E,a},toString:()=>{const w=Math.min(sx(b),Cp),E=zI(S=>b.next(w*S).value,w,30);return w+"ms "+E}};return b}function WE({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=t[0],h={done:!1,value:d},f=x=>a!==void 0&&x<a||l!==void 0&&x>l,v=x=>a===void 0?l:l===void 0||Math.abs(a-x)<Math.abs(l-x)?a:l;let m=r*e;const p=d+m,g=o===void 0?p:o(p);g!==p&&(m=g-d);const y=x=>-m*Math.exp(-x/n),_=x=>g+y(x),b=x=>{const T=y(x),D=_(x);h.done=Math.abs(T)<=c,h.value=h.done?g:D};let w,E;const S=x=>{f(h.value)&&(w=x,E=gx({keyframes:[h.value,v(h.value)],velocity:kO(_,x,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return S(0),{calculatedDuration:null,next:x=>{let T=!1;return!E&&w===void 0&&(T=!0,b(x),S(x)),w!==void 0&&x>=w?E.next(x-w):(!T&&b(x),h)}}}const I7=sc(.42,0,1,1),O7=sc(0,0,.58,1),TO=sc(.42,0,.58,1),AO=t=>Array.isArray(t)&&typeof t[0]!="number",D7={linear:pn,easeIn:I7,easeInOut:TO,easeOut:O7,circIn:ux,circInOut:lO,circOut:aO,backIn:cx,backInOut:iO,backOut:sO,anticipate:oO},KE=t=>{if(ix(t)){EI(t.length===4);const[e,r,n,s]=t;return sc(e,r,n,s)}else if(typeof t=="string")return D7[t];return t};function M7(t,e,r){const n=[],s=r||CO,i=t.length-1;for(let o=0;o<i;o++){let a=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||pn:e;a=Wd(l,a)}n.push(a)}return n}function L7(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const i=t.length;if(EI(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=M7(e,n,s),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=pa(t[d],t[d+1],u);return a[d](h)};return r?u=>c(_i(t[0],t[i-1],u)):c}function RO(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=pa(0,e,n);t.push(Tt(r,1,s))}}function PO(t){const e=[0];return RO(e,t.length-1),e}function N7(t,e){return t.map(r=>r*e)}function B7(t,e){return t.map(()=>e||TO).splice(0,t.length-1)}function Ap({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=AO(n)?n.map(KE):KE(n),i={done:!1,value:e[0]},o=N7(r&&r.length===e.length?r:PO(e),t),a=L7(o,e,{ease:Array.isArray(s)?s:B7(e,s)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const F7=t=>{const e=({timestamp:r})=>t(r);return{start:()=>kt.update(e,!0),stop:()=>io(e),now:()=>ur.isProcessing?ur.timestamp:Ds.now()}},j7={decay:WE,inertia:WE,tween:Ap,keyframes:Ap,spring:gx},$7=t=>t/100;class vx extends SO{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:r,motionValue:n,element:s,keyframes:i}=this.options,o=s?.KeyframeResolver||px,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,r,n,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:r="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=this.options,a=lg(r)?r:j7[r]||Ap;let l,c;a!==Ap&&typeof e[0]!="number"&&(l=Wd($7,CO(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});i==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=sx(u));const{calculatedDuration:d}=u,h=d+s,f=h*(n+1)-s;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:h,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,r=!1){const{resolved:n}=this;if(!n){const{keyframes:x}=this.options;return{done:!0,value:x[x.length-1]}}const{finalKeyframe:s,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:d}=n;if(this.startTime===null)return i.next(0);const{delay:h,repeat:f,repeatType:v,repeatDelay:m,onUpdate:p}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),r?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),y=this.speed>=0?g<0:g>u;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let _=this.currentTime,b=i;if(f){const x=Math.min(this.currentTime,u)/d;let T=Math.floor(x),D=x%1;!D&&x>=1&&(D=1),D===1&&T--,T=Math.min(T,f+1),!!(T%2)&&(v==="reverse"?(D=1-D,m&&(D-=m/d)):v==="mirror"&&(b=o)),_=_i(0,1,D)*d}const w=y?{done:!1,value:l[0]}:b.next(_);a&&(w.value=a(w.value));let{done:E}=w;!y&&c!==null&&(E=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return S&&s!==void 0&&(w.value=ug(l,this.options,s)),p&&p(w.value),S&&this.finish(),w}get duration(){const{resolved:e}=this;return e?Is(e.calculatedDuration):0}get time(){return Is(this.currentTime)}set time(e){e=Ps(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Is(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=F7,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),r&&r();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const U7=new Set(["opacity","clipPath","filter","transform"]);function H7(t,e,r,{delay:n=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:r};l&&(c.offset=l);const u=KI(a,s);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:n,duration:s,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const V7=Vw(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Rp=10,G7=2e4;function z7(t){return lg(t.type)||t.type==="spring"||!WI(t.ease)}function W7(t,e){const r=new vx({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:t[0]};const s=[];let i=0;for(;!n.done&&i<G7;)n=r.sample(i),s.push(n.value),i+=Rp;return{times:void 0,keyframes:s,duration:i-Rp,ease:"linear"}}const IO={anticipate:oO,backInOut:iO,circInOut:lO};function K7(t){return t in IO}class qE extends SO{constructor(e){super(e);const{name:r,motionValue:n,element:s,keyframes:i}=this.options;this.resolver=new xO(i,(o,a)=>this.onKeyframesResolved(o,a),r,n,s),this.resolver.scheduleResolve()}initPlayback(e,r){let{duration:n=300,times:s,ease:i,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof i=="string"&&kp()&&K7(i)&&(i=IO[i]),z7(this.options)){const{onComplete:d,onUpdate:h,motionValue:f,element:v,...m}=this.options,p=W7(e,m);e=p.keyframes,e.length===1&&(e[1]=e[0]),n=p.duration,s=p.times,i=p.ease,o="keyframes"}const u=H7(a.owner.current,l,e,{...this.options,duration:n,times:s,ease:i});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(IE(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:d}=this.options;a.set(ug(e,this.options,r)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:n,times:s,type:o,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:r}=e;return Is(r)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:r}=e;return Is(r.currentTime||0)}set time(e){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=Ps(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:r}=e;return r.playbackRate}set speed(e){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:r}=e;return r.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:r}=e;return r.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:r}=this;if(!r)return pn;const{animation:n}=r;IE(n,e)}return pn}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:r}=e;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:r}=e;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:r,keyframes:n,duration:s,type:i,ease:o,times:a}=e;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:d,element:h,...f}=this.options,v=new vx({...f,keyframes:n,duration:s,type:i,ease:o,times:a,isGenerator:!0}),m=Ps(this.time);c.setWithVelocity(v.sample(m-Rp).value,v.sample(m).value,Rp)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:r,name:n,repeatDelay:s,repeatType:i,damping:o,type:a}=e;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=r.owner.getProps();return V7()&&n&&U7.has(n)&&!l&&!c&&!s&&i!=="mirror"&&o!==0&&a!=="inertia"}}const q7={type:"spring",stiffness:500,damping:25,restSpeed:10},J7=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Y7={type:"keyframes",duration:.8},Z7={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},X7=(t,{keyframes:e})=>e.length>2?Y7:ka.has(t)?t.startsWith("scale")?J7(e[1]):q7:Z7;function Q7({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const yx=(t,e,r,n={},s,i)=>o=>{const a=nx(n,t)||{},l=a.delay||n.delay||0;let{elapsed:c=0}=n;c=c-Ps(l);let u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:s};Q7(a)||(u={...u,...X7(t,u)}),u.duration&&(u.duration=Ps(u.duration)),u.repeatDelay&&(u.repeatDelay=Ps(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),d&&!i&&e.get()!==void 0){const h=ug(u.keyframes,a);if(h!==void 0)return kt.update(()=>{u.onUpdate(h),u.onComplete()}),new GI([])}return!i&&qE.supports(u)?new qE(u):new vx(u)};function e9({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function _x(t,e,{delay:r=0,transitionOverride:n,type:s}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;n&&(o=n);const c=[],u=s&&t.animationState&&t.animationState.getState()[s];for(const d in l){const h=t.getValue(d,(i=t.latestValues[d])!==null&&i!==void 0?i:null),f=l[d];if(f===void 0||u&&e9(u,d))continue;const v={delay:r,...nx(o||{},d)};let m=!1;if(window.MotionHandoffAnimation){const g=eO(t);if(g){const y=window.MotionHandoffAnimation(g,d,kt);y!==null&&(v.startTime=y,m=!0)}}$0(t,d),h.start(yx(d,h,f,t.shouldReduceMotion&&XI.has(d)?{type:!1}:v,t,m));const p=h.animation;p&&c.push(p)}return a&&Promise.all(c).then(()=>{kt.update(()=>{a&&Lz(t,a)})}),c}function K0(t,e,r={}){var n;const s=ag(t,e,r.type==="exit"?(n=t.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(i=r.transitionOverride);const o=s?()=>Promise.all(_x(t,s,r)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=i;return t9(t,e,u+c,d,h,r)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(r.delay)])}function t9(t,e,r=0,n=0,s=1,i){const o=[],a=(t.variantChildren.size-1)*n,l=s===1?(c=0)=>c*n:(c=0)=>a-c*n;return Array.from(t.variantChildren).sort(r9).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(K0(c,e,{...i,delay:r+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function r9(t,e){return t.sortNodePosition(e)}function n9(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(i=>K0(t,i,r));n=Promise.all(s)}else if(typeof e=="string")n=K0(t,e,r);else{const s=typeof e=="function"?ag(t,e,r.custom):e;n=Promise.all(_x(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}const s9=zw.length;function OO(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?OO(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<s9;r++){const n=zw[r],s=t.props[n];(sd(s)||s===!1)&&(e[n]=s)}return e}const i9=[...Gw].reverse(),o9=Gw.length;function a9(t){return e=>Promise.all(e.map(({animation:r,options:n})=>n9(t,r,n)))}function l9(t){let e=a9(t),r=JE(),n=!0;const s=l=>(c,u)=>{var d;const h=ag(t,u,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(h){const{transition:f,transitionEnd:v,...m}=h;c={...c,...m,...v}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=OO(t.parent)||{},d=[],h=new Set;let f={},v=1/0;for(let p=0;p<o9;p++){const g=i9[p],y=r[g],_=c[g]!==void 0?c[g]:u[g],b=sd(_),w=g===l?y.isActive:null;w===!1&&(v=p);let E=_===u[g]&&_!==c[g]&&b;if(E&&n&&t.manuallyAnimateOnMount&&(E=!1),y.protectedKeys={...f},!y.isActive&&w===null||!_&&!y.prevProp||ig(_)||typeof _=="boolean")continue;const S=c9(y.prevProp,_);let x=S||g===l&&y.isActive&&!E&&b||p>v&&b,T=!1;const D=Array.isArray(_)?_:[_];let O=D.reduce(s(g),{});w===!1&&(O={});const{prevResolvedValues:R={}}=y,P={...R,...O},A=V=>{x=!0,h.has(V)&&(T=!0,h.delete(V)),y.needsAnimating[V]=!0;const q=t.getValue(V);q&&(q.liveStyle=!1)};for(const V in P){const q=O[V],I=R[V];if(f.hasOwnProperty(V))continue;let $=!1;F0(q)&&F0(I)?$=!VI(q,I):$=q!==I,$?q!=null?A(V):h.add(V):q!==void 0&&h.has(V)?A(V):y.protectedKeys[V]=!0}y.prevProp=_,y.prevResolvedValues=O,y.isActive&&(f={...f,...O}),n&&t.blockInitialAnimation&&(x=!1),x&&(!(E&&S)||T)&&d.push(...D.map(V=>({animation:V,options:{type:g}})))}if(h.size){const p={};h.forEach(g=>{const y=t.getBaseTarget(g),_=t.getValue(g);_&&(_.liveStyle=!0),p[g]=y??null}),d.push({animation:p})}let m=!!d.length;return n&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(m=!1),n=!1,m?e(d):Promise.resolve()}function a(l,c){var u;if(r[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(h=>{var f;return(f=h.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),r[l].isActive=c;const d=o(l);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>r,reset:()=>{r=JE(),n=!0}}}function c9(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!VI(e,t):!1}function Io(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function JE(){return{animate:Io(!0),whileInView:Io(),whileHover:Io(),whileTap:Io(),whileDrag:Io(),whileFocus:Io(),exit:Io()}}class wo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class u9 extends wo{constructor(e){super(e),e.animationState||(e.animationState=l9(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();ig(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let d9=0;class h9 extends wo{constructor(){super(...arguments),this.id=d9++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>r(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const f9={animation:{Feature:u9},exit:{Feature:h9}};function ld(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function Kd(t){return{point:{x:t.pageX,y:t.pageY}}}const p9=t=>e=>ox(e)&&t(e,Kd(e));function eu(t,e,r,n){return ld(t,e,p9(r),n)}const YE=(t,e)=>Math.abs(t-e);function m9(t,e){const r=YE(t.x,e.x),n=YE(t.y,e.y);return Math.sqrt(r**2+n**2)}class DO{constructor(e,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=Bv(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,f=m9(d.offset,{x:0,y:0})>=3;if(!h&&!f)return;const{point:v}=d,{timestamp:m}=ur;this.history.push({...v,timestamp:m});const{onStart:p,onMove:g}=this.handlers;h||(p&&p(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=Nv(h,this.transformPagePoint),kt.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:f,onSessionEnd:v,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Bv(d.type==="pointercancel"?this.lastMoveEventInfo:Nv(h,this.transformPagePoint),this.history);this.startEvent&&f&&f(d,p),v&&v(d,p)},!ox(e))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=Kd(e),a=Nv(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=ur;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=r;u&&u(e,Bv(a,this.history)),this.removeListeners=Wd(eu(this.contextWindow,"pointermove",this.handlePointerMove),eu(this.contextWindow,"pointerup",this.handlePointerUp),eu(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),io(this.updatePoint)}}function Nv(t,e){return e?{point:e(t.point)}:t}function ZE(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Bv({point:t},e){return{point:t,delta:ZE(t,MO(e)),offset:ZE(t,g9(e)),velocity:v9(e,.1)}}function g9(t){return t[0]}function MO(t){return t[t.length-1]}function v9(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=MO(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>Ps(e)));)r--;if(!n)return{x:0,y:0};const i=Is(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const LO=1e-4,y9=1-LO,_9=1+LO,NO=.01,b9=0-NO,w9=0+NO;function gn(t){return t.max-t.min}function x9(t,e,r){return Math.abs(t-e)<=r}function XE(t,e,r,n=.5){t.origin=n,t.originPoint=Tt(e.min,e.max,t.origin),t.scale=gn(r)/gn(e),t.translate=Tt(r.min,r.max,t.origin)-t.originPoint,(t.scale>=y9&&t.scale<=_9||isNaN(t.scale))&&(t.scale=1),(t.translate>=b9&&t.translate<=w9||isNaN(t.translate))&&(t.translate=0)}function tu(t,e,r,n){XE(t.x,e.x,r.x,n?n.originX:void 0),XE(t.y,e.y,r.y,n?n.originY:void 0)}function QE(t,e,r){t.min=r.min+e.min,t.max=t.min+gn(e)}function S9(t,e,r){QE(t.x,e.x,r.x),QE(t.y,e.y,r.y)}function eC(t,e,r){t.min=e.min-r.min,t.max=t.min+gn(e)}function ru(t,e,r){eC(t.x,e.x,r.x),eC(t.y,e.y,r.y)}function E9(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Tt(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Tt(r,t,n.max):Math.min(t,r)),t}function tC(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function C9(t,{top:e,left:r,bottom:n,right:s}){return{x:tC(t.x,r,s),y:tC(t.y,e,n)}}function rC(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function k9(t,e){return{x:rC(t.x,e.x),y:rC(t.y,e.y)}}function T9(t,e){let r=.5;const n=gn(t),s=gn(e);return s>n?r=pa(e.min,e.max-n,t.min):n>s&&(r=pa(t.min,t.max-s,e.min)),_i(0,1,r)}function A9(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const q0=.35;function R9(t=q0){return t===!1?t=0:t===!0&&(t=q0),{x:nC(t,"left","right"),y:nC(t,"top","bottom")}}function nC(t,e,r){return{min:sC(t,e),max:sC(t,r)}}function sC(t,e){return typeof t=="number"?t:t[e]||0}const iC=()=>({translate:0,scale:1,origin:0,originPoint:0}),el=()=>({x:iC(),y:iC()}),oC=()=>({min:0,max:0}),Mt=()=>({x:oC(),y:oC()});function kn(t){return[t("x"),t("y")]}function BO({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function P9({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function I9(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Fv(t){return t===void 0||t===1}function J0({scale:t,scaleX:e,scaleY:r}){return!Fv(t)||!Fv(e)||!Fv(r)}function Lo(t){return J0(t)||FO(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function FO(t){return aC(t.x)||aC(t.y)}function aC(t){return t&&t!=="0%"}function Pp(t,e,r){const n=t-r,s=e*n;return r+s}function lC(t,e,r,n,s){return s!==void 0&&(t=Pp(t,s,n)),Pp(t,r,n)+e}function Y0(t,e=0,r=1,n,s){t.min=lC(t.min,e,r,n,s),t.max=lC(t.max,e,r,n,s)}function jO(t,{x:e,y:r}){Y0(t.x,e.translate,e.scale,e.originPoint),Y0(t.y,r.translate,r.scale,r.originPoint)}const cC=.999999999999,uC=1.0000000000001;function O9(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let i,o;for(let a=0;a<s;a++){i=r[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&rl(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,jO(t,o)),n&&Lo(i.latestValues)&&rl(t,i.latestValues))}e.x<uC&&e.x>cC&&(e.x=1),e.y<uC&&e.y>cC&&(e.y=1)}function tl(t,e){t.min=t.min+e,t.max=t.max+e}function dC(t,e,r,n,s=.5){const i=Tt(t.min,t.max,s);Y0(t,e,r,i,n)}function rl(t,e){dC(t.x,e.x,e.scaleX,e.scale,e.originX),dC(t.y,e.y,e.scaleY,e.scale,e.originY)}function $O(t,e){return BO(I9(t.getBoundingClientRect(),e))}function D9(t,e,r){const n=$O(t,r),{scroll:s}=e;return s&&(tl(n.x,s.offset.x),tl(n.y,s.offset.y)),n}const UO=({current:t})=>t?t.ownerDocument.defaultView:null,M9=new WeakMap;class L9{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Mt(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Kd(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:f,onDragStart:v}=this.getProps();if(h&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Pz(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),kn(p=>{let g=this.getAxisMotionValue(p).get()||0;if(Os.test(g)){const{projection:y}=this.visualElement;if(y&&y.layout){const _=y.layout.layoutBox[p];_&&(g=gn(_)*(parseFloat(g)/100))}}this.originPoint[p]=g}),v&&kt.postRender(()=>v(u,d)),$0(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,d)=>{const{dragPropagation:h,dragDirectionLock:f,onDirectionLock:v,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:p}=d;if(f&&this.currentDirection===null){this.currentDirection=N9(p),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",d.point,p),this.updateAxis("y",d.point,p),this.visualElement.render(),m&&m(u,d)},a=(u,d)=>this.stop(u,d),l=()=>kn(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new DO(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:UO(this.visualElement)})}stop(e,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&kt.postRender(()=>i(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!Ph(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=E9(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;r&&Xa(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=C9(s.layoutBox,r):this.constraints=!1,this.elastic=R9(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&kn(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=A9(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!Xa(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=D9(n,s.root,this.visualElement.getTransformPagePoint());let o=k9(s.layout.layoutBox,i);if(r){const a=r(P9(o));this.hasMutatedConstraints=!!a,a&&(o=BO(a))}return o}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=kn(u=>{if(!Ph(u,r,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const h=s?200:1e6,f=s?40:1e7,v={type:"inertia",velocity:n?e[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,v)});return Promise.all(c).then(a)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return $0(this.visualElement,e),n.start(yx(e,n,0,r,this.visualElement,!1))}stopAnimation(){kn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){kn(e=>{var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){kn(r=>{const{drag:n}=this.getProps();if(!Ph(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[r];i.set(e[r]-Tt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Xa(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};kn(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();s[o]=T9({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),kn(o=>{if(!Ph(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Tt(l,c,s[o]))})}addListeners(){if(!this.visualElement.current)return;M9.set(this.visualElement,this);const e=this.visualElement.current,r=eu(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Xa(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),kt.read(n);const o=ld(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(kn(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=q0,dragMomentum:a=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function Ph(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function N9(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class B9 extends wo{constructor(e){super(e),this.removeGroupControls=pn,this.removeListeners=pn,this.controls=new L9(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pn}unmount(){this.removeGroupControls(),this.removeListeners()}}const hC=t=>(e,r)=>{t&&kt.postRender(()=>t(e,r))};class F9 extends wo{constructor(){super(...arguments),this.removePointerDownListener=pn}onPointerDown(e){this.session=new DO(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:UO(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:hC(e),onStart:hC(r),onMove:n,onEnd:(i,o)=>{delete this.session,s&&kt.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=eu(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Lf={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function fC(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const xc={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(He.test(t))t=parseFloat(t);else return t;const r=fC(t,e.target.x),n=fC(t,e.target.y);return`${r}% ${n}%`}},j9={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=oo.parse(t);if(s.length>5)return n;const i=oo.createTransformer(t),o=typeof s[0]!="number"?1:0,a=r.x.scale*e.x,l=r.y.scale*e.y;s[0+o]/=a,s[1+o]/=l;const c=Tt(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=c),typeof s[3+o]=="number"&&(s[3+o]/=c),i(s)}};class $9 extends k.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=e;uz(U9),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Lf.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,o=n.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||kt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Kw.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function HO(t){const[e,r]=xI(),n=k.useContext(jw);return C.jsx($9,{...t,layoutGroup:n,switchLayoutGroup:k.useContext(PI),isPresent:e,safeToRemove:r})}const U9={borderRadius:{...xc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:xc,borderTopRightRadius:xc,borderBottomLeftRadius:xc,borderBottomRightRadius:xc,boxShadow:j9};function VO(t,e,r){const n=tr(t)?t:od(t);return n.start(yx("",n,e,r)),n.animation}function GO(t){return t instanceof SVGElement&&t.tagName!=="svg"}const H9=(t,e)=>t.depth-e.depth;class V9{constructor(){this.children=[],this.isDirty=!1}add(e){ax(this.children,e),this.isDirty=!0}remove(e){cg(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(H9),this.isDirty=!1,this.children.forEach(e)}}function G9(t,e){const r=Ds.now(),n=({timestamp:s})=>{const i=s-r;i>=e&&(io(n),t(i-e))};return kt.read(n,!0),()=>io(n)}const zO=["TopLeft","TopRight","BottomLeft","BottomRight"],z9=zO.length,pC=t=>typeof t=="string"?parseFloat(t):t,mC=t=>typeof t=="number"||He.test(t);function W9(t,e,r,n,s,i){s?(t.opacity=Tt(0,r.opacity!==void 0?r.opacity:1,K9(n)),t.opacityExit=Tt(e.opacity!==void 0?e.opacity:1,0,q9(n))):i&&(t.opacity=Tt(e.opacity!==void 0?e.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<z9;o++){const a=`border${zO[o]}Radius`;let l=gC(e,a),c=gC(r,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||mC(l)===mC(c)?(t[a]=Math.max(Tt(pC(l),pC(c),n),0),(Os.test(c)||Os.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||r.rotate)&&(t.rotate=Tt(e.rotate||0,r.rotate||0,n))}function gC(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const K9=WO(0,.5,aO),q9=WO(.5,.95,pn);function WO(t,e,r){return n=>n<t?0:n>e?1:r(pa(t,e,n))}function vC(t,e){t.min=e.min,t.max=e.max}function En(t,e){vC(t.x,e.x),vC(t.y,e.y)}function yC(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function _C(t,e,r,n,s){return t-=e,t=Pp(t,1/r,n),s!==void 0&&(t=Pp(t,1/s,n)),t}function J9(t,e=0,r=1,n=.5,s,i=t,o=t){if(Os.test(e)&&(e=parseFloat(e),e=Tt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Tt(i.min,i.max,n);t===i&&(a-=e),t.min=_C(t.min,e,r,a,s),t.max=_C(t.max,e,r,a,s)}function bC(t,e,[r,n,s],i,o){J9(t,e[r],e[n],e[s],e.scale,i,o)}const Y9=["x","scaleX","originX"],Z9=["y","scaleY","originY"];function wC(t,e,r,n){bC(t.x,e,Y9,r?r.x:void 0,n?n.x:void 0),bC(t.y,e,Z9,r?r.y:void 0,n?n.y:void 0)}function xC(t){return t.translate===0&&t.scale===1}function KO(t){return xC(t.x)&&xC(t.y)}function SC(t,e){return t.min===e.min&&t.max===e.max}function X9(t,e){return SC(t.x,e.x)&&SC(t.y,e.y)}function EC(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function qO(t,e){return EC(t.x,e.x)&&EC(t.y,e.y)}function CC(t){return gn(t.x)/gn(t.y)}function kC(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Q9{constructor(){this.members=[]}add(e){ax(this.members,e),e.scheduleRender()}remove(e){if(cg(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function eW(t,e,r){let n="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=r?.z||0;if((s||i||o)&&(n=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:v}=r;c&&(n=`perspective(${c}px) ${n}`),u&&(n+=`rotate(${u}deg) `),d&&(n+=`rotateX(${d}deg) `),h&&(n+=`rotateY(${h}deg) `),f&&(n+=`skewX(${f}deg) `),v&&(n+=`skewY(${v}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const No={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Vc=typeof window<"u"&&window.MotionDebug!==void 0,jv=["","X","Y","Z"],tW={visibility:"hidden"},TC=1e3;let rW=0;function $v(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function JO(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=eO(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",kt,!(s||i))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&JO(n)}function YO({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},a=e?.()){this.id=rW++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Vc&&(No.totalNodes=No.resolvedTargetDeltas=No.recalculatedProjection=0),this.nodes.forEach(iW),this.nodes.forEach(uW),this.nodes.forEach(dW),this.nodes.forEach(oW),Vc&&window.MotionDebug.record(No)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new V9)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new lx),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=GO(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let d;const h=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=G9(h,250),Lf.hasAnimatedSinceResize&&(Lf.hasAnimatedSinceResize=!1,this.nodes.forEach(RC))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:f,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||gW,{onLayoutAnimationStart:p,onLayoutAnimationComplete:g}=u.getProps(),y=!this.targetLayout||!qO(this.targetLayout,v)||f,_=!h&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||_||h&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,_);const b={...nx(m,"layout"),onPlay:p,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else h||RC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,io(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(hW),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&JO(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(AC);return}this.isUpdating||this.nodes.forEach(lW),this.isUpdating=!1,this.nodes.forEach(cW),this.nodes.forEach(nW),this.nodes.forEach(sW),this.clearAllSnapshots();const a=Ds.now();ur.delta=_i(0,1e3/60,a-ur.timestamp),ur.timestamp=a,ur.isProcessing=!0,Iv.update.process(ur),Iv.preRender.process(ur),Iv.render.process(ur),ur.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Kw.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(aW),this.sharedNodes.forEach(fW)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,kt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){kt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Mt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!KO(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||Lo(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),vW(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return Mt();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(yW))){const{scroll:u}=this.root;u&&(tl(l.x,u.offset.x),tl(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=Mt();if(En(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&En(l,o),tl(l.x,d.offset.x),tl(l.y,d.offset.y))}return l}applyTransform(o,a=!1){const l=Mt();En(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&rl(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Lo(u.latestValues)&&rl(l,u.latestValues)}return Lo(this.latestValues)&&rl(l,this.latestValues),l}removeTransform(o){const a=Mt();En(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Lo(c.latestValues))continue;J0(c.latestValues)&&c.updateSnapshot();const u=Mt(),d=c.measurePageBox();En(u,d),wC(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Lo(this.latestValues)&&wC(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ur.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=ur.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mt(),this.relativeTargetOrigin=Mt(),ru(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),En(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Mt(),this.targetWithTransforms=Mt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),S9(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):En(this.target,this.layout.layoutBox),jO(this.target,this.targetDelta)):En(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mt(),this.relativeTargetOrigin=Mt(),ru(this.relativeTargetOrigin,this.target,f.target),En(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Vc&&No.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||J0(this.parent.latestValues)||FO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ur.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;En(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;O9(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Mt());const{target:v}=a;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(yC(this.prevProjectionDelta.x,this.projectionDelta.x),yC(this.prevProjectionDelta.y,this.projectionDelta.y)),tu(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!kC(this.projectionDelta.x,this.prevProjectionDelta.x)||!kC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),Vc&&No.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=el(),this.projectionDelta=el(),this.projectionDeltaWithTransform=el()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=el();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=Mt(),f=l?l.source:void 0,v=this.layout?this.layout.source:void 0,m=f!==v,p=this.getStack(),g=!p||p.members.length<=1,y=!!(m&&!g&&this.options.crossfade===!0&&!this.path.some(mW));this.animationProgress=0;let _;this.mixTargetDelta=b=>{const w=b/1e3;PC(d.x,o.x,w),PC(d.y,o.y,w),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ru(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),pW(this.relativeTarget,this.relativeTargetOrigin,h,w),_&&X9(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=Mt()),En(_,this.relativeTarget)),m&&(this.animationValues=u,W9(u,c,this.latestValues,w,y,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(io(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=kt.update(()=>{Lf.hasAnimatedSinceResize=!0,this.currentAnimation=VO(0,TC,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(TC),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&ZO(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Mt();const d=gn(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=gn(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}En(a,l),rl(a,u),tu(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Q9),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&$v("z",o,c,this.animationValues);for(let u=0;u<jv.length;u++)$v(`rotate${jv[u]}`,o,c,this.animationValues),$v(`skew${jv[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return tW;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Df(o?.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=Df(o?.pointerEvents)||""),this.hasProjected&&!Lo(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),c.transform=eW(this.projectionDeltaWithTransform,this.treeScale,h),u&&(c.transform=u(h,c.transform));const{x:f,y:v}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${v.origin*100}% 0`,d.animationValues?c.opacity=d===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:c.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const m in Ep){if(h[m]===void 0)continue;const{correct:p,applyTo:g}=Ep[m],y=c.transform==="none"?h[m]:p(h[m],d);if(g){const _=g.length;for(let b=0;b<_;b++)c[g[b]]=y}else c[m]=y}return this.options.layoutId&&(c.pointerEvents=d===this?Df(o?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(AC),this.root.sharedNodes.clear()}}}function nW(t){t.updateLayout()}function sW(t){var e;const r=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:i}=t.options,o=r.source!==t.layout.source;i==="size"?kn(d=>{const h=o?r.measuredBox[d]:r.layoutBox[d],f=gn(h);h.min=n[d].min,h.max=h.min+f}):ZO(i,r.layoutBox,n)&&kn(d=>{const h=o?r.measuredBox[d]:r.layoutBox[d],f=gn(n[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=el();tu(a,n,r.layoutBox);const l=el();o?tu(l,t.applyTransform(s,!0),r.measuredBox):tu(l,n,r.layoutBox);const c=!KO(a);let u=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const v=Mt();ru(v,r.layoutBox,h.layoutBox);const m=Mt();ru(m,n,f.layoutBox),qO(v,m)||(u=!0),d.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=v,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function iW(t){Vc&&No.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function oW(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function aW(t){t.clearSnapshot()}function AC(t){t.clearMeasurements()}function lW(t){t.isLayoutDirty=!1}function cW(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function RC(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function uW(t){t.resolveTargetDelta()}function dW(t){t.calcProjection()}function hW(t){t.resetSkewAndRotation()}function fW(t){t.removeLeadSnapshot()}function PC(t,e,r){t.translate=Tt(e.translate,0,r),t.scale=Tt(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function IC(t,e,r,n){t.min=Tt(e.min,r.min,n),t.max=Tt(e.max,r.max,n)}function pW(t,e,r,n){IC(t.x,e.x,r.x,n),IC(t.y,e.y,r.y,n)}function mW(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const gW={duration:.45,ease:[.4,0,.1,1]},OC=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),DC=OC("applewebkit/")&&!OC("chrome/")?Math.round:pn;function MC(t){t.min=DC(t.min),t.max=DC(t.max)}function vW(t){MC(t.x),MC(t.y)}function ZO(t,e,r){return t==="position"||t==="preserve-aspect"&&!x9(CC(e),CC(r),.2)}function yW(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const _W=YO({attachResizeListener:(t,e)=>ld(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Uv={current:void 0},XO=YO({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Uv.current){const t=new _W({});t.mount(window),t.setOptions({layoutScroll:!0}),Uv.current=t}return Uv.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),bW={pan:{Feature:F9},drag:{Feature:B9,ProjectionNode:XO,MeasureLayout:HO}};function LC(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,i=n[s];i&&kt.postRender(()=>i(e,Kd(e)))}class wW extends wo{mount(){const{current:e}=this.node;e&&(this.unmount=Cz(e,r=>(LC(this.node,r,"Start"),n=>LC(this.node,n,"End"))))}unmount(){}}class xW extends wo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Wd(ld(this.node.current,"focus",()=>this.onFocus()),ld(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function NC(t,e,r){const{props:n}=t;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),i=n[s];i&&kt.postRender(()=>i(e,Kd(e)))}class SW extends wo{mount(){const{current:e}=this.node;e&&(this.unmount=Rz(e,r=>(NC(this.node,r,"Start"),(n,{success:s})=>NC(this.node,n,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Z0=new WeakMap,Hv=new WeakMap,EW=t=>{const e=Z0.get(t.target);e&&e(t)},CW=t=>{t.forEach(EW)};function kW({root:t,...e}){const r=t||document;Hv.has(r)||Hv.set(r,{});const n=Hv.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(CW,{root:t,...e})),n[s]}function TW(t,e,r){const n=kW(e);return Z0.set(t,r),n.observe(t),()=>{Z0.delete(t),n.unobserve(t)}}const AW={some:0,all:1};class RW extends wo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:AW[s]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return TW(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(PW(e,r))&&this.startObserver()}unmount(){}}function PW({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const IW={inView:{Feature:RW},tap:{Feature:SW},focus:{Feature:xW},hover:{Feature:wW}},OW={layout:{ProjectionNode:XO,MeasureLayout:HO}},X0={current:null},QO={current:!1};function DW(){if(QO.current=!0,!!Uw)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>X0.current=t.matches;t.addListener(e),e()}else X0.current=!1}const MW=[...wO,xr,oo],LW=t=>MW.find(bO(t)),Ll=new WeakMap;function NW(t,e,r){for(const n in e){const s=e[n],i=r[n];if(tr(s))t.addValue(n,s);else if(tr(i))t.addValue(n,od(s,{owner:t}));else if(i!==s)if(t.hasValue(n)){const o=t.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(n);t.addValue(n,od(o!==void 0?o:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const BC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class eD{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=px,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Ds.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,kt.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=og(r),this.isVariantNode=AI(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const f in h){const v=h[f];l[f]!==void 0&&tr(v)&&v.set(l[f],!1)}}mount(e){this.current=e,Ll.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),QO.current||DW(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:X0.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Ll.delete(this.current),this.projection&&this.projection.unmount(),io(this.notifyUpdate),io(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=ka.has(e),s=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&kt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),i(),o&&o(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Dl){const r=Dl[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Mt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<BC.length;n++){const s=BC[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=NW(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=od(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){var n;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(yO(s)||cO(s))?s=parseFloat(s):!LW(s)&&oo.test(r)&&(s=mO(e,r)),this.setBaseTarget(e,tr(s)?s.get():s)),tr(s)?s.get():s}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var r;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const o=Jw(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);o&&(s=o[e])}if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!tr(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new lx),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class tD extends eD{constructor(){super(...arguments),this.KeyframeResolver=xO}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;tr(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function BW(t){return window.getComputedStyle(t)}class rD extends tD{constructor(){super(...arguments),this.type="html",this.renderInstance=BI}readValueFromInstance(e,r){if(ka.has(r)){const n=fx(r);return n&&n.default||0}else{const n=BW(e),s=(MI(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:r}){return $O(e,r)}build(e,r,n){Xw(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return rx(e,r,n)}}class nD extends tD{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Mt}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(ka.has(r)){const n=fx(r);return n&&n.default||0}return r=FI.has(r)?r:Ww(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return UI(e,r,n)}build(e,r,n){Qw(e,r,this.isSVGTag,n.transformTemplate)}renderInstance(e,r,n,s){jI(e,r,n,s)}mount(e){this.isSVGTag=tx(e.tagName),super.mount(e)}}const FW=(t,e)=>qw(t)?new nD(e):new rD(e,{allowProjection:t!==k.Fragment}),jW=_z({...f9,...IW,...bW,...OW},FW),mt=MG(jW);function $W(t){return k.useEffect(()=>()=>t(),[])}const UW=(t,e,r)=>{const n=e-t;return((r-t)%n+n)%n+t};function sD(t,e){return AO(t)?t[UW(0,t.length,e)]:t}function bx(t){return typeof t=="object"&&!Array.isArray(t)}function iD(t,e,r,n){return typeof t=="string"&&bx(e)?JI(t,r,n):t instanceof NodeList?Array.from(t):Array.isArray(t)?t:[t]}function HW(t,e,r){return t*(e+1)}function FC(t,e,r,n){var s;return typeof e=="number"?e:e.startsWith("-")||e.startsWith("+")?Math.max(0,t+parseFloat(e)):e==="<"?r:(s=n.get(e))!==null&&s!==void 0?s:t}function VW(t,e,r){for(let n=0;n<t.length;n++){const s=t[n];s.at>e&&s.at<r&&(cg(t,s),n--)}}function GW(t,e,r,n,s,i){VW(t,s,i);for(let o=0;o<e.length;o++)t.push({value:e[o],at:Tt(s,i,n[o]),easing:sD(r,o)})}function zW(t,e){for(let r=0;r<t.length;r++)t[r]=t[r]/(e+1)}function WW(t,e){return t.at===e.at?t.value===null?1:e.value===null?-1:0:t.at-e.at}const KW="easeInOut";function qW(t,{defaultTransition:e={},...r}={},n,s){const i=e.duration||.3,o=new Map,a=new Map,l={},c=new Map;let u=0,d=0,h=0;for(let f=0;f<t.length;f++){const v=t[f];if(typeof v=="string"){c.set(v,d);continue}else if(!Array.isArray(v)){c.set(v.name,FC(d,v.at,u,c));continue}let[m,p,g={}]=v;g.at!==void 0&&(d=FC(d,g.at,u,c));let y=0;const _=(b,w,E,S=0,x=0)=>{const T=JW(b),{delay:D=0,times:O=PO(T),type:R="keyframes",repeat:P,repeatType:A,repeatDelay:H=0,...K}=w;let{ease:V=e.ease||"easeOut",duration:q}=w;const I=typeof D=="function"?D(S,x):D,$=T.length,j=lg(R)?R:s?.[R];if($<=2&&j){let te=100;if($===2&&XW(T)){const F=T[1]-T[0];te=Math.abs(F)}const me={...K};q!==void 0&&(me.duration=Ps(q));const re=xz(me,te,j);V=re.ease,q=re.duration}q??(q=i);const U=d+I;O.length===1&&O[0]===0&&(O[1]=1);const J=O.length-T.length;if(J>0&&RO(O,J),T.length===1&&T.unshift(null),P){q=HW(q,P);const te=[...T],me=[...O];V=Array.isArray(V)?[...V]:[V];const re=[...V];for(let F=0;F<P;F++){T.push(...te);for(let X=0;X<te.length;X++)O.push(me[X]+(F+1)),V.push(X===0?"linear":sD(re,X-1))}zW(O,P)}const ne=U+q;GW(E,T,V,O,U,ne),y=Math.max(I+q,y),h=Math.max(ne,h)};if(tr(m)){const b=jC(m,a);_(p,g,$C("default",b))}else{const b=iD(m,p,n,l),w=b.length;for(let E=0;E<w;E++){p=p,g=g;const S=b[E],x=jC(S,a);for(const T in p)_(p[T],YW(g,T),$C(T,x),E,w)}}u=d,d+=y}return a.forEach((f,v)=>{for(const m in f){const p=f[m];p.sort(WW);const g=[],y=[],_=[];for(let w=0;w<p.length;w++){const{at:E,value:S,easing:x}=p[w];g.push(S),y.push(pa(0,h,E)),_.push(x||"easeOut")}y[0]!==0&&(y.unshift(0),g.unshift(g[0]),_.unshift(KW)),y[y.length-1]!==1&&(y.push(1),g.push(null)),o.has(v)||o.set(v,{keyframes:{},transition:{}});const b=o.get(v);b.keyframes[m]=g,b.transition[m]={...e,duration:h,ease:_,times:y,...r}}}),o}function jC(t,e){return!e.has(t)&&e.set(t,{}),e.get(t)}function $C(t,e){return e[t]||(e[t]=[]),e[t]}function JW(t){return Array.isArray(t)?t:[t]}function YW(t,e){return t&&t[e]?{...t,...t[e]}:{...t}}const ZW=t=>typeof t=="number",XW=t=>t.every(ZW);function QW(t,e){return t in e}class eK extends eD{constructor(){super(...arguments),this.type="object"}readValueFromInstance(e,r){if(QW(r,e)){const n=e[r];if(typeof n=="string"||typeof n=="number")return n}}getBaseTargetFromProps(){}removeValueFromRenderState(e,r){delete r.output[e]}measureInstanceViewportBox(){return Mt()}build(e,r){Object.assign(e.output,r)}renderInstance(e,{output:r}){Object.assign(e,r)}sortInstanceNodePosition(){return 0}}function tK(t){const e={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},r=GO(t)?new nD(e):new rD(e);r.mount(t),Ll.set(t,r)}function rK(t){const e={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},r=new eK(e);r.mount(t),Ll.set(t,r)}function nK(t,e){return tr(t)||typeof t=="number"||typeof t=="string"&&!bx(e)}function oD(t,e,r,n){const s=[];if(nK(t,e))s.push(VO(t,bx(e)&&e.default||e,r&&(r.default||r)));else{const i=iD(t,e,n),o=i.length;for(let a=0;a<o;a++){const l=i[a],c=l instanceof Element?tK:rK;Ll.has(l)||c(l);const u=Ll.get(l),d={...r};"delay"in d&&typeof d.delay=="function"&&(d.delay=d.delay(a,o)),s.push(..._x(u,{...e,transition:d},{}))}}return s}function sK(t,e,r){const n=[];return qW(t,e,r,{spring:gx}).forEach(({keyframes:i,transition:o},a)=>{n.push(...oD(a,i,o))}),n}function iK(t){return Array.isArray(t)&&t.some(Array.isArray)}function oK(t){function e(r,n,s){let i=[];iK(r)?i=sK(r,n,t):i=oD(r,n,s,t);const o=new GI(i);return t&&t.animations.push(o),o}return e}function aK(){const t=nd(()=>({current:null,animations:[]})),e=nd(()=>oK(t));return $W(()=>{t.animations.forEach(r=>r.stop())}),[t,e]}function aD(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=aD(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function di(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=aD(t))&&(n&&(n+=" "),n+=e);return n}const cd=t=>typeof t=="number"&&!isNaN(t),ra=t=>typeof t=="string",un=t=>typeof t=="function",Nf=t=>ra(t)||un(t)?t:null,Q0=t=>k.isValidElement(t)||ra(t)||un(t)||cd(t);function lK(t,e,r){r===void 0&&(r=300);const{scrollHeight:n,style:s}=t;requestAnimationFrame(()=>{s.minHeight="initial",s.height=n+"px",s.transition=`all ${r}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,r)})})}function qd(t){let{enter:e,exit:r,appendPosition:n=!1,collapse:s=!0,collapseDuration:i=300}=t;return function(o){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:d,isIn:h,playToast:f}=o;const v=n?`${e}--${l}`:e,m=n?`${r}--${l}`:r,p=k.useRef(0);return k.useLayoutEffect(()=>{const g=d.current,y=v.split(" "),_=b=>{b.target===d.current&&(f(),g.removeEventListener("animationend",_),g.removeEventListener("animationcancel",_),p.current===0&&b.type!=="animationcancel"&&g.classList.remove(...y))};g.classList.add(...y),g.addEventListener("animationend",_),g.addEventListener("animationcancel",_)},[]),k.useEffect(()=>{const g=d.current,y=()=>{g.removeEventListener("animationend",y),s?lK(g,u,i):u()};h||(c?y():(p.current=1,g.className+=` ${m}`,g.addEventListener("animationend",y)))},[h]),Re.createElement(Re.Fragment,null,a)}}function UC(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const Br=new Map;let ud=[];const e_=new Set,cK=t=>e_.forEach(e=>e(t)),lD=()=>Br.size>0;function cD(t,e){var r;if(e)return!((r=Br.get(e))==null||!r.isToastActive(t));let n=!1;return Br.forEach(s=>{s.isToastActive(t)&&(n=!0)}),n}function uD(t,e){Q0(t)&&(lD()||ud.push({content:t,options:e}),Br.forEach(r=>{r.buildToast(t,e)}))}function HC(t,e){Br.forEach(r=>{e!=null&&e!=null&&e.containerId?e?.containerId===r.id&&r.toggle(t,e?.id):r.toggle(t,e?.id)})}function uK(t){const{subscribe:e,getSnapshot:r,setProps:n}=k.useRef(function(i){const o=i.containerId||1;return{subscribe(a){const l=function(u,d,h){let f=1,v=0,m=[],p=[],g=[],y=d;const _=new Map,b=new Set,w=()=>{g=Array.from(_.values()),b.forEach(x=>x())},E=x=>{p=x==null?[]:p.filter(T=>T!==x),w()},S=x=>{const{toastId:T,onOpen:D,updateId:O,children:R}=x.props,P=O==null;x.staleId&&_.delete(x.staleId),_.set(T,x),p=[...p,x.props.toastId].filter(A=>A!==x.staleId),w(),h(UC(x,P?"added":"updated")),P&&un(D)&&D(k.isValidElement(R)&&R.props)};return{id:u,props:y,observe:x=>(b.add(x),()=>b.delete(x)),toggle:(x,T)=>{_.forEach(D=>{T!=null&&T!==D.props.toastId||un(D.toggle)&&D.toggle(x)})},removeToast:E,toasts:_,clearQueue:()=>{v-=m.length,m=[]},buildToast:(x,T)=>{if((U=>{let{containerId:J,toastId:ne,updateId:te}=U;const me=J?J!==u:u!==1,re=_.has(ne)&&te==null;return me||re})(T))return;const{toastId:D,updateId:O,data:R,staleId:P,delay:A}=T,H=()=>{E(D)},K=O==null;K&&v++;const V={...y,style:y.toastStyle,key:f++,...Object.fromEntries(Object.entries(T).filter(U=>{let[J,ne]=U;return ne!=null})),toastId:D,updateId:O,data:R,closeToast:H,isIn:!1,className:Nf(T.className||y.toastClassName),bodyClassName:Nf(T.bodyClassName||y.bodyClassName),progressClassName:Nf(T.progressClassName||y.progressClassName),autoClose:!T.isLoading&&(q=T.autoClose,I=y.autoClose,q===!1||cd(q)&&q>0?q:I),deleteToast(){const U=_.get(D),{onClose:J,children:ne}=U.props;un(J)&&J(k.isValidElement(ne)&&ne.props),h(UC(U,"removed")),_.delete(D),v--,v<0&&(v=0),m.length>0?S(m.shift()):w()}};var q,I;V.closeButton=y.closeButton,T.closeButton===!1||Q0(T.closeButton)?V.closeButton=T.closeButton:T.closeButton===!0&&(V.closeButton=!Q0(y.closeButton)||y.closeButton);let $=x;k.isValidElement(x)&&!ra(x.type)?$=k.cloneElement(x,{closeToast:H,toastProps:V,data:R}):un(x)&&($=x({closeToast:H,toastProps:V,data:R}));const j={content:$,props:V,staleId:P};y.limit&&y.limit>0&&v>y.limit&&K?m.push(j):cd(A)?setTimeout(()=>{S(j)},A):S(j)},setProps(x){y=x},setToggle:(x,T)=>{_.get(x).toggle=T},isToastActive:x=>p.some(T=>T===x),getSnapshot:()=>g}}(o,i,cK);Br.set(o,l);const c=l.observe(a);return ud.forEach(u=>uD(u.content,u.options)),ud=[],()=>{c(),Br.delete(o)}},setProps(a){var l;(l=Br.get(o))==null||l.setProps(a)},getSnapshot(){var a;return(a=Br.get(o))==null?void 0:a.getSnapshot()}}}(t)).current;n(t);const s=k.useSyncExternalStore(e,r,r);return{getToastToRender:function(i){if(!s)return[];const o=new Map;return t.newestOnTop&&s.reverse(),s.forEach(a=>{const{position:l}=a.props;o.has(l)||o.set(l,[]),o.get(l).push(a)}),Array.from(o,a=>i(a[0],a[1]))},isToastActive:cD,count:s?.length}}function dK(t){const[e,r]=k.useState(!1),[n,s]=k.useState(!1),i=k.useRef(null),o=k.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:d}=t;var h,f;function v(){r(!0)}function m(){r(!1)}function p(_){const b=i.current;o.canDrag&&b&&(o.didMove=!0,e&&m(),o.delta=t.draggableDirection==="x"?_.clientX-o.start:_.clientY-o.start,o.start!==_.clientX&&(o.canCloseOnClick=!1),b.style.transform=`translate3d(${t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,b.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function g(){document.removeEventListener("pointermove",p),document.removeEventListener("pointerup",g);const _=i.current;if(o.canDrag&&o.didMove&&_){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),t.closeToast(),void t.collapseAll();_.style.transition="transform 0.2s, opacity 0.2s",_.style.removeProperty("transform"),_.style.removeProperty("opacity")}}(f=Br.get((h={id:t.toastId,containerId:t.containerId,fn:r}).containerId||1))==null||f.setToggle(h.id,h.fn),k.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||m(),window.addEventListener("focus",v),window.addEventListener("blur",m),()=>{window.removeEventListener("focus",v),window.removeEventListener("blur",m)}},[t.pauseOnFocusLoss]);const y={onPointerDown:function(_){if(t.draggable===!0||t.draggable===_.pointerType){o.didMove=!1,document.addEventListener("pointermove",p),document.addEventListener("pointerup",g);const b=i.current;o.canCloseOnClick=!0,o.canDrag=!0,b.style.transition="none",t.draggableDirection==="x"?(o.start=_.clientX,o.removalDistance=b.offsetWidth*(t.draggablePercent/100)):(o.start=_.clientY,o.removalDistance=b.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(_){const{top:b,bottom:w,left:E,right:S}=i.current.getBoundingClientRect();_.nativeEvent.type!=="touchend"&&t.pauseOnHover&&_.clientX>=E&&_.clientX<=S&&_.clientY>=b&&_.clientY<=w?m():v()}};return a&&l&&(y.onMouseEnter=m,t.stacked||(y.onMouseLeave=v)),d&&(y.onClick=_=>{u&&u(_),o.canCloseOnClick&&c()}),{playToast:v,pauseToast:m,isRunning:e,preventExitTransition:n,toastRef:i,eventHandlers:y}}function hK(t){let{delay:e,isRunning:r,closeToast:n,type:s="default",hide:i,className:o,style:a,controlledProgress:l,progress:c,rtl:u,isIn:d,theme:h}=t;const f=i||l&&c===0,v={...a,animationDuration:`${e}ms`,animationPlayState:r?"running":"paused"};l&&(v.transform=`scaleX(${c})`);const m=di("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":u}),p=un(o)?o({rtl:u,type:s,defaultClassName:m}):di(m,o),g={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{d&&n()}};return Re.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},Re.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${s}`}),Re.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:p,style:v,...g}))}let fK=1;const dD=()=>""+fK++;function pK(t){return t&&(ra(t.toastId)||cd(t.toastId))?t.toastId:dD()}function nu(t,e){return uD(t,e),e.toastId}function Ip(t,e){return{...e,type:e&&e.type||t,toastId:pK(e)}}function Ih(t){return(e,r)=>nu(e,Ip(t,r))}function De(t,e){return nu(t,Ip("default",e))}De.loading=(t,e)=>nu(t,Ip("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),De.promise=function(t,e,r){let n,{pending:s,error:i,success:o}=e;s&&(n=ra(s)?De.loading(s,r):De.loading(s.render,{...r,...s}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,d,h)=>{if(d==null)return void De.dismiss(n);const f={type:u,...a,...r,data:h},v=ra(d)?{render:d}:d;return n?De.update(n,{...f,...v}):De(v.render,{...f,...v}),h},c=un(t)?t():t;return c.then(u=>l("success",o,u)).catch(u=>l("error",i,u)),c},De.success=Ih("success"),De.info=Ih("info"),De.error=Ih("error"),De.warning=Ih("warning"),De.warn=De.warning,De.dark=(t,e)=>nu(t,Ip("default",{theme:"dark",...e})),De.dismiss=function(t){(function(e){var r;if(lD()){if(e==null||ra(r=e)||cd(r))Br.forEach(n=>{n.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const n=Br.get(e.containerId);n?n.removeToast(e.id):Br.forEach(s=>{s.removeToast(e.id)})}}else ud=ud.filter(n=>e!=null&&n.options.toastId!==e)})(t)},De.clearWaitingQueue=function(t){t===void 0&&(t={}),Br.forEach(e=>{!e.props.limit||t.containerId&&e.id!==t.containerId||e.clearQueue()})},De.isActive=cD,De.update=function(t,e){e===void 0&&(e={});const r=((n,s)=>{var i;let{containerId:o}=s;return(i=Br.get(o||1))==null?void 0:i.toasts.get(n)})(t,e);if(r){const{props:n,content:s}=r,i={delay:100,...n,...e,toastId:e.toastId||t,updateId:dD()};i.toastId!==t&&(i.staleId=t);const o=i.render||s;delete i.render,nu(o,i)}},De.done=t=>{De.update(t,{progress:1})},De.onChange=function(t){return e_.add(t),()=>{e_.delete(t)}},De.play=t=>HC(!0,t),De.pause=t=>HC(!1,t);const mK=typeof window<"u"?k.useLayoutEffect:k.useEffect,Oh=t=>{let{theme:e,type:r,isLoading:n,...s}=t;return Re.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...s})},Vv={info:function(t){return Re.createElement(Oh,{...t},Re.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return Re.createElement(Oh,{...t},Re.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return Re.createElement(Oh,{...t},Re.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return Re.createElement(Oh,{...t},Re.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Re.createElement("div",{className:"Toastify__spinner"})}},gK=t=>{const{isRunning:e,preventExitTransition:r,toastRef:n,eventHandlers:s,playToast:i}=dK(t),{closeButton:o,children:a,autoClose:l,onClick:c,type:u,hideProgressBar:d,closeToast:h,transition:f,position:v,className:m,style:p,bodyClassName:g,bodyStyle:y,progressClassName:_,progressStyle:b,updateId:w,role:E,progress:S,rtl:x,toastId:T,deleteToast:D,isIn:O,isLoading:R,closeOnClick:P,theme:A}=t,H=di("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":x},{"Toastify__toast--close-on-click":P}),K=un(m)?m({rtl:x,position:v,type:u,defaultClassName:H}):di(H,m),V=function(j){let{theme:U,type:J,isLoading:ne,icon:te}=j,me=null;const re={theme:U,type:J};return te===!1||(un(te)?me=te({...re,isLoading:ne}):k.isValidElement(te)?me=k.cloneElement(te,re):ne?me=Vv.spinner():(F=>F in Vv)(J)&&(me=Vv[J](re))),me}(t),q=!!S||!l,I={closeToast:h,type:u,theme:A};let $=null;return o===!1||($=un(o)?o(I):k.isValidElement(o)?k.cloneElement(o,I):function(j){let{closeToast:U,theme:J,ariaLabel:ne="close"}=j;return Re.createElement("button",{className:`Toastify__close-button Toastify__close-button--${J}`,type:"button",onClick:te=>{te.stopPropagation(),U(te)},"aria-label":ne},Re.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Re.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(I)),Re.createElement(f,{isIn:O,done:D,position:v,preventExitTransition:r,nodeRef:n,playToast:i},Re.createElement("div",{id:T,onClick:c,"data-in":O,className:K,...s,style:p,ref:n},Re.createElement("div",{...O&&{role:E},className:un(g)?g({type:u}):di("Toastify__toast-body",g),style:y},V!=null&&Re.createElement("div",{className:di("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!R})},V),Re.createElement("div",null,a)),$,Re.createElement(hK,{...w&&!q?{key:`pb-${w}`}:{},rtl:x,theme:A,delay:l,isRunning:e,isIn:O,closeToast:h,hide:d,type:u,style:b,className:_,controlledProgress:q,progress:S||0})))},dg=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},vK=qd(dg("bounce",!0));qd(dg("slide",!0));qd(dg("zoom"));qd(dg("flip"));const yK={position:"top-right",transition:vK,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function _K(t){let e={...yK,...t};const r=t.stacked,[n,s]=k.useState(!0),i=k.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=uK(e),{className:c,style:u,rtl:d,containerId:h}=e;function f(m){const p=di("Toastify__toast-container",`Toastify__toast-container--${m}`,{"Toastify__toast-container--rtl":d});return un(c)?c({position:m,rtl:d,defaultClassName:p}):di(p,Nf(c))}function v(){r&&(s(!0),De.play())}return mK(()=>{if(r){var m;const p=i.current.querySelectorAll('[data-in="true"]'),g=12,y=(m=e.position)==null?void 0:m.includes("top");let _=0,b=0;Array.from(p).reverse().forEach((w,E)=>{const S=w;S.classList.add("Toastify__toast--stacked"),E>0&&(S.dataset.collapsed=`${n}`),S.dataset.pos||(S.dataset.pos=y?"top":"bot");const x=_*(n?.2:1)+(n?0:g*E);S.style.setProperty("--y",`${y?x:-1*x}px`),S.style.setProperty("--g",`${g}`),S.style.setProperty("--s",""+(1-(n?b:0))),_+=S.offsetHeight,b+=.025})}},[n,l,r]),Re.createElement("div",{ref:i,className:"Toastify",id:h,onMouseEnter:()=>{r&&(s(!1),De.pause())},onMouseLeave:v},o((m,p)=>{const g=p.length?{...u}:{...u,pointerEvents:"none"};return Re.createElement("div",{className:f(m),style:g,key:`container-${m}`},p.map(y=>{let{content:_,props:b}=y;return Re.createElement(gK,{...b,stacked:r,collapseAll:v,isIn:a(b.toastId,b.containerId),style:b.style,key:`toast-${b.key}`},_)}))}))}function An(t){throw new Error(`Unreachable: ${t}`)}const Dh="<codeiaArtifact",VC="</codeiaArtifact>",bK="<codeiaAction",GC="</codeiaAction>",La=en("MessageParser");function zC(t){const e=/^\s*```\w*\n([\s\S]*?)\n\s*```\s*$/,r=t.match(e);return r?r[1]:t}function WC(t){return t.replace(/&lt;/g,"<").replace(/&gt;/g,">")}class wK{constructor(e={}){this._options=e}#r=new Map;parse(e,r){let n=this.#r.get(e);n||(n={position:0,insideAction:!1,insideArtifact:!1,currentAction:{content:""},actionId:0},this.#r.set(e,n));let s="",i=n.position,o=!1;for(;i<r.length;){if(n.insideArtifact){const a=n.currentArtifact;if(a===void 0&&An("Artifact not initialized"),n.insideAction){const l=r.indexOf(GC,i),c=n.currentAction;if(l!==-1){c.content+=r.slice(i,l);let u=c.content.trim();"type"in c&&c.type==="file"&&(c.filePath.endsWith(".md")||(u=zC(u),u=WC(u)),u+=`
`),c.content=u,this._options.callbacks?.onActionClose?.({artifactId:a.id,messageId:e,actionId:String(n.actionId-1),action:c}),n.insideAction=!1,n.currentAction={content:""},i=l+GC.length}else{if("type"in c&&c.type==="file"){let u=r.slice(i);c.filePath.endsWith(".md")||(u=zC(u),u=WC(u)),this._options.callbacks?.onActionStream?.({artifactId:a.id,messageId:e,actionId:String(n.actionId-1),action:{...c,content:u,filePath:c.filePath}})}break}}else{const l=r.indexOf(bK,i),c=r.indexOf(VC,i);if(l!==-1&&(c===-1||l<c)){const u=r.indexOf(">",l);if(u!==-1)n.insideAction=!0,n.currentAction=this.#t(r,l,u),this._options.callbacks?.onActionOpen?.({artifactId:a.id,messageId:e,actionId:String(n.actionId++),action:n.currentAction}),i=u+1;else break}else if(c!==-1)this._options.callbacks?.onArtifactClose?.({messageId:e,...a}),n.insideArtifact=!1,n.currentArtifact=void 0,i=c+VC.length;else break}}else if(r[i]==="<"&&r[i+1]!=="/"){let a=i,l="";for(;a<r.length&&l.length<Dh.length;){if(l+=r[a],l===Dh){const c=r[a+1];if(c&&c!==">"&&c!==" "){s+=r.slice(i,a+1),i=a+1;break}const u=r.indexOf(">",a);if(u!==-1){const d=r.slice(i,u+1),h=this.#e(d,"title"),f=this.#e(d,"type"),v=this.#e(d,"id");h||La.warn("Artifact title missing"),v||La.warn("Artifact id missing"),n.insideArtifact=!0;const m={id:v,title:h,type:f};n.currentArtifact=m,this._options.callbacks?.onArtifactOpen?.({messageId:e,...m});const p=this._options.artifactElement??xK;s+=p({messageId:e}),i=u+1}else o=!0;break}else if(!Dh.startsWith(l)){s+=r.slice(i,a+1),i=a+1;break}a++}if(a===r.length&&Dh.startsWith(l))break}else s+=r[i],i++;if(o)break}return n.position=i,s}reset(){this.#r.clear()}#t(e,r,n){const s=e.slice(r,n+1),i=this.#e(s,"type"),o={type:i,content:""};if(i==="supabase"){const a=this.#e(s,"operation");if(!a||!["migration","query"].includes(a))throw La.warn(`Invalid or missing operation for Supabase action: ${a}`),new Error(`Invalid Supabase operation: ${a}`);if(o.operation=a,a==="migration"){const l=this.#e(s,"filePath");if(!l)throw La.warn("Migration requires a filePath"),new Error("Migration requires a filePath");o.filePath=l}}else if(i==="file"){const a=this.#e(s,"filePath");a||La.debug("File path not specified"),o.filePath=a}else["shell","start"].includes(i)||La.warn(`Unknown action type '${i}'`);return o}#e(e,r){const n=e.match(new RegExp(`${r}="([^"]*)"`,"i"));return n?n[1]:void 0}}const xK=t=>`<div ${['class="__codeiaArtifact__"',...Object.entries(t).map(([r,n])=>`data-${SK(r)}=${JSON.stringify(n)}`)].join(" ")}></div>`;function SK(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function as(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function KC(t,e){for(var r="",n=0,s=-1,i=0,o,a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||i===1))if(s!==a-1&&i===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),s=a,i=0;continue}}else if(r.length===2||r.length===1){r="",n=0,s=a,i=0;continue}}e&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/"+t.slice(s+1,a):r=t.slice(s+1,a),n=a-s-1;s=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}function EK(t,e){var r=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+n:r+t+n:n}var hl={resolve:function(){for(var e="",r=!1,n,s=arguments.length-1;s>=-1&&!r;s--){var i;s>=0?i=arguments[s]:(n===void 0&&(n=xt.cwd()),i=n),as(i),i.length!==0&&(e=i+"/"+e,r=i.charCodeAt(0)===47)}return e=KC(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(as(e),e.length===0)return".";var r=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=KC(e,!r),e.length===0&&!r&&(e="."),e.length>0&&n&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return as(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var n=arguments[r];as(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":hl.normalize(e)},relative:function(e,r){if(as(e),as(r),e===r||(e=hl.resolve(e),r=hl.resolve(r),e===r))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var s=e.length,i=s-n,o=1;o<r.length&&r.charCodeAt(o)===47;++o);for(var a=r.length,l=a-o,c=i<l?i:l,u=-1,d=0;d<=c;++d){if(d===c){if(l>c){if(r.charCodeAt(o+d)===47)return r.slice(o+d+1);if(d===0)return r.slice(o+d)}else i>c&&(e.charCodeAt(n+d)===47?u=d:d===0&&(u=0));break}var h=e.charCodeAt(n+d),f=r.charCodeAt(o+d);if(h!==f)break;h===47&&(u=d)}var v="";for(d=n+u+1;d<=s;++d)(d===s||e.charCodeAt(d)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+r.slice(o+u):(o+=u,r.charCodeAt(o)===47&&++o,r.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(as(e),e.length===0)return".";for(var r=e.charCodeAt(0),n=r===47,s=-1,i=!0,o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===47){if(!i){s=o;break}}else i=!1;return s===-1?n?"/":".":n&&s===1?"//":e.slice(0,s)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');as(e);var n=0,s=-1,i=!0,o;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,l=-1;for(o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(c===47){if(!i){n=o+1;break}}else l===-1&&(i=!1,l=o+1),a>=0&&(c===r.charCodeAt(a)?--a===-1&&(s=o):(a=-1,s=l))}return n===s?s=l:s===-1&&(s=e.length),e.slice(n,s)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!i){n=o+1;break}}else s===-1&&(i=!1,s=o+1);return s===-1?"":e.slice(n,s)}},extname:function(e){as(e);for(var r=-1,n=0,s=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){n=a+1;break}continue}s===-1&&(i=!1,s=a+1),l===46?r===-1?r=a:o!==1&&(o=1):r!==-1&&(o=-1)}return r===-1||s===-1||o===0||o===1&&r===s-1&&r===n+1?"":e.slice(r,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return EK("/",e)},parse:function(e){as(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var n=e.charCodeAt(0),s=n===47,i;s?(r.root="/",i=1):i=0;for(var o=-1,a=0,l=-1,c=!0,u=e.length-1,d=0;u>=i;--u){if(n=e.charCodeAt(u),n===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),n===46?o===-1?o=u:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||l===-1||d===0||d===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&s?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(a,l)):(a===0&&s?(r.name=e.slice(1,o),r.base=e.slice(1,l)):(r.name=e.slice(a,o),r.base=e.slice(a,l)),r.ext=e.slice(o,l)),a>0?r.dir=e.slice(0,a-1):s&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};hl.posix=hl;var CK=hl;const Ks=Ql(CK),fr={join:(...t)=>Ks.join(...t),dirname:t=>Ks.dirname(t),basename:(t,e)=>Ks.basename(t,e),extname:t=>Ks.extname(t),relative:(t,e)=>Ks.relative(t,e),isAbsolute:t=>Ks.isAbsolute(t),normalize:t=>Ks.normalize(t),parse:t=>Ks.parse(t),format:t=>Ks.format(t)},_r=en("ActionRunner");class $o extends Error{_output;_header;constructor(e,r){const n=`Failed To Execute Shell Command: ${e}

Output:
${r}`;super(n),this._header=e,this._output=r,Object.setPrototypeOf(this,$o.prototype),this.name="ActionCommandError"}get output(){return this._output}get header(){return this._header}}class kK{#r;#t=Promise.resolve();#e;runnerId=jt(`${Date.now()}`);actions=bo({});onAlert;onSupabaseAlert;onDeployAlert;buildOutput;constructor(e,r,n,s,i){this.#r=e,this.#e=r,this.onAlert=n,this.onSupabaseAlert=s,this.onDeployAlert=i}addAction(e){const{actionId:r}=e;if(this.actions.get()[r])return;const i=new AbortController;this.actions.setKey(r,{...e.action,status:"pending",executed:!1,abort:()=>{i.abort(),this.#a(r,{status:"aborted"})},abortSignal:i.signal}),this.#t.then(()=>{this.#a(r,{status:"running"})})}async runAction(e,r=!1){const{actionId:n}=e,s=this.actions.get()[n];s||An(`Action ${n} not found`),!s.executed&&(r&&s.type!=="file"||(this.#a(n,{...s,...e.action,executed:!r}),this.#t=this.#t.then(()=>this.#n(n,r)).catch(i=>{console.error("Action failed:",i)}),await this.#t))}async#n(e,r=!1){const n=this.actions.get()[e];this.#a(e,{status:"running"});try{switch(n.type){case"shell":{await this.#s(n);break}case"file":{await this.#o(n);break}case"supabase":{try{await this.handleSupabaseAction(n)}catch(s){this.#a(e,{status:"failed",error:s instanceof Error?s.message:"Supabase action failed"});return}break}case"build":{const s=await this.#c(n);this.buildOutput=s;break}case"start":{this.#i(n).then(()=>this.#a(e,{status:"complete"})).catch(s=>{n.abortSignal.aborted||(this.#a(e,{status:"failed",error:"Action failed"}),_r.error(`[${n.type}]:Action failed

`,s),s instanceof $o&&this.onAlert?.({type:"error",title:"Dev Server Failed",description:s.header,content:s.output}))}),await new Promise(s=>setTimeout(s,2e3));return}}this.#a(e,{status:r?"running":n.abortSignal.aborted?"aborted":"complete"})}catch(s){if(n.abortSignal.aborted||(this.#a(e,{status:"failed",error:"Action failed"}),_r.error(`[${n.type}]:Action failed

`,s),!(s instanceof $o)))return;throw this.onAlert?.({type:"error",title:"Dev Server Failed",description:s.header,content:s.output}),s}}async#s(e){e.type!=="shell"&&An("Expected shell action");const r=this.#e();await r.ready(),(!r||!r.terminal||!r.process)&&An("Shell terminal not found");const n=await r.executeCommand(this.runnerId.get(),e.content,()=>{_r.debug(`[${e.type}]:Aborting Action

`,e),e.abort()});if(_r.debug(`${e.type} Shell Response: [exit code:${n?.exitCode}]`),n?.exitCode!=0)throw new $o("Failed To Execute Shell Command",n?.output||"No Output Available")}async#i(e){e.type!=="start"&&An("Expected shell action"),this.#e||An("Shell terminal not found");const r=this.#e();await r.ready(),(!r||!r.terminal||!r.process)&&An("Shell terminal not found");const n=await r.executeCommand(this.runnerId.get(),e.content,()=>{_r.debug(`[${e.type}]:Aborting Action

`,e),e.abort()});if(_r.debug(`${e.type} Shell Response: [exit code:${n?.exitCode}]`),n?.exitCode!=0)throw new $o("Failed To Start Application",n?.output||"No Output Available");return n}async#o(e){e.type!=="file"&&An("Expected file action");const r=await this.#r,n=fr.relative(r.workdir,e.filePath);let s=fr.dirname(n);if(s=s.replace(/\/+$/g,""),s!==".")try{await r.fs.mkdir(s,{recursive:!0}),_r.debug("Created folder",s)}catch(i){_r.error(`Failed to create folder

`,i)}try{await r.fs.writeFile(n,e.content),_r.debug(`File written ${n}`)}catch(i){_r.error(`Failed to write file

`,i)}}#a(e,r){const n=this.actions.get();this.actions.setKey(e,{...n[e],...r})}async getFileHistory(e){try{const r=await this.#r,n=this.#l(e),s=await r.fs.readFile(n,"utf-8");return JSON.parse(s)}catch(r){return _r.error("Failed to get file history:",r),null}}async saveFileHistory(e,r){const n=this.#l(e);await this.#o({type:"file",filePath:n,content:JSON.stringify(r),changeSource:"auto-save"})}#l(e){return fr.join(".history",e)}async#c(e){e.type!=="build"&&An("Expected build action"),this.onDeployAlert?.({type:"info",title:"Building Application",description:"Building your application...",stage:"building",buildStatus:"running",deployStatus:"pending",source:"netlify"});const r=await this.#r,n=await r.spawn("npm",["run","build"]);let s="";n.output.pipeTo(new WritableStream({write(l){s+=l}}));const i=await n.exit;if(i!==0)throw this.onDeployAlert?.({type:"error",title:"Build Failed",description:"Your application build failed",content:s||"No build output available",stage:"building",buildStatus:"failed",deployStatus:"pending",source:"netlify"}),new $o("Build Failed",s||"No Output Available");this.onDeployAlert?.({type:"success",title:"Build Completed",description:"Your application was built successfully",stage:"deploying",buildStatus:"complete",deployStatus:"running",source:"netlify"});const o=["dist","build","out","output",".next","public"];let a="";for(const l of o){const c=fr.join(r.workdir,l);try{await r.fs.readdir(c),a=c,_r.debug(`Found build directory: ${a}`);break}catch(u){_r.debug(`Build directory ${l} not found, trying next option. ${u}`)}}return a||(a=fr.join(r.workdir,"dist"),_r.debug(`No build directory found, defaulting to: ${a}`)),{path:a,exitCode:i,output:s}}async handleSupabaseAction(e){const{operation:r,content:n,filePath:s}=e;switch(_r.debug("[Supabase Action]:",{operation:r,filePath:s,content:n}),r){case"migration":if(!s)throw new Error("Migration requires a filePath");return this.onSupabaseAlert?.({type:"info",title:"Supabase Migration",description:`Create migration file: ${s}`,content:n,source:"supabase"}),await this.#o({type:"file",filePath:s,content:n,changeSource:"supabase"}),{success:!0};case"query":return this.onSupabaseAlert?.({type:"info",title:"Supabase Query",description:"Execute database query",content:n,source:"supabase"}),{pending:!0};default:throw new Error(`Unknown operation: ${r}`)}}handleDeployAction(e,r,n){if(!this.onDeployAlert){_r.debug("No deploy alert handler registered");return}const s=r==="failed"?"error":r==="complete"?"success":"info",i=e==="building"?"Building Application":e==="deploying"?"Deploying Application":"Deployment Complete",o=r==="failed"?`${e==="building"?"Build":"Deployment"} failed`:r==="running"?`${e==="building"?"Building":"Deploying"} your application...`:r==="complete"?`${e==="building"?"Build":"Deployment"} completed successfully`:`Preparing to ${e==="building"?"build":"deploy"} your application`,a=e==="building"?r:e==="deploying"||e==="complete"?"complete":"pending",l=e==="building"?"pending":r;this.onDeployAlert({type:s,title:i,description:o,content:n?.error||"",url:n?.url,stage:e,buildStatus:a,deployStatus:l,source:n?.source||"netlify"})}}const TK="modulepreload",AK=function(t){return"/"+t},qC={},ee=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=Promise.allSettled(r.map(l=>{if(l=AK(l),l in qC)return;qC[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":TK,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},RK="https://.com",PK=new Error;PK.stack="";const Gv={};let Mh=null;const zv={get editorOrigin(){return Mh==null&&(Mh=new URL(globalThis.WEBCONTAINER_API_IFRAME_URL??RK).origin),Mh},set editorOrigin(t){Mh=new URL(t).origin},setQueryParam(t,e){Gv[t]=e},get url(){const t=new URL(this.editorOrigin);t.pathname="/headless";for(const e in Gv)t.searchParams.set(e,Gv[e]);return t.searchParams.set("version","1.6.1-internal.1"),t}};function IK(){let t,e;function r(){e=new Promise(n=>t=n)}return r(),{get promise(){return e},resolve(n){return t(n)},reset:r}}IK();var su;(function(t){t.UncaughtException="PREVIEW_UNCAUGHT_EXCEPTION",t.UnhandledRejection="PREVIEW_UNHANDLED_REJECTION",t.ConsoleError="PREVIEW_CONSOLE_ERROR"})(su||(su={}));var OK=Object.defineProperty,DK=(t,e)=>{for(var r in e)OK(t,r,{get:e[r],enumerable:!0})},Zr={};DK(Zr,{createEndpoint:()=>hD,expose:()=>Sx,proxy:()=>_D,proxyMarker:()=>wx,releaseProxy:()=>fD,transfer:()=>yD,transferHandlers:()=>xx,windowEndpoint:()=>FK,wrap:()=>gD});var wx=Symbol("Comlink.proxy"),hD=Symbol("Comlink.endpoint"),fD=Symbol("Comlink.releaseProxy"),t_=Symbol("Comlink.thrown"),pD=t=>typeof t=="object"&&t!==null||typeof t=="function",MK={canHandle:t=>pD(t)&&t[wx],serialize(t){const{port1:e,port2:r}=new MessageChannel;return Sx(t,e),[r,[r]]},deserialize(t){return t.start(),gD(t)}},LK={canHandle:t=>pD(t)&&t_ in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},xx=new Map([["proxy",MK],["throw",LK]]);function Sx(t,e=self){e.addEventListener("message",function r(n){if(!n||!n.data)return;const{id:s,type:i,path:o}=Object.assign({path:[]},n.data),a=(n.data.argumentList||[]).map(Uo);let l;try{const c=o.slice(0,-1).reduce((d,h)=>d[h],t),u=o.reduce((d,h)=>d[h],t);switch(i){case 0:l=u;break;case 1:c[o.slice(-1)[0]]=Uo(n.data.value),l=!0;break;case 2:l=u.apply(c,a);break;case 3:{const d=new u(...a);l=_D(d)}break;case 4:{const{port1:d,port2:h}=new MessageChannel;Sx(t,h),l=yD(d,[d])}break;case 5:l=void 0;break}}catch(c){l={value:c,[t_]:0}}Promise.resolve(l).catch(c=>({value:c,[t_]:0})).then(c=>{const[u,d]=Ex(c);e.postMessage(Object.assign(Object.assign({},u),{id:s}),d),i===5&&(e.removeEventListener("message",r),mD(e))})}),e.start&&e.start()}function NK(t){return t.constructor.name==="MessagePort"}function mD(t){NK(t)&&t.close()}function gD(t,e){return r_(t,[],e)}function Lh(t){if(t)throw new Error("Proxy has been released and is not useable")}function r_(t,e=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(i,o){if(Lh(n),o===fD)return()=>Na(t,{type:5,path:e.map(a=>a.toString())}).then(()=>{mD(t),n=!0});if(o==="then"){if(e.length===0)return{then:()=>s};const a=Na(t,{type:0,path:e.map(l=>l.toString())}).then(Uo);return a.then.bind(a)}return r_(t,[...e,o])},set(i,o,a){Lh(n);const[l,c]=Ex(a);return Na(t,{type:1,path:[...e,o].map(u=>u.toString()),value:l},c).then(Uo)},apply(i,o,a){Lh(n);const l=e[e.length-1];if(l===hD)return Na(t,{type:4}).then(Uo);if(l==="bind")return r_(t,e.slice(0,-1));const[c,u]=JC(a);return Na(t,{type:2,path:e.map(d=>d.toString()),argumentList:c},u).then(Uo)},construct(i,o){Lh(n);const[a,l]=JC(o);return Na(t,{type:3,path:e.map(c=>c.toString()),argumentList:a},l).then(Uo)}});return s}function BK(t){return Array.prototype.concat.apply([],t)}function JC(t){const e=t.map(Ex);return[e.map(r=>r[0]),BK(e.map(r=>r[1]))]}var vD=new WeakMap;function yD(t,e){return vD.set(t,e),t}function _D(t){return Object.assign(t,{[wx]:!0})}function FK(t,e=self,r="*"){return{postMessage:(n,s)=>t.postMessage(n,r,s),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function Ex(t){for(const[e,r]of xx)if(r.canHandle(t)){const[n,s]=r.serialize(t);return[{type:3,name:e,value:n},s]}return[{type:0,value:t},vD.get(t)||[]]}function Uo(t){switch(t.type){case 3:return xx.get(t.name).deserialize(t.value);case 0:return t.value}}function Na(t,e,r){return new Promise(n=>{const s=jK();t.addEventListener("message",function i(o){!o.data||!o.data.id||o.data.id!==s||(t.removeEventListener("message",i),n(o.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:s},e),r)})}function jK(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const $K=[su.ConsoleError,su.UncaughtException,su.UnhandledRejection];function UK(t){return!(t==null||typeof t!="object"||!("type"in t)||!$K.includes(t.type))}function Ba(t){const e=Object.create(null);return t?Object.assign(e,t):e}const HK=new TextDecoder("latin1");function bD(t){const e={d:{}};for(const r of Object.keys(t)){const n=t[r];if("file"in n){if("symlink"in n.file){e.d[r]={f:{l:n.file.symlink}};continue}const i=n.file.contents,o=typeof i=="string"?i:HK.decode(i),a=typeof i=="string"?{}:{b:!0};e.d[r]={f:{c:o,...a}};continue}const s=bD(n.directory);e.d[r]=s}return e}function wD(t){const e=Ba();if("f"in t)throw new Error("It is not possible to export a single file in the JSON format.");if("d"in t)for(const r of Object.keys(t.d)){const n=t.d[r];"d"in n?e[r]=Ba({directory:wD(n)}):"f"in n&&("c"in n.f?e[r]=Ba({file:Ba({contents:n.f.b?VK(n.f.c):n.f.c})}):"l"in n.f&&(e[r]=Ba({file:Ba({symlink:n.f.l})})))}return e}function VK(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t[r].charCodeAt(0);return e}let Nh=null,Bh=null,Wv={};const xD=new TextDecoder,GK=new TextEncoder;class Zs{_instance;_runtimeInfo;fs;internal;static _instance=null;static _teardownPromise=null;_tornDown=!1;_unsubscribeFromTokenChangedListener=()=>{};constructor(e,r,n,s){this._instance=e,this._runtimeInfo=s,this.fs=new ZK(r);const i=new XK(n);this.internal=new zK(i,e)}async spawn(e,r,n){let s=[];Array.isArray(r)?s=r:n=r;let i,o=new ReadableStream;if(n?.output!==!1){const m=qv();i=m.push,o=m.stream}let a,l,c,u;if(l=new ReadableStream,u=new ReadableStream,n?.stdout){const m=qv();a=m.push,l=m.stream}if(n?.stderr){const m=qv();c=m.push,u=m.stream}const d=Bf(Kv(i)),h=Bf(Kv(a)),f=Bf(Kv(c)),v=await this._instance.run({command:e,args:s,cwd:n?.cwd,env:n?.env,terminal:n?.terminal},h,f,d);return new YK(v,o,l,u)}async export(e,r){const n={format:r?.format??"json",includes:r?.includes,excludes:r?.excludes,external:!0},s=await this._instance.serialize(e,n);if(n.format==="json"){const i=JSON.parse(xD.decode(s));return wD(i)}return s}on(e,r){if(e==="preview-message"){const i=r;r=o=>{UK(o)&&i(o)}}const{listener:n,subscribe:s}=Op(r);return s(this._instance.on(e,Zr.proxy(n)))}mount(e,r){const n=e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):GK.encode(JSON.stringify(bD(e)));return this._instance.loadFiles(Zr.transfer(n,[n.buffer]),{mountPoints:r?.mountPoint})}setPreviewScript(e,r){return this._instance.setPreviewScript(e,r)}get path(){return this._runtimeInfo.path}get workdir(){return this._runtimeInfo.cwd}teardown(){if(this._tornDown)throw new Error("WebContainer already torn down");this._tornDown=!0,this._unsubscribeFromTokenChangedListener();const e=async()=>{try{await this.fs._teardown(),await this._instance.teardown()}finally{this._instance[Zr.releaseProxy](),Zs._instance===this&&(Zs._instance=null)}};Zs._teardownPromise=e()}static async boot(e={}){await this._teardownPromise,Zs._teardownPromise=null;const{workdirName:r}=e;if(window.crossOriginIsolated&&e.coep==="none"&&console.warn(`A Cross-Origin-Embedder-Policy header is required in cross origin isolated environments.
Set the 'coep' option to 'require-corp'.`),r?.includes("/")||r===".."||r===".")throw new Error("workdirName should be a valid folder name");for(;Nh;)await Nh;if(Zs._instance)throw new Error("Only a single WebContainer instance can be booted");const n=QK(e);Nh=n.catch(()=>{});try{const s=await n;return Zs._instance=s,s}finally{Nh=null}}}class zK{previewScript;_instance;constructor(e,r){this.previewScript=e,this._instance=r}watchPaths(e,r){const{listener:n,subscribe:s}=Op(r);return s(this._instance.watchPaths(e,Zr.proxy(n)))}fileSearch(e,r,n){return this._instance.fileSearch(e,r,n)}textSearch(e,r,n){return this._instance.textSearch(e,r,Zr.proxy(n))}getProcesses(){return this._instance.getProcesses()}onProcessesRemove(e){const{listener:r,subscribe:n}=Op(e);return n(this._instance.onProcessesRemove(Zr.proxy(r)))}serialize(e,r){return this._instance.serialize(e,r)}setCORSProxy(e){return this._instance.setCORSProxy(e)}setCORSAuthToken(e){return this._instance.setCORSAuthToken(e)}}const WK=1,KK=2;class qK{name;_type;constructor(e,r){this.name=e,this._type=r}isFile(){return this._type===WK}isDirectory(){return this._type===KK}}class JK{_apiClient;_path;_options;_listener;_wrappedListener;_watcher;_closed=!1;constructor(e,r,n,s){this._apiClient=e,this._path=r,this._options=n,this._listener=s,this._apiClient._watchers.add(this),this._wrappedListener=(i,o)=>{this._listener&&!this._closed&&this._listener(i,o)},this._apiClient._fs.watch(this._path,this._options,Bf(this._wrappedListener)).then(i=>{if(this._watcher=i,this._closed)return this._teardown()}).catch(console.error)}async close(){this._closed||(this._closed=!0,this._apiClient._watchers.delete(this),await this._teardown())}async _teardown(){await this._watcher?.close().finally(()=>{this._watcher?.[Zr.releaseProxy]()})}}class YK{output;input;exit;_process;stdout;stderr;constructor(e,r,n,s){this.output=r,this._process=e,this.input=new WritableStream({write:i=>{this._getProcess()?.write(i).catch(()=>{})}}),this.exit=this._onExit(),this.stdout=n,this.stderr=s}kill(){this._process?.kill()}resize(e){this._getProcess()?.resize(e)}async _onExit(){try{return await this._process.onExit}finally{this._process?.[Zr.releaseProxy](),this._process=null}}_getProcess(){return this._process==null&&console.warn("This process already exited"),this._process}}class ZK{_fs;_watchers=new Set([]);constructor(e){this._fs=e}rm(...e){return this._fs.rm(...e)}async readFile(e,r){return await this._fs.readFile(e,r)}async rename(e,r){return await this._fs.rename(e,r)}async writeFile(e,r,n){if(r instanceof Uint8Array){const s=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);r=Zr.transfer(new Uint8Array(s),[s])}await this._fs.writeFile(e,r,n)}async readdir(e,r){const n=await this._fs.readdir(e,r);return tq(n)||rq(n)?n:n.map(i=>new qK(i.name,i["Symbol(type)"]))}async mkdir(e,r){return await this._fs.mkdir(e,r)}watch(e,r,n){return typeof r=="function"&&(n=r,r=null),new JK(this,e,r,n)}async _teardown(){this._fs[Zr.releaseProxy](),await Promise.all([...this._watchers].map(e=>e.close()))}}class XK{_previewScript;_listeners=new Map;storage={set:e=>{this._previewScript.storageSet(structuredClone(e))},get:()=>this._previewScript.storageGet(),on:(e,r)=>this._on("storage:change",r)};constructor(e){this._previewScript=e}broadcast(e){this._previewScript.broadcast(structuredClone(e))}on(e,r){return this._on(e,r)}_on(e,r){let n=this._listeners.get(e);if(!n){const s=new Set,{listener:i,subscribe:o}=Op(a=>{s.forEach(l=>l(a))});n={localListeners:s,remoteUnsubscribe:o(this._previewScript.on(e,Zr.proxy(i)))},this._listeners.set(e,n)}return n.localListeners.add(r),()=>{const{localListeners:s,remoteUnsubscribe:i}=n;s.delete(r),s.size===0&&(i(),this._listeners.delete(e))}}}async function QK(t){const{serverPromise:e}=eq(t),n=await(await e).build({host:window.location.host,version:"1.6.1-internal.1",workdirName:t.workdirName,forwardPreviewErrors:t.forwardPreviewErrors}),[s,i,o]=await Promise.all([n.fs(),n.previewScript(),n.runtimeInfo()]);return new Zs(n,s,i,o)}function Kv(t){if(t!=null)return e=>{e instanceof Uint8Array?t(xD.decode(e)):e==null&&t(null)}}function Bf(t){if(t!=null)return Zr.proxy(t)}function eq(t){if(Bh!=null)return t.coep!==Wv.coep&&(console.warn(`Attempting to boot WebContainer with 'coep: ${t.coep}'`),console.warn(`First boot had 'coep: ${Wv.coep}', new settings will not take effect!`)),{serverPromise:Bh};t.coep&&zv.setQueryParam("coep",t.coep),t.experimentalNode&&zv.setQueryParam("experimental_node","1");const e=document.createElement("iframe");e.style.display="none",e.setAttribute("allow","cross-origin-isolated");const r=zv.url;e.src=r.toString();const{origin:n}=r;return Wv={...t},Bh=new Promise(s=>{const i=o=>{if(o.origin!==n)return;const{data:a}=o;if(a.type==="init"){s(Zr.wrap(o.ports[0]));return}if(a.type==="warning"){console[a.level].call(console,a.message);return}};window.addEventListener("message",i)}),document.body.insertBefore(e,null),{serverPromise:Bh}}function tq(t){return typeof t[0]=="string"}function rq(t){return t[0]instanceof Uint8Array}function qv(){let t=null;return{stream:new ReadableStream({start(n){t=n}}),push:n=>{n!=null?t?.enqueue(n):(t?.close(),t=null)}}}function Op(t){let e=!1,r=()=>{};return{subscribe(s){return s.then(i=>{r=i,e&&r()}),()=>{e=!0,r()}},listener:(...s)=>{e||t(...s)}}}function nq({prompt:t,useLegacyFunctionCalling:e=!1,systemMessageMode:r="system"}){const n=[];for(const{role:s,content:i}of t)switch(s){case"system":{switch(r){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":break;default:{const o=r;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(i.length===1&&i[0].type==="text"){n.push({role:"user",content:i[0].text});break}n.push({role:"user",content:i.map(o=>{var a,l,c;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(a=o.mimeType)!=null?a:"image/jpeg"};base64,${eI(o.image)}`,detail:(c=(l=o.providerMetadata)==null?void 0:l.openai)==null?void 0:c.imageDetail}};case"file":{if(o.data instanceof URL)throw new Ar({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};default:throw new Ar({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const a=[];for(const l of i)switch(l.type){case"text":{o+=l.text;break}case"tool-call":{a.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)}});break}default:{const c=l;throw new Error(`Unsupported part: ${c}`)}}if(e){if(a.length>1)throw new Ar({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});n.push({role:"assistant",content:o,function_call:a.length>0?a[0].function:void 0})}else n.push({role:"assistant",content:o,tool_calls:a.length>0?a:void 0});break}case"tool":{for(const o of i)e?n.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):n.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=s;throw new Error(`Unsupported role: ${o}`)}}return n}function YC(t){var e,r;return(r=(e=t?.content)==null?void 0:e.map(({token:n,logprob:s,top_logprobs:i})=>({token:n,logprob:s,topLogprobs:i?i.map(({token:o,logprob:a})=>({token:o,logprob:a})):[]})))!=null?r:void 0}function Dp(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Cx=L.object({error:L.object({message:L.string(),type:L.string().nullish(),param:L.any().nullish(),code:L.union([L.string(),L.number()]).nullish()})}),Nl=Q2({errorSchema:Cx,errorToMessage:t=>t.error.message});function Mp({id:t,model:e,created:r}){return{id:t??void 0,modelId:e??void 0,timestamp:r!=null?new Date(r*1e3):void 0}}function sq({mode:t,useLegacyFunctionCalling:e=!1,structuredOutputs:r}){var n;const s=(n=t.tools)!=null&&n.length?t.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const o=t.toolChoice;if(e){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(o==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(o.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new Ar({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:o.toolName},toolWarnings:i}}}const a=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):a.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:r?!0:void 0}});if(o==null)return{tools:a,tool_choice:void 0,toolWarnings:i};const l=o.type;switch(l){case"auto":case"none":case"required":return{tools:a,tool_choice:l,toolWarnings:i};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:o.toolName}},toolWarnings:i};default:{const c=l;throw new Ar({functionality:`Unsupported tool choice type: ${c}`})}}}var iq=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get supportsStructuredOutputs(){var t;return(t=this.settings.structuredOutputs)!=null?t:Lp(this.modelId)}get defaultObjectGenerationMode(){return lq(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,f,v,m,p,g,y,_;const b=t.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),c?.type==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const E=this.settings.useLegacyFunctionCalling;if(E&&this.settings.parallelToolCalls===!0)throw new Ar({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(E&&this.supportsStructuredOutputs)throw new Ar({functionality:"structuredOutputs with useLegacyFunctionCalling"});ZC(this.modelId)==="remove"&&e.some(x=>x.role==="system")&&w.push({type:"other",message:"system messages are removed for this model"});const S={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:s,frequency_penalty:o,presence_penalty:a,response_format:c?.type==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(f=d?.openai)==null?void 0:f.maxCompletionTokens,store:(v=d?.openai)==null?void 0:v.store,metadata:(m=d?.openai)==null?void 0:m.metadata,prediction:(p=d?.openai)==null?void 0:p.prediction,reasoning_effort:(y=(g=d?.openai)==null?void 0:g.reasoningEffort)!=null?y:this.settings.reasoningEffort,messages:nq({prompt:e,useLegacyFunctionCalling:E,systemMessageMode:ZC(this.modelId)})};switch(Lp(this.modelId)&&(S.temperature!=null&&(S.temperature=void 0,w.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),S.top_p!=null&&(S.top_p=void 0,w.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),S.frequency_penalty!=null&&(S.frequency_penalty=void 0,w.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),S.presence_penalty!=null&&(S.presence_penalty=void 0,w.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),S.logit_bias!=null&&(S.logit_bias=void 0,w.push({type:"other",message:"logitBias is not supported for reasoning models"})),S.logprobs!=null&&(S.logprobs=void 0,w.push({type:"other",message:"logprobs is not supported for reasoning models"})),S.top_logprobs!=null&&(S.top_logprobs=void 0,w.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),S.max_tokens!=null&&(S.max_completion_tokens==null&&(S.max_completion_tokens=S.max_tokens),S.max_tokens=void 0)),b){case"regular":{const{tools:x,tool_choice:T,functions:D,function_call:O,toolWarnings:R}=sq({mode:t,useLegacyFunctionCalling:E,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:x,tool_choice:T,functions:D,function_call:O},warnings:[...w,...R]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs&&t.schema!=null?{type:"json_schema",json_schema:{schema:t.schema,strict:!0,name:(_=t.name)!=null?_:"response",description:t.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:E?{...S,function_call:{name:t.tool.name},functions:[{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}]}:{...S,tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:w};default:{const x=b;throw new Error(`Unsupported type: ${x}`)}}}async doGenerate(t){var e,r,n,s,i,o,a,l;const{args:c,warnings:u}=this.getArgs(t),{responseHeaders:d,value:h}=await Qi({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Xi(this.config.headers(),t.headers),body:c,failedResponseHandler:Nl,successfulResponseHandler:Hd(oq),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:f,...v}=c,m=h.choices[0],p=(e=h.usage)==null?void 0:e.completion_tokens_details,g=(r=h.usage)==null?void 0:r.prompt_tokens_details,y={openai:{}};return p?.reasoning_tokens!=null&&(y.openai.reasoningTokens=p?.reasoning_tokens),p?.accepted_prediction_tokens!=null&&(y.openai.acceptedPredictionTokens=p?.accepted_prediction_tokens),p?.rejected_prediction_tokens!=null&&(y.openai.rejectedPredictionTokens=p?.rejected_prediction_tokens),g?.cached_tokens!=null&&(y.openai.cachedPromptTokens=g?.cached_tokens),{text:(n=m.message.content)!=null?n:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&m.message.function_call?[{toolCallType:"function",toolCallId:_s(),toolName:m.message.function_call.name,args:m.message.function_call.arguments}]:(s=m.message.tool_calls)==null?void 0:s.map(_=>{var b;return{toolCallType:"function",toolCallId:(b=_.id)!=null?b:_s(),toolName:_.function.name,args:_.function.arguments}}),finishReason:Dp(m.finish_reason),usage:{promptTokens:(o=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?o:NaN,completionTokens:(l=(a=h.usage)==null?void 0:a.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:f,rawSettings:v},rawResponse:{headers:d},request:{body:JSON.stringify(c)},response:Mp(h),warnings:u,logprobs:YC(m.logprobs),providerMetadata:y}}async doStream(t){var e;if((e=this.settings.simulateStreaming)!=null?e:cq(this.modelId)){const p=await this.doGenerate(t);return{stream:new ReadableStream({start(y){if(y.enqueue({type:"response-metadata",...p.response}),p.text&&y.enqueue({type:"text-delta",textDelta:p.text}),p.toolCalls)for(const _ of p.toolCalls)y.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:_.toolCallId,toolName:_.toolName,argsTextDelta:_.args}),y.enqueue({type:"tool-call",..._});y.enqueue({type:"finish",finishReason:p.finishReason,usage:p.usage,logprobs:p.logprobs,providerMetadata:p.providerMetadata}),y.close()}}),rawCall:p.rawCall,rawResponse:p.rawResponse,warnings:p.warnings}}const{args:r,warnings:n}=this.getArgs(t),s={...r,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:i,value:o}=await Qi({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Xi(this.config.headers(),t.headers),body:s,failedResponseHandler:Nl,successfulResponseHandler:Lw(aq),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:a,...l}=r,c=[];let u="unknown",d={promptTokens:void 0,completionTokens:void 0},h,f=!0;const{useLegacyFunctionCalling:v}=this.settings,m={openai:{}};return{stream:o.pipeThrough(new TransformStream({transform(p,g){var y,_,b,w,E,S,x,T,D,O,R,P;if(!p.success){u="error",g.enqueue({type:"error",error:p.error});return}const A=p.value;if("error"in A){u="error",g.enqueue({type:"error",error:A.error});return}if(f&&(f=!1,g.enqueue({type:"response-metadata",...Mp(A)})),A.usage!=null){const{prompt_tokens:I,completion_tokens:$,prompt_tokens_details:j,completion_tokens_details:U}=A.usage;d={promptTokens:I??void 0,completionTokens:$??void 0},U?.reasoning_tokens!=null&&(m.openai.reasoningTokens=U?.reasoning_tokens),U?.accepted_prediction_tokens!=null&&(m.openai.acceptedPredictionTokens=U?.accepted_prediction_tokens),U?.rejected_prediction_tokens!=null&&(m.openai.rejectedPredictionTokens=U?.rejected_prediction_tokens),j?.cached_tokens!=null&&(m.openai.cachedPromptTokens=j?.cached_tokens)}const H=A.choices[0];if(H?.finish_reason!=null&&(u=Dp(H.finish_reason)),H?.delta==null)return;const K=H.delta;K.content!=null&&g.enqueue({type:"text-delta",textDelta:K.content});const V=YC(H?.logprobs);V?.length&&(h===void 0&&(h=[]),h.push(...V));const q=v&&K.function_call!=null?[{type:"function",id:_s(),function:K.function_call,index:0}]:K.tool_calls;if(q!=null)for(const I of q){const $=I.index;if(c[$]==null){if(I.type!=="function")throw new ul({data:I,message:"Expected 'function' type."});if(I.id==null)throw new ul({data:I,message:"Expected 'id' to be a string."});if(((y=I.function)==null?void 0:y.name)==null)throw new ul({data:I,message:"Expected 'function.name' to be a string."});c[$]={id:I.id,type:"function",function:{name:I.function.name,arguments:(_=I.function.arguments)!=null?_:""},hasFinished:!1};const U=c[$];((b=U.function)==null?void 0:b.name)!=null&&((w=U.function)==null?void 0:w.arguments)!=null&&(U.function.arguments.length>0&&g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:U.id,toolName:U.function.name,argsTextDelta:U.function.arguments}),mp(U.function.arguments)&&(g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(E=U.id)!=null?E:_s(),toolName:U.function.name,args:U.function.arguments}),U.hasFinished=!0));continue}const j=c[$];j.hasFinished||(((S=I.function)==null?void 0:S.arguments)!=null&&(j.function.arguments+=(T=(x=I.function)==null?void 0:x.arguments)!=null?T:""),g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:j.id,toolName:j.function.name,argsTextDelta:(D=I.function.arguments)!=null?D:""}),((O=j.function)==null?void 0:O.name)!=null&&((R=j.function)==null?void 0:R.arguments)!=null&&mp(j.function.arguments)&&(g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=j.id)!=null?P:_s(),toolName:j.function.name,args:j.function.arguments}),j.hasFinished=!0))}},flush(p){var g,y;p.enqueue({type:"finish",finishReason:u,logprobs:h,usage:{promptTokens:(g=d.promptTokens)!=null?g:NaN,completionTokens:(y=d.completionTokens)!=null?y:NaN},...m!=null?{providerMetadata:m}:{}})}})),rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},request:{body:JSON.stringify(s)},warnings:n}}},SD=L.object({prompt_tokens:L.number().nullish(),completion_tokens:L.number().nullish(),prompt_tokens_details:L.object({cached_tokens:L.number().nullish()}).nullish(),completion_tokens_details:L.object({reasoning_tokens:L.number().nullish(),accepted_prediction_tokens:L.number().nullish(),rejected_prediction_tokens:L.number().nullish()}).nullish()}).nullish(),oq=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({message:L.object({role:L.literal("assistant").nullish(),content:L.string().nullish(),function_call:L.object({arguments:L.string(),name:L.string()}).nullish(),tool_calls:L.array(L.object({id:L.string().nullish(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),index:L.number(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullish(),finish_reason:L.string().nullish()})),usage:SD}),aq=L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).nullish(),content:L.string().nullish(),function_call:L.object({name:L.string().optional(),arguments:L.string().optional()}).nullish(),tool_calls:L.array(L.object({index:L.number(),id:L.string().nullish(),type:L.literal("function").optional(),function:L.object({name:L.string().nullish(),arguments:L.string().nullish()})})).nullish()}).nullish(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullish(),finish_reason:L.string().nullable().optional(),index:L.number()})),usage:SD}),Cx]);function Lp(t){return t==="o1"||t.startsWith("o1-")||t==="o3"||t.startsWith("o3-")}function lq(t){return t.startsWith("gpt-4o-audio-preview")}function ZC(t){var e,r;return Lp(t)?(r=(e=ED[t])==null?void 0:e.systemMessageMode)!=null?r:"developer":"system"}function cq(t){var e,r;return Lp(t)?(r=(e=ED[t])==null?void 0:e.simulateStreamingByDefault)!=null?r:!0:!1}var ED={"o1-mini":{systemMessageMode:"remove",simulateStreamingByDefault:!1},"o1-mini-2024-09-12":{systemMessageMode:"remove",simulateStreamingByDefault:!1},"o1-preview":{systemMessageMode:"remove",simulateStreamingByDefault:!1},"o1-preview-2024-09-12":{systemMessageMode:"remove",simulateStreamingByDefault:!1}};function uq({prompt:t,inputFormat:e,user:r="user",assistant:n="assistant"}){if(e==="prompt"&&t.length===1&&t[0].role==="user"&&t[0].content.length===1&&t[0].content[0].type==="text")return{prompt:t[0].content[0].text};let s="";t[0].role==="system"&&(s+=`${t[0].content}

`,t=t.slice(1));for(const{role:i,content:o}of t)switch(i){case"system":throw new TU({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new Ar({functionality:"images"})}}).join("");s+=`${r}:
${a}

`;break}case"assistant":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new Ar({functionality:"tool-call messages"})}}).join("");s+=`${n}:
${a}

`;break}case"tool":throw new Ar({functionality:"tool messages"});default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return s+=`${n}:
`,{prompt:s,stopSequences:[`
${r}:`]}}function XC(t){return t?.tokens.map((e,r)=>({token:e,logprob:t.token_logprobs[r],topLogprobs:t.top_logprobs?Object.entries(t.top_logprobs[r]).map(([n,s])=>({token:n,logprob:s})):[]}))}var dq=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,inputFormat:e,prompt:r,maxTokens:n,temperature:s,topP:i,topK:o,frequencyPenalty:a,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const f=t.type,v=[];o!=null&&v.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:m,stopSequences:p}=uq({prompt:r,inputFormat:e}),g=[...p??[],...c??[]],y={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:l,seed:d,prompt:m,stop:g.length>0?g:void 0};switch(f){case"regular":{if((h=t.tools)!=null&&h.length)throw new Ar({functionality:"tools"});if(t.toolChoice)throw new Ar({functionality:"toolChoice"});return{args:y,warnings:v}}case"object-json":throw new Ar({functionality:"object-json mode"});case"object-tool":throw new Ar({functionality:"object-tool mode"});default:{const _=f;throw new Error(`Unsupported type: ${_}`)}}}async doGenerate(t){const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:s}=await Qi({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Xi(this.config.headers(),t.headers),body:e,failedResponseHandler:Nl,successfulResponseHandler:Hd(hq),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:i,...o}=e,a=s.choices[0];return{text:a.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:Dp(a.finish_reason),logprobs:XC(a.logprobs),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},response:Mp(s),warnings:r,request:{body:JSON.stringify(e)}}}async doStream(t){const{args:e,warnings:r}=this.getArgs(t),n={...e,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Qi({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Xi(this.config.headers(),t.headers),body:n,failedResponseHandler:Nl,successfulResponseHandler:Lw(fq),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:o,...a}=e;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,f){if(!h.success){l="error",f.enqueue({type:"error",error:h.error});return}const v=h.value;if("error"in v){l="error",f.enqueue({type:"error",error:v.error});return}d&&(d=!1,f.enqueue({type:"response-metadata",...Mp(v)})),v.usage!=null&&(c={promptTokens:v.usage.prompt_tokens,completionTokens:v.usage.completion_tokens});const m=v.choices[0];m?.finish_reason!=null&&(l=Dp(m.finish_reason)),m?.text!=null&&f.enqueue({type:"text-delta",textDelta:m.text});const p=XC(m?.logprobs);p?.length&&(u===void 0&&(u=[]),u.push(...p))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:o,rawSettings:a},rawResponse:{headers:s},warnings:r,request:{body:JSON.stringify(n)}}}},hq=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullish()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()})}),fq=L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string().nullish(),index:L.number(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullish()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()}),Cx]),pq=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:2048}get supportsParallelCalls(){var t;return(t=this.settings.supportsParallelCalls)!=null?t:!0}async doEmbed({values:t,headers:e,abortSignal:r}){if(t.length>this.maxEmbeddingsPerCall)throw new MU({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:s}=await Qi({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Xi(this.config.headers(),e),body:{model:this.modelId,input:t,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Nl,successfulResponseHandler:Hd(mq),abortSignal:r,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:n}}}},mq=L.object({data:L.array(L.object({embedding:L.array(L.number())})),usage:L.object({prompt_tokens:L.number()}).nullish()}),gq={"dall-e-3":1,"dall-e-2":10},vq=class{constructor(t,e,r){this.modelId=t,this.settings=e,this.config=r,this.specificationVersion="v1"}get maxImagesPerCall(){var t,e;return(e=(t=this.settings.maxImagesPerCall)!=null?t:gq[this.modelId])!=null?e:1}get provider(){return this.config.provider}async doGenerate({prompt:t,n:e,size:r,aspectRatio:n,seed:s,providerOptions:i,headers:o,abortSignal:a}){var l,c,u,d;const h=[];n!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const f=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:v,responseHeaders:m}=await Qi({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Xi(this.config.headers(),o),body:{model:this.modelId,prompt:t,n:e,size:r,...(d=i.openai)!=null?d:{},response_format:"b64_json"},failedResponseHandler:Nl,successfulResponseHandler:Hd(yq),abortSignal:a,fetch:this.config.fetch});return{images:v.data.map(p=>p.b64_json),warnings:h,response:{timestamp:f,modelId:this.modelId,headers:m}}}},yq=L.object({data:L.array(L.object({b64_json:L.string()}))});function Us(t={}){var e,r,n;const s=(e=tI(t.baseURL))!=null?e:"https://api.openai.com/v1",i=(r=t.compatibility)!=null?r:"compatible",o=(n=t.name)!=null?n:"openai",a=()=>({Authorization:`Bearer ${X2({apiKey:t.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":t.organization,"OpenAI-Project":t.project,...t.headers}),l=(v,m={})=>new iq(v,m,{provider:`${o}.chat`,url:({path:p})=>`${s}${p}`,headers:a,compatibility:i,fetch:t.fetch}),c=(v,m={})=>new dq(v,m,{provider:`${o}.completion`,url:({path:p})=>`${s}${p}`,headers:a,compatibility:i,fetch:t.fetch}),u=(v,m={})=>new pq(v,m,{provider:`${o}.embedding`,url:({path:p})=>`${s}${p}`,headers:a,fetch:t.fetch}),d=(v,m={})=>new vq(v,m,{provider:`${o}.image`,url:({path:p})=>`${s}${p}`,headers:a,fetch:t.fetch}),h=(v,m)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return v==="gpt-3.5-turbo-instruct"?c(v,m):l(v,m)},f=function(v,m){return h(v,m)};return f.languageModel=h,f.chat=l,f.completion=c,f.embedding=u,f.textEmbedding=u,f.textEmbeddingModel=u,f.image=d,f}Us({compatibility:"strict"});class Yt{cachedDynamicModels;getApiKeyLink;labelForGetApiKey;icon;getProviderBaseUrlAndKey(e){const{apiKeys:r,providerSettings:n,serverEnv:s,defaultBaseUrlKey:i,defaultApiTokenKey:o}=e;let a=n?.baseUrl;const l=Go.getInstance();a&&a.length==0&&(a=void 0);const c=this.config.baseUrlKey||i;let u=a||s?.[c]||xt?.env?.[c]||l.env?.[c]||this.config.baseUrl;u&&u.endsWith("/")&&(u=u.slice(0,-1));const d=this.config.apiTokenKey||o,h=r?.[this.name]||s?.[d]||xt?.env?.[d]||l.env?.[d];return{baseUrl:u,apiKey:h}}getModelsFromCache(e){if(!this.cachedDynamicModels)return null;const r=this.cachedDynamicModels.cacheId,n=this.getDynamicModelsCacheKey(e);return r!==n?(this.cachedDynamicModels=void 0,null):this.cachedDynamicModels.models}getDynamicModelsCacheKey(e){return JSON.stringify({apiKeys:e.apiKeys?.[this.name],providerSettings:e.providerSettings?.[this.name],serverEnv:e.serverEnv})}storeDynamicModels(e,r){const n=this.getDynamicModelsCacheKey(e);this.cachedDynamicModels={cacheId:n,models:r}}}function CD(t,e,r){return Us({baseURL:t,apiKey:e})(r)}let kD=(t,e=21)=>(r=e)=>{let n="",s=r;for(;s--;)n+=t[Math.random()*t.length|0];return n};var TD="vercel.ai.error",_q=Symbol.for(TD),AD,bq=class RD extends Error{constructor({name:e,message:r,cause:n}){super(r),this[AD]=!0,this.name=e,this.cause=n}static isInstance(e){return RD.hasMarker(e,TD)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}toJSON(){return{name:this.name,message:this.message}}};AD=_q;var Bn=bq,n_="AI_APICallError",PD=`vercel.ai.error.${n_}`,wq=Symbol.for(PD),ID,ri=class extends Bn{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:n_,message:e,cause:a}),this[ID]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return Bn.hasMarker(e,PD)}static isAPICallError(e){return e instanceof Error&&e.name===n_&&typeof e.url=="string"&&typeof e.requestBodyValues=="object"&&(e.statusCode==null||typeof e.statusCode=="number")&&(e.responseHeaders==null||typeof e.responseHeaders=="object")&&(e.responseBody==null||typeof e.responseBody=="string")&&(e.cause==null||typeof e.cause=="object")&&typeof e.isRetryable=="boolean"&&(e.data==null||typeof e.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};ID=wq;var s_="AI_EmptyResponseBodyError",OD=`vercel.ai.error.${s_}`,xq=Symbol.for(OD),DD,Sq=class extends Bn{constructor({message:e="Empty response body"}={}){super({name:s_,message:e}),this[DD]=!0}static isInstance(e){return Bn.hasMarker(e,OD)}static isEmptyResponseBodyError(e){return e instanceof Error&&e.name===s_}};DD=xq;function MD(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var i_="AI_JSONParseError",LD=`vercel.ai.error.${i_}`,Eq=Symbol.for(LD),ND,Np=class extends Bn{constructor({text:e,cause:r}){super({name:i_,message:`JSON parsing failed: Text: ${e}.
Error message: ${MD(r)}`,cause:r}),this[ND]=!0,this.text=e}static isInstance(e){return Bn.hasMarker(e,LD)}static isJSONParseError(e){return e instanceof Error&&e.name===i_&&typeof e.text=="string"&&typeof e.cause=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};ND=Eq;var o_="AI_LoadAPIKeyError",BD=`vercel.ai.error.${o_}`,Cq=Symbol.for(BD),FD,Fh=class extends Bn{constructor({message:e}){super({name:o_,message:e}),this[FD]=!0}static isInstance(e){return Bn.hasMarker(e,BD)}static isLoadAPIKeyError(e){return e instanceof Error&&e.name===o_}};FD=Cq;var a_="AI_TypeValidationError",jD=`vercel.ai.error.${a_}`,kq=Symbol.for(jD),$D,iu=class extends Bn{constructor({value:e,cause:r}){super({name:a_,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${MD(r)}`,cause:r}),this[$D]=!0,this.value=e}static isInstance(e){return Bn.hasMarker(e,jD)}static isTypeValidationError(e){return e instanceof Error&&e.name===a_}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};$D=kq;var l_="AI_UnsupportedFunctionalityError",UD=`vercel.ai.error.${l_}`,Tq=Symbol.for(UD),HD,c_=class extends Bn{constructor({functionality:e}){super({name:l_,message:`'${e}' functionality not supported.`}),this[HD]=!0,this.functionality=e}static isInstance(e){return Bn.hasMarker(e,UD)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===l_&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};HD=Tq;function Aq(t){let e,r,n,s,i,o,a;return l(),{feed:c,reset:l};function l(){e=!0,r="",n=0,s=-1,i=void 0,o=void 0,a=""}function c(d){r=r?r+d:d,e&&Rq(r)&&(r=r.slice(VD.length)),e=!1;const h=r.length;let f=0,v=!1;for(;f<h;){v&&(r[f]===`
`&&++f,v=!1);let m=-1,p=s,g;for(let y=n;m<0&&y<h;++y)g=r[y],g===":"&&p<0?p=y-f:g==="\r"?(v=!0,m=y-f):g===`
`&&(m=y-f);if(m<0){n=h-f,s=p;break}else n=0,s=-1;u(r,f,p,m),f+=m+1}f===h?r="":f>0&&(r=r.slice(f))}function u(d,h,f,v){if(v===0){a.length>0&&(t({type:"event",id:i,event:o||void 0,data:a.slice(0,-1)}),a="",i=void 0),o=void 0;return}const m=f<0,p=d.slice(h,h+(m?v:f));let g=0;m?g=v:d[h+f+1]===" "?g=f+2:g=f+1;const y=h+g,_=v-g,b=d.slice(y,y+_).toString();if(p==="data")a+=b?"".concat(b,`
`):`
`;else if(p==="event")o=b;else if(p==="id"&&!b.includes("\0"))i=b;else if(p==="retry"){const w=parseInt(b,10);Number.isNaN(w)||t({type:"reconnect-interval",value:w})}}}const VD=[239,187,191];function Rq(t){return VD.every((e,r)=>t.charCodeAt(r)===e)}class kx extends TransformStream{constructor(){let e;super({start(r){e=Aq(n=>{n.type==="event"&&r.enqueue(n)})},transform(r){e.feed(r)}})}}var Pq={};function QC(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function hg(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}function Jv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function Iq({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Fh({message:`${n} API key must be a string.`});if(typeof xt>"u")throw new Fh({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=Pq[e],t==null)throw new Fh({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Fh({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var u_=Symbol.for("vercel.ai.validator");function Oq(t){return{[u_]:!0,validate:t}}function Dq(t){return typeof t=="object"&&t!==null&&u_ in t&&t[u_]===!0&&"validate"in t}function Mq(t){return Oq(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function Lq({value:t,schema:e}){const r=GD({value:t,schema:e});if(!r.success)throw new iu({value:t,cause:r.error});return r.value}function GD({value:t,schema:e}){const r=Dq(e)?e:Mq(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:new iu({value:t,cause:n.error})}}catch(n){return{success:!1,error:iu.isTypeValidationError(n)?n:new iu({value:t,cause:n})}}}function Nq({text:t,schema:e}){try{const r=Un.parse(t);return e==null?r:Lq({value:r,schema:e})}catch(r){throw Np.isJSONParseError(r)||iu.isTypeValidationError(r)?r:new Np({text:t,cause:r})}}function zD({text:t,schema:e}){try{const r=Un.parse(t);return e==null?{success:!0,value:r}:GD({value:r,schema:e})}catch(r){return{success:!1,error:Np.isJSONParseError(r)?r:new Np({text:t,cause:r})}}}function Bq(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var Fq=()=>fetch,ek=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>jq({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),jq=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=Fq()})=>{try{const a=await o(t,{method:"POST",headers:Bq(e),body:r.content,signal:i}),l=hg(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw Jv(u)||ri.isAPICallError(u)?u:new ri({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(Jv(c)||ri.isAPICallError(c))?c:new ri({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(Jv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new ri({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},$q=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=hg(n);if(o.trim()==="")return{responseHeaders:a,value:new ri({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=Nq({text:o,schema:t});return{responseHeaders:a,value:new ri({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new ri({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},Uq=t=>async({response:e})=>{const r=hg(e);if(e.body==null)throw new Sq({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new kx).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(zD({text:n,schema:t}))}}))}},Hq=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=zD({text:s,schema:t}),o=hg(e);if(!i.success)throw new ri({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}};function Vq(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return globalThis.btoa(e)}function Gq(t){return t?.replace(/\/$/,"")}var zq=L.object({type:L.literal("error"),error:L.object({type:L.string(),message:L.string()})}),tk=$q({errorSchema:zq,errorToMessage:t=>t.error.message});function Wq(t){var e;const r=Kq(t);let n;const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=o.type;switch(a){case"system":{if(n!=null)throw new c_({functionality:"Multiple system messages that are separated by user/assistant messages"});n=o.messages.map(({content:l})=>l).join(`
`);break}case"user":{const l=[];for(const{role:c,content:u}of o.messages)switch(c){case"user":{for(const d of u)switch(d.type){case"text":{l.push({type:"text",text:d.text});break}case"image":{if(d.image instanceof URL)throw new c_({functionality:"Image URLs in user messages"});l.push({type:"image",source:{type:"base64",media_type:(e=d.mimeType)!=null?e:"image/jpeg",data:Vq(d.image)}});break}}break}case"tool":{for(const d of u)l.push({type:"tool_result",tool_use_id:d.toolCallId,content:JSON.stringify(d.result),is_error:d.isError});break}default:{const d=c;throw new Error(`Unsupported role: ${d}`)}}s.push({role:"user",content:l});break}case"assistant":{const l=[];for(const{content:c}of o.messages)for(let u=0;u<c.length;u++){const d=c[u];switch(d.type){case"text":{l.push({type:"text",text:i===r.length-1&&u===o.messages.length-1?d.text.trim():d.text});break}case"tool-call":{l.push({type:"tool_use",id:d.toolCallId,name:d.toolName,input:d.args});break}}}s.push({role:"assistant",content:l});break}default:{const l=a;throw new Error(`Unsupported type: ${l}`)}}}return{system:n,messages:s}}function Kq(t){const e=[];let r;for(const{role:n,content:s}of t)switch(n){case"system":{r?.type!=="system"&&(r={type:"system",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}case"assistant":{r?.type!=="assistant"&&(r={type:"assistant",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}case"user":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}case"tool":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}default:{const i=n;throw new Error(`Unsupported role: ${i}`)}}return e}function rk(t){switch(t){case"end_turn":case"stop_sequence":return"stop";case"tool_use":return"tool-calls";case"max_tokens":return"length";default:return"other"}}var qq=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}async getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){const d=t.type,h=[];o!=null&&h.push({type:"unsupported-setting",setting:"frequencyPenalty"}),a!=null&&h.push({type:"unsupported-setting",setting:"presencePenalty"}),u!=null&&h.push({type:"unsupported-setting",setting:"seed"}),c!=null&&c.type!=="text"&&h.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const f=Wq(e),v={model:this.modelId,top_k:i??this.settings.topK,max_tokens:r??4096,temperature:n,top_p:s,stop_sequences:l,system:f.system,messages:f.messages};switch(d){case"regular":return{args:{...v,...Zq(t)},warnings:h};case"object-json":throw new c_({functionality:"json-mode object generation"});case"object-tool":{const{name:m,description:p,parameters:g}=t.tool;return{args:{...v,tools:[{name:m,description:p,input_schema:g}],tool_choice:{type:"tool",name:m}},warnings:h}}default:{const m=d;throw new Error(`Unsupported type: ${m}`)}}}async doGenerate(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:s}=await ek({url:`${this.config.baseURL}/messages`,headers:QC(this.config.headers(),t.headers),body:e,failedResponseHandler:tk,successfulResponseHandler:Hq(Jq),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e;let a="";for(const c of s.content)c.type==="text"&&(a+=c.text);let l;if(s.content.some(c=>c.type==="tool_use")){l=[];for(const c of s.content)c.type==="tool_use"&&l.push({toolCallType:"function",toolCallId:c.id,toolName:c.name,args:JSON.stringify(c.input)})}return{text:a,toolCalls:l,finishReason:rk(s.stop_reason),usage:{promptTokens:s.usage.input_tokens,completionTokens:s.usage.output_tokens},rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}async doStream(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:s}=await ek({url:`${this.config.baseURL}/messages`,headers:QC(this.config.headers(),t.headers),body:{...e,stream:!0},failedResponseHandler:tk,successfulResponseHandler:Uq(Yq),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e;let a="other";const l={promptTokens:Number.NaN,completionTokens:Number.NaN},c={};return{stream:s.pipeThrough(new TransformStream({transform(u,d){if(!u.success){d.enqueue({type:"error",error:u.error});return}const h=u.value;switch(h.type){case"ping":return;case"content_block_start":{const f=h.content_block.type;switch(f){case"text":return;case"tool_use":{c[h.index]={toolCallId:h.content_block.id,toolName:h.content_block.name,jsonText:""};return}default:{const v=f;throw new Error(`Unsupported content block type: ${v}`)}}}case"content_block_stop":{if(c[h.index]!=null){const f=c[h.index];d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:f.toolCallId,toolName:f.toolName,args:f.jsonText}),delete c[h.index]}return}case"content_block_delta":{const f=h.delta.type;switch(f){case"text_delta":{d.enqueue({type:"text-delta",textDelta:h.delta.text});return}case"input_json_delta":{const v=c[h.index];d.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:v.toolCallId,toolName:v.toolName,argsTextDelta:h.delta.partial_json}),v.jsonText+=h.delta.partial_json;return}default:{const v=f;throw new Error(`Unsupported delta type: ${v}`)}}}case"message_start":{l.promptTokens=h.message.usage.input_tokens,l.completionTokens=h.message.usage.output_tokens;return}case"message_delta":{l.completionTokens=h.usage.output_tokens,a=rk(h.delta.stop_reason);return}case"message_stop":{d.enqueue({type:"finish",finishReason:a,usage:l});return}case"error":{d.enqueue({type:"error",error:h.error});return}default:{const f=h;throw new Error(`Unsupported chunk type: ${f}`)}}}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}},Jq=L.object({type:L.literal("message"),content:L.array(L.discriminatedUnion("type",[L.object({type:L.literal("text"),text:L.string()}),L.object({type:L.literal("tool_use"),id:L.string(),name:L.string(),input:L.unknown()})])),stop_reason:L.string().optional().nullable(),usage:L.object({input_tokens:L.number(),output_tokens:L.number()})}),Yq=L.discriminatedUnion("type",[L.object({type:L.literal("message_start"),message:L.object({usage:L.object({input_tokens:L.number(),output_tokens:L.number()})})}),L.object({type:L.literal("content_block_start"),index:L.number(),content_block:L.discriminatedUnion("type",[L.object({type:L.literal("text"),text:L.string()}),L.object({type:L.literal("tool_use"),id:L.string(),name:L.string()})])}),L.object({type:L.literal("content_block_delta"),index:L.number(),delta:L.discriminatedUnion("type",[L.object({type:L.literal("input_json_delta"),partial_json:L.string()}),L.object({type:L.literal("text_delta"),text:L.string()})])}),L.object({type:L.literal("content_block_stop"),index:L.number()}),L.object({type:L.literal("error"),error:L.object({type:L.string(),message:L.string()})}),L.object({type:L.literal("message_delta"),delta:L.object({stop_reason:L.string().optional().nullable()}),usage:L.object({output_tokens:L.number()})}),L.object({type:L.literal("message_stop")}),L.object({type:L.literal("ping")})]);function Zq(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(o=>({name:o.name,description:o.description,input_schema:o.parameters})),s=t.toolChoice;if(s==null)return{tools:n,tool_choice:void 0};const i=s.type;switch(i){case"auto":return{tools:n,tool_choice:{type:"auto"}};case"required":return{tools:n,tool_choice:{type:"any"}};case"none":return{tools:void 0,tool_choice:void 0};case"tool":return{tools:n,tool_choice:{type:"tool",name:s.toolName}};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}function WD(t={}){var e,r;const n=(r=Gq((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://api.anthropic.com/v1",s=()=>({"anthropic-version":"2023-06-01","x-api-key":Iq({apiKey:t.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"}),...t.headers}),i=(a,l={})=>new qq(a,l,{provider:"anthropic.messages",baseURL:n,headers:s,fetch:t.fetch}),o=function(a,l){if(new.target)throw new Error("The Anthropic model function cannot be called with the new keyword.");return i(a,l)};return o.languageModel=i,o.chat=i,o.messages=i,o}WD();class Xq extends Yt{name="Anthropic";getApiKeyLink="https://console.anthropic.com/settings/keys";config={apiTokenKey:"ANTHROPIC_API_KEY"};staticModels=[{name:"claude-3-7-sonnet-20250219",label:"Claude 3.7 Sonnet",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-5-sonnet-latest",label:"Claude 3.5 Sonnet (new)",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-5-sonnet-20240620",label:"Claude 3.5 Sonnet (old)",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-5-haiku-latest",label:"Claude 3.5 Haiku (new)",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-opus-latest",label:"Claude 3 Opus",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-sonnet-20240229",label:"Claude 3 Sonnet",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-haiku-20240307",label:"Claude 3 Haiku",provider:"Anthropic",maxTokenAllowed:8e3}];async getDynamicModels(e,r,n){const{apiKey:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"ANTHROPIC_API_KEY"});if(!s)throw`Missing Api Key configuration for ${this.name} provider`;const o=await(await fetch("https://api.anthropic.com/v1/models",{headers:{"x-api-key":`${s}`,"anthropic-version":"2023-06-01"}})).json(),a=this.staticModels.map(c=>c.name);return o.data.filter(c=>c.type==="model"&&!a.includes(c.id)).map(c=>({name:c.id,label:`${c.display_name}`,provider:this.name,maxTokenAllowed:32e3}))}getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:s,model:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n,serverEnv:s,defaultBaseUrlKey:"",defaultApiTokenKey:"ANTHROPIC_API_KEY"});return WD({apiKey:o})(i)}}var KD="vercel.ai.error",Qq=Symbol.for(KD),qD,eJ=class JD extends Error{constructor({name:e,message:r,cause:n}){super(r),this[qD]=!0,this.name=e,this.cause=n}static isInstance(e){return JD.hasMarker(e,KD)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};qD=Qq;var Ir=eJ,YD="AI_APICallError",ZD=`vercel.ai.error.${YD}`,tJ=Symbol.for(ZD),XD,ni=class extends Ir{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:YD,message:e,cause:a}),this[XD]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return Ir.hasMarker(e,ZD)}};XD=tJ;var QD="AI_EmptyResponseBodyError",eM=`vercel.ai.error.${QD}`,rJ=Symbol.for(eM),tM,nJ=class extends Ir{constructor({message:e="Empty response body"}={}){super({name:QD,message:e}),this[tM]=!0}static isInstance(e){return Ir.hasMarker(e,eM)}};tM=rJ;function rM(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var nM="AI_InvalidArgumentError",sM=`vercel.ai.error.${nM}`,sJ=Symbol.for(sM),iM,iJ=class extends Ir{constructor({message:e,cause:r,argument:n}){super({name:nM,message:e,cause:r}),this[iM]=!0,this.argument=n}static isInstance(e){return Ir.hasMarker(e,sM)}};iM=sJ;var oM="AI_JSONParseError",aM=`vercel.ai.error.${oM}`,oJ=Symbol.for(aM),lM,Bp=class extends Ir{constructor({text:e,cause:r}){super({name:oM,message:`JSON parsing failed: Text: ${e}.
Error message: ${rM(r)}`,cause:r}),this[lM]=!0,this.text=e}static isInstance(e){return Ir.hasMarker(e,aM)}};lM=oJ;var cM="AI_LoadAPIKeyError",uM=`vercel.ai.error.${cM}`,aJ=Symbol.for(uM),dM,jh=class extends Ir{constructor({message:e}){super({name:cM,message:e}),this[dM]=!0}static isInstance(e){return Ir.hasMarker(e,uM)}};dM=aJ;var hM="AI_TooManyEmbeddingValuesForCallError",fM=`vercel.ai.error.${hM}`,lJ=Symbol.for(fM),pM,cJ=class extends Ir{constructor(e){super({name:hM,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[pM]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return Ir.hasMarker(e,fM)}};pM=lJ;var mM="AI_TypeValidationError",gM=`vercel.ai.error.${mM}`,uJ=Symbol.for(gM),vM,dJ=class d_ extends Ir{constructor({value:e,cause:r}){super({name:mM,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${rM(r)}`,cause:r}),this[vM]=!0,this.value=e}static isInstance(e){return Ir.hasMarker(e,gM)}static wrap({value:e,cause:r}){return d_.isInstance(r)&&r.value===e?r:new d_({value:e,cause:r})}};vM=uJ;var Fp=dJ,yM="AI_UnsupportedFunctionalityError",_M=`vercel.ai.error.${yM}`,hJ=Symbol.for(_M),bM,fl=class extends Ir{constructor({functionality:e}){super({name:yM,message:`'${e}' functionality not supported.`}),this[bM]=!0,this.functionality=e}static isInstance(e){return Ir.hasMarker(e,_M)}};bM=hJ;var fJ={};function h_(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function fg(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var pJ=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const s=Iw(r,e);if(t==null)return s;if(r.includes(n))throw new iJ({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return i=>`${t}${n}${s(i)}`};pJ();function Yv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function mJ({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new jh({message:`${n} API key must be a string.`});if(typeof xt>"u")throw new jh({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=fJ[e],t==null)throw new jh({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new jh({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var f_=Symbol.for("vercel.ai.validator");function gJ(t){return{[f_]:!0,validate:t}}function vJ(t){return typeof t=="object"&&t!==null&&f_ in t&&t[f_]===!0&&"validate"in t}function yJ(t){return vJ(t)?t:_J(t)}function _J(t){return gJ(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function bJ({value:t,schema:e}){const r=wM({value:t,schema:e});if(!r.success)throw Fp.wrap({value:t,cause:r.error});return r.value}function wM({value:t,schema:e}){const r=yJ(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:Fp.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:Fp.wrap({value:t,cause:n})}}}function wJ({text:t,schema:e}){try{const r=Un.parse(t);return e==null?r:bJ({value:r,schema:e})}catch(r){throw Bp.isInstance(r)||Fp.isInstance(r)?r:new Bp({text:t,cause:r})}}function xM({text:t,schema:e}){try{const r=Un.parse(t);return e==null?{success:!0,value:r}:wM({value:r,schema:e})}catch(r){return{success:!1,error:Bp.isInstance(r)?r:new Bp({text:t,cause:r})}}}function xJ(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var SJ=()=>globalThis.fetch,p_=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>EJ({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),EJ=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=SJ()})=>{try{const a=await o(t,{method:"POST",headers:xJ(e),body:r.content,signal:i}),l=fg(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw Yv(u)||ni.isInstance(u)?u:new ni({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(Yv(c)||ni.isInstance(c))?c:new ni({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(Yv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new ni({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},CJ=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=fg(n);if(o.trim()==="")return{responseHeaders:a,value:new ni({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=wJ({text:o,schema:t});return{responseHeaders:a,value:new ni({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new ni({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},kJ=t=>async({response:e})=>{const r=fg(e);if(e.body==null)throw new nJ({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new Z2).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(xM({text:n,schema:t}))}}))}},SM=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=xM({text:s,schema:t}),o=fg(e);if(!i.success)throw new ni({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}};function TJ(t){return t?.replace(/\/$/,"")}var AJ=L.object({message:L.string()}),m_=CJ({errorSchema:AJ,errorToMessage:t=>t.message});function RJ(t){const e=[];for(const{role:r,content:n}of t)switch(r){case"system":{e.push({role:"system",content:n});break}case"user":{e.push({role:"user",content:n.map(s=>{switch(s.type){case"text":return s.text;case"image":throw new fl({functionality:"image-part"})}}).join("")});break}case"assistant":{let s="";const i=[];for(const o of n)switch(o.type){case"text":{s+=o.text;break}case"tool-call":{i.push({id:o.toolCallId,type:"function",function:{name:o.toolName,arguments:JSON.stringify(o.args)}});break}default:{const a=o;throw new Error(`Unsupported part: ${a}`)}}e.push({role:"assistant",content:s!==""?s:"call tool",tool_calls:i.length>0?i:void 0,tool_plan:void 0});break}case"tool":{e.push(...n.map(s=>({role:"tool",content:JSON.stringify(s.result),tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return e}function nk(t){switch(t){case"COMPLETE":case"STOP_SEQUENCE":return"stop";case"MAX_TOKENS":return"length";case"ERROR":case"ERROR_LIMIT":return"error";case"ERROR_TOXIC":return"content-filter";case"USER_CANCEL":return"other";default:return"unknown"}}function PJ(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0,n=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:n};const s=[];for(const a of r)a.type==="provider-defined"?n.push({type:"unsupported-tool",tool:a}):s.push({type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}});const i=t.toolChoice;if(i==null)return{tools:s,tool_choice:void 0,toolWarnings:n};const o=i.type;switch(o){case"auto":return{tools:s,tool_choice:o,toolWarnings:n};case"none":return{tools:void 0,tool_choice:"any",toolWarnings:n};case"required":case"tool":throw new fl({functionality:`Unsupported tool choice type: ${o}`});default:{const a=o;throw new fl({functionality:`Unsupported tool choice type: ${a}`})}}}var IJ=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){const d=t.type,h=RJ(e),f={model:this.modelId,frequency_penalty:o,presence_penalty:a,max_tokens:r,temperature:n,p:s,k:i,seed:u,stop_sequences:l,response_format:c?.type==="json"?{type:"json_object",schema:c.schema}:void 0,messages:h};switch(d){case"regular":{const{tools:v,tool_choice:m,toolWarnings:p}=PJ(t);return{...f,tools:v,warnings:p}}case"object-json":throw new fl({functionality:"object-json mode"});case"object-tool":throw new fl({functionality:"object-tool mode"});default:{const v=d;throw new fl({functionality:`Unsupported mode: ${v}`})}}}concatenateMessageText(t){return t.filter(e=>"content"in e).map(e=>e.content).join("")}removeJsonSchemaExtras(t){return t.map(e=>{if(e.type==="function"&&e.function.parameters&&typeof e.function.parameters=="object"){const{additionalProperties:r,$schema:n,...s}=e.function.parameters;return{...e,function:{...e.function,parameters:s}}}return e})}async doGenerate(t){var e,r,n,s,i;const{warnings:o,...a}=this.getArgs(t);a.tools=a.tools&&this.removeJsonSchemaExtras(a.tools);const{responseHeaders:l,value:c}=await p_({url:`${this.config.baseURL}/chat`,headers:h_(this.config.headers(),t.headers),body:a,failedResponseHandler:m_,successfulResponseHandler:SM(OJ),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:u,...d}=a;let h=(n=(r=(e=c.message.content)==null?void 0:e[0])==null?void 0:r.text)!=null?n:"";return h||(h=(s=c.message.tool_plan)!=null?s:""),{text:h,toolCalls:c.message.tool_calls?c.message.tool_calls.map(f=>({toolCallId:f.id,toolName:f.function.name,args:f.function.arguments,toolCallType:"function"})):[],finishReason:nk(c.finish_reason),usage:{promptTokens:c.usage.tokens.input_tokens,completionTokens:c.usage.tokens.output_tokens},rawCall:{rawPrompt:{messages:u},rawSettings:d},response:{id:(i=c.generation_id)!=null?i:void 0},rawResponse:{headers:l},warnings:o,request:{body:JSON.stringify(a)}}}async doStream(t){const{warnings:e,...r}=this.getArgs(t);r.tools=r.tools&&this.removeJsonSchemaExtras(r.tools);const n={...r,stream:!0},{responseHeaders:s,value:i}=await p_({url:`${this.config.baseURL}/chat`,headers:h_(this.config.headers(),t.headers),body:n,failedResponseHandler:m_,successfulResponseHandler:kJ(DJ),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:o,...a}=r;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u={toolCallId:"",toolName:"",argsTextDelta:""};return{stream:i.pipeThrough(new TransformStream({transform(d,h){var f;if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const v=d.value;switch(v.type){case"content-delta":{h.enqueue({type:"text-delta",textDelta:v.delta.message.content.text});return}case"tool-plan-delta":{h.enqueue({type:"text-delta",textDelta:v.delta.message.tool_plan});return}case"tool-call-start":{u={toolCallId:v.delta.message.tool_calls.id,toolName:v.delta.message.tool_calls.function.name,argsTextDelta:v.delta.message.tool_calls.function.arguments},h.enqueue({type:"tool-call-delta",toolCallId:u.toolCallId,toolName:u.toolName,toolCallType:"function",argsTextDelta:u.argsTextDelta});return}case"tool-call-delta":{u.argsTextDelta+=v.delta.message.tool_calls.function.arguments,h.enqueue({type:"tool-call-delta",toolCallId:u.toolCallId,toolName:u.toolName,toolCallType:"function",argsTextDelta:v.delta.message.tool_calls.function.arguments});return}case"tool-call-end":{h.enqueue({type:"tool-call",toolCallId:u.toolCallId,toolName:u.toolName,toolCallType:"function",args:JSON.stringify(JSON.parse(u.argsTextDelta))}),u={toolCallId:"",toolName:"",argsTextDelta:""};return}case"message-start":{h.enqueue({type:"response-metadata",id:(f=v.id)!=null?f:void 0});return}case"message-end":{l=nk(v.delta.finish_reason);const p=v.delta.usage.tokens;c={promptTokens:p.input_tokens,completionTokens:p.output_tokens}}default:return}},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:{messages:o},rawSettings:a},rawResponse:{headers:s},warnings:e,request:{body:JSON.stringify(n)}}}},OJ=L.object({generation_id:L.string().nullish(),message:L.object({role:L.string(),content:L.array(L.object({type:L.string(),text:L.string()})).nullish(),tool_plan:L.string().nullish(),tool_calls:L.array(L.object({id:L.string(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),finish_reason:L.string(),usage:L.object({billed_units:L.object({input_tokens:L.number(),output_tokens:L.number()}),tokens:L.object({input_tokens:L.number(),output_tokens:L.number()})})}),DJ=L.discriminatedUnion("type",[L.object({type:L.literal("citation-start")}),L.object({type:L.literal("citation-end")}),L.object({type:L.literal("content-start")}),L.object({type:L.literal("content-delta"),delta:L.object({message:L.object({content:L.object({text:L.string()})})})}),L.object({type:L.literal("content-end")}),L.object({type:L.literal("message-start"),id:L.string().nullish()}),L.object({type:L.literal("message-end"),delta:L.object({finish_reason:L.string(),usage:L.object({tokens:L.object({input_tokens:L.number(),output_tokens:L.number()})})})}),L.object({type:L.literal("tool-plan-delta"),delta:L.object({message:L.object({tool_plan:L.string()})})}),L.object({type:L.literal("tool-call-start"),delta:L.object({message:L.object({tool_calls:L.object({id:L.string(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})})})}),L.object({type:L.literal("tool-call-delta"),delta:L.object({message:L.object({tool_calls:L.object({function:L.object({arguments:L.string()})})})})}),L.object({type:L.literal("tool-call-end")})]),MJ=class{constructor(t,e,r){this.specificationVersion="v1",this.maxEmbeddingsPerCall=96,this.supportsParallelCalls=!0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}async doEmbed({values:t,headers:e,abortSignal:r}){var n;if(t.length>this.maxEmbeddingsPerCall)throw new cJ({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:s,value:i}=await p_({url:`${this.config.baseURL}/embed`,headers:h_(this.config.headers(),e),body:{model:this.modelId,embedding_types:["float"],texts:t,input_type:(n=this.settings.inputType)!=null?n:"search_query",truncate:this.settings.truncate},failedResponseHandler:m_,successfulResponseHandler:SM(LJ),abortSignal:r,fetch:this.config.fetch});return{embeddings:i.embeddings.float,usage:{tokens:i.meta.billed_units.input_tokens},rawResponse:{headers:s}}}},LJ=L.object({embeddings:L.object({float:L.array(L.array(L.number()))}),meta:L.object({billed_units:L.object({input_tokens:L.number()})})});function EM(t={}){var e;const r=(e=TJ(t.baseURL))!=null?e:"https://api.cohere.com/v2",n=()=>({Authorization:`Bearer ${mJ({apiKey:t.apiKey,environmentVariableName:"COHERE_API_KEY",description:"Cohere"})}`,...t.headers}),s=(a,l={})=>new IJ(a,l,{provider:"cohere.chat",baseURL:r,headers:n,fetch:t.fetch}),i=(a,l={})=>new MJ(a,l,{provider:"cohere.textEmbedding",baseURL:r,headers:n,fetch:t.fetch}),o=function(a,l){if(new.target)throw new Error("The Cohere model function cannot be called with the new keyword.");return s(a,l)};return o.languageModel=s,o.embedding=i,o.textEmbeddingModel=i,o}EM();class NJ extends Yt{name="Cohere";getApiKeyLink="https://dashboard.cohere.com/api-keys";config={apiTokenKey:"COHERE_API_KEY"};staticModels=[{name:"command-r-plus-08-2024",label:"Command R plus Latest",provider:"Cohere",maxTokenAllowed:4096},{name:"command-r-08-2024",label:"Command R Latest",provider:"Cohere",maxTokenAllowed:4096},{name:"command-r-plus",label:"Command R plus",provider:"Cohere",maxTokenAllowed:4096},{name:"command-r",label:"Command R",provider:"Cohere",maxTokenAllowed:4096},{name:"command",label:"Command",provider:"Cohere",maxTokenAllowed:4096},{name:"command-nightly",label:"Command Nightly",provider:"Cohere",maxTokenAllowed:4096},{name:"command-light",label:"Command Light",provider:"Cohere",maxTokenAllowed:4096},{name:"command-light-nightly",label:"Command Light Nightly",provider:"Cohere",maxTokenAllowed:4096},{name:"c4ai-aya-expanse-8b",label:"c4AI Aya Expanse 8b",provider:"Cohere",maxTokenAllowed:4096},{name:"c4ai-aya-expanse-32b",label:"c4AI Aya Expanse 32b",provider:"Cohere",maxTokenAllowed:4096}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"COHERE_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return EM({apiKey:o})(r)}}function Sc(t){var e,r;return(r=(e=t?.providerMetadata)==null?void 0:e.openaiCompatible)!=null?r:{}}function BJ(t){const e=[];for(const{role:r,content:n,...s}of t){const i=Sc({...s});switch(r){case"system":{e.push({role:"system",content:n,...i});break}case"user":{if(n.length===1&&n[0].type==="text"){e.push({role:"user",content:n[0].text,...Sc(n[0])});break}e.push({role:"user",content:n.map(o=>{var a;const l=Sc(o);switch(o.type){case"text":return{type:"text",text:o.text,...l};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(a=o.mimeType)!=null?a:"image/jpeg"};base64,${eI(o.image)}`},...l};case"file":throw new Ar({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let o="";const a=[];for(const l of n){const c=Sc(l);switch(l.type){case"text":{o+=l.text;break}case"tool-call":{a.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}default:{const u=l;throw new Error(`Unsupported part: ${u}`)}}}e.push({role:"assistant",content:o,tool_calls:a.length>0?a:void 0,...i});break}case"tool":{for(const o of n){const a=Sc(o);e.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result),...a})}break}default:{const o=r;throw new Error(`Unsupported role: ${o}`)}}}return e}function sk({id:t,model:e,created:r}){return{id:t??void 0,modelId:e??void 0,timestamp:r!=null?new Date(r*1e3):void 0}}function ik(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var FJ=L.object({error:L.object({message:L.string(),type:L.string().nullish(),param:L.any().nullish(),code:L.union([L.string(),L.number()]).nullish()})}),jJ={errorSchema:FJ,errorToMessage:t=>t.error.message};function $J({mode:t,structuredOutputs:e}){var r;const n=(r=t.tools)!=null&&r.length?t.tools:void 0,s=[];if(n==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=t.toolChoice,o=[];for(const l of n)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):o.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:o,tool_choice:void 0,toolWarnings:s};const a=i.type;switch(a){case"auto":case"none":case"required":return{tools:o,tool_choice:a,toolWarnings:s};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=a;throw new Ar({functionality:`Unsupported tool choice type: ${l}`})}}}var UJ=class{constructor(t,e,r){this.specificationVersion="v1";var n,s;this.modelId=t,this.settings=e,this.config=r;const i=(n=r.errorStructure)!=null?n:jJ;this.chunkSchema=VJ(i.errorSchema),this.failedResponseHandler=Q2(i),this.supportsStructuredOutputs=(s=r.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){var d,h;const f=t.type,v=[];i!=null&&v.push({type:"unsupported-setting",setting:"topK"}),c?.type==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const m={model:this.modelId,user:this.settings.user,max_tokens:r,temperature:n,top_p:s,frequency_penalty:o,presence_penalty:a,response_format:c?.type==="json"?this.supportsStructuredOutputs===!0&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,name:(d=c.name)!=null?d:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,messages:BJ(e)};switch(f){case"regular":{const{tools:p,tool_choice:g,toolWarnings:y}=$J({mode:t,structuredOutputs:this.supportsStructuredOutputs});return{args:{...m,tools:p,tool_choice:g},warnings:[...v,...y]}}case"object-json":return{args:{...m,response_format:this.supportsStructuredOutputs===!0&&t.schema!=null?{type:"json_schema",json_schema:{schema:t.schema,name:(h=t.name)!=null?h:"response",description:t.description}}:{type:"json_object"}},warnings:v};case"object-tool":return{args:{...m,tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}}]},warnings:v};default:{const p=f;throw new Error(`Unsupported type: ${p}`)}}}async doGenerate(t){var e,r,n,s,i,o,a,l,c;const{args:u,warnings:d}=this.getArgs({...t}),h=JSON.stringify(u),{responseHeaders:f,value:v,rawValue:m}=await Qi({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Xi(this.config.headers(),t.headers),body:u,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Hd(HJ),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:p,...g}=u,y=v.choices[0],_=(r=(e=this.config.metadataExtractor)==null?void 0:e.extractMetadata)==null?void 0:r.call(e,{parsedBody:m});return{text:(n=y.message.content)!=null?n:void 0,reasoning:(s=y.message.reasoning_content)!=null?s:void 0,toolCalls:(i=y.message.tool_calls)==null?void 0:i.map(b=>{var w;return{toolCallType:"function",toolCallId:(w=b.id)!=null?w:_s(),toolName:b.function.name,args:b.function.arguments}}),finishReason:ik(y.finish_reason),usage:{promptTokens:(a=(o=v.usage)==null?void 0:o.prompt_tokens)!=null?a:NaN,completionTokens:(c=(l=v.usage)==null?void 0:l.completion_tokens)!=null?c:NaN},..._&&{providerMetadata:_},rawCall:{rawPrompt:p,rawSettings:g},rawResponse:{headers:f},response:sk(v),warnings:d,request:{body:h}}}async doStream(t){var e;if(this.settings.simulateStreaming){const v=await this.doGenerate(t);return{stream:new ReadableStream({start(p){if(p.enqueue({type:"response-metadata",...v.response}),v.reasoning&&p.enqueue({type:"reasoning",textDelta:v.reasoning}),v.text&&p.enqueue({type:"text-delta",textDelta:v.text}),v.toolCalls)for(const g of v.toolCalls)p.enqueue({type:"tool-call",...g});p.enqueue({type:"finish",finishReason:v.finishReason,usage:v.usage,logprobs:v.logprobs,providerMetadata:v.providerMetadata}),p.close()}}),rawCall:v.rawCall,rawResponse:v.rawResponse,warnings:v.warnings}}const{args:r,warnings:n}=this.getArgs({...t}),s=JSON.stringify({...r,stream:!0}),i=(e=this.config.metadataExtractor)==null?void 0:e.createStreamExtractor(),{responseHeaders:o,value:a}=await Qi({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Xi(this.config.headers(),t.headers),body:{...r,stream:!0},failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Lw(this.chunkSchema),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=r,u=[];let d="unknown",h={promptTokens:void 0,completionTokens:void 0},f=!0;return{stream:a.pipeThrough(new TransformStream({transform(v,m){var p,g,y,_,b,w,E,S,x,T,D,O,R,P;if(!v.success){d="error",m.enqueue({type:"error",error:v.error});return}const A=v.value;if(i?.processChunk(v.rawValue),"error"in A){d="error",m.enqueue({type:"error",error:A.error.message});return}f&&(f=!1,m.enqueue({type:"response-metadata",...sk(A)})),A.usage!=null&&(h={promptTokens:(p=A.usage.prompt_tokens)!=null?p:void 0,completionTokens:(g=A.usage.completion_tokens)!=null?g:void 0});const H=A.choices[0];if(H?.finish_reason!=null&&(d=ik(H.finish_reason)),H?.delta==null)return;const K=H.delta;if(K.reasoning_content!=null&&m.enqueue({type:"reasoning",textDelta:K.reasoning_content}),K.content!=null&&m.enqueue({type:"text-delta",textDelta:K.content}),K.tool_calls!=null)for(const V of K.tool_calls){const q=V.index;if(u[q]==null){if(V.type!=="function")throw new ul({data:V,message:"Expected 'function' type."});if(V.id==null)throw new ul({data:V,message:"Expected 'id' to be a string."});if(((y=V.function)==null?void 0:y.name)==null)throw new ul({data:V,message:"Expected 'function.name' to be a string."});u[q]={id:V.id,type:"function",function:{name:V.function.name,arguments:(_=V.function.arguments)!=null?_:""},hasFinished:!1};const $=u[q];((b=$.function)==null?void 0:b.name)!=null&&((w=$.function)==null?void 0:w.arguments)!=null&&($.function.arguments.length>0&&m.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:$.id,toolName:$.function.name,argsTextDelta:$.function.arguments}),mp($.function.arguments)&&(m.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(E=$.id)!=null?E:_s(),toolName:$.function.name,args:$.function.arguments}),$.hasFinished=!0));continue}const I=u[q];I.hasFinished||(((S=V.function)==null?void 0:S.arguments)!=null&&(I.function.arguments+=(T=(x=V.function)==null?void 0:x.arguments)!=null?T:""),m.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.id,toolName:I.function.name,argsTextDelta:(D=V.function.arguments)!=null?D:""}),((O=I.function)==null?void 0:O.name)!=null&&((R=I.function)==null?void 0:R.arguments)!=null&&mp(I.function.arguments)&&(m.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=I.id)!=null?P:_s(),toolName:I.function.name,args:I.function.arguments}),I.hasFinished=!0))}},flush(v){var m,p;const g=i?.buildMetadata();v.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(m=h.promptTokens)!=null?m:NaN,completionTokens:(p=h.completionTokens)!=null?p:NaN},...g&&{providerMetadata:g}})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:o},warnings:n,request:{body:s}}}},HJ=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({message:L.object({role:L.literal("assistant").nullish(),content:L.string().nullish(),reasoning_content:L.string().nullish(),tool_calls:L.array(L.object({id:L.string().nullish(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),finish_reason:L.string().nullish()})),usage:L.object({prompt_tokens:L.number().nullish(),completion_tokens:L.number().nullish()}).nullish()}),VJ=t=>L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).nullish(),content:L.string().nullish(),reasoning_content:L.string().nullish(),tool_calls:L.array(L.object({index:L.number(),id:L.string().nullish(),type:L.literal("function").optional(),function:L.object({name:L.string().nullish(),arguments:L.string().nullish()})})).nullish()}).nullish(),finish_reason:L.string().nullish()})),usage:L.object({prompt_tokens:L.number().nullish(),completion_tokens:L.number().nullish()}).nullish()}),t]);L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()});L.object({data:L.array(L.object({embedding:L.array(L.number())})),usage:L.object({prompt_tokens:L.number()}).nullish()});var ok=t=>{var e,r;return t==null?void 0:{deepseek:{promptCacheHitTokens:(e=t.prompt_cache_hit_tokens)!=null?e:NaN,promptCacheMissTokens:(r=t.prompt_cache_miss_tokens)!=null?r:NaN}}},GJ={extractMetadata:({parsedBody:t})=>{const e=fp({value:t,schema:zJ});return!e.success||e.value.usage==null?void 0:ok(e.value.usage)},createStreamExtractor:()=>{let t;return{processChunk:e=>{var r,n;const s=fp({value:e,schema:WJ});s.success&&((n=(r=s.value.choices)==null?void 0:r[0])==null?void 0:n.finish_reason)==="stop"&&s.value.usage&&(t=s.value.usage)},buildMetadata:()=>ok(t)}}},CM=L.object({prompt_cache_hit_tokens:L.number().nullish(),prompt_cache_miss_tokens:L.number().nullish()}),zJ=L.object({usage:CM.nullish()}),WJ=L.object({choices:L.array(L.object({finish_reason:L.string().nullish()})).nullish(),usage:CM.nullish()});function kM(t={}){var e;const r=tI((e=t.baseURL)!=null?e:"https://api.deepseek.com/v1"),n=()=>({Authorization:`Bearer ${X2({apiKey:t.apiKey,environmentVariableName:"DEEPSEEK_API_KEY",description:"DeepSeek API key"})}`,...t.headers}),s=(o,a={})=>new UJ(o,a,{provider:"deepseek.chat",url:({path:l})=>`${r}${l}`,headers:n,fetch:t.fetch,defaultObjectGenerationMode:"json",metadataExtractor:GJ}),i=(o,a)=>s(o,a);return i.languageModel=s,i.chat=s,i.textEmbeddingModel=o=>{throw new OU({modelId:o,modelType:"textEmbeddingModel"})},i}kM();class KJ extends Yt{name="Deepseek";getApiKeyLink="https://platform.deepseek.com/apiKeys";config={apiTokenKey:"DEEPSEEK_API_KEY"};staticModels=[{name:"deepseek-coder",label:"Deepseek-Coder",provider:"Deepseek",maxTokenAllowed:8e3},{name:"deepseek-chat",label:"Deepseek-Chat",provider:"Deepseek",maxTokenAllowed:8e3},{name:"deepseek-reasoner",label:"Deepseek-Reasoner",provider:"Deepseek",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"DEEPSEEK_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return kM({apiKey:o})(r,{})}}var TM="vercel.ai.error",qJ=Symbol.for(TM),AM,JJ=class RM extends Error{constructor({name:e,message:r,cause:n}){super(r),this[AM]=!0,this.name=e,this.cause=n}static isInstance(e){return RM.hasMarker(e,TM)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}toJSON(){return{name:this.name,message:this.message}}};AM=qJ;var Xr=JJ,g_="AI_APICallError",PM=`vercel.ai.error.${g_}`,YJ=Symbol.for(PM),IM,si=class extends Xr{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:g_,message:e,cause:a}),this[IM]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return Xr.hasMarker(e,PM)}static isAPICallError(e){return e instanceof Error&&e.name===g_&&typeof e.url=="string"&&typeof e.requestBodyValues=="object"&&(e.statusCode==null||typeof e.statusCode=="number")&&(e.responseHeaders==null||typeof e.responseHeaders=="object")&&(e.responseBody==null||typeof e.responseBody=="string")&&(e.cause==null||typeof e.cause=="object")&&typeof e.isRetryable=="boolean"&&(e.data==null||typeof e.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};IM=YJ;var v_="AI_EmptyResponseBodyError",OM=`vercel.ai.error.${v_}`,ZJ=Symbol.for(OM),DM,MM=class extends Xr{constructor({message:e="Empty response body"}={}){super({name:v_,message:e}),this[DM]=!0}static isInstance(e){return Xr.hasMarker(e,OM)}static isEmptyResponseBodyError(e){return e instanceof Error&&e.name===v_}};DM=ZJ;function LM(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var y_="AI_JSONParseError",NM=`vercel.ai.error.${y_}`,XJ=Symbol.for(NM),BM,jp=class extends Xr{constructor({text:e,cause:r}){super({name:y_,message:`JSON parsing failed: Text: ${e}.
Error message: ${LM(r)}`,cause:r}),this[BM]=!0,this.text=e}static isInstance(e){return Xr.hasMarker(e,NM)}static isJSONParseError(e){return e instanceof Error&&e.name===y_&&"text"in e&&typeof e.text=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};BM=XJ;var __="AI_LoadAPIKeyError",FM=`vercel.ai.error.${__}`,QJ=Symbol.for(FM),jM,$h=class extends Xr{constructor({message:e}){super({name:__,message:e}),this[jM]=!0}static isInstance(e){return Xr.hasMarker(e,FM)}static isLoadAPIKeyError(e){return e instanceof Error&&e.name===__}};jM=QJ;var b_="AI_TooManyEmbeddingValuesForCallError",$M=`vercel.ai.error.${b_}`,eY=Symbol.for($M),UM,Tx=class extends Xr{constructor(t){super({name:b_,message:`Too many values for a single embedding call. The ${t.provider} model "${t.modelId}" can only embed up to ${t.maxEmbeddingsPerCall} values per call, but ${t.values.length} values were provided.`}),this[UM]=!0,this.provider=t.provider,this.modelId=t.modelId,this.maxEmbeddingsPerCall=t.maxEmbeddingsPerCall,this.values=t.values}static isInstance(t){return Xr.hasMarker(t,$M)}static isTooManyEmbeddingValuesForCallError(t){return t instanceof Error&&t.name===b_&&"provider"in t&&typeof t.provider=="string"&&"modelId"in t&&typeof t.modelId=="string"&&"maxEmbeddingsPerCall"in t&&typeof t.maxEmbeddingsPerCall=="number"&&"values"in t&&Array.isArray(t.values)}toJSON(){return{name:this.name,message:this.message,stack:this.stack,provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:this.values}}};UM=eY;var w_="AI_TypeValidationError",HM=`vercel.ai.error.${w_}`,tY=Symbol.for(HM),VM,rY=class x_ extends Xr{constructor({value:e,cause:r}){super({name:w_,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${LM(r)}`,cause:r}),this[VM]=!0,this.value=e}static isInstance(e){return Xr.hasMarker(e,HM)}static wrap({value:e,cause:r}){return x_.isInstance(r)&&r.value===e?r:new x_({value:e,cause:r})}static isTypeValidationError(e){return e instanceof Error&&e.name===w_}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};VM=tY;var $p=rY,S_="AI_UnsupportedFunctionalityError",GM=`vercel.ai.error.${S_}`,nY=Symbol.for(GM),zM,ou=class extends Xr{constructor({functionality:e}){super({name:S_,message:`'${e}' functionality not supported.`}),this[zM]=!0,this.functionality=e}static isInstance(e){return Xr.hasMarker(e,GM)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===S_&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};zM=nY;var sY={};function ao(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Jd(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var iY=({prefix:t="",size:e=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}={})=>{const n=kD(r,e);return s=>`${t}${n(s)}`},Ax=iY();function Zv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function WM({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new $h({message:`${n} API key must be a string.`});if(typeof xt>"u")throw new $h({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=sY[e],t==null)throw new $h({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new $h({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var E_=Symbol.for("vercel.ai.validator");function oY(t){return{[E_]:!0,validate:t}}function aY(t){return typeof t=="object"&&t!==null&&E_ in t&&t[E_]===!0&&"validate"in t}function lY(t){return aY(t)?t:cY(t)}function cY(t){return oY(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function uY({value:t,schema:e}){const r=KM({value:t,schema:e});if(!r.success)throw $p.wrap({value:t,cause:r.error});return r.value}function KM({value:t,schema:e}){const r=lY(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:$p.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:$p.wrap({value:t,cause:n})}}}function dY({text:t,schema:e}){try{const r=Un.parse(t);return e==null?r:uY({value:r,schema:e})}catch(r){throw jp.isJSONParseError(r)||$p.isTypeValidationError(r)?r:new jp({text:t,cause:r})}}function Rx({text:t,schema:e}){try{const r=Un.parse(t);return e==null?{success:!0,value:r}:KM({value:r,schema:e})}catch(r){return{success:!1,error:jp.isJSONParseError(r)?r:new jp({text:t,cause:r})}}}function hY(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var fY=()=>globalThis.fetch,bi=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>pY({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),pY=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=fY()})=>{try{const a=await o(t,{method:"POST",headers:hY(e),body:r.content,signal:i}),l=Jd(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw Zv(u)||si.isAPICallError(u)?u:new si({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(Zv(c)||si.isAPICallError(c))?c:new si({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(Zv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new si({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},Px=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=Jd(n);if(o.trim()==="")return{responseHeaders:a,value:new si({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=dY({text:o,schema:t});return{responseHeaders:a,value:new si({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new si({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},qM=t=>async({response:e})=>{const r=Jd(e);if(e.body==null)throw new MM({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new kx).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(Rx({text:n,schema:t}))}}))}},ic=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=Rx({text:s,schema:t}),o=Jd(e);if(!i.success)throw new si({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}},{btoa:mY}=globalThis;function Ix(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return mY(e)}function Ox(t){return t?.replace(/\/$/,"")}function vs(t){if(typeof t=="boolean")return{type:"boolean",properties:{}};const{type:e,description:r,required:n,properties:s,items:i,allOf:o,anyOf:a,oneOf:l,format:c,const:u,minLength:d}=t,h={};return r&&(h.description=r),n&&(h.required=n),c&&(h.format=c),u!==void 0&&(h.enum=[u]),e&&(Array.isArray(e)?e.includes("null")?(h.type=e.filter(f=>f!=="null")[0],h.nullable=!0):h.type=e:e==="null"?h.type="null":h.type=e),s&&(h.properties=Object.entries(s).reduce((f,[v,m])=>(f[v]=vs(m),f),{})),i&&(h.items=Array.isArray(i)?i.map(vs):vs(i)),o&&(h.allOf=o.map(vs)),a&&(h.anyOf=a.map(vs)),l&&(h.oneOf=l.map(vs)),d!==void 0&&(h.minLength=d),h}function gY(t){var e;const r=[],n=[];let s=!0;for(const{role:i,content:o}of t)switch(i){case"system":{if(!s)throw new ou({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{s=!1;const a=[];for(const l of o)switch(l.type){case"text":{a.push({text:l.text});break}case"image":{if(l.image instanceof URL)throw new ou({functionality:"Image URLs in user messages"});a.push({inlineData:{mimeType:(e=l.mimeType)!=null?e:"image/jpeg",data:Ix(l.image)}});break}case"file":{if(l.data instanceof URL)throw new ou({functionality:"File URLs in user messages"});a.push({inlineData:{mimeType:l.mimeType,data:l.data}});break}}n.push({role:"user",parts:a});break}case"assistant":{s=!1,n.push({role:"model",parts:o.map(a=>{switch(a.type){case"text":return a.text.length===0?void 0:{text:a.text};case"tool-call":return{functionCall:{name:a.toolName,args:a.args}}}}).filter(a=>a!==void 0)});break}case"tool":{s=!1,n.push({role:"user",parts:o.map(a=>({functionResponse:{name:a.toolName,response:a.result}}))});break}default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:n}}function ak(t){return t.includes("/")?t:`models/${t}`}var vY=L.object({error:L.object({code:L.number().nullable(),message:L.string(),status:L.string()})}),C_=Px({errorSchema:vY,errorToMessage:t=>t.error.message});function lk({finishReason:t,hasToolCalls:e}){switch(t){case"STOP":return e?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"RECITATION":case"SAFETY":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";default:return"unknown"}}var yY=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get supportsObjectGeneration(){return this.settings.structuredOutputs!==!1}get provider(){return this.config.provider}async getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){var d;const h=t.type,f=[];u!=null&&f.push({type:"unsupported-setting",setting:"seed"});const v={maxOutputTokens:r,temperature:n,topK:i??this.settings.topK,topP:s,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseMimeType:c?.type==="json"?"application/json":void 0,responseSchema:c?.type==="json"&&c.schema!=null&&this.supportsObjectGeneration?vs(c.schema):void 0},{contents:m,systemInstruction:p}=gY(e);switch(h){case"regular":return{args:{generationConfig:v,contents:m,systemInstruction:p,safetySettings:this.settings.safetySettings,...wY(t),cachedContent:this.settings.cachedContent},warnings:f};case"object-json":return{args:{generationConfig:{...v,responseMimeType:"application/json",responseSchema:t.schema!=null&&this.supportsObjectGeneration?vs(t.schema):void 0},contents:m,systemInstruction:p,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:f};case"object-tool":return{args:{generationConfig:v,contents:m,tools:{functionDeclarations:[{name:t.tool.name,description:(d=t.tool.description)!=null?d:"",parameters:vs(t.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:f};default:{const g=h;throw new Error(`Unsupported type: ${g}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:s}=await this.getArgs(t),{responseHeaders:i,value:o}=await bi({url:`${this.config.baseURL}/${ak(this.modelId)}:generateContent`,headers:ao(this.config.headers(),t.headers),body:n,failedResponseHandler:C_,successfulResponseHandler:ic(_Y),abortSignal:t.abortSignal,fetch:this.config.fetch}),{contents:a,...l}=n,c=o.candidates[0],u=ck({parts:c.content.parts,generateId:this.config.generateId}),d=o.usageMetadata;return{text:uk(c.content.parts),toolCalls:u,finishReason:lk({finishReason:c.finishReason,hasToolCalls:u!=null&&u.length>0}),usage:{promptTokens:(e=d?.promptTokenCount)!=null?e:NaN,completionTokens:(r=d?.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},warnings:s}}async doStream(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:s}=await bi({url:`${this.config.baseURL}/${ak(this.modelId)}:streamGenerateContent?alt=sse`,headers:ao(this.config.headers(),t.headers),body:e,failedResponseHandler:C_,successfulResponseHandler:qM(bY),abortSignal:t.abortSignal,fetch:this.config.fetch}),{contents:i,...o}=e;let a="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN};const c=this.config.generateId;let u=!1;return{stream:s.pipeThrough(new TransformStream({transform(d,h){var f,v;if(!d.success){h.enqueue({type:"error",error:d.error});return}const m=d.value,p=m.candidates[0];p?.finishReason!=null&&(a=lk({finishReason:p.finishReason,hasToolCalls:u}));const g=m.usageMetadata;g!=null&&(l={promptTokens:(f=g.promptTokenCount)!=null?f:NaN,completionTokens:(v=g.candidatesTokenCount)!=null?v:NaN});const y=p.content;if(y==null)return;const _=uk(y.parts);_!=null&&h.enqueue({type:"text-delta",textDelta:_});const b=ck({parts:y.parts,generateId:c});if(b!=null)for(const w of b)h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,args:w.args}),u=!0},flush(d){d.enqueue({type:"finish",finishReason:a,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}};function ck({parts:t,generateId:e}){const r=t.filter(n=>"functionCall"in n);return r.length===0?void 0:r.map(n=>({toolCallType:"function",toolCallId:e(),toolName:n.functionCall.name,args:JSON.stringify(n.functionCall.args)}))}function uk(t){const e=t.filter(r=>"text"in r);return e.length===0?void 0:e.map(r=>r.text).join("")}var JM=L.object({role:L.string(),parts:L.array(L.union([L.object({text:L.string()}),L.object({functionCall:L.object({name:L.string(),args:L.unknown()})})]))}),_Y=L.object({candidates:L.array(L.object({content:JM,finishReason:L.string().optional()})),usageMetadata:L.object({promptTokenCount:L.number(),candidatesTokenCount:L.number().nullish(),totalTokenCount:L.number()}).optional()}),bY=L.object({candidates:L.array(L.object({content:JM.optional(),finishReason:L.string().optional()})),usageMetadata:L.object({promptTokenCount:L.number(),candidatesTokenCount:L.number().nullish(),totalTokenCount:L.number()}).optional()});function wY(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,toolConfig:void 0};const n={functionDeclarations:r.map(o=>{var a;return{name:o.name,description:(a=o.description)!=null?a:"",parameters:vs(o.parameters)}})},s=t.toolChoice;if(s==null)return{tools:n,toolConfig:void 0};const i=s.type;switch(i){case"auto":return{tools:n,toolConfig:{functionCallingConfig:{mode:"AUTO"}}};case"none":return{tools:n,toolConfig:{functionCallingConfig:{mode:"NONE"}}};case"required":return{tools:n,toolConfig:{functionCallingConfig:{mode:"ANY"}}};case"tool":return{tools:n,toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[s.toolName]}}};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}var xY=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:t,headers:e,abortSignal:r}){if(t.length>this.maxEmbeddingsPerCall)throw new Tx({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:s}=await bi({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:ao(this.config.headers(),e),body:{requests:t.map(i=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:i}]},outputDimensionality:this.settings.outputDimensionality}))},failedResponseHandler:C_,successfulResponseHandler:ic(SY),abortSignal:r,fetch:this.config.fetch});return{embeddings:s.embeddings.map(i=>i.values),usage:void 0,rawResponse:{headers:n}}}},SY=L.object({embeddings:L.array(L.object({values:L.array(L.number())}))});function YM(t={}){var e,r;const n=(r=Ox((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://generativelanguage.googleapis.com/v1beta",s=()=>({"x-goog-api-key":WM({apiKey:t.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...t.headers}),i=(l,c={})=>{var u;return new yY(l,c,{provider:"google.generative-ai",baseURL:n,headers:s,generateId:(u=t.generateId)!=null?u:Ax,fetch:t.fetch})},o=(l,c={})=>new xY(l,c,{provider:"google.generative-ai",baseURL:n,headers:s,fetch:t.fetch}),a=function(l,c){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return i(l,c)};return a.languageModel=i,a.chat=i,a.generativeAI=i,a.embedding=o,a.textEmbedding=o,a.textEmbeddingModel=o,a}YM();class EY extends Yt{name="Google";getApiKeyLink="https://aistudio.google.com/app/apikey";config={apiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"};staticModels=[{name:"gemini-1.5-flash-latest",label:"Gemini 1.5 Flash",provider:"Google",maxTokenAllowed:8192},{name:"gemini-2.0-flash-thinking-exp-01-21",label:"Gemini 2.0 Flash-thinking-exp-01-21",provider:"Google",maxTokenAllowed:65536},{name:"gemini-2.0-flash-exp",label:"Gemini 2.0 Flash",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-flash-002",label:"Gemini 1.5 Flash-002",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-flash-8b",label:"Gemini 1.5 Flash-8b",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-pro-latest",label:"Gemini 1.5 Pro",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-pro-002",label:"Gemini 1.5 Pro-002",provider:"Google",maxTokenAllowed:8192},{name:"gemini-exp-1206",label:"Gemini exp-1206",provider:"Google",maxTokenAllowed:8192}];async getDynamicModels(e,r,n){const{apiKey:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"});if(!s)throw`Missing Api Key configuration for ${this.name} provider`;return(await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${s}`,{headers:{"Content-Type":"application/json"}})).json()).models.filter(l=>l.outputTokenLimit>8e3).map(l=>({name:l.name.replace("models/",""),label:`${l.displayName} - context ${Math.floor((l.inputTokenLimit+l.outputTokenLimit)/1e3)+"k"}`,provider:this.name,maxTokenAllowed:l.inputTokenLimit+l.outputTokenLimit||8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return YM({apiKey:o})(r)}}class CY extends Yt{name="Groq";getApiKeyLink="https://console.groq.com/keys";config={apiTokenKey:"GROQ_API_KEY"};staticModels=[{name:"llama-3.1-8b-instant",label:"Llama 3.1 8b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-11b-vision-preview",label:"Llama 3.2 11b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-90b-vision-preview",label:"Llama 3.2 90b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-3b-preview",label:"Llama 3.2 3b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-1b-preview",label:"Llama 3.2 1b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.3-70b-versatile",label:"Llama 3.3 70b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"deepseek-r1-distill-llama-70b",label:"Deepseek R1 Distill Llama 70b (Groq)",provider:"Groq",maxTokenAllowed:131072}];async getDynamicModels(e,r,n){const{apiKey:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GROQ_API_KEY"});if(!s)throw`Missing Api Key configuration for ${this.name} provider`;return(await(await fetch("https://api.groq.com/openai/v1/models",{headers:{Authorization:`Bearer ${s}`}})).json()).data.filter(l=>l.object==="model"&&l.active&&l.context_window>8e3).map(l=>({name:l.id,label:`${l.id} - context ${l.context_window?Math.floor(l.context_window/1e3)+"k":"N/A"} [ by ${l.owned_by}]`,provider:this.name,maxTokenAllowed:l.context_window||8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GROQ_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return Us({baseURL:"https://api.groq.com/openai/v1",apiKey:o})(r)}}class kY extends Yt{name="HuggingFace";getApiKeyLink="https://huggingface.co/settings/tokens";config={apiTokenKey:"HuggingFace_API_KEY"};staticModels=[{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen2.5-Coder-32B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"01-ai/Yi-1.5-34B-Chat",label:"Yi-1.5-34B-Chat (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"codellama/CodeLlama-34b-Instruct-hf",label:"CodeLlama-34b-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"NousResearch/Hermes-3-Llama-3.1-8B",label:"Hermes-3-Llama-3.1-8B (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen2.5-Coder-32B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"Qwen/Qwen2.5-72B-Instruct",label:"Qwen2.5-72B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"meta-llama/Llama-3.1-70B-Instruct",label:"Llama-3.1-70B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"meta-llama/Llama-3.1-405B",label:"Llama-3.1-405B (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"01-ai/Yi-1.5-34B-Chat",label:"Yi-1.5-34B-Chat (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"codellama/CodeLlama-34b-Instruct-hf",label:"CodeLlama-34b-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"NousResearch/Hermes-3-Llama-3.1-8B",label:"Hermes-3-Llama-3.1-8B (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"HuggingFace_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return Us({baseURL:"https://api-inference.huggingface.co/v1/",apiKey:o})(r)}}class TY extends Yt{name="LMStudio";getApiKeyLink="https://lmstudio.ai/";labelForGetApiKey="Get LMStudio";icon="i-ph:cloud-arrow-down";config={baseUrlKey:"LMSTUDIO_API_BASE_URL",baseUrl:"http://localhost:1234/"};staticModels=[];async getDynamicModels(e,r,n={}){let{baseUrl:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"LMSTUDIO_API_BASE_URL",defaultApiTokenKey:""});if(!s)throw new Error("No baseUrl found for LMStudio provider");if(typeof window>"u"){const a=xt?.env?.RUNNING_IN_DOCKER==="true"||n?.RUNNING_IN_DOCKER==="true";s=a?s.replace("localhost","host.docker.internal"):s,s=a?s.replace("127.0.0.1","host.docker.internal"):s}return(await(await fetch(`${s}/v1/models`)).json()).data.map(a=>({name:a.id,label:a.id,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:s,model:i}=e;let{baseUrl:o}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n?.[this.name],serverEnv:s,defaultBaseUrlKey:"LMSTUDIO_API_BASE_URL",defaultApiTokenKey:""});if(!o)throw new Error("No baseUrl found for LMStudio provider");const a=xt?.env?.RUNNING_IN_DOCKER==="true"||s?.RUNNING_IN_DOCKER==="true";return typeof window>"u"&&(o=a?o.replace("localhost","host.docker.internal"):o,o=a?o.replace("127.0.0.1","host.docker.internal"):o),c2.debug("LMStudio Base Url used: ",o),Us({baseURL:`${o}/v1`,apiKey:""})(i)}}function AY(t){const e=[];for(let r=0;r<t.length;r++){const{role:n,content:s}=t[r],i=r===t.length-1;switch(n){case"system":{e.push({role:"system",content:s});break}case"user":{e.push({role:"user",content:s.map(o=>{var a;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:o.image instanceof URL?o.image.toString():`data:${(a=o.mimeType)!=null?a:"image/jpeg"};base64,${Ix(o.image)}`};case"file":throw new ou({functionality:"File content parts in user messages"})}})});break}case"assistant":{let o="";const a=[];for(const l of s)switch(l.type){case"text":{o+=l.text;break}case"tool-call":{a.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)}});break}default:{const c=l;throw new Error(`Unsupported part: ${c}`)}}e.push({role:"assistant",content:o,prefix:i?!0:void 0,tool_calls:a.length>0?a:void 0});break}case"tool":{for(const o of s)e.push({role:"tool",name:o.toolName,content:JSON.stringify(o.result),tool_call_id:o.toolCallId});break}default:{const o=n;throw new Error(`Unsupported role: ${o}`)}}}return e}function dk(t){switch(t){case"stop":return"stop";case"length":case"model_length":return"length";case"tool_calls":return"tool-calls";default:return"unknown"}}var RY=L.object({object:L.literal("error"),message:L.string(),type:L.string(),param:L.string().nullable(),code:L.string().nullable()}),k_=Px({errorSchema:RY,errorToMessage:t=>t.message});function hk({id:t,model:e,created:r}){return{id:t??void 0,modelId:e??void 0,timestamp:r!=null?new Date(r*1e3):void 0}}var PY=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){const d=t.type,h=[];i!=null&&h.push({type:"unsupported-setting",setting:"topK"}),o!=null&&h.push({type:"unsupported-setting",setting:"frequencyPenalty"}),a!=null&&h.push({type:"unsupported-setting",setting:"presencePenalty"}),l!=null&&h.push({type:"unsupported-setting",setting:"stopSequences"}),c!=null&&c.type==="json"&&c.schema!=null&&h.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is not supported"});const f={model:this.modelId,safe_prompt:this.settings.safePrompt,max_tokens:r,temperature:n,top_p:s,random_seed:u,response_format:c?.type==="json"?{type:"json_object"}:void 0,messages:AY(e)};switch(d){case"regular":return{args:{...f,...DY(t)},warnings:h};case"object-json":return{args:{...f,response_format:{type:"json_object"}},warnings:h};case"object-tool":return{args:{...f,tool_choice:"any",tools:[{type:"function",function:t.tool}]},warnings:h};default:{const v=d;throw new Error(`Unsupported type: ${v}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:s}=this.getArgs(t),{responseHeaders:i,value:o}=await bi({url:`${this.config.baseURL}/chat/completions`,headers:ao(this.config.headers(),t.headers),body:n,failedResponseHandler:k_,successfulResponseHandler:ic(IY),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:a,...l}=n,c=o.choices[0];let u=(e=c.message.content)!=null?e:void 0;const d=a[a.length-1];return d.role==="assistant"&&u?.startsWith(d.content)&&(u=u.slice(d.content.length)),{text:u,toolCalls:(r=c.message.tool_calls)==null?void 0:r.map(h=>({toolCallType:"function",toolCallId:h.id,toolName:h.function.name,args:h.function.arguments})),finishReason:dk(c.finish_reason),usage:{promptTokens:o.usage.prompt_tokens,completionTokens:o.usage.completion_tokens},rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},response:hk(o),warnings:s}}async doStream(t){const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:s}=await bi({url:`${this.config.baseURL}/chat/completions`,headers:ao(this.config.headers(),t.headers),body:{...e,stream:!0},failedResponseHandler:k_,successfulResponseHandler:qM(OY),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e;let a="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c=0,u=!1;return{stream:s.pipeThrough(new TransformStream({transform(d,h){if(!d.success){h.enqueue({type:"error",error:d.error});return}c++;const f=d.value;c===1&&h.enqueue({type:"response-metadata",...hk(f)}),f.usage!=null&&(l={promptTokens:f.usage.prompt_tokens,completionTokens:f.usage.completion_tokens});const v=f.choices[0];if(v?.finish_reason!=null&&(a=dk(v.finish_reason)),v?.delta==null)return;const m=v.delta;if(c<=2){const p=i[i.length-1];if(p.role==="assistant"&&m.content===p.content.trimEnd()){m.content.length<p.content.length&&(u=!0);return}}if(m.content!=null&&(h.enqueue({type:"text-delta",textDelta:u?m.content.trimStart():m.content}),u=!1),m.tool_calls!=null)for(const p of m.tool_calls)h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:p.id,toolName:p.function.name,argsTextDelta:p.function.arguments}),h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:p.id,toolName:p.function.name,args:p.function.arguments})},flush(d){d.enqueue({type:"finish",finishReason:a,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}},IY=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({message:L.object({role:L.literal("assistant"),content:L.string().nullable(),tool_calls:L.array(L.object({id:L.string(),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),index:L.number(),finish_reason:L.string().nullish()})),object:L.literal("chat.completion"),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()})}),OY=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).optional(),content:L.string().nullish(),tool_calls:L.array(L.object({id:L.string(),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),finish_reason:L.string().nullish(),index:L.number()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()});function DY(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(o=>({type:"function",function:{name:o.name,description:o.description,parameters:o.parameters}})),s=t.toolChoice;if(s==null)return{tools:n,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":return{tools:n,tool_choice:i};case"required":return{tools:n,tool_choice:"any"};case"tool":return{tools:n.filter(o=>o.function.name===s.toolName),tool_choice:"any"};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}var MY=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:32}get supportsParallelCalls(){var t;return(t=this.settings.supportsParallelCalls)!=null?t:!1}async doEmbed({values:t,abortSignal:e,headers:r}){if(t.length>this.maxEmbeddingsPerCall)throw new Tx({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:s}=await bi({url:`${this.config.baseURL}/embeddings`,headers:ao(this.config.headers(),r),body:{model:this.modelId,input:t,encoding_format:"float"},failedResponseHandler:k_,successfulResponseHandler:ic(LY),abortSignal:e,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:n}}}},LY=L.object({data:L.array(L.object({embedding:L.array(L.number())})),usage:L.object({prompt_tokens:L.number()}).nullish()});function ZM(t={}){var e,r;const n=(r=Ox((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://api.mistral.ai/v1",s=()=>({Authorization:`Bearer ${WM({apiKey:t.apiKey,environmentVariableName:"MISTRAL_API_KEY",description:"Mistral"})}`,...t.headers}),i=(l,c={})=>new PY(l,c,{provider:"mistral.chat",baseURL:n,headers:s,fetch:t.fetch}),o=(l,c={})=>new MY(l,c,{provider:"mistral.embedding",baseURL:n,headers:s,fetch:t.fetch}),a=function(l,c){if(new.target)throw new Error("The Mistral model function cannot be called with the new keyword.");return i(l,c)};return a.languageModel=i,a.chat=i,a.embedding=o,a.textEmbedding=o,a.textEmbeddingModel=o,a}ZM();class NY extends Yt{name="Mistral";getApiKeyLink="https://console.mistral.ai/api-keys/";config={apiTokenKey:"MISTRAL_API_KEY"};staticModels=[{name:"open-mistral-7b",label:"Mistral 7B",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-mixtral-8x7b",label:"Mistral 8x7B",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-mixtral-8x22b",label:"Mistral 8x22B",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-codestral-mamba",label:"Codestral Mamba",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-mistral-nemo",label:"Mistral Nemo",provider:"Mistral",maxTokenAllowed:8e3},{name:"ministral-8b-latest",label:"Mistral 8B",provider:"Mistral",maxTokenAllowed:8e3},{name:"mistral-small-latest",label:"Mistral Small",provider:"Mistral",maxTokenAllowed:8e3},{name:"codestral-latest",label:"Codestral",provider:"Mistral",maxTokenAllowed:8e3},{name:"mistral-large-latest",label:"Mistral Large Latest",provider:"Mistral",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"MISTRAL_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return ZM({apiKey:o})(r)}}var XM={},T_={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.ALL=t.COLLECTION=t.ATOM=t.SPECIAL=t.INF=t._INFINITY=t.INFINITY=t.NAN=t.BOOL=t.NULL=t.OBJ=t.ARR=t.NUM=t.STR=void 0,t.STR=1,t.NUM=2,t.ARR=4,t.OBJ=8,t.NULL=16,t.BOOL=32,t.NAN=64,t.INFINITY=128,t._INFINITY=256,t.INF=t.INFINITY|t._INFINITY,t.SPECIAL=t.NULL|t.BOOL|t.INF|t.NAN,t.ATOM=t.STR|t.NUM|t.SPECIAL,t.COLLECTION=t.ARR|t.OBJ,t.ALL=t.ATOM|t.COLLECTION,t.Allow={STR:t.STR,NUM:t.NUM,ARR:t.ARR,OBJ:t.OBJ,NULL:t.NULL,BOOL:t.BOOL,NAN:t.NAN,INFINITY:t.INFINITY,_INFINITY:t._INFINITY,INF:t.INF,SPECIAL:t.SPECIAL,ATOM:t.ATOM,COLLECTION:t.COLLECTION,ALL:t.ALL},t.default=t.Allow})(T_);(function(t){var e=$t&&$t.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var f=Object.getOwnPropertyDescriptor(u,d);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,f)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),r=$t&&$t.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&e(u,c,d)};Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.MalformedJSON=t.PartialJSON=t.parseJSON=t.parse=void 0;const n=T_;Object.defineProperty(t,"Allow",{enumerable:!0,get:function(){return n.Allow}}),r(T_,t);class s extends Error{}t.PartialJSON=s;class i extends Error{}t.MalformedJSON=i;function o(c,u=n.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return a(c.trim(),u)}t.parseJSON=o;const a=(c,u)=>{const d=c.length;let h=0;const f=w=>{throw new s(`${w} at position ${h}`)},v=w=>{throw new i(`${w} at position ${h}`)},m=()=>(b(),h>=d&&f("Unexpected end of input"),c[h]==='"'?p():c[h]==="{"?g():c[h]==="["?y():c.substring(h,h+4)==="null"||n.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||n.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||n.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||n.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||n.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||n.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):_()),p=()=>{const w=h;let E=!1;for(h++;h<d&&(c[h]!=='"'||E&&c[h-1]==="\\");)E=c[h]==="\\"?!E:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(w,++h-Number(E)))}catch(S){v(String(S))}else if(n.Allow.STR&u)try{return JSON.parse(c.substring(w,h-Number(E))+'"')}catch{return JSON.parse(c.substring(w,c.lastIndexOf("\\"))+'"')}f("Unterminated string literal")},g=()=>{h++,b();const w={};try{for(;c[h]!=="}";){if(b(),h>=d&&n.Allow.OBJ&u)return w;const E=p();b(),h++;try{const S=m();w[E]=S}catch(S){if(n.Allow.OBJ&u)return w;throw S}b(),c[h]===","&&h++}}catch{if(n.Allow.OBJ&u)return w;f("Expected '}' at end of object")}return h++,w},y=()=>{h++;const w=[];try{for(;c[h]!=="]";)w.push(m()),b(),c[h]===","&&h++}catch{if(n.Allow.ARR&u)return w;f("Expected ']' at end of array")}return h++,w},_=()=>{if(h===0){c==="-"&&v("Not sure what '-' is");try{return JSON.parse(c)}catch(E){if(n.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}v(String(E))}}const w=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(n.Allow.NUM&u)&&f("Unterminated number literal");try{return JSON.parse(c.substring(w,h))}catch{c.substring(w,h)==="-"&&f("Not sure what '-' is");try{return JSON.parse(c.substring(w,c.lastIndexOf("e")))}catch(S){v(String(S))}}},b=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return m()},l=o;t.parse=l})(XM);function Xv(t){const e=[];for(const{content:r,role:n}of t)switch(n){case"system":{e.push({content:r,role:"system"});break}case"user":{e.push({...r.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new ou({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Ix(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const o of r)switch(o.type){case"text":{s.push(o.text);break}case"tool-call":{i.push({function:{arguments:o.args,name:o.toolName},id:o.toolCallId,type:"function"});break}default:{const a=o;throw new Error(`Unsupported part: ${a}`)}}e.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{e.push(...r.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=n;throw new Error(`Unsupported role: ${s}`)}}return e}var BY=class{constructor({tools:t,type:e}){this._firstMessage=!0,this._tools=t,this._toolPartial="",this._toolCalls=[],this._type=e,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:t,delta:e}){var r;if(this.detectToolCall(e),!this._detectedToolCall)return!1;this._toolPartial+=e;let n=XM.parse(this._toolPartial);Array.isArray(n)||(n=[n]);for(const[s,i]of n.entries()){const o=(r=JSON.stringify(i?.parameters))!=null?r:"";if(o==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:Ax(),type:"function"});const a=this._toolCalls[s];a.function.arguments=o,t.enqueue({argsTextDelta:e,toolCallId:a.id,toolCallType:"function",toolName:a.function.name,type:"tool-call-delta"})}return!0}finish({controller:t}){for(const e of this.toolCalls)t.enqueue({args:e.function.arguments,toolCallId:e.id,toolCallType:"function",toolName:e.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(t){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(t.trim().startsWith("{")||t.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function FY({finishReason:t,hasToolCalls:e}){switch(t){case"stop":return e?"tool-calls":"stop";default:return"other"}}var jY=L.object({error:L.object({code:L.string().nullable(),message:L.string(),param:L.any().nullable(),type:L.string()})}),A_=Px({errorSchema:jY,errorToMessage:t=>t.error.message});function $Y(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0))}var UY=class extends TransformStream{constructor(){super({flush:t=>{this.buffer.length!==0&&t.enqueue(this.buffer)},transform:(t,e)=>{for(t=this.buffer+t;;){const r=t.indexOf(`
`);if(r===-1)break;e.enqueue(t.slice(0,r)),t=t.slice(r+1)}this.buffer=t}}),this.buffer=""}},HY=t=>async({response:e})=>{const r=Jd(e);if(e.body===null)throw new MM({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new UY).pipeThrough(new TransformStream({transform(n,s){s.enqueue(Rx({schema:t,text:n}))}}))}},VY=class{constructor(t,e,r){this.modelId=t,this.settings=e,this.config=r,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:t,maxTokens:e,mode:r,presencePenalty:n,prompt:s,responseFormat:i,seed:o,stopSequences:a,temperature:l,topK:c,topP:u}){var d,h,f;const v=r.type,m=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&m.push({details:"JSON response format schema is not supported",setting:"responseFormat",type:"unsupported-setting"});const p={format:i?.type,model:this.modelId,options:$Y({f16_kv:this.settings.f16Kv,frequency_penalty:t,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:e,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:n,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:o,stop:(d=this.settings.stop)!=null?d:a,temperature:l,tfs_z:this.settings.tfsZ,top_k:(h=this.settings.topK)!=null?h:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(v){case"regular":{const g=(f=r.tools)!=null&&f.length?r.tools:void 0;return{args:{...p,messages:Xv(s),tools:g?.map(y=>({function:{description:y.description,name:y.name,parameters:y.parameters},type:"function"}))},type:v,warnings:m}}case"object-json":return{args:{...p,format:"json",messages:Xv(s)},type:v,warnings:m};case"object-tool":return{args:{...p,messages:Xv(s),tool_choice:{function:{name:r.tool.name},type:"function"},tools:[{function:{description:r.tool.description,name:r.tool.name,parameters:r.tool.parameters},type:"function"}]},type:v,warnings:m};default:{const g=v;throw new Error(`Unsupported type: ${g}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:s}=this.getArguments(t),{responseHeaders:i,value:o}=await bi({abortSignal:t.abortSignal,body:{...n,stream:!1},failedResponseHandler:A_,fetch:this.config.fetch,headers:ao(this.config.headers(),t.headers),successfulResponseHandler:ic(GY),url:`${this.config.baseURL}/chat`}),{messages:a,...l}=n,c=(e=o.message.tool_calls)==null?void 0:e.map(u=>{var d;return{args:JSON.stringify(u.function.arguments),toolCallId:(d=u.id)!=null?d:Ax(),toolCallType:"function",toolName:u.function.name}});return{finishReason:FY({finishReason:o.done_reason,hasToolCalls:c!==void 0&&c.length>0}),rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},text:(r=o.message.content)!=null?r:void 0,toolCalls:c,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(t){const{args:e,type:r,warnings:n}=this.getArguments(t),{responseHeaders:s,value:i}=await bi({abortSignal:t.abortSignal,body:e,failedResponseHandler:A_,fetch:this.config.fetch,headers:ao(this.config.headers(),t.headers),successfulResponseHandler:HY(zY),url:`${this.config.baseURL}/chat`}),{messages:o,...a}=e,l=t.mode.type==="regular"?t.mode.tools:t.mode.type==="object-tool"?[t.mode.tool]:void 0,c=new BY({tools:l,type:r});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:o,rawSettings:a},rawResponse:{headers:s},stream:i.pipeThrough(new TransformStream({async flush(f){f.enqueue({finishReason:u,type:"finish",usage:d})},async transform(f,v){if(!f.success){v.enqueue({error:f.error,type:"error"});return}const m=f.value;if(m.done){u=c.finish({controller:v}),d={completionTokens:m.eval_count,promptTokens:m.prompt_eval_count||0};return}h&&c.parse({controller:v,delta:m.message.content})||m.message.content!==null&&v.enqueue({textDelta:m.message.content,type:"text-delta"})}})),warnings:n}}},GY=L.object({created_at:L.string(),done:L.literal(!0),done_reason:L.string().optional().nullable(),eval_count:L.number(),eval_duration:L.number(),load_duration:L.number().optional(),message:L.object({content:L.string(),role:L.string(),tool_calls:L.array(L.object({function:L.object({arguments:L.record(L.any()),name:L.string()}),id:L.string().optional()})).optional().nullable()}),model:L.string(),prompt_eval_count:L.number().optional(),prompt_eval_duration:L.number().optional(),total_duration:L.number()}),zY=L.discriminatedUnion("done",[L.object({created_at:L.string(),done:L.literal(!1),message:L.object({content:L.string(),role:L.string()}),model:L.string()}),L.object({created_at:L.string(),done:L.literal(!0),eval_count:L.number(),eval_duration:L.number(),load_duration:L.number().optional(),model:L.string(),prompt_eval_count:L.number().optional(),prompt_eval_duration:L.number().optional(),total_duration:L.number()})]),WY=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:t,values:e}){if(e.length>this.maxEmbeddingsPerCall)throw new Tx({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:e});const{responseHeaders:r,value:n}=await bi({abortSignal:t,body:{input:e,model:this.modelId},failedResponseHandler:A_,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:ic(KY),url:`${this.config.baseURL}/embed`});return{embeddings:n.embeddings,rawResponse:{headers:r},usage:n.prompt_eval_count?{tokens:n.prompt_eval_count}:void 0}}},KY=L.object({embeddings:L.array(L.array(L.number())),prompt_eval_count:L.number().nullable()});function qY(t={}){var e;const r=(e=Ox(t.baseURL))!=null?e:"http://127.0.0.1:11434/api",n=()=>({...t.headers}),s=(a,l={})=>new VY(a,l,{baseURL:r,fetch:t.fetch,headers:n,provider:"ollama.chat"}),i=(a,l={})=>new WY(a,l,{baseURL:r,fetch:t.fetch,headers:n,provider:"ollama.embedding"}),o=function(a,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(a,l)};return o.chat=s,o.embedding=i,o.languageModel=s,o.textEmbedding=i,o.textEmbeddingModel=i,o}var JY=qY();class YY extends Yt{name="Ollama";getApiKeyLink="https://ollama.com/download";labelForGetApiKey="Download Ollama";icon="i-ph:cloud-arrow-down";config={baseUrlKey:"OLLAMA_API_BASE_URL"};staticModels=[];_convertEnvToRecord(e){return e?Object.entries(e).reduce((r,[n,s])=>(r[n]=String(s),r),{}):{}}getDefaultNumCtx(e){const r=this._convertEnvToRecord(e);return r.DEFAULT_NUM_CTX?parseInt(r.DEFAULT_NUM_CTX,10):32768}async getDynamicModels(e,r,n={}){let{baseUrl:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"OLLAMA_API_BASE_URL",defaultApiTokenKey:""});if(!s)throw new Error("No baseUrl found for OLLAMA provider");if(typeof window>"u"){const a=xt?.env?.RUNNING_IN_DOCKER==="true"||n?.RUNNING_IN_DOCKER==="true";s=a?s.replace("localhost","host.docker.internal"):s,s=a?s.replace("127.0.0.1","host.docker.internal"):s}return(await(await fetch(`${s}/api/tags`)).json()).models.map(a=>({name:a.name,label:`${a.name} (${a.details.parameter_size})`,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:s,model:i}=e,o=this._convertEnvToRecord(s);let{baseUrl:a}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n?.[this.name],serverEnv:o,defaultBaseUrlKey:"OLLAMA_API_BASE_URL",defaultApiTokenKey:""});if(!a)throw new Error("No baseUrl found for OLLAMA provider");const l=xt?.env?.RUNNING_IN_DOCKER==="true"||o.RUNNING_IN_DOCKER==="true";a=l?a.replace("localhost","host.docker.internal"):a,a=l?a.replace("127.0.0.1","host.docker.internal"):a,c2.debug("Ollama Base Url used: ",a);const c=JY(i,{numCtx:this.getDefaultNumCtx(s)});return c.config.baseURL=`${a}/api`,c}}var ii=class extends Error{constructor({message:t,url:e,requestBodyValues:r,statusCode:n,responseHeaders:s,responseBody:i,cause:o,isRetryable:a=n!=null&&(n===408||n===409||n===429||n>=500),data:l}){super(t),this.name="AI_APICallError",this.url=e,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=s,this.responseBody=i,this.cause=o,this.isRetryable=a,this.data=l}static isAPICallError(t){return t instanceof Error&&t.name==="AI_APICallError"&&typeof t.url=="string"&&typeof t.requestBodyValues=="object"&&(t.statusCode==null||typeof t.statusCode=="number")&&(t.responseHeaders==null||typeof t.responseHeaders=="object")&&(t.responseBody==null||typeof t.responseBody=="string")&&(t.cause==null||typeof t.cause=="object")&&typeof t.isRetryable=="boolean"&&(t.data==null||typeof t.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}},ZY=class extends Error{constructor({message:t="Empty response body"}={}){super(t),this.name="AI_EmptyResponseBodyError"}static isEmptyResponseBodyError(t){return t instanceof Error&&t.name==="AI_EmptyResponseBodyError"}toJSON(){return{name:this.name,message:this.message,stack:this.stack}}},XY=class extends Error{constructor({prompt:t,message:e}){super(`Invalid prompt: ${e}`),this.name="AI_InvalidPromptError",this.prompt=t}static isInvalidPromptError(t){return t instanceof Error&&t.name==="AI_InvalidPromptError"&&prompt!=null}toJSON(){return{name:this.name,message:this.message,stack:this.stack,prompt:this.prompt}}},Qv=class extends Error{constructor({data:t,message:e=`Invalid response data: ${JSON.stringify(t)}.`}){super(e),this.name="AI_InvalidResponseDataError",this.data=t}static isInvalidResponseDataError(t){return t instanceof Error&&t.name==="AI_InvalidResponseDataError"&&t.data!=null}toJSON(){return{name:this.name,message:this.message,stack:this.stack,data:this.data}}};function QM(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var Up=class extends Error{constructor({text:t,cause:e}){super(`JSON parsing failed: Text: ${t}.
Error message: ${QM(e)}`),this.name="AI_JSONParseError",this.cause=e,this.text=t}static isJSONParseError(t){return t instanceof Error&&t.name==="AI_JSONParseError"&&typeof t.text=="string"&&typeof t.cause=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}},Uh=class extends Error{constructor({message:t}){super(t),this.name="AI_LoadAPIKeyError"}static isLoadAPIKeyError(t){return t instanceof Error&&t.name==="AI_LoadAPIKeyError"}toJSON(){return{name:this.name,message:this.message}}},au=class extends Error{constructor({value:t,cause:e}){super(`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${QM(e)}`),this.name="AI_TypeValidationError",this.cause=e,this.value=t}static isTypeValidationError(t){return t instanceof Error&&t.name==="AI_TypeValidationError"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}},oi=class extends Error{constructor({functionality:e}){super(`'${e}' functionality not supported.`),this.name="AI_UnsupportedFunctionalityError",this.functionality=e}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name==="AI_UnsupportedFunctionalityError"&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}},QY={};function Hp(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function pg(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var ey=kD("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);function ty(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function eZ({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Uh({message:`${n} API key must be a string.`});if(typeof xt>"u")throw new Uh({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=QY[e],t==null)throw new Uh({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Uh({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}function tZ({value:t,schema:e}){try{return e.parse(t)}catch(r){throw new au({value:t,cause:r})}}function rZ({value:t,schema:e}){try{const r=e.safeParse(t);return r.success?{success:!0,value:r.data}:{success:!1,error:new au({value:t,cause:r.error})}}catch(r){return{success:!1,error:au.isTypeValidationError(r)?r:new au({value:t,cause:r})}}}function nZ({text:t,schema:e}){try{const r=Un.parse(t);return e==null?r:tZ({value:r,schema:e})}catch(r){throw Up.isJSONParseError(r)||au.isTypeValidationError(r)?r:new Up({text:t,cause:r})}}function eL({text:t,schema:e}){try{const r=Un.parse(t);return e==null?{success:!0,value:r}:rZ({value:r,schema:e})}catch(r){return{success:!1,error:Up.isJSONParseError(r)?r:new Up({text:t,cause:r})}}}function fk(t){try{return Un.parse(t),!0}catch{return!1}}function sZ(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var iZ=()=>fetch,Vp=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>oZ({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),oZ=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=iZ()})=>{try{const a=await o(t,{method:"POST",headers:sZ(e),body:r.content,signal:i}),l=pg(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw ty(u)||ii.isAPICallError(u)?u:new ii({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(ty(c)||ii.isAPICallError(c))?c:new ii({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(ty(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new ii({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},aZ=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=pg(n);if(o.trim()==="")return{responseHeaders:a,value:new ii({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=nZ({text:o,schema:t});return{responseHeaders:a,value:new ii({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new ii({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},tL=t=>async({response:e})=>{const r=pg(e);if(e.body==null)throw new ZY({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new kx).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(eL({text:n,schema:t}))}}))}},rL=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=eL({text:s,schema:t}),o=pg(e);if(!i.success)throw new ii({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}};function lZ(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return globalThis.btoa(e)}function cZ(t){return t?.replace(/\/$/,"")}var uZ=Object.defineProperty,dZ=Object.defineProperties,hZ=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,nL=Object.prototype.hasOwnProperty,sL=Object.prototype.propertyIsEnumerable,pk=(t,e,r)=>e in t?uZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xs=(t,e)=>{for(var r in e||(e={}))nL.call(e,r)&&pk(t,r,e[r]);if(Gp)for(var r of Gp(e))sL.call(e,r)&&pk(t,r,e[r]);return t},Ff=(t,e)=>dZ(t,hZ(e)),zp=(t,e)=>{var r={};for(var n in t)nL.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&Gp)for(var n of Gp(t))e.indexOf(n)<0&&sL.call(t,n)&&(r[n]=t[n]);return r};function fZ(t){var e;const r=[];for(const{role:n,content:s}of t)switch(n){case"system":{r.push({role:"system",content:s});break}case"user":{if(s.length===1&&((e=s[0])==null?void 0:e.type)==="text"){r.push({role:"user",content:s[0].text});break}r.push({role:"user",content:s.map(i=>{var o;switch(i.type){case"text":return{type:"text",text:i.text};case"image":return{type:"image_url",image_url:{url:i.image instanceof URL?i.image.toString():`data:${(o=i.mimeType)!=null?o:"image/jpeg"};base64,${lZ(i.image)}`}}}})});break}case"assistant":{let i="";const o=[];for(const a of s)switch(a.type){case"text":{i+=a.text;break}case"tool-call":{o.push({id:a.toolCallId,type:"function",function:{name:a.toolName,arguments:JSON.stringify(a.args)}});break}default:{const l=a;throw new Error(`Unsupported part: ${l}`)}}r.push({role:"assistant",content:i,tool_calls:o.length>0?o:void 0});break}case"tool":{for(const i of s)r.push({role:"tool",tool_call_id:i.toolCallId,content:JSON.stringify(i.result)});break}default:{const i=n;throw new Error(`Unsupported role: ${i}`)}}return r}function mk(t){var e,r;return(r=(e=t?.content)==null?void 0:e.map(({token:n,logprob:s,top_logprobs:i})=>({token:n,logprob:s,topLogprobs:i?i.map(({token:o,logprob:a})=>({token:o,logprob:a})):[]})))!=null?r:void 0}function Wp(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Dx=L.object({error:L.object({message:L.string(),type:L.string(),param:L.any().nullable(),code:L.string().nullable()})}),Kp=aZ({errorSchema:Dx,errorToMessage:t=>t.error.message}),pZ=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,frequencyPenalty:i,presencePenalty:o,seed:a}){const l=t.type,c=Xs({model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:s,frequency_penalty:i,presence_penalty:o,seed:a,messages:fZ(e)},this.config.extraBody);switch(l){case"regular":return Xs(Xs({},c),vZ(t));case"object-json":return Ff(Xs({},c),{response_format:{type:"json_object"}});case"object-tool":return Ff(Xs({},c),{tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}}]});case"object-grammar":throw new oi({functionality:"object-grammar mode"});default:{const u=l;throw new Error(`Unsupported type: ${u}`)}}}async doGenerate(t){var e,r;const n=this.getArgs(t),{responseHeaders:s,value:i}=await Vp({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Hp(this.config.headers(),t.headers),body:n,failedResponseHandler:Kp,successfulResponseHandler:rL(mZ),abortSignal:t.abortSignal,fetch:this.config.fetch}),o=n,{messages:a}=o,l=zp(o,["messages"]),c=i.choices[0];if(c==null)throw new Error("No choice in response");return{text:(e=c.message.content)!=null?e:void 0,toolCalls:(r=c.message.tool_calls)==null?void 0:r.map(u=>{var d;return{toolCallType:"function",toolCallId:(d=u.id)!=null?d:ey(),toolName:u.function.name,args:u.function.arguments}}),finishReason:Wp(c.finish_reason),usage:{promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:s},warnings:[],logprobs:mk(c.logprobs)}}async doStream(t){const e=this.getArgs(t),{responseHeaders:r,value:n}=await Vp({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Hp(this.config.headers(),t.headers),body:Ff(Xs({},e),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:Kp,successfulResponseHandler:tL(gZ),abortSignal:t.abortSignal,fetch:this.config.fetch}),s=e,{messages:i}=s,o=zp(s,["messages"]),a=[];let l="other",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u;return{stream:n.pipeThrough(new TransformStream({transform(d,h){var f,v,m,p,g,y,_,b,w,E,S,x;if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const T=d.value;if("error"in T){l="error",h.enqueue({type:"error",error:T.error});return}T.usage!=null&&(c={promptTokens:T.usage.prompt_tokens,completionTokens:T.usage.completion_tokens});const D=T.choices[0];if(D?.finish_reason!=null&&(l=Wp(D.finish_reason)),D?.delta==null)return;const O=D.delta;O.content!=null&&h.enqueue({type:"text-delta",textDelta:O.content});const R=mk(D?.logprobs);if(R?.length&&(u===void 0&&(u=[]),u.push(...R)),O.tool_calls!=null)for(const P of O.tool_calls){const A=P.index;if(a[A]==null){if(P.type!=="function")throw new Qv({data:P,message:"Expected 'function' type."});if(P.id==null)throw new Qv({data:P,message:"Expected 'id' to be a string."});if(((f=P.function)==null?void 0:f.name)==null)throw new Qv({data:P,message:"Expected 'function.name' to be a string."});a[A]={id:P.id,type:"function",function:{name:P.function.name,arguments:(v=P.function.arguments)!=null?v:""}};const K=a[A];if(K==null)throw new Error("Tool call is missing");((m=K.function)==null?void 0:m.name)!=null&&((p=K.function)==null?void 0:p.arguments)!=null&&fk(K.function.arguments)&&(h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:K.id,toolName:K.function.name,argsTextDelta:K.function.arguments}),h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(g=K.id)!=null?g:ey(),toolName:K.function.name,args:K.function.arguments}));continue}const H=a[A];if(H==null)throw new Error("Tool call is missing");((y=P.function)==null?void 0:y.arguments)!=null&&(H.function.arguments+=(b=(_=P.function)==null?void 0:_.arguments)!=null?b:""),h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:H.id,toolName:H.function.name,argsTextDelta:(w=P.function.arguments)!=null?w:""}),((E=H.function)==null?void 0:E.name)!=null&&((S=H.function)==null?void 0:S.arguments)!=null&&fk(H.function.arguments)&&h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(x=H.id)!=null?x:ey(),toolName:H.function.name,args:H.function.arguments})}},flush(d){d.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:r},warnings:[]}}},mZ=L.object({choices:L.array(L.object({message:L.object({role:L.literal("assistant"),content:L.string().nullable().optional(),tool_calls:L.array(L.object({id:L.string().optional().nullable(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).optional()}),index:L.number(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullable().optional(),finish_reason:L.string().optional().nullable()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()})}),gZ=L.union([L.object({choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).optional(),content:L.string().nullish(),tool_calls:L.array(L.object({index:L.number(),id:L.string().nullish(),type:L.literal("function").optional(),function:L.object({name:L.string().nullish(),arguments:L.string().nullish()})})).nullish()}).nullish(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullish(),finish_reason:L.string().nullable().optional(),index:L.number()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()}),Dx]);function vZ(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(o=>({type:"function",function:{name:o.name,description:o.description,parameters:o.parameters}})),s=t.toolChoice;if(s==null)return{tools:n,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:n,tool_choice:i};case"tool":return{tools:n,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}function yZ({prompt:t,inputFormat:e,user:r="user",assistant:n="assistant"}){if(e==="prompt"&&t.length===1&&t[0]&&t[0].role==="user"&&t[0].content.length===1&&t[0].content[0]&&t[0].content[0].type==="text")return{prompt:t[0].content[0].text};let s="";t[0]&&t[0].role==="system"&&(s+=`${t[0].content}

`,t=t.slice(1));for(const{role:i,content:o}of t)switch(i){case"system":throw new XY({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new oi({functionality:"images"})}}).join("");s+=`${r}:
${a}

`;break}case"assistant":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new oi({functionality:"tool-call messages"})}}).join("");s+=`${n}:
${a}

`;break}case"tool":throw new oi({functionality:"tool messages"});default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return s+=`${n}:
`,{prompt:s,stopSequences:[`
${r}:`]}}function gk(t){return t?.tokens.map((e,r)=>{var n,s;return{token:e,logprob:(n=t.token_logprobs[r])!=null?n:0,topLogprobs:t.top_logprobs?Object.entries((s=t.top_logprobs[r])!=null?s:{}).map(([i,o])=>({token:i,logprob:o})):[]}})}var _Z=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,inputFormat:e,prompt:r,maxTokens:n,temperature:s,topP:i,frequencyPenalty:o,presencePenalty:a,seed:l}){var c;const u=t.type,{prompt:d,stopSequences:h}=yZ({prompt:r,inputFormat:e}),f=Xs({model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:a,seed:l,prompt:d,stop:h},this.config.extraBody);switch(u){case"regular":{if((c=t.tools)!=null&&c.length)throw new oi({functionality:"tools"});if(t.toolChoice)throw new oi({functionality:"toolChoice"});return f}case"object-json":throw new oi({functionality:"object-json mode"});case"object-tool":throw new oi({functionality:"object-tool mode"});case"object-grammar":throw new oi({functionality:"object-grammar mode"});default:{const v=u;throw new Error(`Unsupported type: ${v}`)}}}async doGenerate(t){const e=this.getArgs(t),{responseHeaders:r,value:n}=await Vp({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Hp(this.config.headers(),t.headers),body:e,failedResponseHandler:Kp,successfulResponseHandler:rL(bZ),abortSignal:t.abortSignal,fetch:this.config.fetch}),s=e,{prompt:i}=s,o=zp(s,["prompt"]),a=n.choices[0];if(!a)throw new Error("No choice in OpenRouter completion response");return{text:a.text,usage:{promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens},finishReason:Wp(a.finish_reason),logprobs:gk(a.logprobs),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:r},warnings:[]}}async doStream(t){const e=this.getArgs(t),{responseHeaders:r,value:n}=await Vp({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Hp(this.config.headers(),t.headers),body:Ff(Xs({},this.getArgs(t)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:Kp,successfulResponseHandler:tL(wZ),abortSignal:t.abortSignal,fetch:this.config.fetch}),s=e,{prompt:i}=s,o=zp(s,["prompt"]);let a="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:n.pipeThrough(new TransformStream({transform(u,d){if(!u.success){a="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){a="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const f=h.choices[0];f?.finish_reason!=null&&(a=Wp(f.finish_reason)),f?.text!=null&&d.enqueue({type:"text-delta",textDelta:f.text});const v=gk(f?.logprobs);v?.length&&(c===void 0&&(c=[]),c.push(...v))},flush(u){u.enqueue({type:"finish",finishReason:a,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:r},warnings:[]}}},bZ=L.object({choices:L.array(L.object({text:L.string(),finish_reason:L.string(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullable().optional()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()})}),wZ=L.union([L.object({choices:L.array(L.object({text:L.string(),finish_reason:L.string().nullish(),index:L.number(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullable().optional()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).optional().nullable()}),Dx]);function iL(t={}){var e,r,n;const s=(r=cZ((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://openrouter.ai/api/v1",i=(n=t.compatibility)!=null?n:"compatible",o=()=>Xs({Authorization:`Bearer ${eZ({apiKey:t.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},t.headers),a=(d,h={})=>new pZ(d,h,{provider:"openrouter.chat",url:({path:f})=>`${s}${f}`,headers:o,compatibility:i,fetch:t.fetch,extraBody:t.extraBody}),l=(d,h={})=>new _Z(d,h,{provider:"openrouter.completion",url:({path:f})=>`${s}${f}`,headers:o,compatibility:i,fetch:t.fetch,extraBody:t.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):a(d,h)},u=function(d,h){return c(d,h)};return u.languageModel=c,u.chat=a,u.completion=l,u}iL({compatibility:"strict"});class xZ extends Yt{name="OpenRouter";getApiKeyLink="https://openrouter.ai/settings/keys";config={apiTokenKey:"OPEN_ROUTER_API_KEY"};staticModels=[{name:"anthropic/claude-3.5-sonnet",label:"Anthropic: Claude 3.5 Sonnet (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"anthropic/claude-3-haiku",label:"Anthropic: Claude 3 Haiku (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"deepseek/deepseek-coder",label:"Deepseek-Coder V2 236B (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"google/gemini-flash-1.5",label:"Google Gemini Flash 1.5 (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"google/gemini-pro-1.5",label:"Google Gemini Pro 1.5 (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"x-ai/grok-beta",label:"xAI Grok Beta (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"mistralai/mistral-nemo",label:"OpenRouter Mistral Nemo (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"qwen/qwen-110b-chat",label:"OpenRouter Qwen 110b Chat (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"cohere/command",label:"Cohere Command (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:4096}];async getDynamicModels(e,r,n={}){try{return(await(await fetch("https://openrouter.ai/api/v1/models",{headers:{"Content-Type":"application/json"}})).json()).data.sort((o,a)=>o.name.localeCompare(a.name)).map(o=>({name:o.id,label:`${o.name} - in:$${(o.pricing.prompt*1e6).toFixed(2)} out:$${(o.pricing.completion*1e6).toFixed(2)} - context ${Math.floor(o.context_length/1e3)}k`,provider:this.name,maxTokenAllowed:8e3}))}catch(s){return console.error("Error getting OpenRouter models:",s),[]}}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPEN_ROUTER_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return iL({apiKey:o}).chat(r)}}class SZ extends Yt{name="OpenAILike";getApiKeyLink=void 0;config={baseUrlKey:"OPENAI_LIKE_API_BASE_URL",apiTokenKey:"OPENAI_LIKE_API_KEY"};staticModels=[];async getDynamicModels(e,r,n={}){const{baseUrl:s,apiKey:i}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"OPENAI_LIKE_API_BASE_URL",defaultApiTokenKey:"OPENAI_LIKE_API_KEY"});return!s||!i?[]:(await(await fetch(`${s}/models`,{headers:{Authorization:`Bearer ${i}`}})).json()).data.map(l=>({name:l.id,label:l.id,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{baseUrl:o,apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"OPENAI_LIKE_API_BASE_URL",defaultApiTokenKey:"OPENAI_LIKE_API_KEY"});if(!o||!a)throw new Error(`Missing configuration for ${this.name} provider`);return CD(o,a,r)}}class EZ extends Yt{name="OpenAI";getApiKeyLink="https://platform.openai.com/api-keys";config={apiTokenKey:"OPENAI_API_KEY"};staticModels=[{name:"gpt-4o",label:"GPT-4o",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-4o-mini",label:"GPT-4o Mini",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-4-turbo",label:"GPT-4 Turbo",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-4",label:"GPT-4",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-3.5-turbo",label:"GPT-3.5 Turbo",provider:"OpenAI",maxTokenAllowed:8e3}];async getDynamicModels(e,r,n){const{apiKey:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPENAI_API_KEY"});if(!s)throw`Missing Api Key configuration for ${this.name} provider`;const o=await(await fetch("https://api.openai.com/v1/models",{headers:{Authorization:`Bearer ${s}`}})).json(),a=this.staticModels.map(c=>c.name);return o.data.filter(c=>c.object==="model"&&(c.id.startsWith("gpt-")||c.id.startsWith("o")||c.id.startsWith("chatgpt-"))&&!a.includes(c.id)).map(c=>({name:c.id,label:`${c.id}`,provider:this.name,maxTokenAllowed:c.context_window||32e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPENAI_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return Us({apiKey:o})(r)}}class CZ extends Yt{name="Perplexity";getApiKeyLink="https://www.perplexity.ai/settings/api";config={apiTokenKey:"PERPLEXITY_API_KEY"};staticModels=[{name:"llama-3.1-sonar-small-128k-online",label:"Sonar Small Online",provider:"Perplexity",maxTokenAllowed:8192},{name:"llama-3.1-sonar-large-128k-online",label:"Sonar Large Online",provider:"Perplexity",maxTokenAllowed:8192},{name:"llama-3.1-sonar-huge-128k-online",label:"Sonar Huge Online",provider:"Perplexity",maxTokenAllowed:8192}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"PERPLEXITY_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return Us({baseURL:"https://api.perplexity.ai/",apiKey:o})(r)}}class kZ extends Yt{name="Together";getApiKeyLink="https://api.together.xyz/settings/api-keys";config={baseUrlKey:"TOGETHER_API_BASE_URL",apiTokenKey:"TOGETHER_API_KEY"};staticModels=[{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen/Qwen2.5-Coder-32B-Instruct",provider:"Together",maxTokenAllowed:8e3},{name:"meta-llama/Llama-3.2-90B-Vision-Instruct-Turbo",label:"meta-llama/Llama-3.2-90B-Vision-Instruct-Turbo",provider:"Together",maxTokenAllowed:8e3},{name:"mistralai/Mixtral-8x7B-Instruct-v0.1",label:"Mixtral 8x7B Instruct",provider:"Together",maxTokenAllowed:8192}];async getDynamicModels(e,r,n={}){const{baseUrl:s,apiKey:i}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"TOGETHER_API_BASE_URL",defaultApiTokenKey:"TOGETHER_API_KEY"}),o=s||"https://api.together.xyz/v1";return i?(await(await fetch(`${o}/models`,{headers:{Authorization:`Bearer ${i}`}})).json()||[]).filter(u=>u.type==="chat").map(u=>({name:u.id,label:`${u.display_name} - in:$${u.pricing.input.toFixed(2)} out:$${u.pricing.output.toFixed(2)} - context ${Math.floor(u.context_length/1e3)}k`,provider:this.name,maxTokenAllowed:8e3})):[]}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{baseUrl:o,apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"TOGETHER_API_BASE_URL",defaultApiTokenKey:"TOGETHER_API_KEY"});if(!o||!a)throw new Error(`Missing configuration for ${this.name} provider`);return CD(o,a,r)}}class TZ extends Yt{name="xAI";getApiKeyLink="https://docs.x.ai/docs/quickstart#creating-an-api-key";config={apiTokenKey:"XAI_API_KEY"};staticModels=[{name:"grok-3-beta",label:"xAI Grok 3 Beta",provider:"xAI",maxTokenAllowed:8e3},{name:"grok-beta",label:"xAI Grok Beta",provider:"xAI",maxTokenAllowed:8e3},{name:"grok-2-1212",label:"xAI Grok2 1212",provider:"xAI",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"XAI_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return Us({baseURL:"https://api.x.ai/v1",apiKey:o})(r)}}class AZ extends Yt{name="Hyperbolic";getApiKeyLink="https://app.hyperbolic.xyz/settings";config={apiTokenKey:"HYPERBOLIC_API_KEY"};staticModels=[{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen 2.5 Coder 32B Instruct",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"Qwen/Qwen2.5-72B-Instruct",label:"Qwen2.5-72B-Instruct",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"deepseek-ai/DeepSeek-V2.5",label:"DeepSeek-V2.5",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"Qwen/QwQ-32B-Preview",label:"QwQ-32B-Preview",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"Qwen/Qwen2-VL-72B-Instruct",label:"Qwen2-VL-72B-Instruct",provider:"Hyperbolic",maxTokenAllowed:8192}];async getDynamicModels(e,r,n={}){const{baseUrl:s,apiKey:i}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"HYPERBOLIC_API_KEY"}),o=s||"https://api.hyperbolic.xyz/v1";if(!i)throw`Missing Api Key configuration for ${this.name} provider`;return(await(await fetch(`${o}/models`,{headers:{Authorization:`Bearer ${i}`}})).json()).data.filter(u=>u.object==="model"&&u.supports_chat).map(u=>({name:u.id,label:`${u.id} - context ${u.context_length?Math.floor(u.context_length/1e3)+"k":"N/A"}`,provider:this.name,maxTokenAllowed:u.context_length||8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"HYPERBOLIC_API_KEY"});if(!o)throw`Missing Api Key configuration for ${this.name} provider`;return Us({baseURL:"https://api.hyperbolic.xyz/v1/",apiKey:o})(r)}}var oL="vercel.ai.error",RZ=Symbol.for(oL),aL,PZ=class lL extends Error{constructor({name:e,message:r,cause:n}){super(r),this[aL]=!0,this.name=e,this.cause=n}static isInstance(e){return lL.hasMarker(e,oL)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};aL=RZ;var Bl=PZ,cL="AI_InvalidArgumentError",uL=`vercel.ai.error.${cL}`,IZ=Symbol.for(uL),dL,OZ=class extends Bl{constructor({message:t,cause:e,argument:r}){super({name:cL,message:t,cause:e}),this[dL]=!0,this.argument=r}static isInstance(t){return Bl.hasMarker(t,uL)}};dL=IZ;var hL="AI_LoadSettingError",fL=`vercel.ai.error.${hL}`,DZ=Symbol.for(fL),pL,Hh=class extends Bl{constructor({message:t}){super({name:hL,message:t}),this[pL]=!0}static isInstance(t){return Bl.hasMarker(t,fL)}};pL=DZ;var mL="AI_UnsupportedFunctionalityError",gL=`vercel.ai.error.${mL}`,MZ=Symbol.for(gL),vL,lu=class extends Bl{constructor({functionality:t}){super({name:mL,message:`'${t}' functionality not supported.`}),this[vL]=!0,this.functionality=t}static isInstance(t){return Bl.hasMarker(t,gL)}};vL=MZ;var yL={},_L=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const s=Iw(r,e);if(t==null)return s;if(r.includes(n))throw new OZ({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return i=>`${t}${n}${s(i)}`},LZ=_L();function NZ({settingValue:t,environmentVariableName:e}){if(typeof t=="string")return t;if(!(t!=null||typeof xt>"u")&&(t=yL[e],!(t==null||typeof t!="string")))return t}function ry({settingValue:t,environmentVariableName:e,settingName:r,description:n}){if(typeof t=="string")return t;if(t!=null)throw new Hh({message:`${n} setting must be a string.`});if(typeof xt>"u")throw new Hh({message:`${n} setting is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=yL[e],t==null)throw new Hh({message:`${n} setting is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Hh({message:`${n} setting must be a string. The value of the ${e} environment variable is not a string.`});return t}const BZ=t=>({setHttpHandler(e){t.httpHandler=e},httpHandler(){return t.httpHandler},updateHttpClientConfig(e,r){t.httpHandler?.updateHttpClientConfig(e,r)},httpHandlerConfigs(){return t.httpHandler.httpHandlerConfigs()}}),FZ=t=>({httpHandler:t.httpHandler()});var vk;(function(t){t.HEADER="header",t.QUERY="query"})(vk||(vk={}));var yk;(function(t){t.HEADER="header",t.QUERY="query"})(yk||(yk={}));var dd;(function(t){t.HTTP="http",t.HTTPS="https"})(dd||(dd={}));var qp;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(qp||(qp={}));var _k;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(_k||(_k={}));const R_="__smithy_context";var bk;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(bk||(bk={}));var wk;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(wk||(wk={}));class vn{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const r=new vn({...e,headers:{...e.headers}});return r.query&&(r.query=jZ(r.query)),r}static isInstance(e){if(!e)return!1;const r=e;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){return vn.clone(this)}}function jZ(t){return Object.keys(t).reduce((e,r)=>{const n=t[r];return{...e,[r]:Array.isArray(n)?[...n]:n}},{})}class Jp{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const r=e;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}const $Z=t=>e=>async r=>{if(!vn.isInstance(r.request))return e(r);const{request:n}=r,{handlerProtocol:s=""}=t.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(r)},UZ={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},HZ=t=>({applyToStack:e=>{e.add($Z(t),UZ)}}),VZ=()=>(t,e)=>async r=>{try{const n=await t(r),{clientName:s,commandName:i,logger:o,dynamoDbDocumentClientOptions:a={}}=e,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:c}=a,u=l??e.inputFilterSensitiveLog,d=c??e.outputFilterSensitiveLog,{$metadata:h,...f}=n.output;return o?.info?.({clientName:s,commandName:i,input:u(r.input),output:d(f),metadata:h}),n}catch(n){const{clientName:s,commandName:i,logger:o,dynamoDbDocumentClientOptions:a={}}=e,{overrideInputFilterSensitiveLog:l}=a,c=l??e.inputFilterSensitiveLog;throw o?.error?.({clientName:s,commandName:i,input:c(r.input),error:n,metadata:n.$metadata}),n}},GZ={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},zZ=t=>({applyToStack:e=>{e.add(VZ(),GZ)}});var xk={};const ny="X-Amzn-Trace-Id",WZ="AWS_LAMBDA_FUNCTION_NAME",KZ="_X_AMZN_TRACE_ID",qZ=t=>e=>async r=>{const{request:n}=r;if(!vn.isInstance(n)||t.runtime!=="node")return e(r);const s=Object.keys(n.headers??{}).find(l=>l.toLowerCase()===ny.toLowerCase())??ny;if(n.headers.hasOwnProperty(s))return e(r);const i=xk[WZ],o=xk[KZ],a=l=>typeof l=="string"&&l.length>0;return a(i)&&a(o)&&(n.headers[ny]=o),e({...r,request:n})},JZ={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},YZ=t=>({applyToStack:e=>{e.add(qZ(t),JZ)}}),mg=t=>t[R_]||(t[R_]={}),Ji=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e};function ZZ(t){const e=new Map;for(const r of t)e.set(r.schemeId,r);return e}const XZ=(t,e)=>(r,n)=>async s=>{const i=t.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(t,n,s.input)),o=ZZ(t.httpAuthSchemes),a=mg(n),l=[];for(const c of i){const u=o.get(c.schemeId);if(!u){l.push(`HttpAuthScheme \`${c.schemeId}\` was not enabled for this service.`);continue}const d=u.identityProvider(await e.identityProviderConfigProvider(t));if(!d){l.push(`HttpAuthScheme \`${c.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:h={},signingProperties:f={}}=c.propertiesExtractor?.(t,n)||{};c.identityProperties=Object.assign(c.identityProperties||{},h),c.signingProperties=Object.assign(c.signingProperties||{},f),a.selectedHttpAuthScheme={httpAuthOption:c,identity:await d(c.identityProperties),signer:u.signer};break}if(!a.selectedHttpAuthScheme)throw new Error(l.join(`
`));return r(s)},QZ={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},eX=(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:r})=>({applyToStack:n=>{n.addRelativeTo(XZ(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:r}),QZ)}}),tX=(t,e)=>(r,n)=>async s=>{const{response:i}=await r(s);try{const o=await e(i,t);return{response:i,output:o}}catch(o){if(Object.defineProperty(o,"$response",{value:i}),!("$metadata"in o)){const a="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{o.message+=`
  `+a}catch{!n.logger||n.logger?.constructor?.name==="NoOpLogger"?console.warn(a):n.logger?.warn?.(a)}typeof o.$responseBodyText<"u"&&o.$response&&(o.$response.body=o.$responseBodyText)}throw o}},rX=(t,e)=>(r,n)=>async s=>{const i=n.endpointV2?.url&&t.urlParser?async()=>t.urlParser(n.endpointV2.url):t.endpoint;if(!i)throw new Error("No valid endpoint provider available.");const o=await e(s.input,{...t,endpoint:i});return r({...s,request:o})},nX={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},Mx={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function Lx(t,e,r){return{applyToStack:n=>{n.add(tX(t,r),nX),n.add(rX(t,e),Mx)}}}Mx.name;const sX=t=>e=>{throw e},iX=(t,e)=>{},oX=t=>(e,r)=>async n=>{if(!vn.isInstance(n.request))return e(n);const i=mg(r).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:o={}},identity:a,signer:l}=i,c=await e({...n,request:await l.sign(n.request,a,o)}).catch((l.errorHandler||sX)(o));return(l.successHandler||iX)(c.response,o),c},aX={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},lX=t=>({applyToStack:e=>{e.addRelativeTo(oX(),aX)}}),cu=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},lo={},oc=new Array(64);for(let t=0,e=65,r=90;t+e<=r;t++){const n=String.fromCharCode(t+e);lo[n]=t,oc[t]=n}for(let t=0,e=97,r=122;t+e<=r;t++){const n=String.fromCharCode(t+e),s=t+26;lo[n]=s,oc[s]=n}for(let t=0;t<10;t++){lo[t.toString(10)]=t+52;const e=t.toString(10),r=t+52;lo[e]=r,oc[r]=e}lo["+"]=62;oc[62]="+";lo["/"]=63;oc[63]="/";const pl=6,uu=8,cX=63,Nx=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const r=new ArrayBuffer(e),n=new DataView(r);for(let s=0;s<t.length;s+=4){let i=0,o=0;for(let c=s,u=s+3;c<=u;c++)if(t[c]!=="="){if(!(t[c]in lo))throw new TypeError(`Invalid character ${t[c]} in base64 string.`);i|=lo[t[c]]<<(u-c)*pl,o+=pl}else i>>=pl;const a=s/4*3;i>>=o%uu;const l=Math.floor(o/uu);for(let c=0;c<l;c++){const u=(l-c-1)*uu;n.setUint8(a+c,(i&255<<u)>>u)}}return new Uint8Array(r)},Fl=t=>new TextEncoder().encode(t),du=t=>typeof t=="string"?Fl(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),bL=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)};function wL(t){let e;typeof t=="string"?e=Fl(t):e=t;const r=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!r&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let o=0,a=0;for(let c=i,u=Math.min(i+3,e.length);c<u;c++)o|=e[c]<<(u-c-1)*uu,a+=uu;const l=Math.ceil(a/pl);o<<=l*pl-a;for(let c=1;c<=l;c++){const u=(l-c)*pl;s+=oc[(o&cX<<u)>>u]}s+="==".slice(0,4-l)}return s}function uX(t,e="utf-8"){return e==="base64"?wL(t):bL(t)}function dX(t,e){return e==="base64"?na.mutate(Nx(t)):na.mutate(Fl(t))}class na extends Uint8Array{static fromString(e,r="utf-8"){switch(typeof e){case"string":return dX(e,r);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,na.prototype),e}transformToString(e="utf-8"){return uX(this,e)}}const sa=t=>encodeURIComponent(t).replace(/[!'()*]/g,hX),hX=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function fX(t){const e=[];for(let r of Object.keys(t).sort()){const n=t[r];if(r=sa(r),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${r}=${sa(n[s])}`);else{let s=r;(n||typeof n=="string")&&(s+=`=${sa(n)}`),e.push(s)}}return e.join("&")}function Sk(t,e){return new Request(t,e)}function pX(t=0){return new Promise((e,r)=>{t&&setTimeout(()=>{const n=new Error(`Request did not complete within ${t} ms`);n.name="TimeoutError",r(n)},t)})}const sy={supported:void 0};class Bx{static create(e){return typeof e?.handle=="function"?e:new Bx(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(r=>r||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),sy.supported===void 0&&(sy.supported=typeof Request<"u"&&"keepalive"in Sk("https://[::1]"))}destroy(){}async handle(e,{abortSignal:r}={}){this.config||(this.config=await this.configProvider);const n=this.config.requestTimeout,s=this.config.keepAlive===!0,i=this.config.credentials;if(r?.aborted){const g=new Error("Request aborted");return g.name="AbortError",Promise.reject(g)}let o=e.path;const a=fX(e.query||{});a&&(o+=`?${a}`),e.fragment&&(o+=`#${e.fragment}`);let l="";if(e.username!=null||e.password!=null){const g=e.username??"",y=e.password??"";l=`${g}:${y}@`}const{port:c,method:u}=e,d=`${e.protocol}//${l}${e.hostname}${c?`:${c}`:""}${o}`,h=u==="GET"||u==="HEAD"?void 0:e.body,f={body:h,headers:new Headers(e.headers),method:u,credentials:i};this.config?.cache&&(f.cache=this.config.cache),h&&(f.duplex="half"),typeof AbortController<"u"&&(f.signal=r),sy.supported&&(f.keepalive=s),typeof this.config.requestInit=="function"&&Object.assign(f,this.config.requestInit(e));let v=()=>{};const m=Sk(d,f),p=[fetch(m).then(g=>{const y=g.headers,_={};for(const w of y.entries())_[w[0]]=w[1];return g.body!=null?{response:new Jp({headers:_,reason:g.statusText,statusCode:g.status,body:g.body})}:g.blob().then(w=>({response:new Jp({headers:_,reason:g.statusText,statusCode:g.status,body:w})}))}),pX(n)];return r&&p.push(new Promise((g,y)=>{const _=()=>{const b=new Error("Request aborted");b.name="AbortError",y(b)};if(typeof r.addEventListener=="function"){const b=r;b.addEventListener("abort",_,{once:!0}),v=()=>b.removeEventListener("abort",_)}else r.onabort=_})),Promise.race(p).finally(v)}updateHttpClientConfig(e,r){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=r,n))}httpHandlerConfigs(){return this.config??{}}}const mX=async t=>typeof Blob=="function"&&t instanceof Blob||t.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await t.arrayBuffer()):gX(t):vX(t);async function gX(t){const e=await yX(t),r=Nx(e);return new Uint8Array(r)}async function vX(t){const e=[],r=t.getReader();let n=!1,s=0;for(;!n;){const{done:a,value:l}=await r.read();l&&(e.push(l),s+=l.length),n=a}const i=new Uint8Array(s);let o=0;for(const a of e)i.set(a,o),o+=a.length;return i}function yX(t){return new Promise((e,r)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return r(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),o=i>-1?i+1:s.length;e(s.substring(o))},n.onabort=()=>r(new Error("Read aborted")),n.onerror=()=>r(n.error),n.readAsDataURL(t)})}const xL={},P_={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),xL[t]=e,P_[e]=t}function SL(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const n=t.slice(r,r+2).toLowerCase();if(n in P_)e[r/2]=P_[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function cn(t){let e="";for(let r=0;r<t.byteLength;r++)e+=xL[t[r]];return e}const EL=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return na.mutate(t);if(!t)return na.mutate(new Uint8Array);const r=e.streamCollector(t);return na.mutate(await r)};function Ek(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}const _X=(t,e,r,n,s,i)=>{if(e!=null&&e[r]!==void 0){const o=n();if(o.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");t=t.replace(s,i?o.split("/").map(a=>Ek(a)).join("/"):Ek(o))}else throw new Error("No value provided for input HTTP label: "+r+".");return t};function Fx(t,e){return new bX(t,e)}class bX{constructor(e,r){this.input=e,this.context=r,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:r="https",port:n,path:s}=await this.context.endpoint();this.path=s;for(const i of this.resolvePathStack)i(this.path);return new vn({protocol:r,hostname:this.hostname||e,port:n,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(r=>{this.path=`${r?.endsWith("/")?r.slice(0,-1):r||""}`+e}),this}p(e,r,n,s){return this.resolvePathStack.push(i=>{this.path=_X(i,this.input,e,r,n,s)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}function wX(t,e,r){t.__smithy_context?t.__smithy_context.features||(t.__smithy_context.features={}):t.__smithy_context={features:{}},t.__smithy_context.features[e]=r}class xX{constructor(e){this.authSchemes=new Map;for(const[r,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(r,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}const SX=t=>e=>CL(e)&&e.expiration.getTime()-Date.now()<t,EX=3e5,CX=SX(EX),CL=t=>t.expiration!==void 0,kX=(t,e,r)=>{if(t===void 0)return;const n=typeof t!="function"?async()=>Promise.resolve(t):t;let s,i,o,a=!1;const l=async c=>{i||(i=n(c));try{s=await i,o=!0,a=!1}finally{i=void 0}return s};return e===void 0?async c=>((!o||c?.forceRefresh)&&(s=await l(c)),s):async c=>((!o||c?.forceRefresh)&&(s=await l(c)),a?s:r(s)?(e(s)&&await l(c),s):(a=!0,s))},TX=void 0;function AX(t){return t===void 0?!0:typeof t=="string"&&t.length<=50}function RX(t){const e=cu(t.userAgentAppId??TX),{customUserAgent:r}=t;return Object.assign(t,{customUserAgent:typeof r=="string"?[[r]]:r,userAgentAppId:async()=>{const n=await e();if(!AX(n)){const s=t.logger?.constructor?.name==="NoOpLogger"||!t.logger?console:t.logger;typeof n!="string"?s?.warn("userAgentAppId must be a string or undefined."):n.length>50&&s?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return n}})}class PX{constructor({size:e,params:r}){this.data=new Map,this.parameters=[],this.capacity=e??50,r&&(this.parameters=r)}get(e,r){const n=this.hash(e);if(n===!1)return r();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:o,done:a}=s.next();if(this.data.delete(o),a||++i>10)break}}this.data.set(n,r())}return this.data.get(n)}size(){return this.data.size}hash(e){let r="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;r+=i+"|;"}return r}}const IX=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),kL=t=>IX.test(t)||t.startsWith("[")&&t.endsWith("]"),OX=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),jx=(t,e=!1)=>{if(!e)return OX.test(t);const r=t.split(".");for(const n of r)if(!jx(n))return!1;return!0},Yp={},hd="endpoints";function co(t){return typeof t!="object"||t==null?t:"ref"in t?`$${co(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map(co).join(", ")})`:JSON.stringify(t,null,2)}class yn extends Error{constructor(e){super(e),this.name="EndpointError"}}const DX=(t,e)=>t===e,MX=t=>{const e=t.split("."),r=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new yn(`Path: '${t}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new yn(`Invalid array index: '${i}' in path: '${t}'`);s!==0&&r.push(n.slice(0,s)),r.push(i)}else r.push(n)}return r},TL=(t,e)=>MX(e).reduce((r,n)=>{if(typeof r!="object")throw new yn(`Index '${n}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(r)?r[parseInt(n)]:r[n]},t),LX=t=>t!=null,NX=t=>!t,iy={[dd.HTTP]:80,[dd.HTTPS]:443},BX=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:h,port:f,protocol:v="",path:m="",query:p={}}=t,g=new URL(`${v}//${h}${f?`:${f}`:""}${m}`);return g.search=Object.entries(p).map(([y,_])=>`${y}=${_}`).join("&"),g}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const r=e.href,{host:n,hostname:s,pathname:i,protocol:o,search:a}=e;if(a)return null;const l=o.slice(0,-1);if(!Object.values(dd).includes(l))return null;const c=kL(s),u=r.includes(`${n}:${iy[l]}`)||typeof t=="string"&&t.includes(`${n}:${iy[l]}`),d=`${n}${u?`:${iy[l]}`:""}`;return{scheme:l,authority:d,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:c}},FX=(t,e)=>t===e,jX=(t,e,r,n)=>e>=r||t.length<r?null:n?t.substring(t.length-r,t.length-e):t.substring(e,r),$X=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),UX={booleanEquals:DX,getAttr:TL,isSet:LX,isValidHostLabel:jx,not:NX,parseURL:BX,stringEquals:FX,substring:jX,uriEncode:$X},AL=(t,e)=>{const r=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<t.length;){const i=t.indexOf("{",s);if(i===-1){r.push(t.slice(s));break}r.push(t.slice(s,i));const o=t.indexOf("}",i);if(o===-1){r.push(t.slice(i));break}t[i+1]==="{"&&t[o+1]==="}"&&(r.push(t.slice(i+1,o)),s=o+2);const a=t.substring(i+1,o);if(a.includes("#")){const[l,c]=a.split("#");r.push(TL(n[l],c))}else r.push(n[a]);s=o+1}return r.join("")},HX=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],gg=(t,e,r)=>{if(typeof t=="string")return AL(t,r);if(t.fn)return RL(t,r);if(t.ref)return HX(t,r);throw new yn(`'${e}': ${String(t)} is not a string, function or reference.`)},RL=({fn:t,argv:e},r)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:gg(i,"arg",r)),s=t.split(".");return s[0]in Yp&&s[1]!=null?Yp[s[0]][s[1]](...n):UX[t](...n)},VX=({assign:t,...e},r)=>{if(t&&t in r.referenceRecord)throw new yn(`'${t}' is already defined in Reference Record.`);const n=RL(e,r);return r.logger?.debug?.(`${hd} evaluateCondition: ${co(e)} = ${co(n)}`),{result:n===""?!0:!!n,...t!=null&&{toAssign:{name:t,value:n}}}},$x=(t=[],e)=>{const r={};for(const n of t){const{result:s,toAssign:i}=VX(n,{...e,referenceRecord:{...e.referenceRecord,...r}});if(!s)return{result:s};i&&(r[i.name]=i.value,e.logger?.debug?.(`${hd} assign: ${i.name} := ${co(i.value)}`))}return{result:!0,referenceRecord:r}},GX=(t,e)=>Object.entries(t).reduce((r,[n,s])=>({...r,[n]:s.map(i=>{const o=gg(i,"Header value entry",e);if(typeof o!="string")throw new yn(`Header '${n}' value '${o}' is not a string`);return o})}),{}),PL=(t,e)=>{if(Array.isArray(t))return t.map(r=>PL(r,e));switch(typeof t){case"string":return AL(t,e);case"object":if(t===null)throw new yn(`Unexpected endpoint property: ${t}`);return IL(t,e);case"boolean":return t;default:throw new yn(`Unexpected endpoint property type: ${typeof t}`)}},IL=(t,e)=>Object.entries(t).reduce((r,[n,s])=>({...r,[n]:PL(s,e)}),{}),zX=(t,e)=>{const r=gg(t,"Endpoint URL",e);if(typeof r=="string")try{return new URL(r)}catch(n){throw console.error(`Failed to construct URL with ${r}`,n),n}throw new yn(`Endpoint URL must be a string, got ${typeof r}`)},WX=(t,e)=>{const{conditions:r,endpoint:n}=t,{result:s,referenceRecord:i}=$x(r,e);if(!s)return;const o={...e,referenceRecord:{...e.referenceRecord,...i}},{url:a,properties:l,headers:c}=n;return e.logger?.debug?.(`${hd} Resolving endpoint from template: ${co(n)}`),{...c!=null&&{headers:GX(c,o)},...l!=null&&{properties:IL(l,o)},url:zX(a,o)}},KX=(t,e)=>{const{conditions:r,error:n}=t,{result:s,referenceRecord:i}=$x(r,e);if(s)throw new yn(gg(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},qX=(t,e)=>{const{conditions:r,rules:n}=t,{result:s,referenceRecord:i}=$x(r,e);if(s)return OL(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},OL=(t,e)=>{for(const r of t)if(r.type==="endpoint"){const n=WX(r,e);if(n)return n}else if(r.type==="error")KX(r,e);else if(r.type==="tree"){const n=qX(r,e);if(n)return n}else throw new yn(`Unknown endpoint rule: ${r}`);throw new yn("Rules evaluation failed")},JX=(t,e)=>{const{endpointParams:r,logger:n}=e,{parameters:s,rules:i}=t;e.logger?.debug?.(`${hd} Initial EndpointParams: ${co(r)}`);const o=Object.entries(s).filter(([,c])=>c.default!=null).map(([c,u])=>[c,u.default]);if(o.length>0)for(const[c,u]of o)r[c]=r[c]??u;const a=Object.entries(s).filter(([,c])=>c.required).map(([c])=>c);for(const c of a)if(r[c]==null)throw new yn(`Missing required parameter: '${c}'`);const l=OL(i,{endpointParams:r,logger:n,referenceRecord:{}});return e.logger?.debug?.(`${hd} Resolved endpoint: ${co(l)}`),l},DL=(t,e=!1)=>{if(e){for(const r of t.split("."))if(!DL(r))return!1;return!0}return!(!jx(t)||t.length<3||t.length>63||t!==t.toLowerCase()||kL(t))},Ck=":",YX="/",ZX=t=>{const e=t.split(Ck);if(e.length<6)return null;const[r,n,s,i,o,...a]=e;if(r!=="arn"||n===""||s===""||a.join(Ck)==="")return null;const l=a.map(c=>c.split(YX)).flat();return{partition:n,service:s,region:i,accountId:o,resourceId:l}},XX=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"AWS ISOF global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}}],QX={partitions:XX};let eQ=QX;const tQ=t=>{const{partitions:e}=eQ;for(const n of e){const{regions:s,outputs:i}=n;for(const[o,a]of Object.entries(s))if(o===t)return{...i,...a}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(t))return{...i}}const r=e.find(n=>n.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},ML={isVirtualHostableS3Bucket:DL,parseArn:ZX,partition:tQ};Yp.aws=ML;function rQ(t,e,r){return t.$source||(t.$source={}),t.$source[e]=r,t}function ls(t,e,r){t.__aws_sdk_context?t.__aws_sdk_context.features||(t.__aws_sdk_context.features={}):t.__aws_sdk_context={features:{}},t.__aws_sdk_context.features[e]=r}const kk=t=>Jp.isInstance(t)?t.headers?.date??t.headers?.Date:void 0,LL=t=>new Date(Date.now()+t),nQ=(t,e)=>Math.abs(LL(e).getTime()-t)>=3e5,Tk=(t,e)=>{const r=Date.parse(t);return nQ(r,e)?r-Date.now():e},hu=(t,e)=>{if(!e)throw new Error(`Property \`${t}\` is not resolved for AWS SDK SigV4Auth`);return e},sQ=async t=>{const e=hu("context",t.context),r=hu("config",t.config),n=e.endpointV2?.properties?.authSchemes?.[0],i=await hu("signer",r.signer)(n),o=t?.signingRegion,a=t?.signingRegionSet,l=t?.signingName;return{config:r,signer:i,signingRegion:o,signingRegionSet:a,signingName:l}};class iQ{async sign(e,r,n){if(!vn.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await sQ(n),{config:i,signer:o}=s;let{signingRegion:a,signingName:l}=s;const c=n.context;if(c?.authSchemes?.length??!1){const[d,h]=c.authSchemes;d?.name==="sigv4a"&&h?.name==="sigv4"&&(a=h?.signingRegion??a,l=h?.signingName??l)}return await o.sign(e,{signingDate:LL(i.systemClockOffset),signingRegion:a,signingService:l})}errorHandler(e){return r=>{const n=r.ServerTime??kk(r.$response);if(n){const s=hu("config",e.config),i=s.systemClockOffset;s.systemClockOffset=Tk(n,s.systemClockOffset),s.systemClockOffset!==i&&r.$metadata&&(r.$metadata.clockSkewCorrected=!0)}throw r}}successHandler(e,r){const n=kk(e);if(n){const s=hu("config",r.config);s.systemClockOffset=Tk(n,s.systemClockOffset)}}}const oQ=(t,e,r)=>{let n,s,i,o=!1;const a=async()=>{s||(s=t());try{n=await s,i=!0,o=!1}finally{s=void 0}return n};return async l=>((!i||l?.forceRefresh)&&(n=await a()),n)},aQ="X-Amz-Algorithm",lQ="X-Amz-Credential",NL="X-Amz-Date",cQ="X-Amz-SignedHeaders",uQ="X-Amz-Expires",BL="X-Amz-Signature",FL="X-Amz-Security-Token",jL="authorization",$L=NL.toLowerCase(),dQ="date",hQ=[jL,$L,dQ],fQ=BL.toLowerCase(),I_="x-amz-content-sha256",pQ=FL.toLowerCase(),mQ={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},gQ=/^proxy-/,vQ=/^sec-/,oy="AWS4-HMAC-SHA256",yQ="AWS4-HMAC-SHA256-PAYLOAD",_Q="UNSIGNED-PAYLOAD",bQ=50,UL="aws4_request",wQ=60*60*24*7,Vh={},ay=[],ly=(t,e,r)=>`${t}/${e}/${r}/${UL}`,xQ=async(t,e,r,n,s)=>{const i=await Ak(t,e.secretAccessKey,e.accessKeyId),o=`${r}:${n}:${s}:${cn(i)}:${e.sessionToken}`;if(o in Vh)return Vh[o];for(ay.push(o);ay.length>bQ;)delete Vh[ay.shift()];let a=`AWS4${e.secretAccessKey}`;for(const l of[r,n,s,UL])a=await Ak(t,a,l);return Vh[o]=a},Ak=(t,e,r)=>{const n=new t(e);return n.update(du(r)),n.digest()},Rk=({headers:t},e,r)=>{const n={};for(const s of Object.keys(t).sort()){if(t[s]==null)continue;const i=s.toLowerCase();(i in mQ||e?.has(i)||gQ.test(i)||vQ.test(i))&&(!r||r&&!r.has(i))||(n[i]=t[s].trim().replace(/\s+/g," "))}return n},SQ=({query:t={}})=>{const e=[],r={};for(const n of Object.keys(t)){if(n.toLowerCase()===fQ)continue;const s=sa(n);e.push(s);const i=t[n];typeof i=="string"?r[s]=`${s}=${sa(i)}`:Array.isArray(i)&&(r[s]=i.slice(0).reduce((o,a)=>o.concat([`${s}=${sa(a)}`]),[]).sort().join("&"))}return e.sort().map(n=>r[n]).filter(n=>n).join("&")},EQ=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",cy=async({headers:t,body:e},r)=>{for(const n of Object.keys(t))if(n.toLowerCase()===I_)return t[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||EQ(e)){const n=new r;return n.update(du(e)),cn(await n.digest())}return _Q};class CQ{format(e){const r=[];for(const i of Object.keys(e)){const o=Fl(i);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const n=new Uint8Array(r.reduce((i,o)=>i+o.byteLength,0));let s=0;for(const i of r)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=Fl(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(TQ.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!kQ.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const d=new Uint8Array(17);return d[0]=9,d.set(SL(e.value.replace(/\-/g,"")),1),d}}}var Pk;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(Pk||(Pk={}));const kQ=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;let TQ=class HL{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)r[n]=s;return e<0&&Ik(r),new HL(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&Ik(e),parseInt(cn(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}};function Ik(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}const AQ=(t,e)=>{t=t.toLowerCase();for(const r of Object.keys(e))if(t===r.toLowerCase())return!0;return!1},RQ=(t,e={})=>{const{headers:r,query:n={}}=vn.clone(t);for(const s of Object.keys(r)){const i=s.toLowerCase();(i.slice(0,6)==="x-amz-"&&!e.unhoistableHeaders?.has(i)||e.hoistableHeaders?.has(i))&&(n[s]=r[s],delete r[s])}return{...t,headers:r,query:n}},Ok=t=>{t=vn.clone(t);for(const e of Object.keys(t.headers))hQ.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},PQ=t=>IQ(t).toISOString().replace(/\.\d{3}Z$/,"Z"),IQ=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class Dk{constructor({applyChecksum:e,credentials:r,region:n,service:s,sha256:i,uriEscapePath:o=!0}){this.headerFormatter=new CQ,this.service=s,this.sha256=i,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=Ji(n),this.credentialProvider=Ji(r)}async presign(e,r={}){const{signingDate:n=new Date,expiresIn:s=3600,unsignableHeaders:i,unhoistableHeaders:o,signableHeaders:a,hoistableHeaders:l,signingRegion:c,signingService:u}=r,d=await this.credentialProvider();this.validateResolvedCredentials(d);const h=c??await this.regionProvider(),{longDate:f,shortDate:v}=Gh(n);if(s>wQ)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const m=ly(v,h,u??this.service),p=RQ(Ok(e),{unhoistableHeaders:o,hoistableHeaders:l});d.sessionToken&&(p.query[FL]=d.sessionToken),p.query[aQ]=oy,p.query[lQ]=`${d.accessKeyId}/${m}`,p.query[NL]=f,p.query[uQ]=s.toString(10);const g=Rk(p,i,a);return p.query[cQ]=Mk(g),p.query[BL]=await this.getSignature(f,m,this.getSigningKey(d,h,v,u),this.createCanonicalRequest(p,g,await cy(e,this.sha256))),p}async sign(e,r){return typeof e=="string"?this.signString(e,r):e.headers&&e.payload?this.signEvent(e,r):e.message?this.signMessage(e,r):this.signRequest(e,r)}async signEvent({headers:e,payload:r},{signingDate:n=new Date,priorSignature:s,signingRegion:i,signingService:o}){const a=i??await this.regionProvider(),{shortDate:l,longDate:c}=Gh(n),u=ly(l,a,o??this.service),d=await cy({headers:{},body:r},this.sha256),h=new this.sha256;h.update(e);const f=cn(await h.digest()),v=[yQ,c,u,s,f,d].join(`
`);return this.signString(v,{signingDate:n,signingRegion:a,signingService:o})}async signMessage(e,{signingDate:r=new Date,signingRegion:n,signingService:s}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:r,signingRegion:n,signingService:s,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:r=new Date,signingRegion:n,signingService:s}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const o=n??await this.regionProvider(),{shortDate:a}=Gh(r),l=new this.sha256(await this.getSigningKey(i,o,a,s));return l.update(du(e)),cn(await l.digest())}async signRequest(e,{signingDate:r=new Date,signableHeaders:n,unsignableHeaders:s,signingRegion:i,signingService:o}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const l=i??await this.regionProvider(),c=Ok(e),{longDate:u,shortDate:d}=Gh(r),h=ly(d,l,o??this.service);c.headers[$L]=u,a.sessionToken&&(c.headers[pQ]=a.sessionToken);const f=await cy(c,this.sha256);!AQ(I_,c.headers)&&this.applyChecksum&&(c.headers[I_]=f);const v=Rk(c,s,n),m=await this.getSignature(u,h,this.getSigningKey(a,l,d,o),this.createCanonicalRequest(c,v,f));return c.headers[jL]=`${oy} Credential=${a.accessKeyId}/${h}, SignedHeaders=${Mk(v)}, Signature=${m}`,c}createCanonicalRequest(e,r,n){const s=Object.keys(r).sort();return`${e.method}
${this.getCanonicalPath(e)}
${SQ(e)}
${s.map(i=>`${i}:${r[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,r,n){const s=new this.sha256;s.update(du(n));const i=await s.digest();return`${oy}
${e}
${r}
${cn(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const r=[];for(const i of e.split("/"))i?.length!==0&&i!=="."&&(i===".."?r.pop():r.push(i));const n=`${e?.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&e?.endsWith("/")?"/":""}`;return sa(n).replace(/%2F/g,"/")}return e}async getSignature(e,r,n,s){const i=await this.createStringToSign(e,r,s),o=new this.sha256(await n);return o.update(du(i)),cn(await o.digest())}getSigningKey(e,r,n,s){return xQ(this.sha256,e,n,r,s||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const Gh=t=>{const e=PQ(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},Mk=t=>Object.keys(t).sort().join(";"),OQ=t=>{let e=t.credentials,r=!!t.credentials,n;Object.defineProperty(t,"credentials",{set(c){c&&c!==e&&c!==n&&(r=!0),e=c;const u=DQ(t,{credentials:e,credentialDefaultProvider:t.credentialDefaultProvider}),d=MQ(t,u);r&&!d.attributed?(n=async h=>d(h).then(f=>rQ(f,"CREDENTIALS_CODE","e")),n.memoized=d.memoized,n.configBound=d.configBound,n.attributed=!0):n=d},get(){return n},enumerable:!0,configurable:!0}),t.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=t.systemClockOffset||0,sha256:o}=t;let a;return t.signer?a=cu(t.signer):t.regionInfoProvider?a=()=>cu(t.region)().then(async c=>[await t.regionInfoProvider(c,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},c]).then(([c,u])=>{const{signingRegion:d,signingService:h}=c;t.signingRegion=t.signingRegion||d||u,t.signingName=t.signingName||h||t.serviceId;const f={...t,credentials:t.credentials,region:t.signingRegion,service:t.signingName,sha256:o,uriEscapePath:s},v=t.signerConstructor||Dk;return new v(f)}):a=async c=>{c=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await cu(t.region)(),properties:{}},c);const u=c.signingRegion,d=c.signingName;t.signingRegion=t.signingRegion||u,t.signingName=t.signingName||d||t.serviceId;const h={...t,credentials:t.credentials,region:t.signingRegion,service:t.signingName,sha256:o,uriEscapePath:s},f=t.signerConstructor||Dk;return new f(h)},Object.assign(t,{systemClockOffset:i,signingEscapePath:s,signer:a})};function DQ(t,{credentials:e,credentialDefaultProvider:r}){let n;return e?e?.memoized?n=e:n=kX(e,CX,CL):r?n=cu(r(Object.assign({},t,{parentClientConfig:t}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function MQ(t,e){if(e.configBound)return e;const r=async n=>e({...n,callerClientConfig:t});return r.memoized=e.memoized,r.configBound=!0,r}const Oo=(t,e)=>{const r=[];if(t&&r.push(t),e)for(const n of e)r.push(n);return r},Di=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,Zp=()=>{let t=[],e=[],r=!1;const n=new Set,s=d=>d.sort((h,f)=>Lk[f.step]-Lk[h.step]||Nk[f.priority||"normal"]-Nk[h.priority||"normal"]),i=d=>{let h=!1;const f=v=>{const m=Oo(v.name,v.aliases);if(m.includes(d)){h=!0;for(const p of m)n.delete(p);return!1}return!0};return t=t.filter(f),e=e.filter(f),h},o=d=>{let h=!1;const f=v=>{if(v.middleware===d){h=!0;for(const m of Oo(v.name,v.aliases))n.delete(m);return!1}return!0};return t=t.filter(f),e=e.filter(f),h},a=d=>(t.forEach(h=>{d.add(h.middleware,{...h})}),e.forEach(h=>{d.addRelativeTo(h.middleware,{...h})}),d.identifyOnResolve?.(u.identifyOnResolve()),d),l=d=>{const h=[];return d.before.forEach(f=>{f.before.length===0&&f.after.length===0?h.push(f):h.push(...l(f))}),h.push(d),d.after.reverse().forEach(f=>{f.before.length===0&&f.after.length===0?h.push(f):h.push(...l(f))}),h},c=(d=!1)=>{const h=[],f=[],v={};return t.forEach(p=>{const g={...p,before:[],after:[]};for(const y of Oo(g.name,g.aliases))v[y]=g;h.push(g)}),e.forEach(p=>{const g={...p,before:[],after:[]};for(const y of Oo(g.name,g.aliases))v[y]=g;f.push(g)}),f.forEach(p=>{if(p.toMiddleware){const g=v[p.toMiddleware];if(g===void 0){if(d)return;throw new Error(`${p.toMiddleware} is not found when adding ${Di(p.name,p.aliases)} middleware ${p.relation} ${p.toMiddleware}`)}p.relation==="after"&&g.after.push(p),p.relation==="before"&&g.before.push(p)}}),s(h).map(l).reduce((p,g)=>(p.push(...g),p),[])},u={add:(d,h={})=>{const{name:f,override:v,aliases:m}=h,p={step:"initialize",priority:"normal",middleware:d,...h},g=Oo(f,m);if(g.length>0){if(g.some(y=>n.has(y))){if(!v)throw new Error(`Duplicate middleware name '${Di(f,m)}'`);for(const y of g){const _=t.findIndex(w=>w.name===y||w.aliases?.some(E=>E===y));if(_===-1)continue;const b=t[_];if(b.step!==p.step||p.priority!==b.priority)throw new Error(`"${Di(b.name,b.aliases)}" middleware with ${b.priority} priority in ${b.step} step cannot be overridden by "${Di(f,m)}" middleware with ${p.priority} priority in ${p.step} step.`);t.splice(_,1)}}for(const y of g)n.add(y)}t.push(p)},addRelativeTo:(d,h)=>{const{name:f,override:v,aliases:m}=h,p={middleware:d,...h},g=Oo(f,m);if(g.length>0){if(g.some(y=>n.has(y))){if(!v)throw new Error(`Duplicate middleware name '${Di(f,m)}'`);for(const y of g){const _=e.findIndex(w=>w.name===y||w.aliases?.some(E=>E===y));if(_===-1)continue;const b=e[_];if(b.toMiddleware!==p.toMiddleware||b.relation!==p.relation)throw new Error(`"${Di(b.name,b.aliases)}" middleware ${b.relation} "${b.toMiddleware}" middleware cannot be overridden by "${Di(f,m)}" middleware ${p.relation} "${p.toMiddleware}" middleware.`);e.splice(_,1)}}for(const y of g)n.add(y)}e.push(p)},clone:()=>a(Zp()),use:d=>{d.applyToStack(u)},remove:d=>typeof d=="string"?i(d):o(d),removeByTag:d=>{let h=!1;const f=v=>{const{tags:m,name:p,aliases:g}=v;if(m&&m.includes(d)){const y=Oo(p,g);for(const _ of y)n.delete(_);return h=!0,!1}return!0};return t=t.filter(f),e=e.filter(f),h},concat:d=>{const h=a(Zp());return h.use(d),h.identifyOnResolve(r||h.identifyOnResolve()||(d.identifyOnResolve?.()??!1)),h},applyToStack:a,identify:()=>c(!0).map(d=>{const h=d.step??d.relation+" "+d.toMiddleware;return Di(d.name,d.aliases)+" - "+h}),identifyOnResolve(d){return typeof d=="boolean"&&(r=d),r},resolve:(d,h)=>{for(const f of c().map(v=>v.middleware).reverse())d=f(d,h);return r&&console.log(u.identify()),d}};return u},Lk={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},Nk={high:3,normal:2,low:1};class LQ{constructor(e){this.config=e,this.middlewareStack=Zp()}send(e,r,n){const s=typeof r!="function"?r:void 0,i=typeof r=="function"?r:n,o=s===void 0&&this.config.cacheMiddleware===!0;let a;if(o){this.handlers||(this.handlers=new WeakMap);const l=this.handlers;l.has(e.constructor)?a=l.get(e.constructor):(a=e.resolveMiddleware(this.middlewareStack,this.config,s),l.set(e.constructor,a))}else delete this.handlers,a=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)a(e).then(l=>i(null,l.output),l=>i(l)).catch(()=>{});else return a(e).then(l=>l.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}class vg{constructor(){this.middlewareStack=Zp()}static classBuilder(){return new NQ}resolveMiddlewareWithContext(e,r,n,{middlewareFn:s,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,smithyContext:c,additionalContext:u,CommandCtor:d}){for(const p of s.bind(this)(d,e,r,n))this.middlewareStack.use(p);const h=e.concat(this.middlewareStack),{logger:f}=r,v={logger:f,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,[R_]:{commandInstance:this,...c},...u},{requestHandler:m}=r;return h.resolve(p=>m.handle(p.request,n||{}),v)}}class NQ{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,r,n={}){return this._smithyContext={service:e,operation:r,...n},this}c(e={}){return this._additionalContext=e,this}n(e,r){return this._clientName=e,this._commandName=r,this}f(e=n=>n,r=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=r,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let r;return r=class extends vg{static getEndpointParameterInstructions(){return e._ep}constructor(...[n]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=n??{},e._init(this)}resolveMiddleware(n,s,i){return this.resolveMiddlewareWithContext(n,s,i,{CommandCtor:r,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const uo="***SensitiveInformation***",BQ=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&zL.warn(GL(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},FQ=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},Ux=t=>jQ(t,32),jQ=(t,e)=>{const r=FQ(t);if(r!==void 0&&$Q(r,e)!==r)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return r},$Q=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},UQ=(t,e)=>{if(t==null)throw new TypeError(`Expected a non-null value for ${e}`);return t},VL=t=>{if(t==null)return;if(typeof t=="object"&&!Array.isArray(t))return t;const e=Array.isArray(t)?"array":typeof t;throw new TypeError(`Expected object, got ${e}: ${t}`)},tt=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return zL.warn(GL(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},HQ=t=>{if(t==null)return;const e=VL(t),r=Object.entries(e).filter(([,n])=>n!=null).map(([n])=>n);if(r.length===0)throw new TypeError("Unions must have exactly one non-null member. None were found.");if(r.length>1)throw new TypeError(`Unions must have exactly one non-null member. Keys ${r} were not null.`);return e},Bk=t=>typeof t=="string"?VQ(t):BQ(t),VQ=t=>{switch(t){case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error(`Unable to parse float value: ${t}`)}},GL=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),zL={warn:console.warn};class nl extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const r=e;return nl.prototype.isPrototypeOf(r)||!!r.$fault&&!!r.$metadata&&(r.$fault==="client"||r.$fault==="server")}static[Symbol.hasInstance](e){if(!e)return!1;const r=e;return this===nl?nl.isInstance(e):nl.isInstance(e)?r.name&&this.name?this.prototype.isPrototypeOf(e)||r.name===this.name:this.prototype.isPrototypeOf(e):!1}}const _n=(t,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(t[n]==null||t[n]==="")&&(t[n]=s)});const r=t.message||t.Message||"UnknownError";return t.message=r,delete t.Message,t},GQ=({output:t,parsedBody:e,exceptionCtor:r,errorCode:n})=>{const s=WQ(t),i=s.httpStatusCode?s.httpStatusCode+"":void 0,o=new r({name:e?.code||e?.Code||n||i||"UnknownError",$fault:"client",$metadata:s});throw _n(o,e)},zQ=t=>({output:e,parsedBody:r,errorCode:n})=>{GQ({output:e,parsedBody:r,exceptionCtor:t,errorCode:n})},WQ=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),KQ=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},qQ=t=>{const e=[];for(const r in qp){const n=qp[r];t[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>t[n]})}return{addChecksumAlgorithm(r){e.push(r)},checksumAlgorithms(){return e}}},JQ=t=>{const e={};return t.checksumAlgorithms().forEach(r=>{e[r.algorithmId()]=r.checksumConstructor()}),e},YQ=t=>({setRetryStrategy(e){t.retryStrategy=e},retryStrategy(){return t.retryStrategy}}),ZQ=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},XQ=t=>Object.assign(qQ(t),YQ(t)),QQ=t=>Object.assign(JQ(t),ZQ(t)),eee=t=>t!=null;class WL{trace(){}debug(){}info(){}warn(){}error(){}}function vr(t,e,r){let n,s,i;if(typeof e>"u"&&typeof r>"u")n={},i=t;else{if(n=t,typeof e=="function")return s=e,i=r,tee(n,s,i);i=e}for(const o of Object.keys(i)){if(!Array.isArray(i[o])){n[o]=i[o];continue}KL(n,null,i,o)}return n}const Ye=(t,e)=>{const r={};for(const n in e)KL(r,t,e,n);return r},tee=(t,e,r)=>vr(t,Object.entries(r).reduce((n,[s,i])=>(Array.isArray(i)?n[s]=i:typeof i=="function"?n[s]=[e,i()]:n[s]=[e,i],n),{})),KL=(t,e,r,n)=>{if(e!==null){let o=r[n];typeof o=="function"&&(o=[,o]);const[a=ree,l=nee,c=n]=o;(typeof a=="function"&&a(e[c])||typeof a!="function"&&a)&&(t[n]=l(e[c]));return}let[s,i]=r[n];if(typeof i=="function"){let o;const a=s===void 0&&(o=i())!=null,l=typeof s=="function"&&!!s(void 0)||typeof s!="function"&&!!s;a?t[n]=o:l&&(t[n]=i())}else{const o=s===void 0&&i!=null,a=typeof s=="function"&&!!s(i)||typeof s!="function"&&!!s;(o||a)&&(t[n]=i)}},ree=t=>t!=null,nee=t=>t,Fk=t=>{if(t!==t)return"NaN";switch(t){case 1/0:return"Infinity";case-1/0:return"-Infinity";default:return t}},et=t=>{if(t==null)return{};if(Array.isArray(t))return t.filter(e=>e!=null).map(et);if(typeof t=="object"){const e={};for(const r of Object.keys(t))t[r]!=null&&(e[r]=et(t[r]));return e}return t},Xn=t=>{if(t!=null)return typeof t=="object"&&"__type"in t&&delete t.__type,HQ(t)},see=(t,e)=>EL(t,e).then(r=>e.utf8Encoder(r)),bn=(t,e)=>see(t,e).then(r=>{if(r.length)try{return JSON.parse(r)}catch(n){throw n?.name==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:r}),n}return{}}),iee=async(t,e)=>{const r=await bn(t,e);return r.message=r.message??r.Message,r},oee=(t,e)=>{const r=(i,o)=>Object.keys(i).find(a=>a.toLowerCase()===o.toLowerCase()),n=i=>{let o=i;return typeof o=="number"&&(o=o.toString()),o.indexOf(",")>=0&&(o=o.split(",")[0]),o.indexOf(":")>=0&&(o=o.split(":")[0]),o.indexOf("#")>=0&&(o=o.split("#")[1]),o},s=r(t.headers,"x-amzn-errortype");if(s!==void 0)return n(t.headers[s]);if(e.code!==void 0)return n(e.code);if(e.__type!==void 0)return n(e.__type)},aee=/\d{12}\.ddb/;async function lee(t,e,r){if(r.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&ls(t,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const i=await e.retryStrategy();typeof i.acquireInitialRetryToken=="function"?i.constructor?.name?.includes("Adaptive")?ls(t,"RETRY_MODE_ADAPTIVE","F"):ls(t,"RETRY_MODE_STANDARD","E"):ls(t,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const i=t.endpointV2;switch(String(i?.url?.hostname).match(aee)&&ls(t,"ACCOUNT_ID_ENDPOINT","O"),await e.accountIdEndpointMode?.()){case"disabled":ls(t,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":ls(t,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":ls(t,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=t.__smithy_context?.selectedHttpAuthScheme?.identity;if(s?.$source){const i=s;i.accountId&&ls(t,"RESOLVED_ACCOUNT_ID","T");for(const[o,a]of Object.entries(i.$source??{}))ls(t,o,a)}}const jk="user-agent",uy="x-amz-user-agent",$k=" ",dy="/",cee=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,uee=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,Uk="-",dee=1024;function hee(t){let e="";for(const r in t){const n=t[r];if(e.length+n.length+1<=dee){e.length?e+=","+n:e+=n;continue}break}return e}const fee=t=>(e,r)=>async n=>{const{request:s}=n;if(!vn.isInstance(s))return e(n);const{headers:i}=s,o=r?.userAgent?.map(zh)||[],a=(await t.defaultUserAgentProvider()).map(zh);await lee(r,t,n);const l=r;a.push(`m/${hee(Object.assign({},r.__smithy_context?.features,l.__aws_sdk_context?.features))}`);const c=t?.customUserAgent?.map(zh)||[],u=await t.userAgentAppId();u&&a.push(zh([`app/${u}`]));const d=[].concat([...a,...o,...c]).join($k),h=[...a.filter(f=>f.startsWith("aws-sdk-")),...c].join($k);return t.runtime!=="browser"?(h&&(i[uy]=i[uy]?`${i[jk]} ${h}`:h),i[jk]=d):i[uy]=d,e({...n,request:s})},zh=t=>{const e=t[0].split(dy).map(o=>o.replace(cee,Uk)).join(dy),r=t[1]?.replace(uee,Uk),n=e.indexOf(dy),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,r].filter(o=>o&&o.length>0).reduce((o,a,l)=>{switch(l){case 0:return a;case 1:return`${o}/${a}`;default:return`${o}#${a}`}},"")},pee={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},mee=t=>({applyToStack:e=>{e.add(fee(t),pee)}});var Hk;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(Hk||(Hk={}));const gee=!1,vee=!1,qL=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),Vk=t=>qL(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,yee=t=>{const{region:e,useFipsEndpoint:r}=t;if(!e)throw new Error("Region is missing");return Object.assign(t,{region:async()=>{if(typeof e=="string")return Vk(e);const n=await e();return Vk(n)},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return qL(n)?!0:typeof r!="function"?Promise.resolve(!!r):r()}})},_ee=t=>Object.assign(t,{eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),Gk="content-length";function bee(t){return e=>async r=>{const n=r.request;if(vn.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(o=>o.toLowerCase()).indexOf(Gk)===-1)try{const o=t(s);n.headers={...n.headers,[Gk]:String(o)}}catch{}}return e({...r,request:n})}}const wee={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},xee=t=>({applyToStack:e=>{e.add(bee(t.bodyLengthChecker),wee)}}),See=async t=>{const e=t?.Bucket||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),Aee(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!Tee(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},Eee=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,Cee=/(\d+\.){3}\d+/,kee=/\.\./,Tee=t=>Eee.test(t)&&!Cee.test(t)&&!kee.test(t),Aee=t=>{const[e,r,n,,,s]=t.split(":"),i=e==="arn"&&t.split(":").length>=6,o=!!(i&&r&&n&&s);if(i&&!o)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return o},Ree=(t,e,r)=>{const n=async()=>{const s=r[t]??r[e];return typeof s=="function"?s():s};return t==="credentialScope"||e==="CredentialScope"?async()=>{const s=typeof r.credentials=="function"?await r.credentials():r.credentials;return s?.credentialScope??s?.CredentialScope}:t==="accountId"||e==="AccountId"?async()=>{const s=typeof r.credentials=="function"?await r.credentials():r.credentials;return s?.accountId??s?.AccountId}:t==="endpoint"||e==="endpoint"?async()=>{const s=await n();if(s&&typeof s=="object"){if("url"in s)return s.url.href;if("hostname"in s){const{protocol:i,hostname:o,port:a,path:l}=s;return`${i}//${o}${a?":"+a:""}${l}`}}return s}:n},JL=async t=>{};function Pee(t){const e={};if(t=t.replace(/^\?/,""),t)for(const r of t.split("&")){let[n,s=null]=r.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Xp=t=>{if(typeof t=="string")return Xp(new URL(t));const{hostname:e,pathname:r,port:n,protocol:s,search:i}=t;let o;return i&&(o=Pee(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:r,query:o}},YL=t=>typeof t=="object"?"url"in t?Xp(t.url):t:Xp(t),Iee=async(t,e,r,n)=>{if(!r.endpoint){let o;r.serviceConfiguredEndpoint?o=await r.serviceConfiguredEndpoint():o=await JL(r.serviceId),o&&(r.endpoint=()=>Promise.resolve(YL(o)))}const s=await Oee(t,e,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(s,n)},Oee=async(t,e,r)=>{const n={},s=e?.getEndpointParameterInstructions?.()||{};for(const[i,o]of Object.entries(s))switch(o.type){case"staticContextParams":n[i]=o.value;break;case"contextParams":n[i]=t[o.name];break;case"clientContextParams":case"builtInParams":n[i]=await Ree(o.name,i,r)();break;case"operationContextParams":n[i]=o.get(t);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(o))}return Object.keys(s).length===0&&Object.assign(n,r),String(r.serviceId).toLowerCase()==="s3"&&await See(n),n},Dee=({config:t,instructions:e})=>(r,n)=>async s=>{t.endpoint&&wX(n,"ENDPOINT_OVERRIDE","N");const i=await Iee(s.input,{getEndpointParameterInstructions(){return e}},{...t},n);n.endpointV2=i,n.authSchemes=i.properties?.authSchemes;const o=n.authSchemes?.[0];if(o){n.signing_region=o.signingRegion,n.signing_service=o.signingName;const l=mg(n)?.selectedHttpAuthScheme?.httpAuthOption;l&&(l.signingProperties=Object.assign(l.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return r({...s})},Mee={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:Mx.name},Hx=(t,e)=>({applyToStack:r=>{r.addRelativeTo(Dee({config:t,instructions:e}),Mee)}}),Lee=t=>{const e=t.tls??!0,{endpoint:r,useDualstackEndpoint:n,useFipsEndpoint:s}=t,i=r!=null?async()=>YL(await Ji(r)()):void 0,a=Object.assign(t,{endpoint:i,tls:e,isCustomEndpoint:!!r,useDualstackEndpoint:Ji(n??!1),useFipsEndpoint:Ji(s??!1)});let l;return a.serviceConfiguredEndpoint=async()=>(t.serviceId&&!l&&(l=JL(t.serviceId)),l),a};var jl;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(jl||(jl={}));const Qp=3,Nee=jl.STANDARD,Bee=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],Fee=["TimeoutError","RequestTimeout","RequestTimeoutException"],jee=[500,502,503,504],$ee=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],Uee=t=>t.$metadata?.clockSkewCorrected,ZL=t=>t.$metadata?.httpStatusCode===429||Bee.includes(t.name)||t.$retryable?.throttling==!0,Vx=(t,e=0)=>Uee(t)||Fee.includes(t.name)||$ee.includes(t?.code||"")||jee.includes(t.$metadata?.httpStatusCode||0)||t.cause!==void 0&&e<=10&&Vx(t.cause,e+1),Hee=t=>{if(t.$metadata?.httpStatusCode!==void 0){const e=t.$metadata.httpStatusCode;return 500<=e&&e<=599&&!Vx(t)}return!1};class yg{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;const r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const r=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>yg.setTimeoutFn(n,r))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const r=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=e}updateClientSendingRate(e){let r;if(this.updateMeasuredRate(),ZL(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),r=Math.floor(e*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){const n=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(e){return parseFloat(e.toFixed(8))}}yg.setTimeoutFn=setTimeout;const O_=100,XL=20*1e3,Vee=500,zk=500,Gee=5,zee=10,Wee=1,Kee="amz-sdk-invocation-id",qee="amz-sdk-request",Jee=()=>{let t=O_;return{computeNextBackoffDelay:n=>Math.floor(Math.min(XL,Math.random()*2**n*t)),setDelayBase:n=>{t=n}}},Wk=({retryDelay:t,retryCount:e,retryCost:r})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(XL,t),getRetryCost:()=>r});class QL{constructor(e){this.maxAttempts=e,this.mode=jl.STANDARD,this.capacity=zk,this.retryBackoffStrategy=Jee(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return Wk({retryDelay:O_,retryCount:0})}async refreshRetryTokenForRetry(e,r){const n=await this.getMaxAttempts();if(this.shouldRetry(e,r,n)){const s=r.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?Vee:O_);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),o=r.retryAfterHint?Math.max(r.retryAfterHint.getTime()-Date.now()||0,i):i,a=this.getCapacityCost(s);return this.capacity-=a,Wk({retryDelay:o,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(zk,this.capacity+(e.getRetryCost()??Wee))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Qp}`),Qp}}shouldRetry(e,r,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(r.errorType)&&this.isRetryableError(r.errorType)}getCapacityCost(e){return e==="TRANSIENT"?zee:Gee}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class Yee{constructor(e,r){this.maxAttemptsProvider=e,this.mode=jl.ADAPTIVE;const{rateLimiter:n}=r??{};this.rateLimiter=n??new yg,this.standardRetryStrategy=new QL(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(e,r)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}let Wh;const Zee=new Uint8Array(16);function Xee(){if(!Wh&&(Wh=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Wh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Wh(Zee)}const ar=[];for(let t=0;t<256;++t)ar.push((t+256).toString(16).slice(1));function Qee(t,e=0){return ar[t[e+0]]+ar[t[e+1]]+ar[t[e+2]]+ar[t[e+3]]+"-"+ar[t[e+4]]+ar[t[e+5]]+"-"+ar[t[e+6]]+ar[t[e+7]]+"-"+ar[t[e+8]]+ar[t[e+9]]+"-"+ar[t[e+10]]+ar[t[e+11]]+ar[t[e+12]]+ar[t[e+13]]+ar[t[e+14]]+ar[t[e+15]]}const ete=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Kk={randomUUID:ete};function tte(t,e,r){if(Kk.randomUUID&&!t)return Kk.randomUUID();t=t||{};const n=t.random||(t.rng||Xee)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Qee(n)}const rte=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),nte=t=>{const{retryStrategy:e,retryMode:r,maxAttempts:n}=t,s=Ji(n??Qp);return Object.assign(t,{maxAttempts:s,retryStrategy:async()=>e||(await Ji(r)()===jl.ADAPTIVE?new Yee(s):new QL(s))})},ste=t=>t?.body instanceof ReadableStream,ite=t=>(e,r)=>async n=>{let s=await t.retryStrategy();const i=await t.maxAttempts();if(ote(s)){s=s;let o=await s.acquireInitialRetryToken(r.partition_id),a=new Error,l=0,c=0;const{request:u}=n,d=vn.isInstance(u);for(d&&(u.headers[Kee]=tte());;)try{d&&(u.headers[qee]=`attempt=${l+1}; max=${i}`);const{response:h,output:f}=await e(n);return s.recordSuccess(o),f.$metadata.attempts=l+1,f.$metadata.totalRetryDelay=c,{response:h,output:f}}catch(h){const f=ate(h);if(a=rte(h),d&&ste(u))throw(r.logger instanceof WL?console:r.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{o=await s.refreshRetryTokenForRetry(o,f)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=l+1,a.$metadata.totalRetryDelay=c,a}l=o.getRetryCount();const v=o.getRetryDelay();c+=v,await new Promise(m=>setTimeout(m,v))}}else return s=s,s?.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},ote=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",ate=t=>{const e={error:t,errorType:lte(t)},r=dte(t.$response);return r&&(e.retryAfterHint=r),e},lte=t=>ZL(t)?"THROTTLING":Vx(t)?"TRANSIENT":Hee(t)?"SERVER_ERROR":"CLIENT_ERROR",cte={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},ute=t=>({applyToStack:e=>{e.add(ite(t),cte)}}),dte=t=>{if(!Jp.isInstance(t))return;const e=Object.keys(t.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const r=t.headers[e],n=Number(r);return Number.isNaN(n)?new Date(r):new Date(n*1e3)},hte=async(t,e,r)=>({operation:mg(e).operation,region:await Ji(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function fte(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"bedrock",region:t.region},propertiesExtractor:(e,r)=>({signingProperties:{config:e,context:r}})}}const pte=t=>{const e=[];switch(t.operation){default:e.push(fte(t))}return e},mte=t=>{const e=OQ(t);return Object.assign(e,{})},gte=t=>Object.assign(t,{useDualstackEndpoint:t.useDualstackEndpoint??!1,useFipsEndpoint:t.useFipsEndpoint??!1,defaultSigningName:"bedrock"}),Gx={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},vte="3.778.0",yte={version:vte},_te=t=>new TextEncoder().encode(t);var bte=typeof Ht<"u"&&Ht.from?function(t){return Ht.from(t,"utf8")}:_te;function fd(t){return t instanceof Uint8Array?t:typeof t=="string"?bte(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function D_(t){return typeof t=="string"?t.length===0:t.byteLength===0}function wte(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),r=0;r<t.length;)e[r]=t[r],r+=1;return e}return Uint32Array.from(t)}var eN={name:"SHA-256"},qk={name:"HMAC",hash:eN},xte=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const Ste={};function jf(){return typeof window<"u"?window:typeof self<"u"?self:Ste}var Ete=function(){function t(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return t.prototype.update=function(e){if(!D_(e)){var r=fd(e),n=new Uint8Array(this.toHash.byteLength+r.byteLength);n.set(this.toHash,0),n.set(r,this.toHash.byteLength),this.toHash=n}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(r){return jf().crypto.subtle.sign(qk,r,e.toHash).then(function(n){return new Uint8Array(n)})}):D_(this.toHash)?Promise.resolve(xte):Promise.resolve().then(function(){return jf().crypto.subtle.digest(eN,e.toHash)}).then(function(r){return Promise.resolve(new Uint8Array(r))})},t.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(r,n){jf().crypto.subtle.importKey("raw",fd(e.secret),qk,!1,["sign"]).then(r,n)}),this.key.catch(function(){}))},t}(),ws=function(){return ws=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ws.apply(this,arguments)};function tN(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function Cte(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(d){o(d)}}function l(u){try{c(n.throw(u))}catch(d){o(d)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})}function kte(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(n=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,s=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(u){c=[6,u],s=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Tte(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ate(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var Rn=64,Rte=32,Pte=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ite=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Ote=Math.pow(2,53)-1,$f=function(){function t(){this.state=Int32Array.from(Ite),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>Ote)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[r++],n--,this.bufferLength===Rn&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%Rn>=Rn-8){for(var s=this.bufferLength;s<Rn;s++)r.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Rn-8;s++)r.setUint8(s,0);r.setUint32(Rn-8,Math.floor(e/4294967296),!0),r.setUint32(Rn-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(Rte),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},t.prototype.hashBuffer=function(){for(var e=this,r=e.buffer,n=e.state,s=n[0],i=n[1],o=n[2],a=n[3],l=n[4],c=n[5],u=n[6],d=n[7],h=0;h<Rn;h++){if(h<16)this.temp[h]=(r[h*4]&255)<<24|(r[h*4+1]&255)<<16|(r[h*4+2]&255)<<8|r[h*4+3]&255;else{var f=this.temp[h-2],v=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[h-15];var m=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(v+this.temp[h-7]|0)+(m+this.temp[h-16]|0)}var p=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&c^~l&u)|0)+(d+(Pte[h]+this.temp[h]|0)|0)|0,g=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&o^i&o)|0;d=u,u=c,c=l,l=a+p|0,a=o,o=i,i=s,s=p+g|0}n[0]+=s,n[1]+=i,n[2]+=o,n[3]+=a,n[4]+=l,n[5]+=c,n[6]+=u,n[7]+=d},t}(),Dte=function(){function t(e){this.secret=e,this.hash=new $f,this.reset()}return t.prototype.update=function(e){if(!(D_(e)||this.error))try{this.hash.update(fd(e))}catch(r){this.error=r}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return Cte(this,void 0,void 0,function(){return kte(this,function(e){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new $f,this.secret){this.outer=new $f;var e=Mte(this.secret),r=new Uint8Array(Rn);r.set(e);for(var n=0;n<Rn;n++)e[n]^=54,r[n]^=92;this.hash.update(e),this.outer.update(r);for(var n=0;n<e.byteLength;n++)e[n]=0}},t}();function Mte(t){var e=fd(t);if(e.byteLength>Rn){var r=new $f;r.update(e),e=r.digest()}var n=new Uint8Array(Rn);return n.set(e),n}var Lte=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function Nte(t){if(Bte(t)&&typeof t.crypto.subtle=="object"){var e=t.crypto.subtle;return Fte(e)}return!1}function Bte(t){if(typeof t=="object"&&typeof t.crypto=="object"){var e=t.crypto.getRandomValues;return typeof e=="function"}return!1}function Fte(t){return t&&Lte.every(function(e){return typeof t[e]=="function"})}var jte=function(){function t(e){Nte(jf())?this.hash=new Ete(e):this.hash=new Dte(e)}return t.prototype.update=function(e,r){this.hash.update(fd(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}();const $te={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},rN={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Bt={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Mr={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Li={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class Se{static getFirstMatch(e,r){const n=r.match(e);return n&&n.length>0&&n[1]||""}static getSecondMatch(e,r){const n=r.match(e);return n&&n.length>1&&n[2]||""}static matchAndReturnConst(e,r,n){if(e.test(r))return n}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const r=e.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const r=e.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5)){if(r[0]===1&&r[1]<6)return"Cupcake";if(r[0]===1&&r[1]>=6)return"Donut";if(r[0]===2&&r[1]<2)return"Eclair";if(r[0]===2&&r[1]===2)return"Froyo";if(r[0]===2&&r[1]>2)return"Gingerbread";if(r[0]===3)return"Honeycomb";if(r[0]===4&&r[1]<1)return"Ice Cream Sandwich";if(r[0]===4&&r[1]<4)return"Jelly Bean";if(r[0]===4&&r[1]>=4)return"KitKat";if(r[0]===5)return"Lollipop";if(r[0]===6)return"Marshmallow";if(r[0]===7)return"Nougat";if(r[0]===8)return"Oreo";if(r[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,r,n=!1){const s=Se.getVersionPrecision(e),i=Se.getVersionPrecision(r);let o=Math.max(s,i),a=0;const l=Se.map([e,r],c=>{const u=o-Se.getVersionPrecision(c),d=c+new Array(u+1).join(".0");return Se.map(d.split("."),h=>new Array(20-h.length).join("0")+h).reverse()});for(n&&(a=o-Math.min(s,i)),o-=1;o>=a;){if(l[0][o]>l[1][o])return 1;if(l[0][o]===l[1][o]){if(o===a)return 0;o-=1}else if(l[0][o]<l[1][o])return-1}}static map(e,r){const n=[];let s;if(Array.prototype.map)return Array.prototype.map.call(e,r);for(s=0;s<e.length;s+=1)n.push(r(e[s]));return n}static find(e,r){let n,s;if(Array.prototype.find)return Array.prototype.find.call(e,r);for(n=0,s=e.length;n<s;n+=1){const i=e[n];if(r(i,n))return i}}static assign(e,...r){const n=e;let s,i;if(Object.assign)return Object.assign(e,...r);for(s=0,i=r.length;s<i;s+=1){const o=r[s];typeof o=="object"&&o!==null&&Object.keys(o).forEach(l=>{n[l]=o[l]})}return e}static getBrowserAlias(e){return $te[e]}static getBrowserTypeByAlias(e){return rN[e]||""}}const vt=/version\/(\d+(\.?_?\d+)+)/i,Ute=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},r=Se.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},r=Se.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},r=Se.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},r=Se.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},r=Se.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},r=Se.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},r=Se.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},r=Se.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=Se.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},r=Se.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},r=Se.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},r=Se.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},r=Se.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},r=Se.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},r=Se.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(e.version=r),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},r=Se.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},r=Se.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},r=Se.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},r=Se.getFirstMatch(vt,t)||Se.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},r=Se.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},r=Se.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},r=Se.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},r=Se.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},r=Se.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},r=Se.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},r=Se.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},r=Se.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},r=Se.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e={name:"Android Browser"},r=Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},r=Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},r=Se.getFirstMatch(vt,t);return r&&(e.version=r),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,r=/^(.*)\/(.*)[ \t]\((.*)/,s=t.search("\\(")!==-1?r:e;return{name:Se.getFirstMatch(s,t),version:Se.getSecondMatch(s,t)}}}],Hte=[{test:[/Roku\/DVP/],describe(t){const e=Se.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:Mr.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=Se.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:Mr.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=Se.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=Se.getWindowsVersionName(e);return{name:Mr.Windows,version:e,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:Mr.iOS},r=Se.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(e.version=r),e}},{test:[/macintosh/i],describe(t){const e=Se.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=Se.getMacOSVersionName(e),n={name:Mr.MacOS,version:e};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=Se.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:Mr.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e=Se.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=Se.getAndroidVersionName(e),n={name:Mr.Android,version:e};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=Se.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:Mr.WebOS};return e&&e.length&&(r.version=e),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=Se.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||Se.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||Se.getFirstMatch(/\bbb(\d+)/i,t);return{name:Mr.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=Se.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:Mr.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=Se.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:Mr.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:Mr.Linux}}},{test:[/CrOS/],describe(){return{name:Mr.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=Se.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:Mr.PlayStation4,version:e}}}],Vte=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=Se.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:Bt.mobile,vendor:"Huawei"};return e&&(r.model=e),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:Bt.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:Bt.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:Bt.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:Bt.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:Bt.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:Bt.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return e&&!r},describe(t){const e=Se.getFirstMatch(/(ipod|iphone)/i,t);return{type:Bt.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:Bt.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:Bt.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:Bt.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:Bt.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:Bt.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:Bt.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:Bt.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:Bt.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:Bt.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:Bt.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:Bt.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:Bt.tv}}}],Gte=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:Li.Blink};const r=Se.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Li.EdgeHTML,version:r}}},{test:[/trident/i],describe(t){const e={name:Li.Trident},r=Se.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:Li.Presto},r=Se.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=t.test(/gecko/i),r=t.test(/like gecko/i);return e&&!r},describe(t){const e={name:Li.Gecko},r=Se.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:Li.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:Li.WebKit},r=Se.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}}];let Jk=class{constructor(e,r=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=Se.find(Ute,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=Se.find(Hte,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:r}=this.getOS();return e?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:r}=this.getPlatform();return e?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const e=Se.find(Vte,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=Se.find(Gte,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return Se.assign({},this.parsedResult)}satisfies(e){const r={};let n=0;const s={};let i=0;if(Object.keys(e).forEach(a=>{const l=e[a];typeof l=="string"?(s[a]=l,i+=1):typeof l=="object"&&(r[a]=l,n+=1)}),n>0){const a=Object.keys(r),l=Se.find(a,u=>this.isOS(u));if(l){const u=this.satisfies(r[l]);if(u!==void 0)return u}const c=Se.find(a,u=>this.isPlatform(u));if(c){const u=this.satisfies(r[c]);if(u!==void 0)return u}}if(i>0){const a=Object.keys(s),l=Se.find(a,c=>this.isBrowser(c,!0));if(l!==void 0)return this.compareVersion(s[l])}}isBrowser(e,r=!1){const n=this.getBrowserName().toLowerCase();let s=e.toLowerCase();const i=Se.getBrowserTypeByAlias(s);return r&&i&&(s=i.toLowerCase()),s===n}compareVersion(e){let r=[0],n=e,s=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(n=e.substr(1),e[1]==="="?(s=!0,n=e.substr(2)):r=[],e[0]===">"?r.push(1):r.push(-1)):e[0]==="="?n=e.substr(1):e[0]==="~"&&(s=!0,n=e.substr(1)),r.indexOf(Se.compareVersions(i,n,s))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,r=!1){return this.isBrowser(e,r)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(r=>this.is(r))}};/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class nN{static getParser(e,r=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new Jk(e,r)}static parse(e){return new Jk(e).getResult()}static get BROWSER_MAP(){return rN}static get ENGINE_MAP(){return Li}static get OS_MAP(){return Mr}static get PLATFORMS_MAP(){return Bt}}const zte=({serviceId:t,clientVersion:e})=>async r=>{const n=typeof window<"u"&&window?.navigator?.userAgent?nN.parse(window.navigator.userAgent):void 0,s=[["aws-sdk-js",e],["ua","2.1"],[`os/${n?.os?.name||"other"}`,n?.os?.version],["lang/js"],["md/browser",`${n?.browser?.name??"unknown"}_${n?.browser?.version??"unknown"}`]];t&&s.push([`api/${t}`,e]);const i=await r?.userAgentAppId?.();return i&&s.push([`app/${i}`]),s};var sN=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var r,n;try{for(var s=Tte(e),i=s.next();!i.done;i=s.next()){var o=i.value;this.checksum=this.checksum>>>8^Kte[(this.checksum^o)&255]}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),Wte=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],Kte=wte(Wte);class fu{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)r[n]=s;return e<0&&Yk(r),new fu(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&Yk(e),parseInt(cn(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}}function Yk(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class qte{constructor(e,r){this.toUtf8=e,this.fromUtf8=r}format(e){const r=[];for(const i of Object.keys(e)){const o=this.fromUtf8(i);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const n=new Uint8Array(r.reduce((i,o)=>i+o.byteLength,0));let s=0;for(const i of r)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=this.fromUtf8(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(fu.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!nre.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const d=new Uint8Array(17);return d[0]=9,d.set(SL(e.value.replace(/\-/g,"")),1),d}}parse(e){const r={};let n=0;for(;n<e.byteLength;){const s=e.getUint8(n++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,s));switch(n+=s,e.getUint8(n++)){case 0:r[i]={type:Xk,value:!0};break;case 1:r[i]={type:Xk,value:!1};break;case 2:r[i]={type:Jte,value:e.getInt8(n++)};break;case 3:r[i]={type:Yte,value:e.getInt16(n,!1)},n+=2;break;case 4:r[i]={type:Zte,value:e.getInt32(n,!1)},n+=4;break;case 5:r[i]={type:Xte,value:new fu(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:const o=e.getUint16(n,!1);n+=2,r[i]={type:Qte,value:new Uint8Array(e.buffer,e.byteOffset+n,o)},n+=o;break;case 7:const a=e.getUint16(n,!1);n+=2,r[i]={type:ere,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,a))},n+=a;break;case 8:r[i]={type:tre,value:new Date(new fu(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:const l=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,r[i]={type:rre,value:`${cn(l.subarray(0,4))}-${cn(l.subarray(4,6))}-${cn(l.subarray(6,8))}-${cn(l.subarray(8,10))}-${cn(l.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return r}}var Zk;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(Zk||(Zk={}));const Xk="boolean",Jte="byte",Yte="short",Zte="integer",Xte="long",Qte="binary",ere="string",tre="timestamp",rre="uuid",nre=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,iN=4,Ni=iN*2,Bo=4,sre=Ni+Bo*2;function ire({byteLength:t,byteOffset:e,buffer:r}){if(t<sre)throw new Error("Provided message too short to accommodate event stream message overhead");const n=new DataView(r,e,t),s=n.getUint32(0,!1);if(t!==s)throw new Error("Reported message length does not match received message length");const i=n.getUint32(iN,!1),o=n.getUint32(Ni,!1),a=n.getUint32(t-Bo,!1),l=new sN().update(new Uint8Array(r,e,Ni));if(o!==l.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${l.digest()})`);if(l.update(new Uint8Array(r,e+Ni,t-(Ni+Bo))),a!==l.digest())throw new Error(`The message checksum (${l.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(r,e+Ni+Bo,i),body:new Uint8Array(r,e+Ni+Bo+i,s-i-(Ni+Bo+Bo))}}class ore{constructor(e,r){this.headerMarshaller=new qte(e,r),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),r=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return r}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const r=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return r}}}encode({headers:e,body:r}){const n=this.headerMarshaller.format(e),s=n.byteLength+r.byteLength+16,i=new Uint8Array(s),o=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new sN;return o.setUint32(0,s,!1),o.setUint32(4,n.byteLength,!1),o.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(n,12),i.set(r,n.byteLength+12),o.setUint32(s-4,a.update(i.subarray(8,s-4)).digest(),!1),i}decode(e){const{headers:r,body:n}=ire(e);return{headers:this.headerMarshaller.parse(r),body:n}}formatHeaders(e){return this.headerMarshaller.format(e)}}class are{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class lre{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class cre{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const r=await this.options.deserializer(e);r!==void 0&&(yield r)}}}class ure{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}function dre(t){let e=0,r=0,n=null,s=null;const i=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,r=4,n=new Uint8Array(a),new DataView(n.buffer).setUint32(0,a,!1)},o=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:l,done:c}=await a.next();if(c){if(e)if(e===r)yield n;else throw new Error("Truncated event message received.");else return;return}const u=l.length;let d=0;for(;d<u;){if(!n){const f=u-d;s||(s=new Uint8Array(4));const v=Math.min(4-r,f);if(s.set(l.slice(d,d+v),r),r+=v,d+=v,r<4)break;i(new DataView(s.buffer).getUint32(0,!1)),s=null}const h=Math.min(e-r,u-d);n.set(l.slice(d,d+h),r),r+=h,d+=h,e&&e===r&&(yield n,n=null,e=0,r=0)}}};return{[Symbol.asyncIterator]:o}}function hre(t,e){return async function(r){const{value:n}=r.headers[":message-type"];if(n==="error"){const s=new Error(r.headers[":error-message"].value||"UnknownError");throw s.name=r.headers[":error-code"].value,s}else if(n==="exception"){const s=r.headers[":exception-type"].value,i={[s]:r},o=await t(i);if(o.$unknown){const a=new Error(e(r.body));throw a.name=s,a}throw o[s]}else if(n==="event"){const s={[r.headers[":event-type"].value]:r},i=await t(s);return i.$unknown?void 0:i}else throw Error(`Unrecognizable event type: ${r.headers[":event-type"].value}`)}}let fre=class{constructor({utf8Encoder:e,utf8Decoder:r}){this.eventStreamCodec=new ore(e,r),this.utfEncoder=e}deserialize(e,r){const n=dre(e);return new cre({messageStream:new are({inputStream:n,decoder:this.eventStreamCodec}),deserializer:hre(r,this.utfEncoder)})}serialize(e,r){return new lre({messageStream:new ure({inputStream:e,serializer:r}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const pre=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)return;yield n}}finally{e.releaseLock()}}}),mre=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(r){const{done:n,value:s}=await e.next();if(n)return r.close();r.enqueue(s)}})};class gre{constructor({utf8Encoder:e,utf8Decoder:r}){this.universalMarshaller=new fre({utf8Decoder:r,utf8Encoder:e})}deserialize(e,r){const n=vre(e)?pre(e):e;return this.universalMarshaller.deserialize(n,r)}serialize(e,r){const n=this.universalMarshaller.serialize(e,r);return typeof ReadableStream=="function"?mre(n):n}}const vre=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,yre=t=>new gre(t),_re=t=>()=>Promise.reject(t),Qk=typeof TextEncoder=="function"?new TextEncoder:null,bre=t=>{if(typeof t=="string"){if(Qk)return Qk.encode(t).byteLength;let e=t.length;for(let r=e-1;r>=0;r--){const n=t.charCodeAt(r);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&r--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},oN="required",xs="fn",Ss="argv",ac="ref",eT=!0,tT="isSet",pd="booleanEquals",Fa="error",Ec="endpoint",Dr="tree",zx="PartitionResult",rT={[oN]:!1,type:"String"},nT={[oN]:!0,default:!1,type:"Boolean"},sT={[ac]:"Endpoint"},aN={[xs]:pd,[Ss]:[{[ac]:"UseFIPS"},!0]},lN={[xs]:pd,[Ss]:[{[ac]:"UseDualStack"},!0]},cs={},iT={[xs]:"getAttr",[Ss]:[{[ac]:zx},"supportsFIPS"]},oT={[xs]:pd,[Ss]:[!0,{[xs]:"getAttr",[Ss]:[{[ac]:zx},"supportsDualStack"]}]},aT=[aN],lT=[lN],cT=[{[ac]:"Region"}],wre={parameters:{Region:rT,UseDualStack:nT,UseFIPS:nT,Endpoint:rT},rules:[{conditions:[{[xs]:tT,[Ss]:[sT]}],rules:[{conditions:aT,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Fa},{rules:[{conditions:lT,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Fa},{endpoint:{url:sT,properties:cs,headers:cs},type:Ec}],type:Dr}],type:Dr},{rules:[{conditions:[{[xs]:tT,[Ss]:cT}],rules:[{conditions:[{[xs]:"aws.partition",[Ss]:cT,assign:zx}],rules:[{conditions:[aN,lN],rules:[{conditions:[{[xs]:pd,[Ss]:[eT,iT]},oT],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:cs,headers:cs},type:Ec}],type:Dr}],type:Dr},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Fa}],type:Dr},{conditions:aT,rules:[{conditions:[{[xs]:pd,[Ss]:[iT,eT]}],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:cs,headers:cs},type:Ec}],type:Dr}],type:Dr},{error:"FIPS is enabled but this partition does not support FIPS",type:Fa}],type:Dr},{conditions:lT,rules:[{conditions:[oT],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:cs,headers:cs},type:Ec}],type:Dr}],type:Dr},{error:"DualStack is enabled but this partition does not support DualStack",type:Fa}],type:Dr},{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dnsSuffix}",properties:cs,headers:cs},type:Ec}],type:Dr}],type:Dr}],type:Dr},{error:"Invalid Configuration: Missing Region",type:Fa}],type:Dr}]},xre=wre,Sre=new PX({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),Ere=(t,e={})=>Sre.get(t,()=>JX(xre,{endpointParams:t,logger:e.logger}));Yp.aws=ML;const Cre=t=>({apiVersion:"2023-09-30",base64Decoder:t?.base64Decoder??Nx,base64Encoder:t?.base64Encoder??wL,disableHostPrefix:t?.disableHostPrefix??!1,endpointProvider:t?.endpointProvider??Ere,extensions:t?.extensions??[],httpAuthSchemeProvider:t?.httpAuthSchemeProvider??pte,httpAuthSchemes:t?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new iQ}],logger:t?.logger??new WL,serviceId:t?.serviceId??"Bedrock Runtime",urlParser:t?.urlParser??Xp,utf8Decoder:t?.utf8Decoder??Fl,utf8Encoder:t?.utf8Encoder??bL}),kre=["in-region","cross-region","mobile","standard","legacy"],Tre=({defaultsMode:t}={})=>oQ(async()=>{const e=typeof t=="function"?await t():t;switch(e?.toLowerCase()){case"auto":return Promise.resolve(Are()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${kre.join(", ")}, got ${e}`)}}),Are=()=>{const e=(typeof window<"u"&&window?.navigator?.userAgent?nN.parse(window.navigator.userAgent):void 0)?.platform?.type;return e==="tablet"||e==="mobile"},Rre=t=>{const e=Tre(t),r=()=>e().then(KQ),n=Cre(t);return{...n,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:t?.bodyLengthChecker??bre,credentialDefaultProvider:t?.credentialDefaultProvider??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:t?.defaultUserAgentProvider??zte({serviceId:n.serviceId,clientVersion:yte.version}),eventStreamSerdeProvider:t?.eventStreamSerdeProvider??yre,maxAttempts:t?.maxAttempts??Qp,region:t?.region??_re("Region is missing"),requestHandler:Bx.create(t?.requestHandler??r),retryMode:t?.retryMode??(async()=>(await r()).retryMode||Nee),sha256:t?.sha256??jte,streamCollector:t?.streamCollector??mX,useDualstackEndpoint:t?.useDualstackEndpoint??(()=>Promise.resolve(gee)),useFipsEndpoint:t?.useFipsEndpoint??(()=>Promise.resolve(vee))}},Pre=t=>({setRegion(e){t.region=e},region(){return t.region}}),Ire=t=>({region:t.region()}),Ore=t=>{const e=t.httpAuthSchemes;let r=t.httpAuthSchemeProvider,n=t.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(o=>o.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){r=s},httpAuthSchemeProvider(){return r},setCredentials(s){n=s},credentials(){return n}}},Dre=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),Mre=(t,e)=>{const r=Object.assign(Pre(t),XQ(t),BZ(t),Ore(t));return e.forEach(n=>n.configure(r)),Object.assign(t,Ire(r),QQ(r),FZ(r),Dre(r))};class Lre extends LQ{config;constructor(...[e]){const r=Rre(e||{});super(r),this.initConfig=r;const n=gte(r),s=RX(n),i=nte(s),o=yee(i),a=o,l=Lee(a),c=_ee(l),u=mte(c),d=Mre(u,e?.extensions||[]);this.config=d,this.middlewareStack.use(mee(this.config)),this.middlewareStack.use(ute(this.config)),this.middlewareStack.use(xee(this.config)),this.middlewareStack.use(HZ(this.config)),this.middlewareStack.use(zZ(this.config)),this.middlewareStack.use(YZ(this.config)),this.middlewareStack.use(eX(this.config,{httpAuthSchemeParametersProvider:hte,identityProviderConfigProvider:async h=>new xX({"aws.auth#sigv4":h.credentials})})),this.middlewareStack.use(lX(this.config))}destroy(){super.destroy()}}class Hr extends nl{constructor(e){super(e),Object.setPrototypeOf(this,Hr.prototype)}}class Wx extends Hr{name="AccessDeniedException";$fault="client";constructor(e){super({name:"AccessDeniedException",$fault:"client",...e}),Object.setPrototypeOf(this,Wx.prototype)}}var uT;(function(t){t.visit=(e,r)=>e.s3OutputDataConfig!==void 0?r.s3OutputDataConfig(e.s3OutputDataConfig):r._(e.$unknown[0],e.$unknown[1])})(uT||(uT={}));class Kx extends Hr{name="InternalServerException";$fault="server";constructor(e){super({name:"InternalServerException",$fault:"server",...e}),Object.setPrototypeOf(this,Kx.prototype)}}class qx extends Hr{name="ThrottlingException";$fault="client";constructor(e){super({name:"ThrottlingException",$fault:"client",...e}),Object.setPrototypeOf(this,qx.prototype)}}class Jx extends Hr{name="ValidationException";$fault="client";constructor(e){super({name:"ValidationException",$fault:"client",...e}),Object.setPrototypeOf(this,Jx.prototype)}}class Yx extends Hr{name="ConflictException";$fault="client";constructor(e){super({name:"ConflictException",$fault:"client",...e}),Object.setPrototypeOf(this,Yx.prototype)}}class Zx extends Hr{name="ResourceNotFoundException";$fault="client";constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),Object.setPrototypeOf(this,Zx.prototype)}}class Xx extends Hr{name="ServiceQuotaExceededException";$fault="client";constructor(e){super({name:"ServiceQuotaExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,Xx.prototype)}}class Qx extends Hr{name="ServiceUnavailableException";$fault="server";constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),Object.setPrototypeOf(this,Qx.prototype)}}var dT;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(dT||(dT={}));var hT;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):r._(e.$unknown[0],e.$unknown[1])})(hT||(hT={}));var M_;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(M_||(M_={}));var L_;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(L_||(L_={}));var N_;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):r._(e.$unknown[0],e.$unknown[1])})(N_||(N_={}));var B_;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(B_||(B_={}));var F_;(function(t){t.visit=(e,r)=>e.reasoningText!==void 0?r.reasoningText(e.reasoningText):e.redactedContent!==void 0?r.redactedContent(e.redactedContent):r._(e.$unknown[0],e.$unknown[1])})(F_||(F_={}));var j_;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):e.s3Location!==void 0?r.s3Location(e.s3Location):r._(e.$unknown[0],e.$unknown[1])})(j_||(j_={}));var $_;(function(t){t.visit=(e,r)=>e.json!==void 0?r.json(e.json):e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):e.document!==void 0?r.document(e.document):e.video!==void 0?r.video(e.video):r._(e.$unknown[0],e.$unknown[1])})($_||($_={}));var U_;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):e.document!==void 0?r.document(e.document):e.video!==void 0?r.video(e.video):e.toolUse!==void 0?r.toolUse(e.toolUse):e.toolResult!==void 0?r.toolResult(e.toolResult):e.guardContent!==void 0?r.guardContent(e.guardContent):e.reasoningContent!==void 0?r.reasoningContent(e.reasoningContent):r._(e.$unknown[0],e.$unknown[1])})(U_||(U_={}));var fT;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):r._(e.$unknown[0],e.$unknown[1])})(fT||(fT={}));var H_;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.guardContent!==void 0?r.guardContent(e.guardContent):r._(e.$unknown[0],e.$unknown[1])})(H_||(H_={}));var pT;(function(t){t.visit=(e,r)=>e.auto!==void 0?r.auto(e.auto):e.any!==void 0?r.any(e.any):e.tool!==void 0?r.tool(e.tool):r._(e.$unknown[0],e.$unknown[1])})(pT||(pT={}));var V_;(function(t){t.visit=(e,r)=>e.json!==void 0?r.json(e.json):r._(e.$unknown[0],e.$unknown[1])})(V_||(V_={}));var G_;(function(t){t.visit=(e,r)=>e.toolSpec!==void 0?r.toolSpec(e.toolSpec):r._(e.$unknown[0],e.$unknown[1])})(G_||(G_={}));var mT;(function(t){t.visit=(e,r)=>e.message!==void 0?r.message(e.message):r._(e.$unknown[0],e.$unknown[1])})(mT||(mT={}));class eS extends Hr{name="ModelErrorException";$fault="client";originalStatusCode;resourceName;constructor(e){super({name:"ModelErrorException",$fault:"client",...e}),Object.setPrototypeOf(this,eS.prototype),this.originalStatusCode=e.originalStatusCode,this.resourceName=e.resourceName}}class tS extends Hr{name="ModelNotReadyException";$fault="client";$retryable={};constructor(e){super({name:"ModelNotReadyException",$fault:"client",...e}),Object.setPrototypeOf(this,tS.prototype)}}class rS extends Hr{name="ModelTimeoutException";$fault="client";constructor(e){super({name:"ModelTimeoutException",$fault:"client",...e}),Object.setPrototypeOf(this,rS.prototype)}}var gT;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.redactedContent!==void 0?r.redactedContent(e.redactedContent):e.signature!==void 0?r.signature(e.signature):r._(e.$unknown[0],e.$unknown[1])})(gT||(gT={}));var vT;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.toolUse!==void 0?r.toolUse(e.toolUse):e.reasoningContent!==void 0?r.reasoningContent(e.reasoningContent):r._(e.$unknown[0],e.$unknown[1])})(vT||(vT={}));var yT;(function(t){t.visit=(e,r)=>e.toolUse!==void 0?r.toolUse(e.toolUse):r._(e.$unknown[0],e.$unknown[1])})(yT||(yT={}));class nS extends Hr{name="ModelStreamErrorException";$fault="client";originalStatusCode;originalMessage;constructor(e){super({name:"ModelStreamErrorException",$fault:"client",...e}),Object.setPrototypeOf(this,nS.prototype),this.originalStatusCode=e.originalStatusCode,this.originalMessage=e.originalMessage}}var _T;(function(t){t.visit=(e,r)=>e.messageStart!==void 0?r.messageStart(e.messageStart):e.contentBlockStart!==void 0?r.contentBlockStart(e.contentBlockStart):e.contentBlockDelta!==void 0?r.contentBlockDelta(e.contentBlockDelta):e.contentBlockStop!==void 0?r.contentBlockStop(e.contentBlockStop):e.messageStop!==void 0?r.messageStop(e.messageStop):e.metadata!==void 0?r.metadata(e.metadata):e.internalServerException!==void 0?r.internalServerException(e.internalServerException):e.modelStreamErrorException!==void 0?r.modelStreamErrorException(e.modelStreamErrorException):e.validationException!==void 0?r.validationException(e.validationException):e.throttlingException!==void 0?r.throttlingException(e.throttlingException):e.serviceUnavailableException!==void 0?r.serviceUnavailableException(e.serviceUnavailableException):r._(e.$unknown[0],e.$unknown[1])})(_T||(_T={}));var bT;(function(t){t.visit=(e,r)=>e.chunk!==void 0?r.chunk(e.chunk):e.internalServerException!==void 0?r.internalServerException(e.internalServerException):e.modelStreamErrorException!==void 0?r.modelStreamErrorException(e.modelStreamErrorException):e.validationException!==void 0?r.validationException(e.validationException):e.throttlingException!==void 0?r.throttlingException(e.throttlingException):e.modelTimeoutException!==void 0?r.modelTimeoutException(e.modelTimeoutException):e.serviceUnavailableException!==void 0?r.serviceUnavailableException(e.serviceUnavailableException):r._(e.$unknown[0],e.$unknown[1])})(bT||(bT={}));const cN=t=>{if(t.text!==void 0)return{text:t.text};if(t.image!==void 0)return{image:uo};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},Nre=t=>{if(t.text!==void 0)return{text:t.text};if(t.image!==void 0)return{image:t.image};if(t.document!==void 0)return{document:t.document};if(t.video!==void 0)return{video:t.video};if(t.toolUse!==void 0)return{toolUse:t.toolUse};if(t.toolResult!==void 0)return{toolResult:t.toolResult};if(t.guardContent!==void 0)return{guardContent:cN(t.guardContent)};if(t.reasoningContent!==void 0)return{reasoningContent:uo};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},sS=t=>({...t,...t.content&&{content:t.content.map(e=>Nre(e))}}),uN=t=>{if(t.text!==void 0)return{text:t.text};if(t.guardContent!==void 0)return{guardContent:cN(t.guardContent)};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},Bre=t=>({...t,...t.messages&&{messages:t.messages.map(e=>sS(e))},...t.system&&{system:t.system.map(e=>uN(e))},...t.toolConfig&&{toolConfig:t.toolConfig},...t.promptVariables&&{promptVariables:uo},...t.requestMetadata&&{requestMetadata:uo}}),Fre=t=>{if(t.message!==void 0)return{message:sS(t.message)};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},jre=t=>({...t,...t.output&&{output:Fre(t.output)}}),$re=t=>({...t,...t.messages&&{messages:t.messages.map(e=>sS(e))},...t.system&&{system:t.system.map(e=>uN(e))},...t.toolConfig&&{toolConfig:t.toolConfig},...t.promptVariables&&{promptVariables:uo},...t.requestMetadata&&{requestMetadata:uo}}),Ure=t=>({...t,...t.stream&&{stream:"STREAMING_CONTENT"}}),Hre=t=>({...t,...t.body&&{body:uo}}),Vre=t=>({...t,...t.body&&{body:uo}}),Gre=async(t,e)=>{const r=Fx(t,e),n={"content-type":"application/json"};r.bp("/model/{modelId}/converse"),r.p("modelId",()=>t.modelId,"{modelId}",!1);let s;return s=JSON.stringify(Ye(t,{additionalModelRequestFields:i=>Yd(i),additionalModelResponseFieldPaths:i=>et(i),guardrailConfig:i=>et(i),inferenceConfig:i=>_N(i),messages:i=>bN(i,e),performanceConfig:i=>et(i),promptVariables:i=>et(i),requestMetadata:i=>et(i),system:i=>wN(i,e),toolConfig:i=>xN(i)})),r.m("POST").h(n).b(s),r.build()},zre=async(t,e)=>{const r=Fx(t,e),n={"content-type":"application/json"};r.bp("/model/{modelId}/converse-stream"),r.p("modelId",()=>t.modelId,"{modelId}",!1);let s;return s=JSON.stringify(Ye(t,{additionalModelRequestFields:i=>Yd(i),additionalModelResponseFieldPaths:i=>et(i),guardrailConfig:i=>et(i),inferenceConfig:i=>_N(i),messages:i=>bN(i,e),performanceConfig:i=>et(i),promptVariables:i=>et(i),requestMetadata:i=>et(i),system:i=>wN(i,e),toolConfig:i=>xN(i)})),r.m("POST").h(n).b(s),r.build()},Wre=async(t,e)=>{const r=Fx(t,e),n=vr({},eee,{[PN]:t[RN]||"application/octet-stream",[wT]:t[wT],[fse]:t[use],[dse]:t[lse],[hse]:t[cse],[ON]:t[IN]});r.bp("/model/{modelId}/invoke"),r.p("modelId",()=>t.modelId,"{modelId}",!1);let s;return t.body!==void 0&&(s=t.body),r.m("POST").h(n).b(s),r.build()},Kre=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return iS(t,e);const r=vr({$metadata:Vr(t)}),n=UQ(VL(await bn(t.body,e)),"body"),s=Ye(n,{additionalModelResponseFields:i=>_g(i),metrics:et,output:i=>Fne(Xn(i),e),performanceConfig:et,stopReason:tt,trace:i=>Une(i),usage:et});return Object.assign(r,s),r},qre=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return iS(t,e);const r=vr({$metadata:Vr(t)}),n=t.body;return r.stream=sne(n,e),r},Jre=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return iS(t,e);const r=vr({$metadata:Vr(t),[RN]:[,t.headers[PN]],[IN]:[,t.headers[ON]]}),n=await EL(t.body,e);return r.body=n,r},iS=async(t,e)=>{const r={...t,body:await iee(t.body,e)},n=oee(t,r.body);switch(n){case"AccessDeniedException":case"com.amazonaws.bedrockruntime#AccessDeniedException":throw await Zre(r);case"InternalServerException":case"com.amazonaws.bedrockruntime#InternalServerException":throw await dN(r);case"ResourceNotFoundException":case"com.amazonaws.bedrockruntime#ResourceNotFoundException":throw await rne(r);case"ServiceQuotaExceededException":case"com.amazonaws.bedrockruntime#ServiceQuotaExceededException":throw await nne(r);case"ThrottlingException":case"com.amazonaws.bedrockruntime#ThrottlingException":throw await pN(r);case"ValidationException":case"com.amazonaws.bedrockruntime#ValidationException":throw await mN(r);case"ModelErrorException":case"com.amazonaws.bedrockruntime#ModelErrorException":throw await Qre(r);case"ModelNotReadyException":case"com.amazonaws.bedrockruntime#ModelNotReadyException":throw await ene(r);case"ModelTimeoutException":case"com.amazonaws.bedrockruntime#ModelTimeoutException":throw await tne(r);case"ServiceUnavailableException":case"com.amazonaws.bedrockruntime#ServiceUnavailableException":throw await fN(r);case"ModelStreamErrorException":case"com.amazonaws.bedrockruntime#ModelStreamErrorException":throw await hN(r);case"ConflictException":case"com.amazonaws.bedrockruntime#ConflictException":throw await Xre(r);default:const s=r.body;return Yre({output:t,parsedBody:s,errorCode:n})}},Yre=zQ(Hr),Zre=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Wx({$metadata:Vr(t),...r});return _n(i,t.body)},Xre=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Yx({$metadata:Vr(t),...r});return _n(i,t.body)},dN=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Kx({$metadata:Vr(t),...r});return _n(i,t.body)},Qre=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt,originalStatusCode:Ux,resourceName:tt});Object.assign(r,s);const i=new eS({$metadata:Vr(t),...r});return _n(i,t.body)},ene=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new tS({$metadata:Vr(t),...r});return _n(i,t.body)},hN=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt,originalMessage:tt,originalStatusCode:Ux});Object.assign(r,s);const i=new nS({$metadata:Vr(t),...r});return _n(i,t.body)},tne=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new rS({$metadata:Vr(t),...r});return _n(i,t.body)},rne=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Zx({$metadata:Vr(t),...r});return _n(i,t.body)},nne=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Xx({$metadata:Vr(t),...r});return _n(i,t.body)},fN=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Qx({$metadata:Vr(t),...r});return _n(i,t.body)},pN=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new qx({$metadata:Vr(t),...r});return _n(i,t.body)},mN=async(t,e)=>{const r=vr({}),n=t.body,s=Ye(n,{message:tt});Object.assign(r,s);const i=new Jx({$metadata:Vr(t),...r});return _n(i,t.body)},sne=(t,e)=>e.eventStreamMarshaller.deserialize(t,async r=>r.messageStart!=null?{messageStart:await une(r.messageStart,e)}:r.contentBlockStart!=null?{contentBlockStart:await one(r.contentBlockStart,e)}:r.contentBlockDelta!=null?{contentBlockDelta:await ine(r.contentBlockDelta,e)}:r.contentBlockStop!=null?{contentBlockStop:await ane(r.contentBlockStop,e)}:r.messageStop!=null?{messageStop:await dne(r.messageStop,e)}:r.metadata!=null?{metadata:await lne(r.metadata,e)}:r.internalServerException!=null?{internalServerException:await cne(r.internalServerException,e)}:r.modelStreamErrorException!=null?{modelStreamErrorException:await hne(r.modelStreamErrorException,e)}:r.validationException!=null?{validationException:await mne(r.validationException,e)}:r.throttlingException!=null?{throttlingException:await pne(r.throttlingException,e)}:r.serviceUnavailableException!=null?{serviceUnavailableException:await fne(r.serviceUnavailableException,e)}:{$unknown:t}),ine=async(t,e)=>{const r={},n=await bn(t.body,e);return Object.assign(r,Nne(n,e)),r},one=async(t,e)=>{const r={},n=await bn(t.body,e);return Object.assign(r,et(n)),r},ane=async(t,e)=>{const r={},n=await bn(t.body,e);return Object.assign(r,et(n)),r},lne=async(t,e)=>{const r={},n=await bn(t.body,e);return Object.assign(r,jne(n)),r},cne=async(t,e)=>{const r={...t,body:await bn(t.body,e)};return dN(r)},une=async(t,e)=>{const r={},n=await bn(t.body,e);return Object.assign(r,et(n)),r},dne=async(t,e)=>{const r={},n=await bn(t.body,e);return Object.assign(r,ese(n)),r},hne=async(t,e)=>{const r={...t,body:await bn(t.body,e)};return hN(r)},fne=async(t,e)=>{const r={...t,body:await bn(t.body,e)};return fN(r)},pne=async(t,e)=>{const r={...t,body:await bn(t.body,e)};return pN(r)},mne=async(t,e)=>{const r={...t,body:await bn(t.body,e)};return mN(r)},gne=(t,e)=>U_.visit(t,{document:r=>({document:gN(r,e)}),guardContent:r=>({guardContent:vN(r,e)}),image:r=>({image:yN(r,e)}),reasoningContent:r=>({reasoningContent:Sne(r,e)}),text:r=>({text:r}),toolResult:r=>({toolResult:Tne(r,e)}),toolUse:r=>({toolUse:One(r)}),video:r=>({video:SN(r,e)}),_:(r,n)=>({[r]:n})}),vne=(t,e)=>t.filter(r=>r!=null).map(r=>gne(r,e)),gN=(t,e)=>Ye(t,{format:[],name:[],source:r=>yne(r,e)}),yne=(t,e)=>M_.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),_:(r,n)=>({[r]:n})}),vN=(t,e)=>N_.visit(t,{image:r=>({image:_ne(r,e)}),text:r=>({text:et(r)}),_:(r,n)=>({[r]:n})}),_ne=(t,e)=>Ye(t,{format:[],source:r=>bne(r,e)}),bne=(t,e)=>L_.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),_:(r,n)=>({[r]:n})}),yN=(t,e)=>Ye(t,{format:[],source:r=>wne(r,e)}),wne=(t,e)=>B_.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),_:(r,n)=>({[r]:n})}),_N=(t,e)=>Ye(t,{maxTokens:[],stopSequences:et,temperature:Fk,topP:Fk}),xne=(t,e)=>Ye(t,{content:r=>vne(r,e),role:[]}),bN=(t,e)=>t.filter(r=>r!=null).map(r=>xne(r,e)),Sne=(t,e)=>F_.visit(t,{reasoningText:r=>({reasoningText:et(r)}),redactedContent:r=>({redactedContent:e.base64Encoder(r)}),_:(r,n)=>({[r]:n})}),Ene=(t,e)=>H_.visit(t,{guardContent:r=>({guardContent:vN(r,e)}),text:r=>({text:r}),_:(r,n)=>({[r]:n})}),wN=(t,e)=>t.filter(r=>r!=null).map(r=>Ene(r,e)),Cne=(t,e)=>G_.visit(t,{toolSpec:r=>({toolSpec:Ine(r)}),_:(r,n)=>({[r]:n})}),xN=(t,e)=>Ye(t,{toolChoice:et,tools:r=>Pne(r)}),kne=(t,e)=>V_.visit(t,{json:r=>({json:Yd(r)}),_:(r,n)=>({[r]:n})}),Tne=(t,e)=>Ye(t,{content:r=>Rne(r,e),status:[],toolUseId:[]}),Ane=(t,e)=>$_.visit(t,{document:r=>({document:gN(r,e)}),image:r=>({image:yN(r,e)}),json:r=>({json:Yd(r)}),text:r=>({text:r}),video:r=>({video:SN(r,e)}),_:(r,n)=>({[r]:n})}),Rne=(t,e)=>t.filter(r=>r!=null).map(r=>Ane(r,e)),Pne=(t,e)=>t.filter(r=>r!=null).map(r=>Cne(r)),Ine=(t,e)=>Ye(t,{description:[],inputSchema:r=>kne(r),name:[]}),One=(t,e)=>Ye(t,{input:r=>Yd(r),name:[],toolUseId:[]}),SN=(t,e)=>Ye(t,{format:[],source:r=>Dne(r,e)}),Dne=(t,e)=>j_.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),s3Location:r=>({s3Location:et(r)}),_:(r,n)=>({[r]:n})}),Yd=(t,e)=>t,Mne=(t,e)=>t.document!=null?{document:EN(t.document,e)}:t.guardContent!=null?{guardContent:Jne(Xn(t.guardContent),e)}:t.image!=null?{image:TN(t.image,e)}:t.reasoningContent!=null?{reasoningContent:tse(Xn(t.reasoningContent),e)}:tt(t.text)!==void 0?{text:tt(t.text)}:t.toolResult!=null?{toolResult:nse(t.toolResult,e)}:t.toolUse!=null?{toolUse:ose(t.toolUse)}:t.video!=null?{video:AN(t.video,e)}:{$unknown:Object.entries(t)[0]},Lne=(t,e)=>t.reasoningContent!=null?{reasoningContent:rse(Xn(t.reasoningContent),e)}:tt(t.text)!==void 0?{text:tt(t.text)}:t.toolUse!=null?{toolUse:et(t.toolUse)}:{$unknown:Object.entries(t)[0]},Nne=(t,e)=>Ye(t,{contentBlockIndex:Ux,delta:r=>Lne(Xn(r),e)}),Bne=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>Mne(Xn(n),e)),Fne=(t,e)=>t.message!=null?{message:Qne(t.message,e)}:{$unknown:Object.entries(t)[0]},jne=(t,e)=>Ye(t,{metrics:et,performanceConfig:et,trace:r=>$ne(r),usage:et}),$ne=(t,e)=>Ye(t,{guardrail:r=>kN(r),promptRouter:et}),Une=(t,e)=>Ye(t,{guardrail:r=>kN(r),promptRouter:et}),EN=(t,e)=>Ye(t,{format:tt,name:tt,source:r=>Hne(Xn(r),e)}),Hne=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:{$unknown:Object.entries(t)[0]},CN=(t,e)=>Ye(t,{contentPolicy:et,contextualGroundingPolicy:r=>qne(r),invocationMetrics:et,sensitiveInformationPolicy:et,topicPolicy:et,wordPolicy:et}),Vne=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>CN(n)),Gne=(t,e)=>Object.entries(t).reduce((r,[n,s])=>(s===null||(r[n]=Vne(s)),r),{}),zne=(t,e)=>Object.entries(t).reduce((r,[n,s])=>(s===null||(r[n]=CN(s)),r),{}),Wne=(t,e)=>Ye(t,{action:tt,score:Bk,threshold:Bk,type:tt}),Kne=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>Wne(n)),qne=(t,e)=>Ye(t,{filters:r=>Kne(r)}),Jne=(t,e)=>t.image!=null?{image:Yne(t.image,e)}:t.text!=null?{text:et(t.text)}:{$unknown:Object.entries(t)[0]},Yne=(t,e)=>Ye(t,{format:tt,source:r=>Zne(Xn(r),e)}),Zne=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:{$unknown:Object.entries(t)[0]},kN=(t,e)=>Ye(t,{inputAssessment:r=>zne(r),modelOutput:et,outputAssessments:r=>Gne(r)}),TN=(t,e)=>Ye(t,{format:tt,source:r=>Xne(Xn(r),e)}),Xne=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:{$unknown:Object.entries(t)[0]},Qne=(t,e)=>Ye(t,{content:r=>Bne(r,e),role:tt}),ese=(t,e)=>Ye(t,{additionalModelResponseFields:r=>_g(r),stopReason:tt}),tse=(t,e)=>t.reasoningText!=null?{reasoningText:et(t.reasoningText)}:t.redactedContent!=null?{redactedContent:e.base64Decoder(t.redactedContent)}:{$unknown:Object.entries(t)[0]},rse=(t,e)=>t.redactedContent!=null?{redactedContent:e.base64Decoder(t.redactedContent)}:tt(t.signature)!==void 0?{signature:tt(t.signature)}:tt(t.text)!==void 0?{text:tt(t.text)}:{$unknown:Object.entries(t)[0]},nse=(t,e)=>Ye(t,{content:r=>ise(r,e),status:tt,toolUseId:tt}),sse=(t,e)=>t.document!=null?{document:EN(t.document,e)}:t.image!=null?{image:TN(t.image,e)}:t.json!=null?{json:_g(t.json)}:tt(t.text)!==void 0?{text:tt(t.text)}:t.video!=null?{video:AN(t.video,e)}:{$unknown:Object.entries(t)[0]},ise=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>sse(Xn(n),e)),ose=(t,e)=>Ye(t,{input:r=>_g(r),name:tt,toolUseId:tt}),AN=(t,e)=>Ye(t,{format:tt,source:r=>ase(Xn(r),e)}),ase=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:t.s3Location!=null?{s3Location:et(t.s3Location)}:{$unknown:Object.entries(t)[0]},_g=(t,e)=>t,Vr=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),wT="accept",RN="contentType",PN="content-type",lse="guardrailIdentifier",cse="guardrailVersion",IN="performanceConfigLatency",use="trace",dse="x-amzn-bedrock-guardrailidentifier",hse="x-amzn-bedrock-guardrailversion",ON="x-amzn-bedrock-performanceconfig-latency",fse="x-amzn-bedrock-trace";class pse extends vg.classBuilder().ep(Gx).m(function(e,r,n,s){return[Lx(n,this.serialize,this.deserialize),Hx(n,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","Converse",{}).n("BedrockRuntimeClient","ConverseCommand").f(Bre,jre).ser(Gre).de(Kre).build(){}class mse extends vg.classBuilder().ep(Gx).m(function(e,r,n,s){return[Lx(n,this.serialize,this.deserialize),Hx(n,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","ConverseStream",{eventStream:{output:!0}}).n("BedrockRuntimeClient","ConverseStreamCommand").f($re,Ure).ser(zre).de(qre).build(){}class gse extends vg.classBuilder().ep(Gx).m(function(e,r,n,s){return[Lx(n,this.serialize,this.deserialize),Hx(n,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","InvokeModel",{}).n("BedrockRuntimeClient","InvokeModelCommand").f(Hre,Vre).ser(Wre).de(Jre).build(){}function vse(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{toolConfig:{tools:void 0,toolChoice:void 0},toolWarnings:[]};const n=[],s=[];for(const a of r)a.type==="provider-defined"?n.push({type:"unsupported-tool",tool:a}):s.push({toolSpec:{name:a.name,description:a.description,inputSchema:{json:a.parameters}}});const i=t.toolChoice;if(i==null)return{toolConfig:{tools:s,toolChoice:void 0},toolWarnings:n};const o=i.type;switch(o){case"auto":return{toolConfig:{tools:s,toolChoice:{auto:{}}},toolWarnings:n};case"required":return{toolConfig:{tools:s,toolChoice:{any:{}}},toolWarnings:n};case"none":return{toolConfig:{tools:void 0,toolChoice:void 0},toolWarnings:n};case"tool":return{toolConfig:{tools:s,toolChoice:{tool:{name:i.toolName}}},toolWarnings:n};default:{const a=o;throw new lu({functionality:`Unsupported tool choice type: ${a}`})}}}var yse=_L({prefix:"file",size:16});function _se(t){var e,r,n,s,i;const o=bse(t);let a;const l=[];for(let c=0;c<o.length;c++){const u=o[c],d=c===o.length-1,h=u.type;switch(h){case"system":{if(l.length>0)throw new lu({functionality:"Multiple system messages that are separated by user/assistant messages"});a=u.messages.map(({content:f})=>f).join(`
`);break}case"user":{const f=[];for(const v of u.messages){const{role:m,content:p}=v;switch(m){case"user":{for(let g=0;g<p.length;g++){const y=p[g];switch(y.type){case"text":{f.push({text:y.text});break}case"image":{if(y.image instanceof URL)throw new lu({functionality:"Image URLs in user messages"});f.push({image:{format:(r=(e=y.mimeType)==null?void 0:e.split("/"))==null?void 0:r[1],source:{bytes:(n=y.image)!=null?n:y.image}}});break}case"file":{if(y.data instanceof URL)throw new lu({functionality:"File URLs in user messages"});f.push({document:{format:(i=(s=y.mimeType)==null?void 0:s.split("/"))==null?void 0:i[1],name:yse(),source:{bytes:Ht.from(y.data,"base64")}}});break}}}break}case"tool":{for(let g=0;g<p.length;g++){const y=p[g];f.push({toolResult:{toolUseId:y.toolCallId,content:[{text:JSON.stringify(y.result)}]}})}break}default:{const g=m;throw new Error(`Unsupported role: ${g}`)}}}l.push({role:"user",content:f});break}case"assistant":{const f=[];for(let v=0;v<u.messages.length;v++){const m=u.messages[v],p=v===u.messages.length-1,{content:g}=m;for(let y=0;y<g.length;y++){const _=g[y],b=y===g.length-1;switch(_.type){case"text":{f.push({text:d&&p&&b?_.text.trim():_.text});break}case"tool-call":{f.push({toolUse:{toolUseId:_.toolCallId,name:_.toolName,input:_.args}});break}}}}l.push({role:"assistant",content:f});break}default:{const f=h;throw new Error(`Unsupported type: ${f}`)}}}return{system:a,messages:l}}function bse(t){const e=[];let r;for(const n of t){const{role:s}=n;switch(s){case"system":{r?.type!=="system"&&(r={type:"system",messages:[]},e.push(r)),r.messages.push(n);break}case"assistant":{r?.type!=="assistant"&&(r={type:"assistant",messages:[]},e.push(r)),r.messages.push(n);break}case"user":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push(n);break}case"tool":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push(n);break}default:{const i=s;throw new Error(`Unsupported role: ${i}`)}}}return e}function xT(t){switch(t){case"stop_sequence":case"end_turn":return"stop";case"max_tokens":return"length";case"content_filtered":case"guardrail_intervened":return"content-filter";case"tool_use":return"tool-calls";default:return"unknown"}}var wse=class{constructor(t,e,r){this.specificationVersion="v1",this.provider="amazon-bedrock",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d,headers:h}){var f,v;const m=t.type,p=[];o!=null&&p.push({type:"unsupported-setting",setting:"frequencyPenalty"}),a!=null&&p.push({type:"unsupported-setting",setting:"presencePenalty"}),u!=null&&p.push({type:"unsupported-setting",setting:"seed"}),h!=null&&p.push({type:"unsupported-setting",setting:"headers"}),i!=null&&p.push({type:"unsupported-setting",setting:"topK"}),c!=null&&c.type!=="text"&&p.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{system:g,messages:y}=_se(e),_={modelId:this.modelId,system:g?[{text:g}]:void 0,additionalModelRequestFields:this.settings.additionalModelRequestFields,inferenceConfig:{maxTokens:r,temperature:n,topP:s,stopSequences:l},messages:y,guardrailConfig:(f=d?.bedrock)==null?void 0:f.guardrailConfig};switch(m){case"regular":{const{toolConfig:b,toolWarnings:w}=vse(t);return{command:{..._,...(v=b.tools)!=null&&v.length?{toolConfig:b}:{}},warnings:[...p,...w]}}case"object-json":throw new lu({functionality:"json-mode object generation"});case"object-tool":return{command:{..._,toolConfig:{tools:[{toolSpec:{name:t.tool.name,description:t.tool.description,inputSchema:{json:t.tool.parameters}}}],toolChoice:{tool:{name:t.tool.name}}}},warnings:p};default:{const b=m;throw new Error(`Unsupported type: ${b}`)}}}async doGenerate(t){var e,r,n,s,i,o,a,l,c,u,d,h;const{command:f,warnings:v}=this.getArgs(t),m=await this.config.client.send(new pse(f)),{messages:p,...g}=f,y=m.trace?{bedrock:{trace:m.trace}}:void 0;return{text:(s=(n=(r=(e=m.output)==null?void 0:e.message)==null?void 0:r.content)==null?void 0:n.map(_=>{var b;return(b=_.text)!=null?b:""}).join(""))!=null?s:void 0,toolCalls:(l=(a=(o=(i=m.output)==null?void 0:i.message)==null?void 0:o.content)==null?void 0:a.filter(_=>!!_.toolUse))==null?void 0:l.map(_=>{var b,w,E,S,x,T;return{toolCallType:"function",toolCallId:(w=(b=_.toolUse)==null?void 0:b.toolUseId)!=null?w:this.config.generateId(),toolName:(S=(E=_.toolUse)==null?void 0:E.name)!=null?S:`tool-${this.config.generateId()}`,args:JSON.stringify((T=(x=_.toolUse)==null?void 0:x.input)!=null?T:"")}}),finishReason:xT(m.stopReason),usage:{promptTokens:(u=(c=m.usage)==null?void 0:c.inputTokens)!=null?u:Number.NaN,completionTokens:(h=(d=m.usage)==null?void 0:d.outputTokens)!=null?h:Number.NaN},rawCall:{rawPrompt:p,rawSettings:g},warnings:v,providerMetadata:y}}async doStream(t){const{command:e,warnings:r}=this.getArgs(t),n=await this.config.client.send(new mse(e)),{messages:s,...i}=e;let o="unknown",a={promptTokens:Number.NaN,completionTokens:Number.NaN},l;if(!n.stream)throw new Error("No stream found");const c=new ReadableStream({async start(d){for await(const h of n.stream)d.enqueue({success:!0,value:h});d.close()}}),u={};return{stream:c.pipeThrough(new TransformStream({transform(d,h){var f,v,m,p,g,y,_,b,w;function E(O){o="error",h.enqueue({type:"error",error:O})}if(!d.success){E(d.error);return}const S=d.value;if(S.internalServerException){E(S.internalServerException);return}if(S.modelStreamErrorException){E(S.modelStreamErrorException);return}if(S.throttlingException){E(S.throttlingException);return}if(S.validationException){E(S.validationException);return}S.messageStop&&(o=xT(S.messageStop.stopReason)),S.metadata&&(a={promptTokens:(v=(f=S.metadata.usage)==null?void 0:f.inputTokens)!=null?v:Number.NaN,completionTokens:(p=(m=S.metadata.usage)==null?void 0:m.outputTokens)!=null?p:Number.NaN},S.metadata.trace&&(l={bedrock:{trace:S.metadata.trace}})),(y=(g=S.contentBlockDelta)==null?void 0:g.delta)!=null&&y.text&&h.enqueue({type:"text-delta",textDelta:S.contentBlockDelta.delta.text});const x=S.contentBlockStart;if(((_=x?.start)==null?void 0:_.toolUse)!=null){const O=x.start.toolUse;u[x.contentBlockIndex]={toolCallId:O.toolUseId,toolName:O.name,jsonText:""}}const T=S.contentBlockDelta;if((b=T?.delta)!=null&&b.toolUse){const O=u[T.contentBlockIndex],R=(w=T.delta.toolUse.input)!=null?w:"";h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:O.toolCallId,toolName:O.toolName,argsTextDelta:R}),O.jsonText+=R}const D=S.contentBlockStop;if(D!=null){const O=D.contentBlockIndex,R=u[O];R!=null&&(h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:R.toolCallId,toolName:R.toolName,args:R.jsonText}),delete u[O])}},flush(d){d.enqueue({type:"finish",finishReason:o,usage:a,providerMetadata:l})}})),rawCall:{rawPrompt:s,rawSettings:i},warnings:r}}},xse=class{constructor(t,e,r){this.specificationVersion="v1",this.provider="amazon-bedrock",this.maxEmbeddingsPerCall=void 0,this.supportsParallelCalls=!0,this.modelId=t,this.config=r,this.settings=e}async doEmbed({values:t}){const e=async s=>{const i={inputText:s,dimensions:this.settings.dimensions,normalize:this.settings.normalize},o=new gse({contentType:"application/json",body:JSON.stringify(i),modelId:this.modelId}),a=await this.config.client.send(o);return JSON.parse(new TextDecoder().decode(a.body))};return(await Promise.all(t.map(e))).reduce((s,i)=>(s.embeddings.push(i.embedding),s.usage.tokens+=i.inputTextTokenCount,s),{embeddings:[],usage:{tokens:0}})}};function DN(t={}){const e=()=>{var i;return new Lre((i=t.bedrockOptions)!=null?i:{region:ry({settingValue:t.region,settingName:"region",environmentVariableName:"AWS_REGION",description:"AWS region"}),credentials:{accessKeyId:ry({settingValue:t.accessKeyId,settingName:"accessKeyId",environmentVariableName:"AWS_ACCESS_KEY_ID",description:"AWS access key ID"}),secretAccessKey:ry({settingValue:t.secretAccessKey,settingName:"secretAccessKey",environmentVariableName:"AWS_SECRET_ACCESS_KEY",description:"AWS secret access key"}),sessionToken:NZ({settingValue:t.sessionToken,environmentVariableName:"AWS_SESSION_TOKEN"})}})},r=(i,o={})=>new wse(i,o,{client:e(),generateId:LZ}),n=function(i,o){if(new.target)throw new Error("The Amazon Bedrock model function cannot be called with the new keyword.");return r(i,o)},s=(i,o={})=>new xse(i,o,{client:e()});return n.languageModel=r,n.embedding=s,n.textEmbedding=s,n.textEmbeddingModel=s,n}DN();class Sse extends Yt{name="AmazonBedrock";getApiKeyLink="https://console.aws.amazon.com/iam/home";config={apiTokenKey:"AWS_BEDROCK_CONFIG"};staticModels=[{name:"anthropic.claude-3-5-sonnet-20241022-v2:0",label:"Claude 3.5 Sonnet v2 (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:2e5},{name:"anthropic.claude-3-5-sonnet-20240620-v1:0",label:"Claude 3.5 Sonnet (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:4096},{name:"anthropic.claude-3-sonnet-20240229-v1:0",label:"Claude 3 Sonnet (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:4096},{name:"anthropic.claude-3-haiku-20240307-v1:0",label:"Claude 3 Haiku (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:4096},{name:"amazon.nova-pro-v1:0",label:"Amazon Nova Pro (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:5120},{name:"amazon.nova-lite-v1:0",label:"Amazon Nova Lite (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:5120},{name:"mistral.mistral-large-2402-v1:0",label:"Mistral Large 24.02 (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:8192}];_parseAndValidateConfig(e){let r;try{r=JSON.parse(e)}catch{throw new Error("Invalid AWS Bedrock configuration format. Please provide a valid JSON string containing region, accessKeyId, and secretAccessKey.")}const{region:n,accessKeyId:s,secretAccessKey:i,sessionToken:o}=r;if(!n||!s||!i)throw new Error("Missing required AWS credentials. Configuration must include region, accessKeyId, and secretAccessKey.");return{region:n,accessKeyId:s,secretAccessKey:i,...o&&{sessionToken:o}}}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"AWS_BEDROCK_CONFIG"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);const a=this._parseAndValidateConfig(o);return DN(a)(r)}}class Ese extends Yt{name="Github";getApiKeyLink="https://github.com/settings/personal-access-tokens";config={apiTokenKey:"GITHUB_API_KEY"};staticModels=[{name:"gpt-4o",label:"GPT-4o",provider:"Github",maxTokenAllowed:8e3},{name:"o1",label:"o1-preview",provider:"Github",maxTokenAllowed:1e5},{name:"o1-mini",label:"o1-mini",provider:"Github",maxTokenAllowed:8e3},{name:"gpt-4o-mini",label:"GPT-4o Mini",provider:"Github",maxTokenAllowed:8e3},{name:"gpt-4-turbo",label:"GPT-4 Turbo",provider:"Github",maxTokenAllowed:8e3},{name:"gpt-4",label:"GPT-4",provider:"Github",maxTokenAllowed:8e3},{name:"gpt-3.5-turbo",label:"GPT-3.5 Turbo",provider:"Github",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GITHUB_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return Us({baseURL:"https://models.inference.ai.azure.com",apiKey:o})(r)}}const Cse=Object.freeze(Object.defineProperty({__proto__:null,AmazonBedrockProvider:Sse,AnthropicProvider:Xq,CohereProvider:NJ,DeepseekProvider:KJ,GithubProvider:Ese,GoogleProvider:EY,GroqProvider:CY,HuggingFaceProvider:kY,HyperbolicProvider:AZ,LMStudioProvider:TY,MistralProvider:NY,OllamaProvider:YY,OpenAILikeProvider:SZ,OpenAIProvider:EZ,OpenRouterProvider:xZ,PerplexityProvider:CZ,TogetherProvider:kZ,XAIProvider:TZ},Symbol.toStringTag,{value:"Module"})),us=en("LLMManager");class Go{static _instance;_providers=new Map;_modelList=[];_env={};constructor(e){this._registerProvidersFromDirectory(),this._env=e}static getInstance(e={}){return Go._instance||(Go._instance=new Go(e)),Go._instance}get env(){return this._env}async _registerProvidersFromDirectory(){try{for(const e of Object.values(Cse))if(typeof e=="function"&&e.prototype instanceof Yt){const r=new e;try{this.registerProvider(r)}catch(n){us.warn("Failed To Register Provider: ",r.name,"error:",n.message)}}}catch(e){us.error("Error registering providers:",e)}}registerProvider(e){if(this._providers.has(e.name)){us.warn(`Provider ${e.name} is already registered. Skipping.`);return}us.info("Registering Provider: ",e.name),this._providers.set(e.name,e),this._modelList=[...this._modelList,...e.staticModels]}getProvider(e){return this._providers.get(e)}getAllProviders(){return Array.from(this._providers.values())}getModelList(){return this._modelList}async updateModelList(e){const{apiKeys:r,providerSettings:n,serverEnv:s}=e;let i=Array.from(this._providers.values()).map(h=>h.name);n&&Object.keys(n).length>0&&(i=i.filter(h=>n[h].enabled));const o=await Promise.all(Array.from(this._providers.values()).filter(h=>i.includes(h.name)).filter(h=>!!h.getDynamicModels).map(async h=>{const f=h.getModelsFromCache(e);return f||await h.getDynamicModels(r,n?.[h.name],s).then(m=>(us.info(`Caching ${m.length} dynamic models for ${h.name}`),h.storeDynamicModels(e,m),m)).catch(m=>(us.error(`Error getting dynamic models ${h.name} :`,m),[]))})),a=Array.from(this._providers.values()).flatMap(h=>h.staticModels||[]),l=o.flat(),c=l.map(h=>`${h.name}-${h.provider}`),u=a.filter(h=>!c.includes(`${h.name}-${h.provider}`)),d=[...l,...u];return d.sort((h,f)=>h.name.localeCompare(f.name)),this._modelList=d,d}getStaticModelList(){return[...this._providers.values()].flatMap(e=>e.staticModels||[])}async getModelListFromProvider(e,r){const n=this._providers.get(e.name);if(!n)throw new Error(`Provider ${e.name} not found`);const s=n.staticModels||[];if(!n.getDynamicModels)return s;const{apiKeys:i,providerSettings:o,serverEnv:a}=r,l=n.getModelsFromCache({apiKeys:i,providerSettings:o,serverEnv:a});if(l)return us.info(`Found ${l.length} cached models for ${n.name}`),[...l,...s];us.info(`Getting dynamic models for ${n.name}`);const c=await n.getDynamicModels?.(i,o?.[n.name],a).then(f=>(us.info(`Got ${f.length} dynamic models for ${n.name}`),n.storeDynamicModels(r,f),f)).catch(f=>(us.error(`Error getting dynamic models ${n.name} :`,f),[])),u=c.map(f=>f.name),d=s.filter(f=>!u.includes(f.name)),h=[...c,...d];return h.sort((f,v)=>f.name.localeCompare(v.name)),h}getStaticModelListFromProvider(e){const r=this._providers.get(e.name);if(!r)throw new Error(`Provider ${e.name} not found`);return[...r.staticModels||[]]}getDefaultProvider(){const e=this._providers.values().next().value;if(!e)throw new Error("No providers registered");return e}}const kse={BASE_URL:"/",DEV:!1,LMSTUDIO_API_BASE_URL:"",MODE:"production",OLLAMA_API_BASE_URL:"",OPENAI_LIKE_API_BASE_URL:"",PROD:!0,SSR:!1,TOGETHER_API_BASE_URL:"",VITE_DISABLE_PERSISTENCE:"true",VITE_GITHUB_ACCESS_TOKEN:"",VITE_GITHUB_TOKEN_TYPE:"classic",VITE_LOG_LEVEL:"debug"},MN="project",lc=`/home/${MN}`,Tse="claude-3-5-sonnet-latest",Kh="cachedPrompt",LN=Go.getInstance(kse),bg=LN.getAllProviders(),Ase=LN.getDefaultProvider(),Rse={};bg.forEach(t=>{Rse[t.name]={baseUrlKey:t.config.baseUrlKey,apiTokenKey:t.config.apiTokenKey}});function Pse(t){const e=r=>{if(!/^https?:\/\/[^\/]+\.webcontainer-api\.io(\/.*)?$/.test(r))return r;const s=/^https?:\/\/[^\/]+\.webcontainer-api\.io\/(.*?)$/;return r.match(s)?.[1]||""};return t.split(`
`).map(r=>r.replace(/(https?:\/\/[^\/]+\.webcontainer-api\.io\/[^\s\)]+)/g,n=>e(n))).join(`
`)}let Ui=new Promise(()=>{});Ui=Promise.resolve().then(()=>Zs.boot({coep:"credentialless",workdirName:MN,forwardPreviewErrors:!0})).then(async t=>{const{workbenchStore:e}=await ee(async()=>{const{workbenchStore:r}=await Promise.resolve().then(()=>zoe);return{workbenchStore:r}},void 0);return t.on("preview-message",r=>{if(console.log("WebContainer preview message:",r),r.type==="PREVIEW_UNCAUGHT_EXCEPTION"||r.type==="PREVIEW_UNHANDLED_REJECTION"){const s=r.type==="PREVIEW_UNHANDLED_REJECTION"?"Unhandled Promise Rejection":"Uncaught Exception";e.actionAlert.set({type:"preview",title:s,description:"message"in r?r.message:"Unknown error",content:`Error occurred at ${r.pathname}${r.search}${r.hash}
Port: ${r.port}

Stack trace:
${Pse(r.stack||"")}`,source:"preview"})}}),t});const Ise=en("EditorStore");class Ose{#r;selectedFile=jt();documents=bo({});currentDocument=u2([this.documents,this.selectedFile],(e,r)=>{if(r)return e[r]});constructor(e){this.#r=e}setDocuments(e){const r=this.documents.value;this.documents.set(Object.fromEntries(Object.entries(e).map(([n,s])=>{if(s===void 0||s.type!=="file")return;const i=r?.[n];return[n,{value:s.content,filePath:n,scroll:i?.scroll}]}).filter(Boolean)))}setSelectedFile(e){this.selectedFile.set(e)}updateScrollPosition(e,r){const s=this.documents.get()[e];s&&this.documents.setKey(e,{...s,scroll:r})}updateFile(e,r){const s=this.documents.get()[e];if(!s)return;if(this.#r.getFile(e)?.isLocked){Ise.warn(`Attempted to update locked file: ${e}`);return}s.value!==r&&this.documents.setKey(e,{...s,value:r})}}function Uf(t,e){if(!t)return null;const r="utf8",n="binary",s=e?.chunkLength??24;let i=e?.chunkBegin??0;if(e?.chunkBegin==null){let o=Uf(t,{chunkLength:s,chunkBegin:i});return o===r&&(i=Math.max(0,Math.floor(t.length/2)-s),o=Uf(t,{chunkLength:s,chunkBegin:i}),o===r&&(i=Math.max(0,t.length-s),o=Uf(t,{chunkLength:s,chunkBegin:i}))),o}else{if(i=Dse(t,i),i===-1)return n;const o=Mse(t,Math.min(t.length,i+s));if(o>t.length)return n;const a=t.toString(r,i,o);for(let l=0;l<a.length;++l){const c=a.charCodeAt(l);if(c===65533||c<=8)return n}return r}}function Dse(t,e){if(e===0)return 0;if(!Lse(t[e]))return e;let r=e-3;return r>=0&&ml(t[r])||(r=e-2,r>=0&&(ml(t[r])||em(t[r])))||(r=e-1,r>=0&&(ml(t[r])||em(t[r])||NN(t[r])))?r:-1}function Mse(t,e){if(e===t.length)return e;let r=e-3;if(r>=0&&ml(t[r]))return e+1;if(r=e-2,r>=0){if(ml(t[r]))return e+2;if(em(t[r]))return e+1}if(r=e-1,r>=0){if(ml(t[r]))return e+3;if(em(t[r]))return e+2;if(NN(t[r]))return e+1}return e}function ml(t){return t>>3===30}function em(t){return t>>4===14}function NN(t){return t>>5===6}function Lse(t){return t>>6===2}function Nse(t,e){let r,n=[],s=Promise.resolve();const i=()=>{r=self.setTimeout(async()=>{await s,n.length>0&&(s=Promise.resolve(e(n))),r=void 0,n=[]},t)};return(...o)=>{n.push(o),r||i()}}function xo(){}xo.prototype={diff:function(e,r){var n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=s.callback;typeof s=="function"&&(i=s,s={}),this.options=s;var o=this;function a(b){return i?(setTimeout(function(){i(void 0,b)},0),!0):b}e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var l=r.length,c=e.length,u=1,d=l+c;s.maxEditLength&&(d=Math.min(d,s.maxEditLength));var h=(n=s.timeout)!==null&&n!==void 0?n:1/0,f=Date.now()+h,v=[{oldPos:-1,lastComponent:void 0}],m=this.extractCommon(v[0],r,e,0);if(v[0].oldPos+1>=c&&m+1>=l)return a([{value:this.join(r),count:r.length}]);var p=-1/0,g=1/0;function y(){for(var b=Math.max(p,-u);b<=Math.min(g,u);b+=2){var w=void 0,E=v[b-1],S=v[b+1];E&&(v[b-1]=void 0);var x=!1;if(S){var T=S.oldPos-b;x=S&&0<=T&&T<l}var D=E&&E.oldPos+1<c;if(!x&&!D){v[b]=void 0;continue}if(!D||x&&E.oldPos+1<S.oldPos?w=o.addToPath(S,!0,void 0,0):w=o.addToPath(E,void 0,!0,1),m=o.extractCommon(w,r,e,b),w.oldPos+1>=c&&m+1>=l)return a(Bse(o,w.lastComponent,r,e,o.useLongestToken));v[b]=w,w.oldPos+1>=c&&(g=Math.min(g,b-1)),m+1>=l&&(p=Math.max(p,b+1))}u++}if(i)(function b(){setTimeout(function(){if(u>d||Date.now()>f)return i();y()||b()},0)})();else for(;u<=d&&Date.now()<=f;){var _=y();if(_)return _}},addToPath:function(e,r,n,s){var i=e.lastComponent;return i&&i.added===r&&i.removed===n?{oldPos:e.oldPos+s,lastComponent:{count:i.count+1,added:r,removed:n,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+s,lastComponent:{count:1,added:r,removed:n,previousComponent:i}}},extractCommon:function(e,r,n,s){for(var i=r.length,o=n.length,a=e.oldPos,l=a-s,c=0;l+1<i&&a+1<o&&this.equals(r[l+1],n[a+1]);)l++,a++,c++;return c&&(e.lastComponent={count:c,previousComponent:e.lastComponent}),e.oldPos=a,l},equals:function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},removeEmpty:function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function Bse(t,e,r,n,s){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var a=0,l=i.length,c=0,u=0;a<l;a++){var d=i[a];if(d.removed){if(d.value=t.join(n.slice(u,u+d.count)),u+=d.count,a&&i[a-1].added){var f=i[a-1];i[a-1]=i[a],i[a]=f}}else{if(!d.added&&s){var h=r.slice(c,c+d.count);h=h.map(function(m,p){var g=n[u+p];return g.length>m.length?g:m}),d.value=t.join(h)}else d.value=t.join(r.slice(c,c+d.count));c+=d.count,d.added||(u+=d.count)}}var v=i[l-1];return l>1&&typeof v.value=="string"&&(v.added||v.removed)&&t.equals("",v.value)&&(i[l-2].value+=v.value,i.pop()),i}var ST=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,ET=/\S/,BN=new xo;BN.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!ET.test(t)&&!ET.test(e)};BN.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&ST.test(e[r])&&ST.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};var oS=new xo;oS.tokenize=function(t){this.options.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var s=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=s:(this.options.ignoreWhitespace&&(s=s.trim()),e.push(s))}return e};function $l(t,e,r){return oS.diff(t,e,r)}var Fse=new xo;Fse.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var jse=new xo;jse.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function Hf(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Hf=function(e){return typeof e}:Hf=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hf(t)}function hy(t){return $se(t)||Use(t)||Hse(t)||Vse()}function $se(t){if(Array.isArray(t))return z_(t)}function Use(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Hse(t,e){if(t){if(typeof t=="string")return z_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z_(t,e)}}function z_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Gse=Object.prototype.toString,md=new xo;md.useLongestToken=!0;md.tokenize=oS.tokenize;md.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,s=n===void 0?function(i,o){return typeof o>"u"?r:o}:n;return typeof t=="string"?t:JSON.stringify(W_(t,null,null,s),s,"  ")};md.equals=function(t,e){return xo.prototype.equals.call(md,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function W_(t,e,r,n,s){e=e||[],r=r||[],n&&(t=n(s,t));var i;for(i=0;i<e.length;i+=1)if(e[i]===t)return r[i];var o;if(Gse.call(t)==="[object Array]"){for(e.push(t),o=new Array(t.length),r.push(o),i=0;i<t.length;i+=1)o[i]=W_(t[i],e,r,n,s);return e.pop(),r.pop(),o}if(t&&t.toJSON&&(t=t.toJSON()),Hf(t)==="object"&&t!==null){e.push(t),o={},r.push(o);var a=[],l;for(l in t)t.hasOwnProperty(l)&&a.push(l);for(a.sort(),i=0;i<a.length;i+=1)l=a[i],o[l]=W_(t[l],e,r,n,l);e.pop(),r.pop()}else o=t;return o}var K_=new xo;K_.tokenize=function(t){return t.slice()};K_.join=K_.removeEmpty=function(t){return t};function zse(t,e,r,n,s,i,o){o||(o={}),typeof o.context>"u"&&(o.context=4);var a=$l(r,n,o);if(!a)return;a.push({value:"",lines:[]});function l(g){return g.map(function(y){return" "+y})}for(var c=[],u=0,d=0,h=[],f=1,v=1,m=function(y){var _=a[y],b=_.lines||_.value.replace(/\n$/,"").split(`
`);if(_.lines=b,_.added||_.removed){var w;if(!u){var E=a[y-1];u=f,d=v,E&&(h=o.context>0?l(E.lines.slice(-o.context)):[],u-=h.length,d-=h.length)}(w=h).push.apply(w,hy(b.map(function(A){return(_.added?"+":"-")+A}))),_.added?v+=b.length:f+=b.length}else{if(u)if(b.length<=o.context*2&&y<a.length-2){var S;(S=h).push.apply(S,hy(l(b)))}else{var x,T=Math.min(b.length,o.context);(x=h).push.apply(x,hy(l(b.slice(0,T))));var D={oldStart:u,oldLines:f-u+T,newStart:d,newLines:v-d+T,lines:h};if(y>=a.length-2&&b.length<=o.context){var O=/\n$/.test(r),R=/\n$/.test(n),P=b.length==0&&h.length>D.oldLines;!O&&P&&r.length>0&&h.splice(D.oldLines,0,"\\ No newline at end of file"),(!O&&!P||!R)&&h.push("\\ No newline at end of file")}c.push(D),u=0,d=0,h=[]}f+=b.length,v+=b.length}},p=0;p<a.length;p++)m(p);return{oldFileName:t,newFileName:e,oldHeader:s,newHeader:i,hunks:c}}function FN(t){if(Array.isArray(t))return t.map(FN).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}function Wse(t,e,r,n,s,i,o){return FN(zse(t,e,r,n,s,i,o))}function Kse(t,e){const r={};let n=!1;for(const[s,i]of e){const o=t[s];if(o?.type!=="file")continue;const a=jN(s,i,o.content);a&&(n=!0,a.length>o.content.length?r[s]={type:"file",content:o.content}:r[s]={type:"diff",content:a})}if(n)return r}function jN(t,e,r){let n=Wse(t,t,e,r);const s=`--- ${t}
+++ ${t}
`,i=n.indexOf(s);if(i>=0&&(n=n.slice(i+s.length)),n!=="")return n}const qse=new RegExp(`^${lc}/`);function pu(t){return t.replace(qse,"")}const wi=en("LockedFiles"),wg="codeia.lockedFiles";let ai=null;const zi=new Map;let fy=null;const Jse=300;function Zd(t,e=!1){return e&&!zi.has(t)&&zi.set(t,new Map),zi.get(t)}function Yse(){if(ai!==null)return ai;try{if(typeof localStorage<"u"){const t=localStorage.getItem(wg);if(t){const r=JSON.parse(t).map(n=>({...n,isFolder:n.isFolder!==void 0?n.isFolder:!1}));return ai=r,$N(r),r}}return ai=[],[]}catch(t){return wi.error("Failed to initialize locked items cache",t),ai=[],[]}}function $N(t){zi.clear();for(const e of t)zi.has(e.chatId)||zi.set(e.chatId,new Map),zi.get(e.chatId).set(e.path,e)}function aS(t){ai=[...t],$N(t),fy&&clearTimeout(fy),fy=setTimeout(()=>{try{typeof localStorage<"u"&&(localStorage.setItem(wg,JSON.stringify(t)),wi.info(`Saved ${t.length} locked items to localStorage`))}catch(e){wi.error("Failed to save locked items to localStorage",e)}},Jse)}function xg(){return ai!==null?ai:Yse()}function UN(t,e,r=!1){const n=xg(),s={chatId:t,path:e,isFolder:r};Zd(t,!0).set(e,s);const o=n.filter(a=>!(a.chatId===t&&a.path===e));o.push(s),aS(o),wi.info(`Added locked ${r?"folder":"file"}: ${e} for chat: ${t}`)}function Zse(t,e){UN(t,e)}function Xse(t,e){UN(t,e)}function HN(t,e){const r=xg(),n=Zd(t);n&&n.delete(e);const s=r.filter(i=>!(i.chatId===t&&i.path===e));aS(s),wi.info(`Removed lock for: ${e} in chat: ${t}`)}function Qse(t,e){HN(t,e)}function eie(t,e){HN(t,e)}function tie(t,e){xg();const r=Zd(t);if(r){const n=r.get(e);if(n&&!n.isFolder)return{locked:!0,lockedBy:e}}return VN(t,e)}function VN(t,e){const r=Zd(t);if(!r)return{locked:!1};const n=e.split("/");let s="";for(let i=0;i<n.length-1;i++){s=s?`${s}/${n[i]}`:n[i];const o=r.get(s);if(o&&o.isFolder)return{locked:!0,lockedBy:s}}return{locked:!1}}function lS(t){const e=xg(),r=Zd(t);return r?Array.from(r.values()):e.filter(n=>n.chatId===t)}function rie(t){return lS(t).filter(r=>!r.isFolder)}function nie(t){return lS(t).filter(r=>r.isFolder)}function GN(t,e){return VN(t,e)}function CT(t){try{if(cS(),typeof localStorage<"u"){const e=localStorage.getItem(wg);if(e){const r=JSON.parse(e);if(Array.isArray(r)){let n=!1;const s=r.map(i=>!i.chatId||i.isFolder===void 0?(n=!0,{...i,chatId:i.chatId||t,isFolder:i.isFolder!==void 0?i.isFolder:!1}):i);n&&(aS(s),wi.info(`Migrated ${s.length} legacy locks to chat ID: ${t}`))}}}}catch(e){wi.error("Failed to migrate legacy locks",e)}}function cS(){ai=null,zi.clear(),wi.info("Cleared locked items cache")}typeof window<"u"&&window.addEventListener("storage",t=>{t.key===wg&&(wi.info("Detected localStorage change for locked items, refreshing cache"),cS())});const zN=en("FileLocks");function wr(){try{if(typeof window<"u"){const t=window.location.pathname.match(/\/chat\/([^/]+)/);if(t&&t[1])return t[1]}return"default"}catch(t){return zN.error("Failed to get current chat ID",t),"default"}}function uS(t,e){try{const r=e||wr(),n=tie(r,t);if(!n.locked){const s=GN(r,t);if(s.locked)return s}return n}catch(r){return zN.error("Failed to check if file is locked",r),{locked:!1}}}const Et=en("FilesStore"),sie=new TextDecoder("utf8",{fatal:!0});class iie{#r;#t=0;#e=new Map;#n=new Set;files=bo({});get filesCount(){return this.#t}constructor(e){this.#r=e;try{if(typeof localStorage<"u"){const r=localStorage.getItem("codeia-deleted-paths");if(r){const n=JSON.parse(r);Array.isArray(n)&&n.forEach(s=>this.#n.add(s))}}}catch(r){Et.error("Failed to load deleted paths from localStorage",r)}if(this.#s(),typeof window<"u"){let r=wr();new MutationObserver(()=>{const s=wr();s!==r&&(Et.info(`Chat ID changed from ${r} to ${s}, reloading locks`),r=s,this.#s(s))}).observe(document,{subtree:!0,childList:!0})}this.#o()}#s(e){try{const r=e||wr(),n=performance.now();CT(r);const s=lS(r),i=s.filter(u=>!u.isFolder),o=s.filter(u=>u.isFolder);if(s.length===0){Et.info(`No locked items found for chat ID: ${r}`);return}Et.info(`Found ${i.length} locked files and ${o.length} locked folders for chat ID: ${r}`);const a=this.files.get(),l={};for(const u of i){const d=a[u.path];d?.type==="file"&&(l[u.path]={...d,isLocked:!0})}for(const u of o){const d=a[u.path];d?.type==="folder"&&(l[u.path]={...d,isLocked:!0},this.#i(a,l,u.path))}Object.keys(l).length>0&&this.files.set({...a,...l});const c=performance.now();Et.info(`Loaded locked items in ${Math.round(c-n)}ms`)}catch(r){Et.error("Failed to load locked files from localStorage",r)}}#i(e,r,n){const s=n.endsWith("/")?n:`${n}/`;Object.entries(e).forEach(([i,o])=>{i.startsWith(s)&&o&&(o.type==="file"?r[i]={...o,isLocked:!0,lockedByFolder:n}:o.type==="folder"&&(r[i]={...o,isLocked:!0,lockedByFolder:n}))})}lockFile(e,r){const n=this.getFile(e),s=r||wr();return n?(this.files.setKey(e,{...n,isLocked:!0}),Zse(s,e),Et.info(`File locked: ${e} for chat: ${s}`),!0):(Et.error(`Cannot lock non-existent file: ${e}`),!1)}lockFolder(e,r){const n=this.getFileOrFolder(e),s=this.files.get(),i=r||wr();if(!n||n.type!=="folder")return Et.error(`Cannot lock non-existent folder: ${e}`),!1;const o={};return o[e]={type:n.type,isLocked:!0},this.#i(s,o,e),this.files.set({...s,...o}),Xse(i,e),Et.info(`Folder locked: ${e} for chat: ${i}`),!0}unlockFile(e,r){const n=this.getFile(e),s=r||wr();return n?(this.files.setKey(e,{...n,isLocked:!1,lockedByFolder:void 0}),Qse(s,e),Et.info(`File unlocked: ${e} for chat: ${s}`),!0):(Et.error(`Cannot unlock non-existent file: ${e}`),!1)}unlockFolder(e,r){const n=this.getFileOrFolder(e),s=this.files.get(),i=r||wr();if(!n||n.type!=="folder")return Et.error(`Cannot unlock non-existent folder: ${e}`),!1;const o={};o[e]={type:n.type,isLocked:!1};const a=e.endsWith("/")?e:`${e}/`;return Object.entries(s).forEach(([l,c])=>{l.startsWith(a)&&c&&(c.type==="file"&&c.lockedByFolder===e?o[l]={...c,isLocked:!1,lockedByFolder:void 0}:c.type==="folder"&&c.lockedByFolder===e&&(o[l]={type:c.type,isLocked:!1,lockedByFolder:void 0}))}),this.files.set({...s,...o}),eie(i,e),Et.info(`Folder unlocked: ${e} for chat: ${i}`),!0}isFileLocked(e,r){const n=this.getFile(e),s=r||wr();if(!n)return{locked:!1};if(n.isLocked)return n.lockedByFolder?{locked:!0,lockedBy:n.lockedByFolder}:{locked:!0,lockedBy:e};if(rie(s).find(l=>l.path===e))return this.files.setKey(e,{...n,isLocked:!0}),{locked:!0,lockedBy:e};const a=this.isFileInLockedFolder(e,s);return a.locked?(this.files.setKey(e,{...n,isLocked:!0,lockedByFolder:a.lockedBy}),a):{locked:!1}}isFileInLockedFolder(e,r){const n=r||wr();return GN(n,e)}isFolderLocked(e,r){const n=this.getFileOrFolder(e),s=r||wr();return!n||n.type!=="folder"?{isLocked:!1}:n.isLocked?{isLocked:!0,lockedBy:e}:nie(s).find(a=>a.path===e)?(this.files.setKey(e,{type:n.type,isLocked:!0}),{isLocked:!0,lockedBy:e}):{isLocked:!1}}getFile(e){const r=this.files.get()[e];if(r&&r.type==="file")return r}getFileOrFolder(e){return this.files.get()[e]}getFileModifications(){return Kse(this.files.get(),this.#e)}getModifiedFiles(){let e;for(const[r,n]of this.#e){const s=this.files.get()[r];s?.type==="file"&&s.content!==n&&(e||(e={}),e[r]=s)}return e}resetFileModifications(){this.#e.clear()}async saveFile(e,r){const n=await this.#r;try{const s=fr.relative(n.workdir,e);if(!s)throw new Error(`EINVAL: invalid file path, write '${s}'`);const i=this.getFile(e)?.content;!i&&i!==""&&An("Expected content to be defined"),await n.fs.writeFile(s,r),this.#e.has(e)||this.#e.set(e,i);const o=this.files.get()[e],a=o?.type==="file"?o.isLocked:!1;this.files.setKey(e,{type:"file",content:r,isBinary:!1,isLocked:a}),Et.info("File updated")}catch(s){throw Et.error(`Failed to update file content

`,s),s}}async#o(){const e=await this.#r;this.#a(),e.internal.watchPaths({include:[`${lc}/**`],exclude:["**/node_modules",".git"],includeContent:!0},Nse(100,this.#l.bind(this)));const r=wr();CT(r),this.#s(r),setTimeout(()=>{this.#s(r)},2e3),setInterval(()=>{cS();const n=wr();this.#s(n)},3e4)}#a(){if(this.#n.size===0)return;const e=this.files.get(),r=new Set,n=[...this.#n].map(s=>s+"/");for(const[s,i]of Object.entries(e))if(i){if(this.#n.has(s)){r.add(s);continue}for(const o of n)if(s.startsWith(o)){r.add(s);break}}if(r.size>0){const s={};for(const i of r){const o=e[i];s[i]=void 0,o?.type==="file"&&(this.#t--,this.#e.has(i)&&this.#e.delete(i))}this.files.set({...e,...s})}}#l(e){const r=e.flat(2);for(const{type:n,path:s,buffer:i}of r){const o=s.replace(/\/+$/g,"");if(this.#n.has(o))continue;let a=!1;for(const l of this.#n)if(o.startsWith(l+"/")){a=!0;break}if(!a)switch(n){case"add_dir":{this.files.setKey(o,{type:"folder"});break}case"remove_dir":{this.files.setKey(o,void 0);for(const[l]of Object.entries(this.files))l.startsWith(o)&&this.files.setKey(l,void 0);break}case"add_file":case"change":{n==="add_file"&&this.#t++;let l="";const c=oie(i);c&&i?l=Of.from(i).toString("base64"):c||(l=this.#c(i),l===" "&&n==="add_file"&&(l=""));const u=this.files.get()[o];u?.type==="file"&&u.isBinary&&u.content&&!l&&(l=u.content);const d=u?.type==="file"?u.isLocked:!1;this.files.setKey(o,{type:"file",content:l,isBinary:c,isLocked:d});break}case"remove_file":{this.#t--,this.files.setKey(o,void 0);break}}}}#c(e){if(!e||e.byteLength===0)return"";try{return sie.decode(e)}catch(r){return console.log(r),""}}async createFile(e,r=""){const n=await this.#r;try{const s=fr.relative(n.workdir,e);if(!s)throw new Error(`EINVAL: invalid file path, create '${s}'`);const i=fr.dirname(s);if(i!=="."&&await n.fs.mkdir(i,{recursive:!0}),r instanceof Uint8Array){await n.fs.writeFile(s,Of.from(r));const a=Of.from(r).toString("base64");this.files.setKey(e,{type:"file",content:a,isBinary:!0,isLocked:!1}),this.#e.set(e,a)}else{const a=r.length===0?" ":r;await n.fs.writeFile(s,a),this.files.setKey(e,{type:"file",content:r,isBinary:!1,isLocked:!1}),this.#e.set(e,r)}return Et.info(`File created: ${e}`),!0}catch(s){throw Et.error(`Failed to create file

`,s),s}}async createFolder(e){const r=await this.#r;try{const n=fr.relative(r.workdir,e);if(!n)throw new Error(`EINVAL: invalid folder path, create '${n}'`);return await r.fs.mkdir(n,{recursive:!0}),this.files.setKey(e,{type:"folder"}),Et.info(`Folder created: ${e}`),!0}catch(n){throw Et.error(`Failed to create folder

`,n),n}}async deleteFile(e){const r=await this.#r;try{const n=fr.relative(r.workdir,e);if(!n)throw new Error(`EINVAL: invalid file path, delete '${n}'`);return await r.fs.rm(n),this.#n.add(e),this.files.setKey(e,void 0),this.#t--,this.#e.has(e)&&this.#e.delete(e),this.#u(),Et.info(`File deleted: ${e}`),!0}catch(n){throw Et.error(`Failed to delete file

`,n),n}}async deleteFolder(e){const r=await this.#r;try{const n=fr.relative(r.workdir,e);if(!n)throw new Error(`EINVAL: invalid folder path, delete '${n}'`);await r.fs.rm(n,{recursive:!0}),this.#n.add(e),this.files.setKey(e,void 0);const s=this.files.get();for(const[i,o]of Object.entries(s))i.startsWith(e+"/")&&(this.files.setKey(i,void 0),this.#n.add(i),o?.type==="file"&&this.#t--,o?.type==="file"&&this.#e.has(i)&&this.#e.delete(i));return this.#u(),Et.info(`Folder deleted: ${e}`),!0}catch(n){throw Et.error(`Failed to delete folder

`,n),n}}#u(){try{typeof localStorage<"u"&&localStorage.setItem("codeia-deleted-paths",JSON.stringify([...this.#n]))}catch(e){Et.error("Failed to persist deleted paths to localStorage",e)}}}function oie(t){return t===void 0?!1:Uf(aie(t),{chunkLength:100})==="binary"}function aie(t){return Of.from(t.buffer,t.byteOffset,t.byteLength)}const lie="preview-updates";class WN{#r=new Map;#t;#e;#n=new Map;#s=new Set;#i=new Map;#o=300;#a;previews=jt([]);constructor(e){if(this.#t=e,this.#e=new BroadcastChannel(lie),this.#a=new BroadcastChannel("storage-sync-channel"),this.#e.onmessage=r=>{const{type:n,previewId:s}=r.data;if(n==="file-change"){const i=r.data.timestamp,o=this.#n.get(s)||0;i>o&&(this.#n.set(s,i),this.refreshPreview(s))}},this.#a.onmessage=r=>{const{storage:n,source:s}=r.data;n&&s!==this._getTabId()&&this._syncStorage(n)},typeof window<"u"){const r=localStorage.setItem;localStorage.setItem=(...n)=>{r.apply(localStorage,n),this._broadcastStorageSync()}}this.#l()}_getTabId(){return typeof window<"u"?(window._tabId||(window._tabId=Math.random().toString(36).substring(2,15)),window._tabId):""}_syncStorage(e){if(typeof window<"u"&&(Object.entries(e).forEach(([n,s])=>{try{Object.getPrototypeOf(localStorage).setItem.call(localStorage,n,s)}catch(i){console.error("[Preview] Error syncing storage:",i)}}),this.previews.get().forEach(n=>{const s=this.getPreviewId(n.baseUrl);s&&this.refreshPreview(s)}),typeof window<"u"&&window.location)){const n=document.querySelector("iframe");n&&(n.src=n.src)}}_broadcastStorageSync(){if(typeof window<"u"){const e={};for(let r=0;r<localStorage.length;r++){const n=localStorage.key(r);n&&(e[n]=localStorage.getItem(n)||"")}this.#a.postMessage({type:"storage-sync",storage:e,source:this._getTabId(),timestamp:Date.now()})}}async#l(){const e=await this.#t;e.on("server-ready",(r,n)=>{console.log("[Preview] Server ready on port:",r,n),this.broadcastUpdate(n),this._broadcastStorageSync()});try{e.internal.watchPaths({include:["**/*.html","**/*.css","**/*.js","**/*.jsx","**/*.ts","**/*.tsx","**/*.json"],exclude:["**/node_modules/**","**/.git/**","**/dist/**","**/build/**","**/coverage/**"]},async r=>{const n=this.previews.get();for(const s of n){const i=this.getPreviewId(s.baseUrl);i&&this.broadcastFileChange(i)}}),typeof window<"u"&&new MutationObserver(n=>{this._broadcastStorageSync()}).observe(document.body,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}catch(r){console.error("[Preview] Error setting up watchers:",r)}e.on("port",(r,n,s)=>{let i=this.#r.get(r);if(n==="close"&&i){this.#r.delete(r),this.previews.set(this.previews.get().filter(a=>a.port!==r));return}const o=this.previews.get();i||(i={port:r,ready:n==="open",baseUrl:s},this.#r.set(r,i),o.push(i)),i.ready=n==="open",i.baseUrl=s,this.previews.set([...o]),n==="open"&&this.broadcastUpdate(s)})}getPreviewId(e){const r=e.match(/^https?:\/\/([^.]+)\.local-credentialless\.webcontainer-api\.io/);return r?r[1]:null}broadcastStateChange(e){const r=Date.now();this.#n.set(e,r),this.#e.postMessage({type:"state-change",previewId:e,timestamp:r})}broadcastFileChange(e){const r=Date.now();this.#n.set(e,r),this.#e.postMessage({type:"file-change",previewId:e,timestamp:r})}broadcastUpdate(e){const r=this.getPreviewId(e);if(r){const n=Date.now();this.#n.set(r,n),this.#e.postMessage({type:"file-change",previewId:r,timestamp:n})}}refreshPreview(e){const r=this.#i.get(e);r&&clearTimeout(r);const n=setTimeout(()=>{const s=this.previews.get(),i=s.find(o=>this.getPreviewId(o.baseUrl)===e);i&&(i.ready=!1,this.previews.set([...s]),requestAnimationFrame(()=>{i.ready=!0,this.previews.set([...s])})),this.#i.delete(e)},this.#o);this.#i.set(e,n)}refreshAllPreviews(){const e=this.previews.get();for(const r of e){const n=this.getPreviewId(r.baseUrl);n&&this.broadcastFileChange(n)}}}let py=null;function cie(){return py||(py=new WN(Promise.resolve({}))),py}function KN(){if(typeof Promise.withResolvers=="function")return Promise.withResolvers();let t,e;const r=new Promise((n,s)=>{t=n,e=s});return{resolve:t,reject:e,promise:r}}const gd=jt(null);async function uie(t,e){const r=[],n=await t.spawn("/bin/jsh",["--osc",...r],{terminal:{cols:e.cols??80,rows:e.rows??15}}),s=n.input.getWriter(),i=n.output,o=KN();let a=!1;return i.pipeTo(new WritableStream({write(l){if(!a){const[,c]=l.match(/\x1b\]654;([^\x07]+)\x07/)||[];c==="interactive"&&(a=!0,o.resolve())}e.write(l)}})),e.onData(l=>{a&&s.write(l)}),await o.promise,n}class die{#r;#t;#e;#n;#s;executionState=jt();#i;#o;constructor(){this.#t=new Promise(e=>{this.#r=e})}ready(){return this.#t}async init(e,r){this.#e=e,this.#n=r;const{process:n,commandStream:s,expoUrlStream:i}=await this.newCodeiaShellProcess(e,r);this.#s=n,this.#i=s.getReader(),this._watchExpoUrlInBackground(i),await this.waitTillOscCode("interactive"),this.#r?.()}async newCodeiaShellProcess(e,r){const n=[],s=await e.spawn("/bin/jsh",["--osc",...n],{terminal:{cols:r.cols??80,rows:r.rows??15}}),i=s.input.getWriter();this.#o=i;const[o,a]=s.output.tee(),[l,c]=a.tee(),u=KN();let d=!1;return o.pipeTo(new WritableStream({write(h){if(!d){const[,f]=h.match(/\x1b\]654;([^\x07]+)\x07/)||[];f==="interactive"&&(d=!0,u.resolve())}r.write(h)}})),r.onData(h=>{d&&i.write(h)}),await u.promise,{process:s,terminalStream:o,commandStream:l,expoUrlStream:c}}async _watchExpoUrlInBackground(e){const r=e.getReader();let n="";const s=/(exp:\/\/[^\s]+)/;for(;;){const{value:i,done:o}=await r.read();if(o)break;n+=i||"";const a=n.match(s);if(a){const l=a[1].replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"").replace(/[^\x20-\x7E]+$/g,"");gd.set(l),n=n.slice(n.indexOf(a[1])+a[1].length)}n.length>2048&&(n=n.slice(-2048))}}get terminal(){return this.#n}get process(){return this.#s}async executeCommand(e,r,n){if(!this.process||!this.terminal)return;const s=this.executionState.get();s?.active&&s.abort&&s.abort(),this.terminal.input(""),await this.waitTillOscCode("prompt"),s&&s.executionPrms&&await s.executionPrms,this.terminal.input(r.trim()+`
`);const i=this.getCurrentExecutionResult();this.executionState.set({sessionId:e,active:!0,executionPrms:i,abort:n});const o=await i;if(this.executionState.set({sessionId:e,active:!1}),o)try{o.output=hie(o.output)}catch(a){console.log("failed to format terminal output",a)}return o}async getCurrentExecutionResult(){const{output:e,exitCode:r}=await this.waitTillOscCode("exit");return{output:e,exitCode:r}}onQRCodeDetected;async waitTillOscCode(e){let r="",n=0,s="";if(!this.#i)return{output:r,exitCode:n};const i=this.#i,o=/(exp:\/\/[^\s]+)/;for(;;){const{value:a,done:l}=await i.read();if(l)break;const c=a||"";r+=c,s+=c;const u=s.match(o);if(u){const f=u[1].replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"").replace(/[^\x20-\x7E]+$/g,"");gd.set(f),s=s.slice(s.indexOf(u[1])+u[1].length)}const[,d,,,h]=c.match(/\x1b\]654;([^\x07=]+)=?((-?\d+):(\d+))?\x07/)||[];if(d==="exit"&&(n=parseInt(h,10)),d===e)break}return{output:r,exitCode:n}}}function hie(t){return t.replace(/\x1b\](\d+;[^\x07\x1b]*|\d+[^\x07\x1b]*)\x07/g,"").replace(/\](\d+;[^\n]*|\d+[^\n]*)/g,"").replace(/\u001b\[[\?]?[0-9;]*[a-zA-Z]/g,"").replace(/\x1b\[[\?]?[0-9;]*[a-zA-Z]/g,"").replace(/\u001b\[[0-9;]*m/g,"").replace(/\x1b\[[0-9;]*m/g,"").replace(/\u001b/g,"").replace(/\x1b/g,"").replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n{3,}/g,`

`).replace(/^([~\/][^\n❯]+)❯/m,`$1
❯`).replace(/(?<!^|\n)>/g,`
>`).replace(/(?<!^|\n|\w)(error|failed|warning|Error|Failed|Warning):/g,`
$1:`).replace(/(?<!^|\n|\/)(at\s+(?!async|sync))/g,`
at `).replace(/\bat\s+async/g,"at async").replace(/(?<!^|\n)(npm ERR!)/g,`
$1`).split(`
`).map(o=>o.trim()).filter(o=>o.length>0).join(`
`).replace(/\n{3,}/g,`

`).replace(/:\s+/g,": ").replace(/\s{2,}/g," ").replace(/^\s+|\s+$/g,"").replace(/\u0000/g,"")}function fie(){return new die}const pie="\x1B[0m",mie={red:"\x1B[1;31m"},kT={red:t=>`${mie.red}${t}${pie}`};class gie{#r;#t=[];#e=fie();showTerminal=jt(!0);constructor(e){this.#r=e}get codeiaTerminal(){return this.#e}toggleTerminal(e){this.showTerminal.set(e!==void 0?e:!this.showTerminal.get())}async attachCodeiaTerminal(e){try{const r=await this.#r;await this.#e.init(r,e)}catch(r){e.write(kT.red(`Failed to spawn codeia shell

`)+r.message);return}}async attachTerminal(e){try{const r=await uie(await this.#r,e);this.#t.push({terminal:e,process:r})}catch(r){e.write(kT.red(`Failed to spawn shell

`)+r.message);return}}onTerminalResize(e,r){for(const{process:n}of this.#t)n.resize({cols:e,rows:r})}}function qh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qN={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,s,i){function o(c,u){if(!s[c]){if(!n[c]){var d=typeof qh=="function"&&qh;if(!u&&d)return d(c,!0);if(a)return a(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var f=s[c]={exports:{}};n[c][0].call(f.exports,function(v){var m=n[c][1][v];return o(m||v)},f,f.exports,r,n,s,i)}return s[c].exports}for(var a=typeof qh=="function"&&qh,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(r,n,s){var i=r("./utils"),o=r("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,f,v,m,p=[],g=0,y=l.length,_=y,b=i.getTypeOf(l)!=="string";g<l.length;)_=y-g,d=b?(c=l[g++],u=g<y?l[g++]:0,g<y?l[g++]:0):(c=l.charCodeAt(g++),u=g<y?l.charCodeAt(g++):0,g<y?l.charCodeAt(g++):0),h=c>>2,f=(3&c)<<4|u>>4,v=1<_?(15&u)<<2|d>>6:64,m=2<_?63&d:64,p.push(a.charAt(h)+a.charAt(f)+a.charAt(v)+a.charAt(m));return p.join("")},s.decode=function(l){var c,u,d,h,f,v,m=0,p=0,g="data:";if(l.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var y,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&_--,l.charAt(l.length-2)===a.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=o.uint8array?new Uint8Array(0|_):new Array(0|_);m<l.length;)c=a.indexOf(l.charAt(m++))<<2|(h=a.indexOf(l.charAt(m++)))>>4,u=(15&h)<<4|(f=a.indexOf(l.charAt(m++)))>>2,d=(3&f)<<6|(v=a.indexOf(l.charAt(m++))),y[p++]=c,f!==64&&(y[p++]=u),v!==64&&(y[p++]=d);return y}},{"./support":30,"./utils":32}],2:[function(r,n,s){var i=r("./external"),o=r("./stream/DataWorker"),a=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function c(u,d,h,f,v){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=f,this.compressedContent=v}c.prototype={getContentWorker:function(){var u=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,s){var i=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,s){var i=r("./utils"),o=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?i.getTypeOf(a)!=="string"?function(c,u,d,h){var f=o,v=h+d;c^=-1;for(var m=h;m<v;m++)c=c>>>8^f[255&(c^u[m])];return-1^c}(0|l,a,a.length,0):function(c,u,d,h){var f=o,v=h+d;c^=-1;for(var m=h;m<v;m++)c=c>>>8^f[255&(c^u.charCodeAt(m))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(r,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,n,s){var i=null;i=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:i}},{lie:37}],7:[function(r,n,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),a=r("./utils"),l=r("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,s){function i(f,v){var m,p="";for(m=0;m<v;m++)p+=String.fromCharCode(255&f),f>>>=8;return p}function o(f,v,m,p,g,y){var _,b,w=f.file,E=f.compression,S=y!==c.utf8encode,x=a.transformTo("string",y(w.name)),T=a.transformTo("string",c.utf8encode(w.name)),D=w.comment,O=a.transformTo("string",y(D)),R=a.transformTo("string",c.utf8encode(D)),P=T.length!==w.name.length,A=R.length!==D.length,H="",K="",V="",q=w.dir,I=w.date,$={crc32:0,compressedSize:0,uncompressedSize:0};v&&!m||($.crc32=f.crc32,$.compressedSize=f.compressedSize,$.uncompressedSize=f.uncompressedSize);var j=0;v&&(j|=8),S||!P&&!A||(j|=2048);var U=0,J=0;q&&(U|=16),g==="UNIX"?(J=798,U|=function(te,me){var re=te;return te||(re=me?16893:33204),(65535&re)<<16}(w.unixPermissions,q)):(J=20,U|=function(te){return 63&(te||0)}(w.dosPermissions)),_=I.getUTCHours(),_<<=6,_|=I.getUTCMinutes(),_<<=5,_|=I.getUTCSeconds()/2,b=I.getUTCFullYear()-1980,b<<=4,b|=I.getUTCMonth()+1,b<<=5,b|=I.getUTCDate(),P&&(K=i(1,1)+i(u(x),4)+T,H+="up"+i(K.length,2)+K),A&&(V=i(1,1)+i(u(O),4)+R,H+="uc"+i(V.length,2)+V);var ne="";return ne+=`
\0`,ne+=i(j,2),ne+=E.magic,ne+=i(_,2),ne+=i(b,2),ne+=i($.crc32,4),ne+=i($.compressedSize,4),ne+=i($.uncompressedSize,4),ne+=i(x.length,2),ne+=i(H.length,2),{fileRecord:d.LOCAL_FILE_HEADER+ne+x+H,dirRecord:d.CENTRAL_FILE_HEADER+i(J,2)+ne+i(O.length,2)+"\0\0\0\0"+i(U,4)+i(p,4)+x+H+O}}var a=r("../utils"),l=r("../stream/GenericWorker"),c=r("../utf8"),u=r("../crc32"),d=r("../signature");function h(f,v,m,p){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=m,this.encodeFileName=p,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(h,l),h.prototype.push=function(f){var v=f.meta.percent||0,m=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:m?(v+100*(m-p-1))/m:100}}))},h.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var v=this.streamFiles&&!f.file.dir;if(v){var m=o(f,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(f){this.accumulate=!1;var v=this.streamFiles&&!f.file.dir,m=o(f,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),v)this.push({data:function(p){return d.DATA_DESCRIPTOR+i(p.crc32,4)+i(p.compressedSize,4)+i(p.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var f=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var m=this.bytesWritten-f,p=function(g,y,_,b,w){var E=a.transformTo("string",w(b));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(y,4)+i(_,4)+i(E.length,2)+E}(this.dirRecords.length,m,f,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(f){this._sources.push(f);var v=this;return f.on("data",function(m){v.processChunk(m)}),f.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),f.on("error",function(m){v.error(m)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(f){var v=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var m=0;m<v.length;m++)try{v[m].error(f)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,v=0;v<f.length;v++)f[v].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,s){var i=r("../compressions"),o=r("./ZipFileWorker");s.generateWorker=function(a,l,c){var u=new o(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{a.forEach(function(h,f){d++;var v=function(y,_){var b=y||_,w=i[b];if(!w)throw new Error(b+" is not a valid compression method !");return w}(f.options.compression,l.compression),m=f.options.compressionOptions||l.compressionOptions||{},p=f.dir,g=f.date;f._compressWorker(v,m).withStreamInfo("file",{name:h,dir:p,date:g,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(o,a){return new i().loadAsync(o,a)},i.external=r("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,s){var i=r("./utils"),o=r("./external"),a=r("./utf8"),l=r("./zipEntries"),c=r("./stream/Crc32Probe"),u=r("./nodejsUtils");function d(h){return new o.Promise(function(f,v){var m=h.decompressed.getContentWorker().pipe(new c);m.on("error",function(p){v(p)}).on("end",function(){m.streamInfo.crc32!==h.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}n.exports=function(h,f){var v=this;return f=i.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(h)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,f.optimizedBinaryString,f.base64).then(function(m){var p=new l(f);return p.load(m),p}).then(function(m){var p=[o.Promise.resolve(m)],g=m.files;if(f.checkCRC32)for(var y=0;y<g.length;y++)p.push(d(g[y]));return o.Promise.all(p)}).then(function(m){for(var p=m.shift(),g=p.files,y=0;y<g.length;y++){var _=g[y],b=_.fileNameStr,w=i.resolve(_.fileNameStr);v.file(w,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:f.createFolders}),_.dir||(v.file(w).unsafeOriginalName=b)}return p.zipComment.length&&(v.comment=p.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,s){var i=r("../utils"),o=r("../stream/GenericWorker");function a(l,c){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(a,o),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,s){var i=r("readable-stream").Readable;function o(a,l,c){i.call(this,l),this._helper=a;var u=this;a.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}r("../utils").inherits(o,i),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,n,s){n.exports={isNode:typeof Ht<"u",newBufferFrom:function(i,o){if(Ht.from&&Ht.from!==Uint8Array.from)return Ht.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Ht(i,o)},allocBuffer:function(i){if(Ht.alloc)return Ht.alloc(i);var o=new Ht(i);return o.fill(0),o},isBuffer:function(i){return Ht.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,n,s){function i(w,E,S){var x,T=a.getTypeOf(E),D=a.extend(S||{},u);D.date=D.date||new Date,D.compression!==null&&(D.compression=D.compression.toUpperCase()),typeof D.unixPermissions=="string"&&(D.unixPermissions=parseInt(D.unixPermissions,8)),D.unixPermissions&&16384&D.unixPermissions&&(D.dir=!0),D.dosPermissions&&16&D.dosPermissions&&(D.dir=!0),D.dir&&(w=g(w)),D.createFolders&&(x=p(w))&&y.call(this,x,!0);var O=T==="string"&&D.binary===!1&&D.base64===!1;S&&S.binary!==void 0||(D.binary=!O),(E instanceof d&&E.uncompressedSize===0||D.dir||!E||E.length===0)&&(D.base64=!1,D.binary=!0,E="",D.compression="STORE",T="string");var R=null;R=E instanceof d||E instanceof l?E:v.isNode&&v.isStream(E)?new m(w,E):a.prepareContent(w,E,D.binary,D.optimizedBinaryString,D.base64);var P=new h(w,R,D);this.files[w]=P}var o=r("./utf8"),a=r("./utils"),l=r("./stream/GenericWorker"),c=r("./stream/StreamHelper"),u=r("./defaults"),d=r("./compressedObject"),h=r("./zipObject"),f=r("./generate"),v=r("./nodejsUtils"),m=r("./nodejs/NodejsStreamInputAdapter"),p=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var E=w.lastIndexOf("/");return 0<E?w.substring(0,E):""},g=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},y=function(w,E){return E=E!==void 0?E:u.createFolders,w=g(w),this.files[w]||i.call(this,w,null,{dir:!0,createFolders:E}),this.files[w]};function _(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var E,S,x;for(E in this.files)x=this.files[E],(S=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&w(S,x)},filter:function(w){var E=[];return this.forEach(function(S,x){w(S,x)&&E.push(x)}),E},file:function(w,E,S){if(arguments.length!==1)return w=this.root+w,i.call(this,w,E,S),this;if(_(w)){var x=w;return this.filter(function(D,O){return!O.dir&&x.test(D)})}var T=this.files[this.root+w];return T&&!T.dir?T:null},folder:function(w){if(!w)return this;if(_(w))return this.filter(function(T,D){return D.dir&&w.test(T)});var E=this.root+w,S=y.call(this,E),x=this.clone();return x.root=S.name,x},remove:function(w){w=this.root+w;var E=this.files[w];if(E||(w.slice(-1)!=="/"&&(w+="/"),E=this.files[w]),E&&!E.dir)delete this.files[w];else for(var S=this.filter(function(T,D){return D.name.slice(0,w.length)===w}),x=0;x<S.length;x++)delete this.files[S[x].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var E,S={};try{if((S=a.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");a.checkSupport(S.type),S.platform!=="darwin"&&S.platform!=="freebsd"&&S.platform!=="linux"&&S.platform!=="sunos"||(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var x=S.comment||this.comment||"";E=f.generateWorker(this,S,x)}catch(T){(E=new l("error")).error(T)}return new c(E,S.type||"string",S.mimeType)},generateAsync:function(w,E){return this.generateInternalStream(w).accumulate(E)},generateNodeStream:function(w,E){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(E)}};n.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,s){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,s){var i=r("./DataReader");function o(a){i.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}r("../utils").inherits(o,i),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,n,s){var i=r("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=o},{"../utils":32}],19:[function(r,n,s){var i=r("./Uint8ArrayReader");function o(a){i.call(this,a)}r("../utils").inherits(o,i),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,s){var i=r("./DataReader");function o(a){i.call(this,a)}r("../utils").inherits(o,i),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,n,s){var i=r("./ArrayReader");function o(a){i.call(this,a)}r("../utils").inherits(o,i),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,s){var i=r("../utils"),o=r("../support"),a=r("./ArrayReader"),l=r("./StringReader"),c=r("./NodeBufferReader"),u=r("./Uint8ArrayReader");n.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||o.uint8array?h==="nodebuffer"?new c(d):o.uint8array?new u(i.transformTo("uint8array",d)):new a(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,s){var i=r("./GenericWorker"),o=r("../utils");function a(l){i.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,i),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,s){var i=r("./GenericWorker"),o=r("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(a,i),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,s){var i=r("../utils"),o=r("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(a,o),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}o.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,s){var i=r("../utils"),o=r("./GenericWorker");function a(l){o.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=i},{}],29:[function(r,n,s){var i=r("../utils"),o=r("./ConvertWorker"),a=r("./GenericWorker"),l=r("../base64"),c=r("../support"),u=r("../external"),d=null;if(c.nodestream)try{d=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(v,m){return new u.Promise(function(p,g){var y=[],_=v._internalType,b=v._outputType,w=v._mimeType;v.on("data",function(E,S){y.push(E),m&&m(S)}).on("error",function(E){y=[],g(E)}).on("end",function(){try{var E=function(S,x,T){switch(S){case"blob":return i.newBlob(i.transformTo("arraybuffer",x),T);case"base64":return l.encode(x);default:return i.transformTo(S,x)}}(b,function(S,x){var T,D=0,O=null,R=0;for(T=0;T<x.length;T++)R+=x[T].length;switch(S){case"string":return x.join("");case"array":return Array.prototype.concat.apply([],x);case"uint8array":for(O=new Uint8Array(R),T=0;T<x.length;T++)O.set(x[T],D),D+=x[T].length;return O;case"nodebuffer":return Ht.concat(x);default:throw new Error("concat : unsupported type '"+S+"'")}}(_,y),w);p(E)}catch(S){g(S)}y=[]}).resume()})}function f(v,m,p){var g=m;switch(m){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=m,this._mimeType=p,i.checkSupport(g),this._worker=v.pipe(new o(g)),v.lock()}catch(y){this._worker=new a("error"),this._worker.error(y)}}f.prototype={accumulate:function(v){return h(this,v)},on:function(v,m){var p=this;return v==="data"?this._worker.on(v,function(g){m.call(p,g.data,g.meta)}):this._worker.on(v,function(){i.delay(m,arguments,p)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Ht<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,s){for(var i=r("./utils"),o=r("./support"),a=r("./nodejsUtils"),l=r("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(f){return o.nodebuffer?a.newBufferFrom(f,"utf-8"):function(v){var m,p,g,y,_,b=v.length,w=0;for(y=0;y<b;y++)(64512&(p=v.charCodeAt(y)))==55296&&y+1<b&&(64512&(g=v.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),y++),w+=p<128?1:p<2048?2:p<65536?3:4;for(m=o.uint8array?new Uint8Array(w):new Array(w),y=_=0;_<w;y++)(64512&(p=v.charCodeAt(y)))==55296&&y+1<b&&(64512&(g=v.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),y++),p<128?m[_++]=p:(p<2048?m[_++]=192|p>>>6:(p<65536?m[_++]=224|p>>>12:(m[_++]=240|p>>>18,m[_++]=128|p>>>12&63),m[_++]=128|p>>>6&63),m[_++]=128|63&p);return m}(f)},s.utf8decode=function(f){return o.nodebuffer?i.transformTo("nodebuffer",f).toString("utf-8"):function(v){var m,p,g,y,_=v.length,b=new Array(2*_);for(m=p=0;m<_;)if((g=v[m++])<128)b[p++]=g;else if(4<(y=c[g]))b[p++]=65533,m+=y-1;else{for(g&=y===2?31:y===3?15:7;1<y&&m<_;)g=g<<6|63&v[m++],y--;1<y?b[p++]=65533:g<65536?b[p++]=g:(g-=65536,b[p++]=55296|g>>10&1023,b[p++]=56320|1023&g)}return b.length!==p&&(b.subarray?b=b.subarray(0,p):b.length=p),i.applyFromCharCode(b)}(f=i.transformTo(o.uint8array?"uint8array":"array",f))},i.inherits(d,l),d.prototype.processChunk=function(f){var v=i.transformTo(o.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=v;(v=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),v.set(m,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var p=function(y,_){var b;for((_=_||y.length)>y.length&&(_=y.length),b=_-1;0<=b&&(192&y[b])==128;)b--;return b<0||b===0?_:b+c[y[b]]>_?b:_}(v),g=v;p!==v.length&&(o.uint8array?(g=v.subarray(0,p),this.leftOver=v.subarray(p,v.length)):(g=v.slice(0,p),this.leftOver=v.slice(p,v.length))),this.push({data:s.utf8decode(g),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(f){this.push({data:s.utf8encode(f.data),meta:f.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,s){var i=r("./support"),o=r("./base64"),a=r("./nodejsUtils"),l=r("./external");function c(m){return m}function u(m,p){for(var g=0;g<m.length;++g)p[g]=255&m.charCodeAt(g);return p}r("setimmediate"),s.newBlob=function(m,p){s.checkSupport("blob");try{return new Blob([m],{type:p})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(m),g.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(m,p,g){var y=[],_=0,b=m.length;if(b<=g)return String.fromCharCode.apply(null,m);for(;_<b;)p==="array"||p==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(_,Math.min(_+g,b)))):y.push(String.fromCharCode.apply(null,m.subarray(_,Math.min(_+g,b)))),_+=g;return y.join("")},stringifyByChar:function(m){for(var p="",g=0;g<m.length;g++)p+=String.fromCharCode(m[g]);return p},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function h(m){var p=65536,g=s.getTypeOf(m),y=!0;if(g==="uint8array"?y=d.applyCanBeUsed.uint8array:g==="nodebuffer"&&(y=d.applyCanBeUsed.nodebuffer),y)for(;1<p;)try{return d.stringifyByChunk(m,g,p)}catch{p=Math.floor(p/2)}return d.stringifyByChar(m)}function f(m,p){for(var g=0;g<m.length;g++)p[g]=m[g];return p}s.applyFromCharCode=h;var v={};v.string={string:c,array:function(m){return u(m,new Array(m.length))},arraybuffer:function(m){return v.string.uint8array(m).buffer},uint8array:function(m){return u(m,new Uint8Array(m.length))},nodebuffer:function(m){return u(m,a.allocBuffer(m.length))}},v.array={string:h,array:c,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(m)}},v.arraybuffer={string:function(m){return h(new Uint8Array(m))},array:function(m){return f(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:c,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(new Uint8Array(m))}},v.uint8array={string:h,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:c,nodebuffer:function(m){return a.newBufferFrom(m)}},v.nodebuffer={string:h,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return v.nodebuffer.uint8array(m).buffer},uint8array:function(m){return f(m,new Uint8Array(m.length))},nodebuffer:c},s.transformTo=function(m,p){if(p=p||"",!m)return p;s.checkSupport(m);var g=s.getTypeOf(p);return v[g][m](p)},s.resolve=function(m){for(var p=m.split("/"),g=[],y=0;y<p.length;y++){var _=p[y];_==="."||_===""&&y!==0&&y!==p.length-1||(_===".."?g.pop():g.push(_))}return g.join("/")},s.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":i.nodebuffer&&a.isBuffer(m)?"nodebuffer":i.uint8array&&m instanceof Uint8Array?"uint8array":i.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(m){if(!i[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(m){var p,g,y="";for(g=0;g<(m||"").length;g++)y+="\\x"+((p=m.charCodeAt(g))<16?"0":"")+p.toString(16).toUpperCase();return y},s.delay=function(m,p,g){setImmediate(function(){m.apply(g||null,p||[])})},s.inherits=function(m,p){function g(){}g.prototype=p.prototype,m.prototype=new g},s.extend=function(){var m,p,g={};for(m=0;m<arguments.length;m++)for(p in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],p)&&g[p]===void 0&&(g[p]=arguments[m][p]);return g},s.prepareContent=function(m,p,g,y,_){return l.Promise.resolve(p).then(function(b){return i.blob&&(b instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(b))!==-1)&&typeof FileReader<"u"?new l.Promise(function(w,E){var S=new FileReader;S.onload=function(x){w(x.target.result)},S.onerror=function(x){E(x.target.error)},S.readAsArrayBuffer(b)}):b}).then(function(b){var w=s.getTypeOf(b);return w?(w==="arraybuffer"?b=s.transformTo("uint8array",b):w==="string"&&(_?b=o.decode(b):g&&y!==!0&&(b=function(E){return u(E,i.uint8array?new Uint8Array(E.length):new Array(E.length))}(b))),b):l.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,s){var i=r("./reader/readerFor"),o=r("./utils"),a=r("./signature"),l=r("./zipEntry"),c=r("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(h)+", expected "+o.pretty(d)+")")}},isSignature:function(d,h){var f=this.reader.index;this.reader.setIndex(d);var v=this.reader.readString(4)===h;return this.reader.setIndex(f),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",f=o.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,f,v=this.zip64EndOfCentralSize-44;0<v;)d=this.reader.readInt(2),h=this.reader.readInt(4),f=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var v=h-f;if(0<v)this.isSignature(h,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,s){var i=r("./reader/readerFor"),o=r("./utils"),a=r("./compressedObject"),l=r("./crc32"),c=r("./utf8"),u=r("./compressions"),d=r("./support");function h(f,v){this.options=f,this.loadOptions=v}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var v,m;if(f.skip(22),this.fileNameLength=f.readInt(2),m=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(p){for(var g in u)if(Object.prototype.hasOwnProperty.call(u,g)&&u[g].magic===p)return u[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var v=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(v),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var v,m,p,g=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<g;)v=f.readInt(2),m=f.readInt(2),p=f.readData(m),this.extraFields[v]={id:v,length:m,value:p};f.setIndex(g)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var m=o.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var g=o.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var v=i(f.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:c.utf8decode(v.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var v=i(f.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:c.utf8decode(v.readData(f.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,s){function i(v,m,p){this.name=v,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=m,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var o=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),l=r("./utf8"),c=r("./compressedObject"),u=r("./stream/GenericWorker");i.prototype={internalStream:function(v){var m=null,p="string";try{if(!v)throw new Error("No output type specified.");var g=(p=v.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),m=this._decompressWorker();var y=!this._dataBinary;y&&!g&&(m=m.pipe(new l.Utf8EncodeWorker)),!y&&g&&(m=m.pipe(new l.Utf8DecodeWorker))}catch(_){(m=new u("error")).error(_)}return new o(m,p,"")},async:function(v,m){return this.internalStream(v).accumulate(m)},nodeStream:function(v,m){return this.internalStream(v||"nodebuffer").toNodejsStream(m)},_compressWorker:function(v,m){if(this._data instanceof c&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(p,v,m)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)i.prototype[d[f]]=h;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,s){(function(i){var o,a,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(v),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)o="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var m=i.document.createElement("script");m.onreadystatechange=function(){v(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},i.document.documentElement.appendChild(m)}:function(){setTimeout(v,0)};else{var h=new i.MessageChannel;h.port1.onmessage=v,o=function(){h.port2.postMessage(0)}}var f=[];function v(){var m,p;a=!0;for(var g=f.length;g;){for(p=f,f=[],m=-1;++m<g;)p[m]();g=f.length}a=!1}n.exports=function(m){f.push(m)!==1||a||o()}}).call(this,typeof $t<"u"?$t:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,s){var i=r("immediate");function o(){}var a={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,g!==o&&m(this,g)}function h(g,y,_){this.promise=g,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function f(g,y,_){i(function(){var b;try{b=y(_)}catch(w){return a.reject(g,w)}b===g?a.reject(g,new TypeError("Cannot resolve promise with itself")):a.resolve(g,b)})}function v(g){var y=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof y=="function")return function(){y.apply(g,arguments)}}function m(g,y){var _=!1;function b(S){_||(_=!0,a.reject(g,S))}function w(S){_||(_=!0,a.resolve(g,S))}var E=p(function(){y(w,b)});E.status==="error"&&b(E.value)}function p(g,y){var _={};try{_.value=g(y),_.status="success"}catch(b){_.status="error",_.value=b}return _}(n.exports=d).prototype.finally=function(g){if(typeof g!="function")return this;var y=this.constructor;return this.then(function(_){return y.resolve(g()).then(function(){return _})},function(_){return y.resolve(g()).then(function(){throw _})})},d.prototype.catch=function(g){return this.then(null,g)},d.prototype.then=function(g,y){if(typeof g!="function"&&this.state===c||typeof y!="function"&&this.state===l)return this;var _=new this.constructor(o);return this.state!==u?f(_,this.state===c?g:y,this.outcome):this.queue.push(new h(_,g,y)),_},h.prototype.callFulfilled=function(g){a.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){f(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){a.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){f(this.promise,this.onRejected,g)},a.resolve=function(g,y){var _=p(v,y);if(_.status==="error")return a.reject(g,_.value);var b=_.value;if(b)m(g,b);else{g.state=c,g.outcome=y;for(var w=-1,E=g.queue.length;++w<E;)g.queue[w].callFulfilled(y)}return g},a.reject=function(g,y){g.state=l,g.outcome=y;for(var _=-1,b=g.queue.length;++_<b;)g.queue[_].callRejected(y);return g},d.resolve=function(g){return g instanceof this?g:a.resolve(new this(o),g)},d.reject=function(g){var y=new this(o);return a.reject(y,g)},d.all=function(g){var y=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=g.length,b=!1;if(!_)return this.resolve([]);for(var w=new Array(_),E=0,S=-1,x=new this(o);++S<_;)T(g[S],S);return x;function T(D,O){y.resolve(D).then(function(R){w[O]=R,++E!==_||b||(b=!0,a.resolve(x,w))},function(R){b||(b=!0,a.reject(x,R))})}},d.race=function(g){var y=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=g.length,b=!1;if(!_)return this.resolve([]);for(var w=-1,E=new this(o);++w<_;)S=g[w],y.resolve(S).then(function(x){b||(b=!0,a.resolve(E,x))},function(x){b||(b=!0,a.reject(E,x))});var S;return E}},{immediate:36}],38:[function(r,n,s){var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,s){var i=r("./zlib/deflate"),o=r("./utils/common"),a=r("./utils/strings"),l=r("./zlib/messages"),c=r("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,f=0,v=8;function m(g){if(!(this instanceof m))return new m(g);this.options=o.assign({level:h,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},g||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=i.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(_!==d)throw new Error(l[_]);if(y.header&&i.deflateSetHeader(this.strm,y.header),y.dictionary){var b;if(b=typeof y.dictionary=="string"?a.string2buf(y.dictionary):u.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(_=i.deflateSetDictionary(this.strm,b))!==d)throw new Error(l[_]);this._dict_set=!0}}function p(g,y){var _=new m(y);if(_.push(g,!0),_.err)throw _.msg||l[_.err];return _.result}m.prototype.push=function(g,y){var _,b,w=this.strm,E=this.options.chunkSize;if(this.ended)return!1;b=y===~~y?y:y===!0?4:0,typeof g=="string"?w.input=a.string2buf(g):u.call(g)==="[object ArrayBuffer]"?w.input=new Uint8Array(g):w.input=g,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new o.Buf8(E),w.next_out=0,w.avail_out=E),(_=i.deflate(w,b))!==1&&_!==d)return this.onEnd(_),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||b!==4&&b!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(w.output,w.next_out))):this.onData(o.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&_!==1);return b===4?(_=i.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===d):b!==2||(this.onEnd(d),!(w.avail_out=0))},m.prototype.onData=function(g){this.chunks.push(g)},m.prototype.onEnd=function(g){g===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},s.Deflate=m,s.deflate=p,s.deflateRaw=function(g,y){return(y=y||{}).raw=!0,p(g,y)},s.gzip=function(g,y){return(y=y||{}).gzip=!0,p(g,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,s){var i=r("./zlib/inflate"),o=r("./utils/common"),a=r("./utils/strings"),l=r("./zlib/constants"),c=r("./zlib/messages"),u=r("./zlib/zstream"),d=r("./zlib/gzheader"),h=Object.prototype.toString;function f(m){if(!(this instanceof f))return new f(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||m&&m.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&!(15&p.windowBits)&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,p.windowBits);if(g!==l.Z_OK)throw new Error(c[g]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function v(m,p){var g=new f(p);if(g.push(m,!0),g.err)throw g.msg||c[g.err];return g.result}f.prototype.push=function(m,p){var g,y,_,b,w,E,S=this.strm,x=this.options.chunkSize,T=this.options.dictionary,D=!1;if(this.ended)return!1;y=p===~~p?p:p===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof m=="string"?S.input=a.binstring2buf(m):h.call(m)==="[object ArrayBuffer]"?S.input=new Uint8Array(m):S.input=m,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new o.Buf8(x),S.next_out=0,S.avail_out=x),(g=i.inflate(S,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&T&&(E=typeof T=="string"?a.string2buf(T):h.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,g=i.inflateSetDictionary(this.strm,E)),g===l.Z_BUF_ERROR&&D===!0&&(g=l.Z_OK,D=!1),g!==l.Z_STREAM_END&&g!==l.Z_OK)return this.onEnd(g),!(this.ended=!0);S.next_out&&(S.avail_out!==0&&g!==l.Z_STREAM_END&&(S.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=a.utf8border(S.output,S.next_out),b=S.next_out-_,w=a.buf2string(S.output,_),S.next_out=b,S.avail_out=x-b,b&&o.arraySet(S.output,S.output,_,b,0),this.onData(w)):this.onData(o.shrinkBuf(S.output,S.next_out)))),S.avail_in===0&&S.avail_out===0&&(D=!0)}while((0<S.avail_in||S.avail_out===0)&&g!==l.Z_STREAM_END);return g===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(S.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},s.Inflate=f,s.inflate=v,s.inflateRaw=function(m,p){return(p=p||{}).raw=!0,v(m,p)},s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var o={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var f=0;f<d;f++)l[h+f]=c[u+f]},flattenChunks:function(l){var c,u,d,h,f,v;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(v=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)f=l[c],v.set(f,h),h+=f.length;return v}},a={arraySet:function(l,c,u,d,h){for(var f=0;f<d;f++)l[h+f]=c[u+f]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(i)},{}],42:[function(r,n,s){var i=r("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&a||!d.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var f="",v=0;v<h;v++)f+=String.fromCharCode(d[v]);return f}l[254]=l[254]=1,s.string2buf=function(d){var h,f,v,m,p,g=d.length,y=0;for(m=0;m<g;m++)(64512&(f=d.charCodeAt(m)))==55296&&m+1<g&&(64512&(v=d.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(v-56320),m++),y+=f<128?1:f<2048?2:f<65536?3:4;for(h=new i.Buf8(y),m=p=0;p<y;m++)(64512&(f=d.charCodeAt(m)))==55296&&m+1<g&&(64512&(v=d.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(v-56320),m++),f<128?h[p++]=f:(f<2048?h[p++]=192|f>>>6:(f<65536?h[p++]=224|f>>>12:(h[p++]=240|f>>>18,h[p++]=128|f>>>12&63),h[p++]=128|f>>>6&63),h[p++]=128|63&f);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),f=0,v=h.length;f<v;f++)h[f]=d.charCodeAt(f);return h},s.buf2string=function(d,h){var f,v,m,p,g=h||d.length,y=new Array(2*g);for(f=v=0;f<g;)if((m=d[f++])<128)y[v++]=m;else if(4<(p=l[m]))y[v++]=65533,f+=p-1;else{for(m&=p===2?31:p===3?15:7;1<p&&f<g;)m=m<<6|63&d[f++],p--;1<p?y[v++]=65533:m<65536?y[v++]=m:(m-=65536,y[v++]=55296|m>>10&1023,y[v++]=56320|1023&m)}return u(y,v)},s.utf8border=function(d,h){var f;for((h=h||d.length)>d.length&&(h=d.length),f=h-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?h:f+l[d[f]]>h?f:h}},{"./common":41}],43:[function(r,n,s){n.exports=function(i,o,a,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(c=c+o[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(r,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,s){var i=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();n.exports=function(o,a,l,c){var u=i,d=c+l;o^=-1;for(var h=c;h<d;h++)o=o>>>8^u[255&(o^a[h])];return-1^o}},{}],46:[function(r,n,s){var i,o=r("../utils/common"),a=r("./trees"),l=r("./adler32"),c=r("./crc32"),u=r("./messages"),d=0,h=4,f=0,v=-2,m=-1,p=4,g=2,y=8,_=9,b=286,w=30,E=19,S=2*b+1,x=15,T=3,D=258,O=D+T+1,R=42,P=113,A=1,H=2,K=3,V=4;function q(N,Z){return N.msg=u[Z],Z}function I(N){return(N<<1)-(4<N?9:0)}function $(N){for(var Z=N.length;0<=--Z;)N[Z]=0}function j(N){var Z=N.state,ie=Z.pending;ie>N.avail_out&&(ie=N.avail_out),ie!==0&&(o.arraySet(N.output,Z.pending_buf,Z.pending_out,ie,N.next_out),N.next_out+=ie,Z.pending_out+=ie,N.total_out+=ie,N.avail_out-=ie,Z.pending-=ie,Z.pending===0&&(Z.pending_out=0))}function U(N,Z){a._tr_flush_block(N,0<=N.block_start?N.block_start:-1,N.strstart-N.block_start,Z),N.block_start=N.strstart,j(N.strm)}function J(N,Z){N.pending_buf[N.pending++]=Z}function ne(N,Z){N.pending_buf[N.pending++]=Z>>>8&255,N.pending_buf[N.pending++]=255&Z}function te(N,Z){var ie,W,z=N.max_chain_length,ae=N.strstart,ce=N.prev_length,ge=N.nice_match,de=N.strstart>N.w_size-O?N.strstart-(N.w_size-O):0,fe=N.window,we=N.w_mask,_e=N.prev,Ae=N.strstart+D,ze=fe[ae+ce-1],Ne=fe[ae+ce];N.prev_length>=N.good_match&&(z>>=2),ge>N.lookahead&&(ge=N.lookahead);do if(fe[(ie=Z)+ce]===Ne&&fe[ie+ce-1]===ze&&fe[ie]===fe[ae]&&fe[++ie]===fe[ae+1]){ae+=2,ie++;do;while(fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&fe[++ae]===fe[++ie]&&ae<Ae);if(W=D-(Ae-ae),ae=Ae-D,ce<W){if(N.match_start=Z,ge<=(ce=W))break;ze=fe[ae+ce-1],Ne=fe[ae+ce]}}while((Z=_e[Z&we])>de&&--z!=0);return ce<=N.lookahead?ce:N.lookahead}function me(N){var Z,ie,W,z,ae,ce,ge,de,fe,we,_e=N.w_size;do{if(z=N.window_size-N.lookahead-N.strstart,N.strstart>=_e+(_e-O)){for(o.arraySet(N.window,N.window,_e,_e,0),N.match_start-=_e,N.strstart-=_e,N.block_start-=_e,Z=ie=N.hash_size;W=N.head[--Z],N.head[Z]=_e<=W?W-_e:0,--ie;);for(Z=ie=_e;W=N.prev[--Z],N.prev[Z]=_e<=W?W-_e:0,--ie;);z+=_e}if(N.strm.avail_in===0)break;if(ce=N.strm,ge=N.window,de=N.strstart+N.lookahead,fe=z,we=void 0,we=ce.avail_in,fe<we&&(we=fe),ie=we===0?0:(ce.avail_in-=we,o.arraySet(ge,ce.input,ce.next_in,we,de),ce.state.wrap===1?ce.adler=l(ce.adler,ge,we,de):ce.state.wrap===2&&(ce.adler=c(ce.adler,ge,we,de)),ce.next_in+=we,ce.total_in+=we,we),N.lookahead+=ie,N.lookahead+N.insert>=T)for(ae=N.strstart-N.insert,N.ins_h=N.window[ae],N.ins_h=(N.ins_h<<N.hash_shift^N.window[ae+1])&N.hash_mask;N.insert&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[ae+T-1])&N.hash_mask,N.prev[ae&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=ae,ae++,N.insert--,!(N.lookahead+N.insert<T)););}while(N.lookahead<O&&N.strm.avail_in!==0)}function re(N,Z){for(var ie,W;;){if(N.lookahead<O){if(me(N),N.lookahead<O&&Z===d)return A;if(N.lookahead===0)break}if(ie=0,N.lookahead>=T&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+T-1])&N.hash_mask,ie=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),ie!==0&&N.strstart-ie<=N.w_size-O&&(N.match_length=te(N,ie)),N.match_length>=T)if(W=a._tr_tally(N,N.strstart-N.match_start,N.match_length-T),N.lookahead-=N.match_length,N.match_length<=N.max_lazy_match&&N.lookahead>=T){for(N.match_length--;N.strstart++,N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+T-1])&N.hash_mask,ie=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart,--N.match_length!=0;);N.strstart++}else N.strstart+=N.match_length,N.match_length=0,N.ins_h=N.window[N.strstart],N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+1])&N.hash_mask;else W=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++;if(W&&(U(N,!1),N.strm.avail_out===0))return A}return N.insert=N.strstart<T-1?N.strstart:T-1,Z===h?(U(N,!0),N.strm.avail_out===0?K:V):N.last_lit&&(U(N,!1),N.strm.avail_out===0)?A:H}function F(N,Z){for(var ie,W,z;;){if(N.lookahead<O){if(me(N),N.lookahead<O&&Z===d)return A;if(N.lookahead===0)break}if(ie=0,N.lookahead>=T&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+T-1])&N.hash_mask,ie=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),N.prev_length=N.match_length,N.prev_match=N.match_start,N.match_length=T-1,ie!==0&&N.prev_length<N.max_lazy_match&&N.strstart-ie<=N.w_size-O&&(N.match_length=te(N,ie),N.match_length<=5&&(N.strategy===1||N.match_length===T&&4096<N.strstart-N.match_start)&&(N.match_length=T-1)),N.prev_length>=T&&N.match_length<=N.prev_length){for(z=N.strstart+N.lookahead-T,W=a._tr_tally(N,N.strstart-1-N.prev_match,N.prev_length-T),N.lookahead-=N.prev_length-1,N.prev_length-=2;++N.strstart<=z&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+T-1])&N.hash_mask,ie=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),--N.prev_length!=0;);if(N.match_available=0,N.match_length=T-1,N.strstart++,W&&(U(N,!1),N.strm.avail_out===0))return A}else if(N.match_available){if((W=a._tr_tally(N,0,N.window[N.strstart-1]))&&U(N,!1),N.strstart++,N.lookahead--,N.strm.avail_out===0)return A}else N.match_available=1,N.strstart++,N.lookahead--}return N.match_available&&(W=a._tr_tally(N,0,N.window[N.strstart-1]),N.match_available=0),N.insert=N.strstart<T-1?N.strstart:T-1,Z===h?(U(N,!0),N.strm.avail_out===0?K:V):N.last_lit&&(U(N,!1),N.strm.avail_out===0)?A:H}function X(N,Z,ie,W,z){this.good_length=N,this.max_lazy=Z,this.nice_length=ie,this.max_chain=W,this.func=z}function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*S),this.dyn_dtree=new o.Buf16(2*(2*w+1)),this.bl_tree=new o.Buf16(2*(2*E+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(x+1),this.heap=new o.Buf16(2*b+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*b+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function oe(N){var Z;return N&&N.state?(N.total_in=N.total_out=0,N.data_type=g,(Z=N.state).pending=0,Z.pending_out=0,Z.wrap<0&&(Z.wrap=-Z.wrap),Z.status=Z.wrap?R:P,N.adler=Z.wrap===2?0:1,Z.last_flush=d,a._tr_init(Z),f):q(N,v)}function le(N){var Z=oe(N);return Z===f&&function(ie){ie.window_size=2*ie.w_size,$(ie.head),ie.max_lazy_match=i[ie.level].max_lazy,ie.good_match=i[ie.level].good_length,ie.nice_match=i[ie.level].nice_length,ie.max_chain_length=i[ie.level].max_chain,ie.strstart=0,ie.block_start=0,ie.lookahead=0,ie.insert=0,ie.match_length=ie.prev_length=T-1,ie.match_available=0,ie.ins_h=0}(N.state),Z}function ue(N,Z,ie,W,z,ae){if(!N)return v;var ce=1;if(Z===m&&(Z=6),W<0?(ce=0,W=-W):15<W&&(ce=2,W-=16),z<1||_<z||ie!==y||W<8||15<W||Z<0||9<Z||ae<0||p<ae)return q(N,v);W===8&&(W=9);var ge=new Y;return(N.state=ge).strm=N,ge.wrap=ce,ge.gzhead=null,ge.w_bits=W,ge.w_size=1<<ge.w_bits,ge.w_mask=ge.w_size-1,ge.hash_bits=z+7,ge.hash_size=1<<ge.hash_bits,ge.hash_mask=ge.hash_size-1,ge.hash_shift=~~((ge.hash_bits+T-1)/T),ge.window=new o.Buf8(2*ge.w_size),ge.head=new o.Buf16(ge.hash_size),ge.prev=new o.Buf16(ge.w_size),ge.lit_bufsize=1<<z+6,ge.pending_buf_size=4*ge.lit_bufsize,ge.pending_buf=new o.Buf8(ge.pending_buf_size),ge.d_buf=1*ge.lit_bufsize,ge.l_buf=3*ge.lit_bufsize,ge.level=Z,ge.strategy=ae,ge.method=ie,le(N)}i=[new X(0,0,0,0,function(N,Z){var ie=65535;for(ie>N.pending_buf_size-5&&(ie=N.pending_buf_size-5);;){if(N.lookahead<=1){if(me(N),N.lookahead===0&&Z===d)return A;if(N.lookahead===0)break}N.strstart+=N.lookahead,N.lookahead=0;var W=N.block_start+ie;if((N.strstart===0||N.strstart>=W)&&(N.lookahead=N.strstart-W,N.strstart=W,U(N,!1),N.strm.avail_out===0)||N.strstart-N.block_start>=N.w_size-O&&(U(N,!1),N.strm.avail_out===0))return A}return N.insert=0,Z===h?(U(N,!0),N.strm.avail_out===0?K:V):(N.strstart>N.block_start&&(U(N,!1),N.strm.avail_out),A)}),new X(4,4,8,4,re),new X(4,5,16,8,re),new X(4,6,32,32,re),new X(4,4,16,16,F),new X(8,16,32,32,F),new X(8,16,128,128,F),new X(8,32,128,256,F),new X(32,128,258,1024,F),new X(32,258,258,4096,F)],s.deflateInit=function(N,Z){return ue(N,Z,y,15,8,0)},s.deflateInit2=ue,s.deflateReset=le,s.deflateResetKeep=oe,s.deflateSetHeader=function(N,Z){return N&&N.state?N.state.wrap!==2?v:(N.state.gzhead=Z,f):v},s.deflate=function(N,Z){var ie,W,z,ae;if(!N||!N.state||5<Z||Z<0)return N?q(N,v):v;if(W=N.state,!N.output||!N.input&&N.avail_in!==0||W.status===666&&Z!==h)return q(N,N.avail_out===0?-5:v);if(W.strm=N,ie=W.last_flush,W.last_flush=Z,W.status===R)if(W.wrap===2)N.adler=0,J(W,31),J(W,139),J(W,8),W.gzhead?(J(W,(W.gzhead.text?1:0)+(W.gzhead.hcrc?2:0)+(W.gzhead.extra?4:0)+(W.gzhead.name?8:0)+(W.gzhead.comment?16:0)),J(W,255&W.gzhead.time),J(W,W.gzhead.time>>8&255),J(W,W.gzhead.time>>16&255),J(W,W.gzhead.time>>24&255),J(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),J(W,255&W.gzhead.os),W.gzhead.extra&&W.gzhead.extra.length&&(J(W,255&W.gzhead.extra.length),J(W,W.gzhead.extra.length>>8&255)),W.gzhead.hcrc&&(N.adler=c(N.adler,W.pending_buf,W.pending,0)),W.gzindex=0,W.status=69):(J(W,0),J(W,0),J(W,0),J(W,0),J(W,0),J(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),J(W,3),W.status=P);else{var ce=y+(W.w_bits-8<<4)<<8;ce|=(2<=W.strategy||W.level<2?0:W.level<6?1:W.level===6?2:3)<<6,W.strstart!==0&&(ce|=32),ce+=31-ce%31,W.status=P,ne(W,ce),W.strstart!==0&&(ne(W,N.adler>>>16),ne(W,65535&N.adler)),N.adler=1}if(W.status===69)if(W.gzhead.extra){for(z=W.pending;W.gzindex<(65535&W.gzhead.extra.length)&&(W.pending!==W.pending_buf_size||(W.gzhead.hcrc&&W.pending>z&&(N.adler=c(N.adler,W.pending_buf,W.pending-z,z)),j(N),z=W.pending,W.pending!==W.pending_buf_size));)J(W,255&W.gzhead.extra[W.gzindex]),W.gzindex++;W.gzhead.hcrc&&W.pending>z&&(N.adler=c(N.adler,W.pending_buf,W.pending-z,z)),W.gzindex===W.gzhead.extra.length&&(W.gzindex=0,W.status=73)}else W.status=73;if(W.status===73)if(W.gzhead.name){z=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>z&&(N.adler=c(N.adler,W.pending_buf,W.pending-z,z)),j(N),z=W.pending,W.pending===W.pending_buf_size)){ae=1;break}ae=W.gzindex<W.gzhead.name.length?255&W.gzhead.name.charCodeAt(W.gzindex++):0,J(W,ae)}while(ae!==0);W.gzhead.hcrc&&W.pending>z&&(N.adler=c(N.adler,W.pending_buf,W.pending-z,z)),ae===0&&(W.gzindex=0,W.status=91)}else W.status=91;if(W.status===91)if(W.gzhead.comment){z=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>z&&(N.adler=c(N.adler,W.pending_buf,W.pending-z,z)),j(N),z=W.pending,W.pending===W.pending_buf_size)){ae=1;break}ae=W.gzindex<W.gzhead.comment.length?255&W.gzhead.comment.charCodeAt(W.gzindex++):0,J(W,ae)}while(ae!==0);W.gzhead.hcrc&&W.pending>z&&(N.adler=c(N.adler,W.pending_buf,W.pending-z,z)),ae===0&&(W.status=103)}else W.status=103;if(W.status===103&&(W.gzhead.hcrc?(W.pending+2>W.pending_buf_size&&j(N),W.pending+2<=W.pending_buf_size&&(J(W,255&N.adler),J(W,N.adler>>8&255),N.adler=0,W.status=P)):W.status=P),W.pending!==0){if(j(N),N.avail_out===0)return W.last_flush=-1,f}else if(N.avail_in===0&&I(Z)<=I(ie)&&Z!==h)return q(N,-5);if(W.status===666&&N.avail_in!==0)return q(N,-5);if(N.avail_in!==0||W.lookahead!==0||Z!==d&&W.status!==666){var ge=W.strategy===2?function(de,fe){for(var we;;){if(de.lookahead===0&&(me(de),de.lookahead===0)){if(fe===d)return A;break}if(de.match_length=0,we=a._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++,we&&(U(de,!1),de.strm.avail_out===0))return A}return de.insert=0,fe===h?(U(de,!0),de.strm.avail_out===0?K:V):de.last_lit&&(U(de,!1),de.strm.avail_out===0)?A:H}(W,Z):W.strategy===3?function(de,fe){for(var we,_e,Ae,ze,Ne=de.window;;){if(de.lookahead<=D){if(me(de),de.lookahead<=D&&fe===d)return A;if(de.lookahead===0)break}if(de.match_length=0,de.lookahead>=T&&0<de.strstart&&(_e=Ne[Ae=de.strstart-1])===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]){ze=de.strstart+D;do;while(_e===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]&&_e===Ne[++Ae]&&Ae<ze);de.match_length=D-(ze-Ae),de.match_length>de.lookahead&&(de.match_length=de.lookahead)}if(de.match_length>=T?(we=a._tr_tally(de,1,de.match_length-T),de.lookahead-=de.match_length,de.strstart+=de.match_length,de.match_length=0):(we=a._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++),we&&(U(de,!1),de.strm.avail_out===0))return A}return de.insert=0,fe===h?(U(de,!0),de.strm.avail_out===0?K:V):de.last_lit&&(U(de,!1),de.strm.avail_out===0)?A:H}(W,Z):i[W.level].func(W,Z);if(ge!==K&&ge!==V||(W.status=666),ge===A||ge===K)return N.avail_out===0&&(W.last_flush=-1),f;if(ge===H&&(Z===1?a._tr_align(W):Z!==5&&(a._tr_stored_block(W,0,0,!1),Z===3&&($(W.head),W.lookahead===0&&(W.strstart=0,W.block_start=0,W.insert=0))),j(N),N.avail_out===0))return W.last_flush=-1,f}return Z!==h?f:W.wrap<=0?1:(W.wrap===2?(J(W,255&N.adler),J(W,N.adler>>8&255),J(W,N.adler>>16&255),J(W,N.adler>>24&255),J(W,255&N.total_in),J(W,N.total_in>>8&255),J(W,N.total_in>>16&255),J(W,N.total_in>>24&255)):(ne(W,N.adler>>>16),ne(W,65535&N.adler)),j(N),0<W.wrap&&(W.wrap=-W.wrap),W.pending!==0?f:1)},s.deflateEnd=function(N){var Z;return N&&N.state?(Z=N.state.status)!==R&&Z!==69&&Z!==73&&Z!==91&&Z!==103&&Z!==P&&Z!==666?q(N,v):(N.state=null,Z===P?q(N,-3):f):v},s.deflateSetDictionary=function(N,Z){var ie,W,z,ae,ce,ge,de,fe,we=Z.length;if(!N||!N.state||(ae=(ie=N.state).wrap)===2||ae===1&&ie.status!==R||ie.lookahead)return v;for(ae===1&&(N.adler=l(N.adler,Z,we,0)),ie.wrap=0,we>=ie.w_size&&(ae===0&&($(ie.head),ie.strstart=0,ie.block_start=0,ie.insert=0),fe=new o.Buf8(ie.w_size),o.arraySet(fe,Z,we-ie.w_size,ie.w_size,0),Z=fe,we=ie.w_size),ce=N.avail_in,ge=N.next_in,de=N.input,N.avail_in=we,N.next_in=0,N.input=Z,me(ie);ie.lookahead>=T;){for(W=ie.strstart,z=ie.lookahead-(T-1);ie.ins_h=(ie.ins_h<<ie.hash_shift^ie.window[W+T-1])&ie.hash_mask,ie.prev[W&ie.w_mask]=ie.head[ie.ins_h],ie.head[ie.ins_h]=W,W++,--z;);ie.strstart=W,ie.lookahead=T-1,me(ie)}return ie.strstart+=ie.lookahead,ie.block_start=ie.strstart,ie.insert=ie.lookahead,ie.lookahead=0,ie.match_length=ie.prev_length=T-1,ie.match_available=0,N.next_in=ge,N.input=de,N.avail_in=ce,ie.wrap=ae,f},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,s){n.exports=function(i,o){var a,l,c,u,d,h,f,v,m,p,g,y,_,b,w,E,S,x,T,D,O,R,P,A,H;a=i.state,l=i.next_in,A=i.input,c=l+(i.avail_in-5),u=i.next_out,H=i.output,d=u-(o-i.avail_out),h=u+(i.avail_out-257),f=a.dmax,v=a.wsize,m=a.whave,p=a.wnext,g=a.window,y=a.hold,_=a.bits,b=a.lencode,w=a.distcode,E=(1<<a.lenbits)-1,S=(1<<a.distbits)-1;e:do{_<15&&(y+=A[l++]<<_,_+=8,y+=A[l++]<<_,_+=8),x=b[y&E];t:for(;;){if(y>>>=T=x>>>24,_-=T,(T=x>>>16&255)===0)H[u++]=65535&x;else{if(!(16&T)){if(!(64&T)){x=b[(65535&x)+(y&(1<<T)-1)];continue t}if(32&T){a.mode=12;break e}i.msg="invalid literal/length code",a.mode=30;break e}D=65535&x,(T&=15)&&(_<T&&(y+=A[l++]<<_,_+=8),D+=y&(1<<T)-1,y>>>=T,_-=T),_<15&&(y+=A[l++]<<_,_+=8,y+=A[l++]<<_,_+=8),x=w[y&S];r:for(;;){if(y>>>=T=x>>>24,_-=T,!(16&(T=x>>>16&255))){if(!(64&T)){x=w[(65535&x)+(y&(1<<T)-1)];continue r}i.msg="invalid distance code",a.mode=30;break e}if(O=65535&x,_<(T&=15)&&(y+=A[l++]<<_,(_+=8)<T&&(y+=A[l++]<<_,_+=8)),f<(O+=y&(1<<T)-1)){i.msg="invalid distance too far back",a.mode=30;break e}if(y>>>=T,_-=T,(T=u-d)<O){if(m<(T=O-T)&&a.sane){i.msg="invalid distance too far back",a.mode=30;break e}if(P=g,(R=0)===p){if(R+=v-T,T<D){for(D-=T;H[u++]=g[R++],--T;);R=u-O,P=H}}else if(p<T){if(R+=v+p-T,(T-=p)<D){for(D-=T;H[u++]=g[R++],--T;);if(R=0,p<D){for(D-=T=p;H[u++]=g[R++],--T;);R=u-O,P=H}}}else if(R+=p-T,T<D){for(D-=T;H[u++]=g[R++],--T;);R=u-O,P=H}for(;2<D;)H[u++]=P[R++],H[u++]=P[R++],H[u++]=P[R++],D-=3;D&&(H[u++]=P[R++],1<D&&(H[u++]=P[R++]))}else{for(R=u-O;H[u++]=H[R++],H[u++]=H[R++],H[u++]=H[R++],2<(D-=3););D&&(H[u++]=H[R++],1<D&&(H[u++]=H[R++]))}break}}break}}while(l<c&&u<h);l-=D=_>>3,y&=(1<<(_-=D<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),a.hold=y,a.bits=_}},{}],49:[function(r,n,s){var i=r("../utils/common"),o=r("./adler32"),a=r("./crc32"),l=r("./inffast"),c=r("./inftrees"),u=1,d=2,h=0,f=-2,v=1,m=852,p=592;function g(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(R){var P;return R&&R.state?(P=R.state,R.total_in=R.total_out=P.total=0,R.msg="",P.wrap&&(R.adler=1&P.wrap),P.mode=v,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new i.Buf32(m),P.distcode=P.distdyn=new i.Buf32(p),P.sane=1,P.back=-1,h):f}function b(R){var P;return R&&R.state?((P=R.state).wsize=0,P.whave=0,P.wnext=0,_(R)):f}function w(R,P){var A,H;return R&&R.state?(H=R.state,P<0?(A=0,P=-P):(A=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?f:(H.window!==null&&H.wbits!==P&&(H.window=null),H.wrap=A,H.wbits=P,b(R))):f}function E(R,P){var A,H;return R?(H=new y,(R.state=H).window=null,(A=w(R,P))!==h&&(R.state=null),A):f}var S,x,T=!0;function D(R){if(T){var P;for(S=new i.Buf32(512),x=new i.Buf32(32),P=0;P<144;)R.lens[P++]=8;for(;P<256;)R.lens[P++]=9;for(;P<280;)R.lens[P++]=7;for(;P<288;)R.lens[P++]=8;for(c(u,R.lens,0,288,S,0,R.work,{bits:9}),P=0;P<32;)R.lens[P++]=5;c(d,R.lens,0,32,x,0,R.work,{bits:5}),T=!1}R.lencode=S,R.lenbits=9,R.distcode=x,R.distbits=5}function O(R,P,A,H){var K,V=R.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new i.Buf8(V.wsize)),H>=V.wsize?(i.arraySet(V.window,P,A-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(H<(K=V.wsize-V.wnext)&&(K=H),i.arraySet(V.window,P,A-H,K,V.wnext),(H-=K)?(i.arraySet(V.window,P,A-H,H,0),V.wnext=H,V.whave=V.wsize):(V.wnext+=K,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=K))),0}s.inflateReset=b,s.inflateReset2=w,s.inflateResetKeep=_,s.inflateInit=function(R){return E(R,15)},s.inflateInit2=E,s.inflate=function(R,P){var A,H,K,V,q,I,$,j,U,J,ne,te,me,re,F,X,Y,oe,le,ue,N,Z,ie,W,z=0,ae=new i.Buf8(4),ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return f;(A=R.state).mode===12&&(A.mode=13),q=R.next_out,K=R.output,$=R.avail_out,V=R.next_in,H=R.input,I=R.avail_in,j=A.hold,U=A.bits,J=I,ne=$,Z=h;e:for(;;)switch(A.mode){case v:if(A.wrap===0){A.mode=13;break}for(;U<16;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(2&A.wrap&&j===35615){ae[A.check=0]=255&j,ae[1]=j>>>8&255,A.check=a(A.check,ae,2,0),U=j=0,A.mode=2;break}if(A.flags=0,A.head&&(A.head.done=!1),!(1&A.wrap)||(((255&j)<<8)+(j>>8))%31){R.msg="incorrect header check",A.mode=30;break}if((15&j)!=8){R.msg="unknown compression method",A.mode=30;break}if(U-=4,N=8+(15&(j>>>=4)),A.wbits===0)A.wbits=N;else if(N>A.wbits){R.msg="invalid window size",A.mode=30;break}A.dmax=1<<N,R.adler=A.check=1,A.mode=512&j?10:12,U=j=0;break;case 2:for(;U<16;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(A.flags=j,(255&A.flags)!=8){R.msg="unknown compression method",A.mode=30;break}if(57344&A.flags){R.msg="unknown header flags set",A.mode=30;break}A.head&&(A.head.text=j>>8&1),512&A.flags&&(ae[0]=255&j,ae[1]=j>>>8&255,A.check=a(A.check,ae,2,0)),U=j=0,A.mode=3;case 3:for(;U<32;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}A.head&&(A.head.time=j),512&A.flags&&(ae[0]=255&j,ae[1]=j>>>8&255,ae[2]=j>>>16&255,ae[3]=j>>>24&255,A.check=a(A.check,ae,4,0)),U=j=0,A.mode=4;case 4:for(;U<16;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}A.head&&(A.head.xflags=255&j,A.head.os=j>>8),512&A.flags&&(ae[0]=255&j,ae[1]=j>>>8&255,A.check=a(A.check,ae,2,0)),U=j=0,A.mode=5;case 5:if(1024&A.flags){for(;U<16;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}A.length=j,A.head&&(A.head.extra_len=j),512&A.flags&&(ae[0]=255&j,ae[1]=j>>>8&255,A.check=a(A.check,ae,2,0)),U=j=0}else A.head&&(A.head.extra=null);A.mode=6;case 6:if(1024&A.flags&&(I<(te=A.length)&&(te=I),te&&(A.head&&(N=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),i.arraySet(A.head.extra,H,V,te,N)),512&A.flags&&(A.check=a(A.check,H,te,V)),I-=te,V+=te,A.length-=te),A.length))break e;A.length=0,A.mode=7;case 7:if(2048&A.flags){if(I===0)break e;for(te=0;N=H[V+te++],A.head&&N&&A.length<65536&&(A.head.name+=String.fromCharCode(N)),N&&te<I;);if(512&A.flags&&(A.check=a(A.check,H,te,V)),I-=te,V+=te,N)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=8;case 8:if(4096&A.flags){if(I===0)break e;for(te=0;N=H[V+te++],A.head&&N&&A.length<65536&&(A.head.comment+=String.fromCharCode(N)),N&&te<I;);if(512&A.flags&&(A.check=a(A.check,H,te,V)),I-=te,V+=te,N)break e}else A.head&&(A.head.comment=null);A.mode=9;case 9:if(512&A.flags){for(;U<16;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(j!==(65535&A.check)){R.msg="header crc mismatch",A.mode=30;break}U=j=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),R.adler=A.check=0,A.mode=12;break;case 10:for(;U<32;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}R.adler=A.check=g(j),U=j=0,A.mode=11;case 11:if(A.havedict===0)return R.next_out=q,R.avail_out=$,R.next_in=V,R.avail_in=I,A.hold=j,A.bits=U,2;R.adler=A.check=1,A.mode=12;case 12:if(P===5||P===6)break e;case 13:if(A.last){j>>>=7&U,U-=7&U,A.mode=27;break}for(;U<3;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}switch(A.last=1&j,U-=1,3&(j>>>=1)){case 0:A.mode=14;break;case 1:if(D(A),A.mode=20,P!==6)break;j>>>=2,U-=2;break e;case 2:A.mode=17;break;case 3:R.msg="invalid block type",A.mode=30}j>>>=2,U-=2;break;case 14:for(j>>>=7&U,U-=7&U;U<32;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if((65535&j)!=(j>>>16^65535)){R.msg="invalid stored block lengths",A.mode=30;break}if(A.length=65535&j,U=j=0,A.mode=15,P===6)break e;case 15:A.mode=16;case 16:if(te=A.length){if(I<te&&(te=I),$<te&&(te=$),te===0)break e;i.arraySet(K,H,V,te,q),I-=te,V+=te,$-=te,q+=te,A.length-=te;break}A.mode=12;break;case 17:for(;U<14;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(A.nlen=257+(31&j),j>>>=5,U-=5,A.ndist=1+(31&j),j>>>=5,U-=5,A.ncode=4+(15&j),j>>>=4,U-=4,286<A.nlen||30<A.ndist){R.msg="too many length or distance symbols",A.mode=30;break}A.have=0,A.mode=18;case 18:for(;A.have<A.ncode;){for(;U<3;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}A.lens[ce[A.have++]]=7&j,j>>>=3,U-=3}for(;A.have<19;)A.lens[ce[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,ie={bits:A.lenbits},Z=c(0,A.lens,0,19,A.lencode,0,A.work,ie),A.lenbits=ie.bits,Z){R.msg="invalid code lengths set",A.mode=30;break}A.have=0,A.mode=19;case 19:for(;A.have<A.nlen+A.ndist;){for(;X=(z=A.lencode[j&(1<<A.lenbits)-1])>>>16&255,Y=65535&z,!((F=z>>>24)<=U);){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(Y<16)j>>>=F,U-=F,A.lens[A.have++]=Y;else{if(Y===16){for(W=F+2;U<W;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(j>>>=F,U-=F,A.have===0){R.msg="invalid bit length repeat",A.mode=30;break}N=A.lens[A.have-1],te=3+(3&j),j>>>=2,U-=2}else if(Y===17){for(W=F+3;U<W;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}U-=F,N=0,te=3+(7&(j>>>=F)),j>>>=3,U-=3}else{for(W=F+7;U<W;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}U-=F,N=0,te=11+(127&(j>>>=F)),j>>>=7,U-=7}if(A.have+te>A.nlen+A.ndist){R.msg="invalid bit length repeat",A.mode=30;break}for(;te--;)A.lens[A.have++]=N}}if(A.mode===30)break;if(A.lens[256]===0){R.msg="invalid code -- missing end-of-block",A.mode=30;break}if(A.lenbits=9,ie={bits:A.lenbits},Z=c(u,A.lens,0,A.nlen,A.lencode,0,A.work,ie),A.lenbits=ie.bits,Z){R.msg="invalid literal/lengths set",A.mode=30;break}if(A.distbits=6,A.distcode=A.distdyn,ie={bits:A.distbits},Z=c(d,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,ie),A.distbits=ie.bits,Z){R.msg="invalid distances set",A.mode=30;break}if(A.mode=20,P===6)break e;case 20:A.mode=21;case 21:if(6<=I&&258<=$){R.next_out=q,R.avail_out=$,R.next_in=V,R.avail_in=I,A.hold=j,A.bits=U,l(R,ne),q=R.next_out,K=R.output,$=R.avail_out,V=R.next_in,H=R.input,I=R.avail_in,j=A.hold,U=A.bits,A.mode===12&&(A.back=-1);break}for(A.back=0;X=(z=A.lencode[j&(1<<A.lenbits)-1])>>>16&255,Y=65535&z,!((F=z>>>24)<=U);){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(X&&!(240&X)){for(oe=F,le=X,ue=Y;X=(z=A.lencode[ue+((j&(1<<oe+le)-1)>>oe)])>>>16&255,Y=65535&z,!(oe+(F=z>>>24)<=U);){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}j>>>=oe,U-=oe,A.back+=oe}if(j>>>=F,U-=F,A.back+=F,A.length=Y,X===0){A.mode=26;break}if(32&X){A.back=-1,A.mode=12;break}if(64&X){R.msg="invalid literal/length code",A.mode=30;break}A.extra=15&X,A.mode=22;case 22:if(A.extra){for(W=A.extra;U<W;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}A.length+=j&(1<<A.extra)-1,j>>>=A.extra,U-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=23;case 23:for(;X=(z=A.distcode[j&(1<<A.distbits)-1])>>>16&255,Y=65535&z,!((F=z>>>24)<=U);){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(!(240&X)){for(oe=F,le=X,ue=Y;X=(z=A.distcode[ue+((j&(1<<oe+le)-1)>>oe)])>>>16&255,Y=65535&z,!(oe+(F=z>>>24)<=U);){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}j>>>=oe,U-=oe,A.back+=oe}if(j>>>=F,U-=F,A.back+=F,64&X){R.msg="invalid distance code",A.mode=30;break}A.offset=Y,A.extra=15&X,A.mode=24;case 24:if(A.extra){for(W=A.extra;U<W;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}A.offset+=j&(1<<A.extra)-1,j>>>=A.extra,U-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){R.msg="invalid distance too far back",A.mode=30;break}A.mode=25;case 25:if($===0)break e;if(te=ne-$,A.offset>te){if((te=A.offset-te)>A.whave&&A.sane){R.msg="invalid distance too far back",A.mode=30;break}me=te>A.wnext?(te-=A.wnext,A.wsize-te):A.wnext-te,te>A.length&&(te=A.length),re=A.window}else re=K,me=q-A.offset,te=A.length;for($<te&&(te=$),$-=te,A.length-=te;K[q++]=re[me++],--te;);A.length===0&&(A.mode=21);break;case 26:if($===0)break e;K[q++]=A.length,$--,A.mode=21;break;case 27:if(A.wrap){for(;U<32;){if(I===0)break e;I--,j|=H[V++]<<U,U+=8}if(ne-=$,R.total_out+=ne,A.total+=ne,ne&&(R.adler=A.check=A.flags?a(A.check,K,ne,q-ne):o(A.check,K,ne,q-ne)),ne=$,(A.flags?j:g(j))!==A.check){R.msg="incorrect data check",A.mode=30;break}U=j=0}A.mode=28;case 28:if(A.wrap&&A.flags){for(;U<32;){if(I===0)break e;I--,j+=H[V++]<<U,U+=8}if(j!==(4294967295&A.total)){R.msg="incorrect length check",A.mode=30;break}U=j=0}A.mode=29;case 29:Z=1;break e;case 30:Z=-3;break e;case 31:return-4;case 32:default:return f}return R.next_out=q,R.avail_out=$,R.next_in=V,R.avail_in=I,A.hold=j,A.bits=U,(A.wsize||ne!==R.avail_out&&A.mode<30&&(A.mode<27||P!==4))&&O(R,R.output,R.next_out,ne-R.avail_out)?(A.mode=31,-4):(J-=R.avail_in,ne-=R.avail_out,R.total_in+=J,R.total_out+=ne,A.total+=ne,A.wrap&&ne&&(R.adler=A.check=A.flags?a(A.check,K,ne,R.next_out-ne):o(A.check,K,ne,R.next_out-ne)),R.data_type=A.bits+(A.last?64:0)+(A.mode===12?128:0)+(A.mode===20||A.mode===15?256:0),(J==0&&ne===0||P===4)&&Z===h&&(Z=-5),Z)},s.inflateEnd=function(R){if(!R||!R.state)return f;var P=R.state;return P.window&&(P.window=null),R.state=null,h},s.inflateGetHeader=function(R,P){var A;return R&&R.state&&2&(A=R.state).wrap?((A.head=P).done=!1,h):f},s.inflateSetDictionary=function(R,P){var A,H=P.length;return R&&R.state?(A=R.state).wrap!==0&&A.mode!==11?f:A.mode===11&&o(1,P,H,0)!==A.check?-3:O(R,P,H,H)?(A.mode=31,-4):(A.havedict=1,h):f},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,s){var i=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,d,h,f,v,m,p,g){var y,_,b,w,E,S,x,T,D,O=g.bits,R=0,P=0,A=0,H=0,K=0,V=0,q=0,I=0,$=0,j=0,U=null,J=0,ne=new i.Buf16(16),te=new i.Buf16(16),me=null,re=0;for(R=0;R<=15;R++)ne[R]=0;for(P=0;P<f;P++)ne[d[h+P]]++;for(K=O,H=15;1<=H&&ne[H]===0;H--);if(H<K&&(K=H),H===0)return v[m++]=20971520,v[m++]=20971520,g.bits=1,0;for(A=1;A<H&&ne[A]===0;A++);for(K<A&&(K=A),R=I=1;R<=15;R++)if(I<<=1,(I-=ne[R])<0)return-1;if(0<I&&(u===0||H!==1))return-1;for(te[1]=0,R=1;R<15;R++)te[R+1]=te[R]+ne[R];for(P=0;P<f;P++)d[h+P]!==0&&(p[te[d[h+P]]++]=P);if(S=u===0?(U=me=p,19):u===1?(U=o,J-=257,me=a,re-=257,256):(U=l,me=c,-1),R=A,E=m,q=P=j=0,b=-1,w=($=1<<(V=K))-1,u===1&&852<$||u===2&&592<$)return 1;for(;;){for(x=R-q,D=p[P]<S?(T=0,p[P]):p[P]>S?(T=me[re+p[P]],U[J+p[P]]):(T=96,0),y=1<<R-q,A=_=1<<V;v[E+(j>>q)+(_-=y)]=x<<24|T<<16|D|0,_!==0;);for(y=1<<R-1;j&y;)y>>=1;if(y!==0?(j&=y-1,j+=y):j=0,P++,--ne[R]==0){if(R===H)break;R=d[h+p[P]]}if(K<R&&(j&w)!==b){for(q===0&&(q=K),E+=A,I=1<<(V=R-q);V+q<H&&!((I-=ne[V+q])<=0);)V++,I<<=1;if($+=1<<V,u===1&&852<$||u===2&&592<$)return 1;v[b=j&w]=K<<24|V<<16|E-m|0}}return j!==0&&(v[E+j]=R-q<<24|64<<16|0),g.bits=K,0}},{"../utils/common":41}],51:[function(r,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,s){var i=r("../utils/common"),o=0,a=1;function l(z){for(var ae=z.length;0<=--ae;)z[ae]=0}var c=0,u=29,d=256,h=d+1+u,f=30,v=19,m=2*h+1,p=15,g=16,y=7,_=256,b=16,w=17,E=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=new Array(2*(h+2));l(O);var R=new Array(2*f);l(R);var P=new Array(512);l(P);var A=new Array(256);l(A);var H=new Array(u);l(H);var K,V,q,I=new Array(f);function $(z,ae,ce,ge,de){this.static_tree=z,this.extra_bits=ae,this.extra_base=ce,this.elems=ge,this.max_length=de,this.has_stree=z&&z.length}function j(z,ae){this.dyn_tree=z,this.max_code=0,this.stat_desc=ae}function U(z){return z<256?P[z]:P[256+(z>>>7)]}function J(z,ae){z.pending_buf[z.pending++]=255&ae,z.pending_buf[z.pending++]=ae>>>8&255}function ne(z,ae,ce){z.bi_valid>g-ce?(z.bi_buf|=ae<<z.bi_valid&65535,J(z,z.bi_buf),z.bi_buf=ae>>g-z.bi_valid,z.bi_valid+=ce-g):(z.bi_buf|=ae<<z.bi_valid&65535,z.bi_valid+=ce)}function te(z,ae,ce){ne(z,ce[2*ae],ce[2*ae+1])}function me(z,ae){for(var ce=0;ce|=1&z,z>>>=1,ce<<=1,0<--ae;);return ce>>>1}function re(z,ae,ce){var ge,de,fe=new Array(p+1),we=0;for(ge=1;ge<=p;ge++)fe[ge]=we=we+ce[ge-1]<<1;for(de=0;de<=ae;de++){var _e=z[2*de+1];_e!==0&&(z[2*de]=me(fe[_e]++,_e))}}function F(z){var ae;for(ae=0;ae<h;ae++)z.dyn_ltree[2*ae]=0;for(ae=0;ae<f;ae++)z.dyn_dtree[2*ae]=0;for(ae=0;ae<v;ae++)z.bl_tree[2*ae]=0;z.dyn_ltree[2*_]=1,z.opt_len=z.static_len=0,z.last_lit=z.matches=0}function X(z){8<z.bi_valid?J(z,z.bi_buf):0<z.bi_valid&&(z.pending_buf[z.pending++]=z.bi_buf),z.bi_buf=0,z.bi_valid=0}function Y(z,ae,ce,ge){var de=2*ae,fe=2*ce;return z[de]<z[fe]||z[de]===z[fe]&&ge[ae]<=ge[ce]}function oe(z,ae,ce){for(var ge=z.heap[ce],de=ce<<1;de<=z.heap_len&&(de<z.heap_len&&Y(ae,z.heap[de+1],z.heap[de],z.depth)&&de++,!Y(ae,ge,z.heap[de],z.depth));)z.heap[ce]=z.heap[de],ce=de,de<<=1;z.heap[ce]=ge}function le(z,ae,ce){var ge,de,fe,we,_e=0;if(z.last_lit!==0)for(;ge=z.pending_buf[z.d_buf+2*_e]<<8|z.pending_buf[z.d_buf+2*_e+1],de=z.pending_buf[z.l_buf+_e],_e++,ge===0?te(z,de,ae):(te(z,(fe=A[de])+d+1,ae),(we=S[fe])!==0&&ne(z,de-=H[fe],we),te(z,fe=U(--ge),ce),(we=x[fe])!==0&&ne(z,ge-=I[fe],we)),_e<z.last_lit;);te(z,_,ae)}function ue(z,ae){var ce,ge,de,fe=ae.dyn_tree,we=ae.stat_desc.static_tree,_e=ae.stat_desc.has_stree,Ae=ae.stat_desc.elems,ze=-1;for(z.heap_len=0,z.heap_max=m,ce=0;ce<Ae;ce++)fe[2*ce]!==0?(z.heap[++z.heap_len]=ze=ce,z.depth[ce]=0):fe[2*ce+1]=0;for(;z.heap_len<2;)fe[2*(de=z.heap[++z.heap_len]=ze<2?++ze:0)]=1,z.depth[de]=0,z.opt_len--,_e&&(z.static_len-=we[2*de+1]);for(ae.max_code=ze,ce=z.heap_len>>1;1<=ce;ce--)oe(z,fe,ce);for(de=Ae;ce=z.heap[1],z.heap[1]=z.heap[z.heap_len--],oe(z,fe,1),ge=z.heap[1],z.heap[--z.heap_max]=ce,z.heap[--z.heap_max]=ge,fe[2*de]=fe[2*ce]+fe[2*ge],z.depth[de]=(z.depth[ce]>=z.depth[ge]?z.depth[ce]:z.depth[ge])+1,fe[2*ce+1]=fe[2*ge+1]=de,z.heap[1]=de++,oe(z,fe,1),2<=z.heap_len;);z.heap[--z.heap_max]=z.heap[1],function(Ne,ft){var G,M,B,Q,he,ye,be=ft.dyn_tree,We=ft.max_code,bt=ft.stat_desc.static_tree,it=ft.stat_desc.has_stree,gt=ft.stat_desc.extra_bits,dt=ft.stat_desc.extra_base,ko=ft.stat_desc.max_length,Ri=0;for(Q=0;Q<=p;Q++)Ne.bl_count[Q]=0;for(be[2*Ne.heap[Ne.heap_max]+1]=0,G=Ne.heap_max+1;G<m;G++)ko<(Q=be[2*be[2*(M=Ne.heap[G])+1]+1]+1)&&(Q=ko,Ri++),be[2*M+1]=Q,We<M||(Ne.bl_count[Q]++,he=0,dt<=M&&(he=gt[M-dt]),ye=be[2*M],Ne.opt_len+=ye*(Q+he),it&&(Ne.static_len+=ye*(bt[2*M+1]+he)));if(Ri!==0){do{for(Q=ko-1;Ne.bl_count[Q]===0;)Q--;Ne.bl_count[Q]--,Ne.bl_count[Q+1]+=2,Ne.bl_count[ko]--,Ri-=2}while(0<Ri);for(Q=ko;Q!==0;Q--)for(M=Ne.bl_count[Q];M!==0;)We<(B=Ne.heap[--G])||(be[2*B+1]!==Q&&(Ne.opt_len+=(Q-be[2*B+1])*be[2*B],be[2*B+1]=Q),M--)}}(z,ae),re(fe,ze,z.bl_count)}function N(z,ae,ce){var ge,de,fe=-1,we=ae[1],_e=0,Ae=7,ze=4;for(we===0&&(Ae=138,ze=3),ae[2*(ce+1)+1]=65535,ge=0;ge<=ce;ge++)de=we,we=ae[2*(ge+1)+1],++_e<Ae&&de===we||(_e<ze?z.bl_tree[2*de]+=_e:de!==0?(de!==fe&&z.bl_tree[2*de]++,z.bl_tree[2*b]++):_e<=10?z.bl_tree[2*w]++:z.bl_tree[2*E]++,fe=de,ze=(_e=0)===we?(Ae=138,3):de===we?(Ae=6,3):(Ae=7,4))}function Z(z,ae,ce){var ge,de,fe=-1,we=ae[1],_e=0,Ae=7,ze=4;for(we===0&&(Ae=138,ze=3),ge=0;ge<=ce;ge++)if(de=we,we=ae[2*(ge+1)+1],!(++_e<Ae&&de===we)){if(_e<ze)for(;te(z,de,z.bl_tree),--_e!=0;);else de!==0?(de!==fe&&(te(z,de,z.bl_tree),_e--),te(z,b,z.bl_tree),ne(z,_e-3,2)):_e<=10?(te(z,w,z.bl_tree),ne(z,_e-3,3)):(te(z,E,z.bl_tree),ne(z,_e-11,7));fe=de,ze=(_e=0)===we?(Ae=138,3):de===we?(Ae=6,3):(Ae=7,4)}}l(I);var ie=!1;function W(z,ae,ce,ge){ne(z,(c<<1)+(ge?1:0),3),function(de,fe,we,_e){X(de),J(de,we),J(de,~we),i.arraySet(de.pending_buf,de.window,fe,we,de.pending),de.pending+=we}(z,ae,ce)}s._tr_init=function(z){ie||(function(){var ae,ce,ge,de,fe,we=new Array(p+1);for(de=ge=0;de<u-1;de++)for(H[de]=ge,ae=0;ae<1<<S[de];ae++)A[ge++]=de;for(A[ge-1]=de,de=fe=0;de<16;de++)for(I[de]=fe,ae=0;ae<1<<x[de];ae++)P[fe++]=de;for(fe>>=7;de<f;de++)for(I[de]=fe<<7,ae=0;ae<1<<x[de]-7;ae++)P[256+fe++]=de;for(ce=0;ce<=p;ce++)we[ce]=0;for(ae=0;ae<=143;)O[2*ae+1]=8,ae++,we[8]++;for(;ae<=255;)O[2*ae+1]=9,ae++,we[9]++;for(;ae<=279;)O[2*ae+1]=7,ae++,we[7]++;for(;ae<=287;)O[2*ae+1]=8,ae++,we[8]++;for(re(O,h+1,we),ae=0;ae<f;ae++)R[2*ae+1]=5,R[2*ae]=me(ae,5);K=new $(O,S,d+1,h,p),V=new $(R,x,0,f,p),q=new $(new Array(0),T,0,v,y)}(),ie=!0),z.l_desc=new j(z.dyn_ltree,K),z.d_desc=new j(z.dyn_dtree,V),z.bl_desc=new j(z.bl_tree,q),z.bi_buf=0,z.bi_valid=0,F(z)},s._tr_stored_block=W,s._tr_flush_block=function(z,ae,ce,ge){var de,fe,we=0;0<z.level?(z.strm.data_type===2&&(z.strm.data_type=function(_e){var Ae,ze=4093624447;for(Ae=0;Ae<=31;Ae++,ze>>>=1)if(1&ze&&_e.dyn_ltree[2*Ae]!==0)return o;if(_e.dyn_ltree[18]!==0||_e.dyn_ltree[20]!==0||_e.dyn_ltree[26]!==0)return a;for(Ae=32;Ae<d;Ae++)if(_e.dyn_ltree[2*Ae]!==0)return a;return o}(z)),ue(z,z.l_desc),ue(z,z.d_desc),we=function(_e){var Ae;for(N(_e,_e.dyn_ltree,_e.l_desc.max_code),N(_e,_e.dyn_dtree,_e.d_desc.max_code),ue(_e,_e.bl_desc),Ae=v-1;3<=Ae&&_e.bl_tree[2*D[Ae]+1]===0;Ae--);return _e.opt_len+=3*(Ae+1)+5+5+4,Ae}(z),de=z.opt_len+3+7>>>3,(fe=z.static_len+3+7>>>3)<=de&&(de=fe)):de=fe=ce+5,ce+4<=de&&ae!==-1?W(z,ae,ce,ge):z.strategy===4||fe===de?(ne(z,2+(ge?1:0),3),le(z,O,R)):(ne(z,4+(ge?1:0),3),function(_e,Ae,ze,Ne){var ft;for(ne(_e,Ae-257,5),ne(_e,ze-1,5),ne(_e,Ne-4,4),ft=0;ft<Ne;ft++)ne(_e,_e.bl_tree[2*D[ft]+1],3);Z(_e,_e.dyn_ltree,Ae-1),Z(_e,_e.dyn_dtree,ze-1)}(z,z.l_desc.max_code+1,z.d_desc.max_code+1,we+1),le(z,z.dyn_ltree,z.dyn_dtree)),F(z),ge&&X(z)},s._tr_tally=function(z,ae,ce){return z.pending_buf[z.d_buf+2*z.last_lit]=ae>>>8&255,z.pending_buf[z.d_buf+2*z.last_lit+1]=255&ae,z.pending_buf[z.l_buf+z.last_lit]=255&ce,z.last_lit++,ae===0?z.dyn_ltree[2*ce]++:(z.matches++,ae--,z.dyn_ltree[2*(A[ce]+d+1)]++,z.dyn_dtree[2*U(ae)]++),z.last_lit===z.lit_bufsize-1},s._tr_align=function(z){ne(z,2,3),te(z,_,O),function(ae){ae.bi_valid===16?(J(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)}(z)}},{"../utils/common":41}],53:[function(r,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,s){(function(i){(function(o,a){if(!o.setImmediate){var l,c,u,d,h=1,f={},v=!1,m=o.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(o);p=p&&p.setTimeout?p:o,l={}.toString.call(o.process)==="[object process]"?function(b){xt.nextTick(function(){y(b)})}:function(){if(o.postMessage&&!o.importScripts){var b=!0,w=o.onmessage;return o.onmessage=function(){b=!1},o.postMessage("","*"),o.onmessage=w,b}}()?(d="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",_,!1):o.attachEvent("onmessage",_),function(b){o.postMessage(d+b,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(b){y(b.data)},function(b){u.port2.postMessage(b)}):m&&"onreadystatechange"in m.createElement("script")?(c=m.documentElement,function(b){var w=m.createElement("script");w.onreadystatechange=function(){y(b),w.onreadystatechange=null,c.removeChild(w),w=null},c.appendChild(w)}):function(b){setTimeout(y,0,b)},p.setImmediate=function(b){typeof b!="function"&&(b=new Function(""+b));for(var w=new Array(arguments.length-1),E=0;E<w.length;E++)w[E]=arguments[E+1];var S={callback:b,args:w};return f[h]=S,l(h),h++},p.clearImmediate=g}function g(b){delete f[b]}function y(b){if(v)setTimeout(y,0,b);else{var w=f[b];if(w){v=!0;try{(function(E){var S=E.callback,x=E.args;switch(x.length){case 0:S();break;case 1:S(x[0]);break;case 2:S(x[0],x[1]);break;case 3:S(x[0],x[1],x[2]);break;default:S.apply(a,x)}})(w)}finally{g(b),v=!1}}}}function _(b){b.source===o&&typeof b.data=="string"&&b.data.indexOf(d)===0&&y(+b.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof $t<"u"?$t:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(qN);var vie=qN.exports;const yie=Ql(vie);var JN={exports:{}};(function(t,e){(function(r,n){n()})($t,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,d){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){l(h.response,u,d)},h.onerror=function(){console.error("could not download file")},h.send()}function s(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function i(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $t=="object"&&$t.global===$t?$t:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,u,d){var h=o.URL||o.webkitURL,f=document.createElement("a");u=u||c.name||"download",f.download=u,f.rel="noopener",typeof c=="string"?(f.href=c,f.origin===location.origin?i(f):s(f.href)?n(c,u,d):i(f,f.target="_blank")):(f.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(f.href)},4e4),setTimeout(function(){i(f)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,d){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,d),u);else if(s(c))n(c,u,d);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){i(h)})}}:function(c,u,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,d);var f=c.type==="application/octet-stream",v=/constructor/i.test(o.HTMLElement)||o.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||f&&v||a)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var _=p.result;_=m?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=_:location=_,h=null},p.readAsDataURL(c)}else{var g=o.URL||o.webkitURL,y=g.createObjectURL(c);h?h.location=y:location.href=y,h=null,setTimeout(function(){g.revokeObjectURL(y)},4e4)}});o.saveAs=l.saveAs=l,t.exports=l})})(JN);var _ie=JN.exports;const bie=Ql(_ie);function Sg(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof xt=="object"&&xt.version!==void 0?`Node.js/${xt.version.substr(1)} (${xt.platform}; ${xt.arch})`:"<environment undetectable>"}function YN(t,e,r,n){if(typeof r!="function")throw new Error("method for before hook must be a function");return n||(n={}),Array.isArray(e)?e.reverse().reduce((s,i)=>YN.bind(null,t,i,s,n),r)():Promise.resolve().then(()=>t.registry[e]?t.registry[e].reduce((s,i)=>i.hook.bind(null,s,n),r)():r(n))}function wie(t,e,r,n){const s=n;t.registry[r]||(t.registry[r]=[]),e==="before"&&(n=(i,o)=>Promise.resolve().then(s.bind(null,o)).then(i.bind(null,o))),e==="after"&&(n=(i,o)=>{let a;return Promise.resolve().then(i.bind(null,o)).then(l=>(a=l,s(a,o))).then(()=>a)}),e==="error"&&(n=(i,o)=>Promise.resolve().then(i.bind(null,o)).catch(a=>s(a,o))),t.registry[r].push({hook:n,orig:s})}function xie(t,e,r){if(!t.registry[e])return;const n=t.registry[e].map(s=>s.orig).indexOf(r);n!==-1&&t.registry[e].splice(n,1)}const TT=Function.bind,AT=TT.bind(TT);function Sie(t,e,r){const n=AT(xie,null).apply(null,[e]);t.api={remove:n},t.remove=n,["before","error","after","wrap"].forEach(s=>{const i=[e,s];t[s]=t.api[s]=AT(wie,null).apply(null,i)})}function Eie(){const t={registry:{}},e=YN.bind(null,t);return Sie(e,t),e}const Cie={Collection:Eie};var kie="0.0.0-development",Tie=`octokit-endpoint.js/${kie} ${Sg()}`,Aie={method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":Tie},mediaType:{format:""}};function Rie(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}function Pie(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);if(e===null)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}function ZN(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{Pie(e[n])?n in t?r[n]=ZN(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}function RT(t){for(const e in t)t[e]===void 0&&delete t[e];return t}function q_(t,e,r){if(typeof e=="string"){let[s,i]=e.split(" ");r=Object.assign(i?{method:s,url:i}:{url:s},r)}else r=Object.assign({},e);r.headers=Rie(r.headers),RT(r),RT(r.headers);const n=ZN(t||{},r);return r.url==="/graphql"&&(t&&t.mediaType.previews?.length&&(n.mediaType.previews=t.mediaType.previews.filter(s=>!n.mediaType.previews.includes(s)).concat(n.mediaType.previews)),n.mediaType.previews=(n.mediaType.previews||[]).map(s=>s.replace(/-preview/,""))),n}function Iie(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(s=>s==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${s}=${encodeURIComponent(e[s])}`).join("&")}var Oie=/\{[^{}}]+\}/g;function Die(t){return t.replace(/(?:^\W+)|(?:(?<!\W)\W+$)/g,"").split(/,/)}function Mie(t){const e=t.match(Oie);return e?e.map(Die).reduce((r,n)=>r.concat(n),[]):[]}function PT(t,e){const r={__proto__:null};for(const n of Object.keys(t))e.indexOf(n)===-1&&(r[n]=t[n]);return r}function XN(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}function sl(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function Cc(t,e,r){return e=t==="+"||t==="#"?XN(e):sl(e),r?sl(r)+"="+e:e}function ja(t){return t!=null}function my(t){return t===";"||t==="&"||t==="?"}function Lie(t,e,r,n){var s=t[r],i=[];if(ja(s)&&s!=="")if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")s=s.toString(),n&&n!=="*"&&(s=s.substring(0,parseInt(n,10))),i.push(Cc(e,s,my(e)?r:""));else if(n==="*")Array.isArray(s)?s.filter(ja).forEach(function(o){i.push(Cc(e,o,my(e)?r:""))}):Object.keys(s).forEach(function(o){ja(s[o])&&i.push(Cc(e,s[o],o))});else{const o=[];Array.isArray(s)?s.filter(ja).forEach(function(a){o.push(Cc(e,a))}):Object.keys(s).forEach(function(a){ja(s[a])&&(o.push(sl(a)),o.push(Cc(e,s[a].toString())))}),my(e)?i.push(sl(r)+"="+o.join(",")):o.length!==0&&i.push(o.join(","))}else e===";"?ja(s)&&i.push(sl(r)):s===""&&(e==="&"||e==="?")?i.push(sl(r)+"="):s===""&&i.push("");return i}function Nie(t){return{expand:Bie.bind(null,t)}}function Bie(t,e){var r=["+","#",".","/",";","?","&"];return t=t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,s,i){if(s){let a="";const l=[];if(r.indexOf(s.charAt(0))!==-1&&(a=s.charAt(0),s=s.substr(1)),s.split(/,/g).forEach(function(c){var u=/([^:\*]*)(?::(\d+)|(\*))?/.exec(c);l.push(Lie(e,a,u[1],u[2]||u[3]))}),a&&a!=="+"){var o=",";return a==="?"?o="&":a!=="#"&&(o=a),(l.length!==0?a:"")+l.join(o)}else return l.join(",")}else return XN(i)}),t==="/"?t:t.replace(/\/$/,"")}function QN(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),s,i=PT(t,["method","baseUrl","url","headers","request","mediaType"]);const o=Mie(r);r=Nie(r).expand(i),/^http/.test(r)||(r=t.baseUrl+r);const a=Object.keys(t).filter(u=>o.includes(u)).concat("baseUrl"),l=PT(i,a);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(u=>u.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),r.endsWith("/graphql")&&t.mediaType.previews?.length)){const u=n.accept.match(/(?<![\w-])[\w-]+(?=-preview)/g)||[];n.accept=u.concat(t.mediaType.previews).map(d=>{const h=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${d}-preview${h}`}).join(",")}return["GET","HEAD"].includes(e)?r=Iie(r,l):"data"in l?s=l.data:Object.keys(l).length&&(s=l),!n["content-type"]&&typeof s<"u"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof s>"u"&&(s=""),Object.assign({method:e,url:r,headers:n},typeof s<"u"?{body:s}:null,t.request?{request:t.request}:null)}function Fie(t,e,r){return QN(q_(t,e,r))}function eB(t,e){const r=q_(t,e),n=Fie.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:eB.bind(null,r),merge:q_.bind(null,r),parse:QN})}var jie=eB(null,Aie);const dS=function(){};dS.prototype=Object.create(null);const IT=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,OT=/\\([\v\u0020-\u00ff])/gu,$ie=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,il={type:"",parameters:new dS};Object.freeze(il.parameters);Object.freeze(il);function Uie(t){if(typeof t!="string")return il;let e=t.indexOf(";");const r=e!==-1?t.slice(0,e).trim():t.trim();if($ie.test(r)===!1)return il;const n={type:r.toLowerCase(),parameters:new dS};if(e===-1)return n;let s,i,o;for(IT.lastIndex=e;i=IT.exec(t);){if(i.index!==e)return il;e+=i[0].length,s=i[1].toLowerCase(),o=i[2],o[0]==='"'&&(o=o.slice(1,o.length-1),OT.test(o)&&(o=o.replace(OT,"$1"))),n.parameters[s]=o}return e!==t.length?il:n}var Hie=Uie;class Jh extends Error{name;status;request;response;constructor(e,r,n){super(e),this.name="HttpError",this.status=Number.parseInt(r),Number.isNaN(this.status)&&(this.status=0),"response"in n&&(this.response=n.response);const s=Object.assign({},n.request);n.request.headers.authorization&&(s.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/(?<! ) .*$/," [REDACTED]")})),s.url=s.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=s}}var Vie="0.0.0-development",Gie={headers:{"user-agent":`octokit-request.js/${Vie} ${Sg()}`}};function zie(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);if(e===null)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}async function DT(t){const e=t.request?.fetch||globalThis.fetch;if(!e)throw new Error("fetch is not set. Please pass a fetch implementation as new Octokit({ request: { fetch }}). Learn more at https://github.com/octokit/octokit.js/#fetch-missing");const r=t.request?.log||console,n=t.request?.parseSuccessResponseBody!==!1,s=zie(t.body)||Array.isArray(t.body)?JSON.stringify(t.body):t.body,i=Object.fromEntries(Object.entries(t.headers).map(([d,h])=>[d,String(h)]));let o;try{o=await e(t.url,{method:t.method,body:s,redirect:t.request?.redirect,headers:i,signal:t.request?.signal,...t.body&&{duplex:"half"}})}catch(d){let h="Unknown Error";if(d instanceof Error){if(d.name==="AbortError")throw d.status=500,d;h=d.message,d.name==="TypeError"&&"cause"in d&&(d.cause instanceof Error?h=d.cause.message:typeof d.cause=="string"&&(h=d.cause))}const f=new Jh(h,500,{request:t});throw f.cause=d,f}const a=o.status,l=o.url,c={};for(const[d,h]of o.headers)c[d]=h;const u={url:l,status:a,headers:c,data:""};if("deprecation"in c){const d=c.link&&c.link.match(/<([^<>]+)>; rel="deprecation"/),h=d&&d.pop();r.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${c.sunset}${h?`. See ${h}`:""}`)}if(a===204||a===205)return u;if(t.method==="HEAD"){if(a<400)return u;throw new Jh(o.statusText,a,{response:u,request:t})}if(a===304)throw u.data=await gy(o),new Jh("Not modified",a,{response:u,request:t});if(a>=400)throw u.data=await gy(o),new Jh(Kie(u.data),a,{response:u,request:t});return u.data=n?await gy(o):o.body,u}async function gy(t){const e=t.headers.get("content-type");if(!e)return t.text().catch(()=>"");const r=Hie(e);if(Wie(r)){let n="";try{return n=await t.text(),JSON.parse(n)}catch{return n}}else return r.type.startsWith("text/")||r.parameters.charset?.toLowerCase()==="utf-8"?t.text().catch(()=>""):t.arrayBuffer().catch(()=>new ArrayBuffer(0))}function Wie(t){return t.type==="application/json"||t.type==="application/scim+json"}function Kie(t){if(typeof t=="string")return t;if(t instanceof ArrayBuffer)return"Unknown error";if("message"in t){const e="documentation_url"in t?` - ${t.documentation_url}`:"";return Array.isArray(t.errors)?`${t.message}: ${t.errors.map(r=>JSON.stringify(r)).join(", ")}${e}`:`${t.message}${e}`}return`Unknown error: ${JSON.stringify(t)}`}function J_(t,e){const r=t.defaults(e);return Object.assign(function(s,i){const o=r.merge(s,i);if(!o.request||!o.request.hook)return DT(r.parse(o));const a=(l,c)=>DT(r.parse(r.merge(l,c)));return Object.assign(a,{endpoint:r,defaults:J_.bind(null,r)}),o.request.hook(a,o)},{endpoint:r,defaults:J_.bind(null,r)})}var Y_=J_(jie,Gie),qie="0.0.0-development";function Jie(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}var Yie=class extends Error{constructor(t,e,r){super(Jie(r)),this.request=t,this.headers=e,this.response=r,this.errors=r.errors,this.data=r.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}name="GraphqlResponseError";errors;data},Zie=["method","baseUrl","url","headers","request","query","mediaType","operationName"],Xie=["query","method","url"],MT=/\/api\/v3\/?$/;function Qie(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const o in r)if(Xie.includes(o))return Promise.reject(new Error(`[@octokit/graphql] "${o}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,s=Object.keys(n).reduce((o,a)=>Zie.includes(a)?(o[a]=n[a],o):(o.variables||(o.variables={}),o.variables[a]=n[a],o),{}),i=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return MT.test(i)&&(s.url=i.replace(MT,"/api/graphql")),t(s).then(o=>{if(o.data.errors){const a={};for(const l of Object.keys(o.headers))a[l]=o.headers[l];throw new Yie(s,a,o.data)}return o.data.data})}function hS(t,e){const r=t.defaults(e);return Object.assign((s,i)=>Qie(r,s,i),{defaults:hS.bind(null,r),endpoint:r.endpoint})}hS(Y_,{headers:{"user-agent":`octokit-graphql.js/${qie} ${Sg()}`},method:"POST",url:"/graphql"});function eoe(t){return hS(t,{method:"POST",url:"/graphql"})}var vy="(?:[a-zA-Z0-9_-]+)",LT="\\.",NT=new RegExp(`^${vy}${LT}${vy}${LT}${vy}$`),toe=NT.test.bind(NT);async function roe(t){const e=toe(t),r=t.startsWith("v1.")||t.startsWith("ghs_"),n=t.startsWith("ghu_");return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}function noe(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}async function soe(t,e,r,n){const s=e.endpoint.merge(r,n);return s.headers.authorization=noe(t),e(s)}var ioe=function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(roe.bind(null,e),{hook:soe.bind(null,e)})};const tB="6.1.4",BT=()=>{},ooe=console.warn.bind(console),aoe=console.error.bind(console),FT=`octokit-core.js/${tB} ${Sg()}`;let loe=class{static VERSION=tB;static defaults(e){return class extends this{constructor(...n){const s=n[0]||{};if(typeof e=="function"){super(e(s));return}super(Object.assign({},e,s,s.userAgent&&e.userAgent?{userAgent:`${s.userAgent} ${e.userAgent}`}:null))}}}static plugins=[];static plugin(...e){const r=this.plugins;return class extends this{static plugins=r.concat(e.filter(s=>!r.includes(s)))}}constructor(e={}){const r=new Cie.Collection,n={baseUrl:Y_.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=e.userAgent?`${e.userAgent} ${FT}`:FT,e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=Y_.defaults(n),this.graphql=eoe(this.request).defaults(n),this.log=Object.assign({debug:BT,info:BT,warn:ooe,error:aoe},e.log),this.hook=r,e.authStrategy){const{authStrategy:i,...o}=e,a=i(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:o},e.auth));r.wrap("request",a.hook),this.auth=a}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const i=ioe(e.auth);r.wrap("request",i.hook),this.auth=i}const s=this.constructor;for(let i=0;i<s.plugins.length;++i)Object.assign(this,s.plugins[i](this,e))}request;graphql;log;hook;auth};const coe="5.3.1";function rB(t){t.hook.wrap("request",(e,r)=>{t.log.debug("request",r);const n=Date.now(),s=t.request.endpoint.parse(r),i=s.url.replace(r.baseUrl,"");return e(r).then(o=>{const a=o.headers["x-github-request-id"];return t.log.info(`${s.method} ${i} - ${o.status} with id ${a} in ${Date.now()-n}ms`),o}).catch(o=>{const a=o.response?.headers["x-github-request-id"]||"UNKNOWN";throw t.log.error(`${s.method} ${i} - ${o.status} with id ${a} in ${Date.now()-n}ms`),o})})}rB.VERSION=coe;var uoe="0.0.0-development";function doe(t){if(!t.data)return{...t,data:[]};if(!("total_count"in t.data&&!("url"in t.data)))return t;const r=t.data.incomplete_results,n=t.data.repository_selection,s=t.data.total_count;delete t.data.incomplete_results,delete t.data.repository_selection,delete t.data.total_count;const i=Object.keys(t.data)[0],o=t.data[i];return t.data=o,typeof r<"u"&&(t.data.incomplete_results=r),typeof n<"u"&&(t.data.repository_selection=n),t.data.total_count=s,t}function fS(t,e,r){const n=typeof e=="function"?e.endpoint(r):t.request.endpoint(e,r),s=typeof e=="function"?e:t.request,i=n.method,o=n.headers;let a=n.url;return{[Symbol.asyncIterator]:()=>({async next(){if(!a)return{done:!0};try{const l=await s({method:i,url:a,headers:o}),c=doe(l);return a=((c.headers.link||"").match(/<([^<>]+)>;\s*rel="next"/)||[])[1],{value:c}}catch(l){if(l.status!==409)throw l;return a="",{value:{status:200,headers:{},data:[]}}}}})}}function nB(t,e,r,n){return typeof r=="function"&&(n=r,r=void 0),sB(t,[],fS(t,e,r)[Symbol.asyncIterator](),n)}function sB(t,e,r,n){return r.next().then(s=>{if(s.done)return e;let i=!1;function o(){i=!0}return e=e.concat(n?n(s.value,o):s.value.data),i?e:sB(t,e,r,n)})}Object.assign(nB,{iterator:fS});function iB(t){return{paginate:Object.assign(nB.bind(null,t),{iterator:fS.bind(null,t)})}}iB.VERSION=uoe;const hoe="13.5.0",foe={actions:{addCustomLabelsToSelfHostedRunnerForOrg:["POST /orgs/{org}/actions/runners/{runner_id}/labels"],addCustomLabelsToSelfHostedRunnerForRepo:["POST /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],addRepoAccessToSelfHostedRunnerGroupInOrg:["PUT /orgs/{org}/actions/runner-groups/{runner_group_id}/repositories/{repository_id}"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],approveWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/approve"],cancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/cancel"],createEnvironmentVariable:["POST /repos/{owner}/{repo}/environments/{environment_name}/variables"],createHostedRunnerForOrg:["POST /orgs/{org}/actions/hosted-runners"],createOrUpdateEnvironmentSecret:["PUT /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/actions/secrets/{secret_name}"],createOrgVariable:["POST /orgs/{org}/actions/variables"],createRegistrationTokenForOrg:["POST /orgs/{org}/actions/runners/registration-token"],createRegistrationTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/registration-token"],createRemoveTokenForOrg:["POST /orgs/{org}/actions/runners/remove-token"],createRemoveTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/remove-token"],createRepoVariable:["POST /repos/{owner}/{repo}/actions/variables"],createWorkflowDispatch:["POST /repos/{owner}/{repo}/actions/workflows/{workflow_id}/dispatches"],deleteActionsCacheById:["DELETE /repos/{owner}/{repo}/actions/caches/{cache_id}"],deleteActionsCacheByKey:["DELETE /repos/{owner}/{repo}/actions/caches{?key,ref}"],deleteArtifact:["DELETE /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],deleteEnvironmentSecret:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],deleteEnvironmentVariable:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],deleteHostedRunnerForOrg:["DELETE /orgs/{org}/actions/hosted-runners/{hosted_runner_id}"],deleteOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}"],deleteOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/actions/secrets/{secret_name}"],deleteRepoVariable:["DELETE /repos/{owner}/{repo}/actions/variables/{name}"],deleteSelfHostedRunnerFromOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}"],deleteSelfHostedRunnerFromRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}"],deleteWorkflowRun:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}"],deleteWorkflowRunLogs:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],disableSelectedRepositoryGithubActionsOrganization:["DELETE /orgs/{org}/actions/permissions/repositories/{repository_id}"],disableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/disable"],downloadArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}/{archive_format}"],downloadJobLogsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}/logs"],downloadWorkflowRunAttemptLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/logs"],downloadWorkflowRunLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],enableSelectedRepositoryGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories/{repository_id}"],enableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/enable"],forceCancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/force-cancel"],generateRunnerJitconfigForOrg:["POST /orgs/{org}/actions/runners/generate-jitconfig"],generateRunnerJitconfigForRepo:["POST /repos/{owner}/{repo}/actions/runners/generate-jitconfig"],getActionsCacheList:["GET /repos/{owner}/{repo}/actions/caches"],getActionsCacheUsage:["GET /repos/{owner}/{repo}/actions/cache/usage"],getActionsCacheUsageByRepoForOrg:["GET /orgs/{org}/actions/cache/usage-by-repository"],getActionsCacheUsageForOrg:["GET /orgs/{org}/actions/cache/usage"],getAllowedActionsOrganization:["GET /orgs/{org}/actions/permissions/selected-actions"],getAllowedActionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/selected-actions"],getArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],getCustomOidcSubClaimForRepo:["GET /repos/{owner}/{repo}/actions/oidc/customization/sub"],getEnvironmentPublicKey:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets/public-key"],getEnvironmentSecret:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],getEnvironmentVariable:["GET /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],getGithubActionsDefaultWorkflowPermissionsOrganization:["GET /orgs/{org}/actions/permissions/workflow"],getGithubActionsDefaultWorkflowPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/workflow"],getGithubActionsPermissionsOrganization:["GET /orgs/{org}/actions/permissions"],getGithubActionsPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions"],getHostedRunnerForOrg:["GET /orgs/{org}/actions/hosted-runners/{hosted_runner_id}"],getHostedRunnersGithubOwnedImagesForOrg:["GET /orgs/{org}/actions/hosted-runners/images/github-owned"],getHostedRunnersLimitsForOrg:["GET /orgs/{org}/actions/hosted-runners/limits"],getHostedRunnersMachineSpecsForOrg:["GET /orgs/{org}/actions/hosted-runners/machine-sizes"],getHostedRunnersPartnerImagesForOrg:["GET /orgs/{org}/actions/hosted-runners/images/partner"],getHostedRunnersPlatformsForOrg:["GET /orgs/{org}/actions/hosted-runners/platforms"],getJobForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}"],getOrgPublicKey:["GET /orgs/{org}/actions/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}"],getOrgVariable:["GET /orgs/{org}/actions/variables/{name}"],getPendingDeploymentsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],getRepoPermissions:["GET /repos/{owner}/{repo}/actions/permissions",{},{renamed:["actions","getGithubActionsPermissionsRepository"]}],getRepoPublicKey:["GET /repos/{owner}/{repo}/actions/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/actions/secrets/{secret_name}"],getRepoVariable:["GET /repos/{owner}/{repo}/actions/variables/{name}"],getReviewsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/approvals"],getSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}"],getSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}"],getWorkflow:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}"],getWorkflowAccessToRepository:["GET /repos/{owner}/{repo}/actions/permissions/access"],getWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}"],getWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}"],getWorkflowRunUsage:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/timing"],getWorkflowUsage:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/timing"],listArtifactsForRepo:["GET /repos/{owner}/{repo}/actions/artifacts"],listEnvironmentSecrets:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets"],listEnvironmentVariables:["GET /repos/{owner}/{repo}/environments/{environment_name}/variables"],listGithubHostedRunnersInGroupForOrg:["GET /orgs/{org}/actions/runner-groups/{runner_group_id}/hosted-runners"],listHostedRunnersForOrg:["GET /orgs/{org}/actions/hosted-runners"],listJobsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/jobs"],listJobsForWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/jobs"],listLabelsForSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}/labels"],listLabelsForSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],listOrgSecrets:["GET /orgs/{org}/actions/secrets"],listOrgVariables:["GET /orgs/{org}/actions/variables"],listRepoOrganizationSecrets:["GET /repos/{owner}/{repo}/actions/organization-secrets"],listRepoOrganizationVariables:["GET /repos/{owner}/{repo}/actions/organization-variables"],listRepoSecrets:["GET /repos/{owner}/{repo}/actions/secrets"],listRepoVariables:["GET /repos/{owner}/{repo}/actions/variables"],listRepoWorkflows:["GET /repos/{owner}/{repo}/actions/workflows"],listRunnerApplicationsForOrg:["GET /orgs/{org}/actions/runners/downloads"],listRunnerApplicationsForRepo:["GET /repos/{owner}/{repo}/actions/runners/downloads"],listSelectedReposForOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}/repositories"],listSelectedReposForOrgVariable:["GET /orgs/{org}/actions/variables/{name}/repositories"],listSelectedRepositoriesEnabledGithubActionsOrganization:["GET /orgs/{org}/actions/permissions/repositories"],listSelfHostedRunnersForOrg:["GET /orgs/{org}/actions/runners"],listSelfHostedRunnersForRepo:["GET /repos/{owner}/{repo}/actions/runners"],listWorkflowRunArtifacts:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/artifacts"],listWorkflowRuns:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/runs"],listWorkflowRunsForRepo:["GET /repos/{owner}/{repo}/actions/runs"],reRunJobForWorkflowRun:["POST /repos/{owner}/{repo}/actions/jobs/{job_id}/rerun"],reRunWorkflow:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun"],reRunWorkflowFailedJobs:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun-failed-jobs"],removeAllCustomLabelsFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels"],removeAllCustomLabelsFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],removeCustomLabelFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels/{name}"],removeCustomLabelFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels/{name}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],reviewCustomGatesForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/deployment_protection_rule"],reviewPendingDeploymentsForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],setAllowedActionsOrganization:["PUT /orgs/{org}/actions/permissions/selected-actions"],setAllowedActionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/selected-actions"],setCustomLabelsForSelfHostedRunnerForOrg:["PUT /orgs/{org}/actions/runners/{runner_id}/labels"],setCustomLabelsForSelfHostedRunnerForRepo:["PUT /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],setCustomOidcSubClaimForRepo:["PUT /repos/{owner}/{repo}/actions/oidc/customization/sub"],setGithubActionsDefaultWorkflowPermissionsOrganization:["PUT /orgs/{org}/actions/permissions/workflow"],setGithubActionsDefaultWorkflowPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/workflow"],setGithubActionsPermissionsOrganization:["PUT /orgs/{org}/actions/permissions"],setGithubActionsPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories"],setSelectedReposForOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories"],setSelectedRepositoriesEnabledGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories"],setWorkflowAccessToRepository:["PUT /repos/{owner}/{repo}/actions/permissions/access"],updateEnvironmentVariable:["PATCH /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],updateHostedRunnerForOrg:["PATCH /orgs/{org}/actions/hosted-runners/{hosted_runner_id}"],updateOrgVariable:["PATCH /orgs/{org}/actions/variables/{name}"],updateRepoVariable:["PATCH /repos/{owner}/{repo}/actions/variables/{name}"]},activity:{checkRepoIsStarredByAuthenticatedUser:["GET /user/starred/{owner}/{repo}"],deleteRepoSubscription:["DELETE /repos/{owner}/{repo}/subscription"],deleteThreadSubscription:["DELETE /notifications/threads/{thread_id}/subscription"],getFeeds:["GET /feeds"],getRepoSubscription:["GET /repos/{owner}/{repo}/subscription"],getThread:["GET /notifications/threads/{thread_id}"],getThreadSubscriptionForAuthenticatedUser:["GET /notifications/threads/{thread_id}/subscription"],listEventsForAuthenticatedUser:["GET /users/{username}/events"],listNotificationsForAuthenticatedUser:["GET /notifications"],listOrgEventsForAuthenticatedUser:["GET /users/{username}/events/orgs/{org}"],listPublicEvents:["GET /events"],listPublicEventsForRepoNetwork:["GET /networks/{owner}/{repo}/events"],listPublicEventsForUser:["GET /users/{username}/events/public"],listPublicOrgEvents:["GET /orgs/{org}/events"],listReceivedEventsForUser:["GET /users/{username}/received_events"],listReceivedPublicEventsForUser:["GET /users/{username}/received_events/public"],listRepoEvents:["GET /repos/{owner}/{repo}/events"],listRepoNotificationsForAuthenticatedUser:["GET /repos/{owner}/{repo}/notifications"],listReposStarredByAuthenticatedUser:["GET /user/starred"],listReposStarredByUser:["GET /users/{username}/starred"],listReposWatchedByUser:["GET /users/{username}/subscriptions"],listStargazersForRepo:["GET /repos/{owner}/{repo}/stargazers"],listWatchedReposForAuthenticatedUser:["GET /user/subscriptions"],listWatchersForRepo:["GET /repos/{owner}/{repo}/subscribers"],markNotificationsAsRead:["PUT /notifications"],markRepoNotificationsAsRead:["PUT /repos/{owner}/{repo}/notifications"],markThreadAsDone:["DELETE /notifications/threads/{thread_id}"],markThreadAsRead:["PATCH /notifications/threads/{thread_id}"],setRepoSubscription:["PUT /repos/{owner}/{repo}/subscription"],setThreadSubscription:["PUT /notifications/threads/{thread_id}/subscription"],starRepoForAuthenticatedUser:["PUT /user/starred/{owner}/{repo}"],unstarRepoForAuthenticatedUser:["DELETE /user/starred/{owner}/{repo}"]},apps:{addRepoToInstallation:["PUT /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","addRepoToInstallationForAuthenticatedUser"]}],addRepoToInstallationForAuthenticatedUser:["PUT /user/installations/{installation_id}/repositories/{repository_id}"],checkToken:["POST /applications/{client_id}/token"],createFromManifest:["POST /app-manifests/{code}/conversions"],createInstallationAccessToken:["POST /app/installations/{installation_id}/access_tokens"],deleteAuthorization:["DELETE /applications/{client_id}/grant"],deleteInstallation:["DELETE /app/installations/{installation_id}"],deleteToken:["DELETE /applications/{client_id}/token"],getAuthenticated:["GET /app"],getBySlug:["GET /apps/{app_slug}"],getInstallation:["GET /app/installations/{installation_id}"],getOrgInstallation:["GET /orgs/{org}/installation"],getRepoInstallation:["GET /repos/{owner}/{repo}/installation"],getSubscriptionPlanForAccount:["GET /marketplace_listing/accounts/{account_id}"],getSubscriptionPlanForAccountStubbed:["GET /marketplace_listing/stubbed/accounts/{account_id}"],getUserInstallation:["GET /users/{username}/installation"],getWebhookConfigForApp:["GET /app/hook/config"],getWebhookDelivery:["GET /app/hook/deliveries/{delivery_id}"],listAccountsForPlan:["GET /marketplace_listing/plans/{plan_id}/accounts"],listAccountsForPlanStubbed:["GET /marketplace_listing/stubbed/plans/{plan_id}/accounts"],listInstallationReposForAuthenticatedUser:["GET /user/installations/{installation_id}/repositories"],listInstallationRequestsForAuthenticatedApp:["GET /app/installation-requests"],listInstallations:["GET /app/installations"],listInstallationsForAuthenticatedUser:["GET /user/installations"],listPlans:["GET /marketplace_listing/plans"],listPlansStubbed:["GET /marketplace_listing/stubbed/plans"],listReposAccessibleToInstallation:["GET /installation/repositories"],listSubscriptionsForAuthenticatedUser:["GET /user/marketplace_purchases"],listSubscriptionsForAuthenticatedUserStubbed:["GET /user/marketplace_purchases/stubbed"],listWebhookDeliveries:["GET /app/hook/deliveries"],redeliverWebhookDelivery:["POST /app/hook/deliveries/{delivery_id}/attempts"],removeRepoFromInstallation:["DELETE /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","removeRepoFromInstallationForAuthenticatedUser"]}],removeRepoFromInstallationForAuthenticatedUser:["DELETE /user/installations/{installation_id}/repositories/{repository_id}"],resetToken:["PATCH /applications/{client_id}/token"],revokeInstallationAccessToken:["DELETE /installation/token"],scopeToken:["POST /applications/{client_id}/token/scoped"],suspendInstallation:["PUT /app/installations/{installation_id}/suspended"],unsuspendInstallation:["DELETE /app/installations/{installation_id}/suspended"],updateWebhookConfigForApp:["PATCH /app/hook/config"]},billing:{getGithubActionsBillingOrg:["GET /orgs/{org}/settings/billing/actions"],getGithubActionsBillingUser:["GET /users/{username}/settings/billing/actions"],getGithubBillingUsageReportOrg:["GET /organizations/{org}/settings/billing/usage"],getGithubPackagesBillingOrg:["GET /orgs/{org}/settings/billing/packages"],getGithubPackagesBillingUser:["GET /users/{username}/settings/billing/packages"],getSharedStorageBillingOrg:["GET /orgs/{org}/settings/billing/shared-storage"],getSharedStorageBillingUser:["GET /users/{username}/settings/billing/shared-storage"]},checks:{create:["POST /repos/{owner}/{repo}/check-runs"],createSuite:["POST /repos/{owner}/{repo}/check-suites"],get:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}"],getSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}"],listAnnotations:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}/annotations"],listForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-runs"],listForSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}/check-runs"],listSuitesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-suites"],rerequestRun:["POST /repos/{owner}/{repo}/check-runs/{check_run_id}/rerequest"],rerequestSuite:["POST /repos/{owner}/{repo}/check-suites/{check_suite_id}/rerequest"],setSuitesPreferences:["PATCH /repos/{owner}/{repo}/check-suites/preferences"],update:["PATCH /repos/{owner}/{repo}/check-runs/{check_run_id}"]},codeScanning:{commitAutofix:["POST /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/autofix/commits"],createAutofix:["POST /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/autofix"],createVariantAnalysis:["POST /repos/{owner}/{repo}/code-scanning/codeql/variant-analyses"],deleteAnalysis:["DELETE /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}{?confirm_delete}"],deleteCodeqlDatabase:["DELETE /repos/{owner}/{repo}/code-scanning/codeql/databases/{language}"],getAlert:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}",{},{renamedParameters:{alert_id:"alert_number"}}],getAnalysis:["GET /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}"],getAutofix:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/autofix"],getCodeqlDatabase:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases/{language}"],getDefaultSetup:["GET /repos/{owner}/{repo}/code-scanning/default-setup"],getSarif:["GET /repos/{owner}/{repo}/code-scanning/sarifs/{sarif_id}"],getVariantAnalysis:["GET /repos/{owner}/{repo}/code-scanning/codeql/variant-analyses/{codeql_variant_analysis_id}"],getVariantAnalysisRepoTask:["GET /repos/{owner}/{repo}/code-scanning/codeql/variant-analyses/{codeql_variant_analysis_id}/repos/{repo_owner}/{repo_name}"],listAlertInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances"],listAlertsForOrg:["GET /orgs/{org}/code-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/code-scanning/alerts"],listAlertsInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances",{},{renamed:["codeScanning","listAlertInstances"]}],listCodeqlDatabases:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases"],listRecentAnalyses:["GET /repos/{owner}/{repo}/code-scanning/analyses"],updateAlert:["PATCH /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}"],updateDefaultSetup:["PATCH /repos/{owner}/{repo}/code-scanning/default-setup"],uploadSarif:["POST /repos/{owner}/{repo}/code-scanning/sarifs"]},codeSecurity:{attachConfiguration:["POST /orgs/{org}/code-security/configurations/{configuration_id}/attach"],attachEnterpriseConfiguration:["POST /enterprises/{enterprise}/code-security/configurations/{configuration_id}/attach"],createConfiguration:["POST /orgs/{org}/code-security/configurations"],createConfigurationForEnterprise:["POST /enterprises/{enterprise}/code-security/configurations"],deleteConfiguration:["DELETE /orgs/{org}/code-security/configurations/{configuration_id}"],deleteConfigurationForEnterprise:["DELETE /enterprises/{enterprise}/code-security/configurations/{configuration_id}"],detachConfiguration:["DELETE /orgs/{org}/code-security/configurations/detach"],getConfiguration:["GET /orgs/{org}/code-security/configurations/{configuration_id}"],getConfigurationForRepository:["GET /repos/{owner}/{repo}/code-security-configuration"],getConfigurationsForEnterprise:["GET /enterprises/{enterprise}/code-security/configurations"],getConfigurationsForOrg:["GET /orgs/{org}/code-security/configurations"],getDefaultConfigurations:["GET /orgs/{org}/code-security/configurations/defaults"],getDefaultConfigurationsForEnterprise:["GET /enterprises/{enterprise}/code-security/configurations/defaults"],getRepositoriesForConfiguration:["GET /orgs/{org}/code-security/configurations/{configuration_id}/repositories"],getRepositoriesForEnterpriseConfiguration:["GET /enterprises/{enterprise}/code-security/configurations/{configuration_id}/repositories"],getSingleConfigurationForEnterprise:["GET /enterprises/{enterprise}/code-security/configurations/{configuration_id}"],setConfigurationAsDefault:["PUT /orgs/{org}/code-security/configurations/{configuration_id}/defaults"],setConfigurationAsDefaultForEnterprise:["PUT /enterprises/{enterprise}/code-security/configurations/{configuration_id}/defaults"],updateConfiguration:["PATCH /orgs/{org}/code-security/configurations/{configuration_id}"],updateEnterpriseConfiguration:["PATCH /enterprises/{enterprise}/code-security/configurations/{configuration_id}"]},codesOfConduct:{getAllCodesOfConduct:["GET /codes_of_conduct"],getConductCode:["GET /codes_of_conduct/{key}"]},codespaces:{addRepositoryForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],checkPermissionsForDevcontainer:["GET /repos/{owner}/{repo}/codespaces/permissions_check"],codespaceMachinesForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/machines"],createForAuthenticatedUser:["POST /user/codespaces"],createOrUpdateOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],createOrUpdateSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}"],createWithPrForAuthenticatedUser:["POST /repos/{owner}/{repo}/pulls/{pull_number}/codespaces"],createWithRepoForAuthenticatedUser:["POST /repos/{owner}/{repo}/codespaces"],deleteForAuthenticatedUser:["DELETE /user/codespaces/{codespace_name}"],deleteFromOrganization:["DELETE /orgs/{org}/members/{username}/codespaces/{codespace_name}"],deleteOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],deleteSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}"],exportForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/exports"],getCodespacesForUserInOrg:["GET /orgs/{org}/members/{username}/codespaces"],getExportDetailsForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/exports/{export_id}"],getForAuthenticatedUser:["GET /user/codespaces/{codespace_name}"],getOrgPublicKey:["GET /orgs/{org}/codespaces/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}"],getPublicKeyForAuthenticatedUser:["GET /user/codespaces/secrets/public-key"],getRepoPublicKey:["GET /repos/{owner}/{repo}/codespaces/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],getSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}"],listDevcontainersInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/devcontainers"],listForAuthenticatedUser:["GET /user/codespaces"],listInOrganization:["GET /orgs/{org}/codespaces",{},{renamedParameters:{org_id:"org"}}],listInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces"],listOrgSecrets:["GET /orgs/{org}/codespaces/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/codespaces/secrets"],listRepositoriesForSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}/repositories"],listSecretsForAuthenticatedUser:["GET /user/codespaces/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],preFlightWithRepoForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/new"],publishForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/publish"],removeRepositoryForSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],repoMachinesForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/machines"],setRepositoriesForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],startForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/start"],stopForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/stop"],stopInOrganization:["POST /orgs/{org}/members/{username}/codespaces/{codespace_name}/stop"],updateForAuthenticatedUser:["PATCH /user/codespaces/{codespace_name}"]},copilot:{addCopilotSeatsForTeams:["POST /orgs/{org}/copilot/billing/selected_teams"],addCopilotSeatsForUsers:["POST /orgs/{org}/copilot/billing/selected_users"],cancelCopilotSeatAssignmentForTeams:["DELETE /orgs/{org}/copilot/billing/selected_teams"],cancelCopilotSeatAssignmentForUsers:["DELETE /orgs/{org}/copilot/billing/selected_users"],copilotMetricsForOrganization:["GET /orgs/{org}/copilot/metrics"],copilotMetricsForTeam:["GET /orgs/{org}/team/{team_slug}/copilot/metrics"],getCopilotOrganizationDetails:["GET /orgs/{org}/copilot/billing"],getCopilotSeatDetailsForUser:["GET /orgs/{org}/members/{username}/copilot"],listCopilotSeats:["GET /orgs/{org}/copilot/billing/seats"],usageMetricsForOrg:["GET /orgs/{org}/copilot/usage"],usageMetricsForTeam:["GET /orgs/{org}/team/{team_slug}/copilot/usage"]},dependabot:{addSelectedRepoToOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],deleteOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],getAlert:["GET /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"],getOrgPublicKey:["GET /orgs/{org}/dependabot/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}"],getRepoPublicKey:["GET /repos/{owner}/{repo}/dependabot/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/dependabot/alerts"],listAlertsForOrg:["GET /orgs/{org}/dependabot/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/dependabot/alerts"],listOrgSecrets:["GET /orgs/{org}/dependabot/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/dependabot/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],updateAlert:["PATCH /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"]},dependencyGraph:{createRepositorySnapshot:["POST /repos/{owner}/{repo}/dependency-graph/snapshots"],diffRange:["GET /repos/{owner}/{repo}/dependency-graph/compare/{basehead}"],exportSbom:["GET /repos/{owner}/{repo}/dependency-graph/sbom"]},emojis:{get:["GET /emojis"]},gists:{checkIsStarred:["GET /gists/{gist_id}/star"],create:["POST /gists"],createComment:["POST /gists/{gist_id}/comments"],delete:["DELETE /gists/{gist_id}"],deleteComment:["DELETE /gists/{gist_id}/comments/{comment_id}"],fork:["POST /gists/{gist_id}/forks"],get:["GET /gists/{gist_id}"],getComment:["GET /gists/{gist_id}/comments/{comment_id}"],getRevision:["GET /gists/{gist_id}/{sha}"],list:["GET /gists"],listComments:["GET /gists/{gist_id}/comments"],listCommits:["GET /gists/{gist_id}/commits"],listForUser:["GET /users/{username}/gists"],listForks:["GET /gists/{gist_id}/forks"],listPublic:["GET /gists/public"],listStarred:["GET /gists/starred"],star:["PUT /gists/{gist_id}/star"],unstar:["DELETE /gists/{gist_id}/star"],update:["PATCH /gists/{gist_id}"],updateComment:["PATCH /gists/{gist_id}/comments/{comment_id}"]},git:{createBlob:["POST /repos/{owner}/{repo}/git/blobs"],createCommit:["POST /repos/{owner}/{repo}/git/commits"],createRef:["POST /repos/{owner}/{repo}/git/refs"],createTag:["POST /repos/{owner}/{repo}/git/tags"],createTree:["POST /repos/{owner}/{repo}/git/trees"],deleteRef:["DELETE /repos/{owner}/{repo}/git/refs/{ref}"],getBlob:["GET /repos/{owner}/{repo}/git/blobs/{file_sha}"],getCommit:["GET /repos/{owner}/{repo}/git/commits/{commit_sha}"],getRef:["GET /repos/{owner}/{repo}/git/ref/{ref}"],getTag:["GET /repos/{owner}/{repo}/git/tags/{tag_sha}"],getTree:["GET /repos/{owner}/{repo}/git/trees/{tree_sha}"],listMatchingRefs:["GET /repos/{owner}/{repo}/git/matching-refs/{ref}"],updateRef:["PATCH /repos/{owner}/{repo}/git/refs/{ref}"]},gitignore:{getAllTemplates:["GET /gitignore/templates"],getTemplate:["GET /gitignore/templates/{name}"]},hostedCompute:{createNetworkConfigurationForOrg:["POST /orgs/{org}/settings/network-configurations"],deleteNetworkConfigurationFromOrg:["DELETE /orgs/{org}/settings/network-configurations/{network_configuration_id}"],getNetworkConfigurationForOrg:["GET /orgs/{org}/settings/network-configurations/{network_configuration_id}"],getNetworkSettingsForOrg:["GET /orgs/{org}/settings/network-settings/{network_settings_id}"],listNetworkConfigurationsForOrg:["GET /orgs/{org}/settings/network-configurations"],updateNetworkConfigurationForOrg:["PATCH /orgs/{org}/settings/network-configurations/{network_configuration_id}"]},interactions:{getRestrictionsForAuthenticatedUser:["GET /user/interaction-limits"],getRestrictionsForOrg:["GET /orgs/{org}/interaction-limits"],getRestrictionsForRepo:["GET /repos/{owner}/{repo}/interaction-limits"],getRestrictionsForYourPublicRepos:["GET /user/interaction-limits",{},{renamed:["interactions","getRestrictionsForAuthenticatedUser"]}],removeRestrictionsForAuthenticatedUser:["DELETE /user/interaction-limits"],removeRestrictionsForOrg:["DELETE /orgs/{org}/interaction-limits"],removeRestrictionsForRepo:["DELETE /repos/{owner}/{repo}/interaction-limits"],removeRestrictionsForYourPublicRepos:["DELETE /user/interaction-limits",{},{renamed:["interactions","removeRestrictionsForAuthenticatedUser"]}],setRestrictionsForAuthenticatedUser:["PUT /user/interaction-limits"],setRestrictionsForOrg:["PUT /orgs/{org}/interaction-limits"],setRestrictionsForRepo:["PUT /repos/{owner}/{repo}/interaction-limits"],setRestrictionsForYourPublicRepos:["PUT /user/interaction-limits",{},{renamed:["interactions","setRestrictionsForAuthenticatedUser"]}]},issues:{addAssignees:["POST /repos/{owner}/{repo}/issues/{issue_number}/assignees"],addLabels:["POST /repos/{owner}/{repo}/issues/{issue_number}/labels"],addSubIssue:["POST /repos/{owner}/{repo}/issues/{issue_number}/sub_issues"],checkUserCanBeAssigned:["GET /repos/{owner}/{repo}/assignees/{assignee}"],checkUserCanBeAssignedToIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/assignees/{assignee}"],create:["POST /repos/{owner}/{repo}/issues"],createComment:["POST /repos/{owner}/{repo}/issues/{issue_number}/comments"],createLabel:["POST /repos/{owner}/{repo}/labels"],createMilestone:["POST /repos/{owner}/{repo}/milestones"],deleteComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}"],deleteLabel:["DELETE /repos/{owner}/{repo}/labels/{name}"],deleteMilestone:["DELETE /repos/{owner}/{repo}/milestones/{milestone_number}"],get:["GET /repos/{owner}/{repo}/issues/{issue_number}"],getComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}"],getEvent:["GET /repos/{owner}/{repo}/issues/events/{event_id}"],getLabel:["GET /repos/{owner}/{repo}/labels/{name}"],getMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}"],list:["GET /issues"],listAssignees:["GET /repos/{owner}/{repo}/assignees"],listComments:["GET /repos/{owner}/{repo}/issues/{issue_number}/comments"],listCommentsForRepo:["GET /repos/{owner}/{repo}/issues/comments"],listEvents:["GET /repos/{owner}/{repo}/issues/{issue_number}/events"],listEventsForRepo:["GET /repos/{owner}/{repo}/issues/events"],listEventsForTimeline:["GET /repos/{owner}/{repo}/issues/{issue_number}/timeline"],listForAuthenticatedUser:["GET /user/issues"],listForOrg:["GET /orgs/{org}/issues"],listForRepo:["GET /repos/{owner}/{repo}/issues"],listLabelsForMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}/labels"],listLabelsForRepo:["GET /repos/{owner}/{repo}/labels"],listLabelsOnIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/labels"],listMilestones:["GET /repos/{owner}/{repo}/milestones"],listSubIssues:["GET /repos/{owner}/{repo}/issues/{issue_number}/sub_issues"],lock:["PUT /repos/{owner}/{repo}/issues/{issue_number}/lock"],removeAllLabels:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels"],removeAssignees:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/assignees"],removeLabel:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels/{name}"],removeSubIssue:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/sub_issue"],reprioritizeSubIssue:["PATCH /repos/{owner}/{repo}/issues/{issue_number}/sub_issues/priority"],setLabels:["PUT /repos/{owner}/{repo}/issues/{issue_number}/labels"],unlock:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/lock"],update:["PATCH /repos/{owner}/{repo}/issues/{issue_number}"],updateComment:["PATCH /repos/{owner}/{repo}/issues/comments/{comment_id}"],updateLabel:["PATCH /repos/{owner}/{repo}/labels/{name}"],updateMilestone:["PATCH /repos/{owner}/{repo}/milestones/{milestone_number}"]},licenses:{get:["GET /licenses/{license}"],getAllCommonlyUsed:["GET /licenses"],getForRepo:["GET /repos/{owner}/{repo}/license"]},markdown:{render:["POST /markdown"],renderRaw:["POST /markdown/raw",{headers:{"content-type":"text/plain; charset=utf-8"}}]},meta:{get:["GET /meta"],getAllVersions:["GET /versions"],getOctocat:["GET /octocat"],getZen:["GET /zen"],root:["GET /"]},migrations:{deleteArchiveForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/archive"],deleteArchiveForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/archive"],downloadArchiveForOrg:["GET /orgs/{org}/migrations/{migration_id}/archive"],getArchiveForAuthenticatedUser:["GET /user/migrations/{migration_id}/archive"],getStatusForAuthenticatedUser:["GET /user/migrations/{migration_id}"],getStatusForOrg:["GET /orgs/{org}/migrations/{migration_id}"],listForAuthenticatedUser:["GET /user/migrations"],listForOrg:["GET /orgs/{org}/migrations"],listReposForAuthenticatedUser:["GET /user/migrations/{migration_id}/repositories"],listReposForOrg:["GET /orgs/{org}/migrations/{migration_id}/repositories"],listReposForUser:["GET /user/migrations/{migration_id}/repositories",{},{renamed:["migrations","listReposForAuthenticatedUser"]}],startForAuthenticatedUser:["POST /user/migrations"],startForOrg:["POST /orgs/{org}/migrations"],unlockRepoForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/repos/{repo_name}/lock"],unlockRepoForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/repos/{repo_name}/lock"]},oidc:{getOidcCustomSubTemplateForOrg:["GET /orgs/{org}/actions/oidc/customization/sub"],updateOidcCustomSubTemplateForOrg:["PUT /orgs/{org}/actions/oidc/customization/sub"]},orgs:{addSecurityManagerTeam:["PUT /orgs/{org}/security-managers/teams/{team_slug}",{},{deprecated:"octokit.rest.orgs.addSecurityManagerTeam() is deprecated, see https://docs.github.com/rest/orgs/security-managers#add-a-security-manager-team"}],assignTeamToOrgRole:["PUT /orgs/{org}/organization-roles/teams/{team_slug}/{role_id}"],assignUserToOrgRole:["PUT /orgs/{org}/organization-roles/users/{username}/{role_id}"],blockUser:["PUT /orgs/{org}/blocks/{username}"],cancelInvitation:["DELETE /orgs/{org}/invitations/{invitation_id}"],checkBlockedUser:["GET /orgs/{org}/blocks/{username}"],checkMembershipForUser:["GET /orgs/{org}/members/{username}"],checkPublicMembershipForUser:["GET /orgs/{org}/public_members/{username}"],convertMemberToOutsideCollaborator:["PUT /orgs/{org}/outside_collaborators/{username}"],createInvitation:["POST /orgs/{org}/invitations"],createIssueType:["POST /orgs/{org}/issue-types"],createOrUpdateCustomProperties:["PATCH /orgs/{org}/properties/schema"],createOrUpdateCustomPropertiesValuesForRepos:["PATCH /orgs/{org}/properties/values"],createOrUpdateCustomProperty:["PUT /orgs/{org}/properties/schema/{custom_property_name}"],createWebhook:["POST /orgs/{org}/hooks"],delete:["DELETE /orgs/{org}"],deleteIssueType:["DELETE /orgs/{org}/issue-types/{issue_type_id}"],deleteWebhook:["DELETE /orgs/{org}/hooks/{hook_id}"],enableOrDisableSecurityProductOnAllOrgRepos:["POST /orgs/{org}/{security_product}/{enablement}",{},{deprecated:"octokit.rest.orgs.enableOrDisableSecurityProductOnAllOrgRepos() is deprecated, see https://docs.github.com/rest/orgs/orgs#enable-or-disable-a-security-feature-for-an-organization"}],get:["GET /orgs/{org}"],getAllCustomProperties:["GET /orgs/{org}/properties/schema"],getCustomProperty:["GET /orgs/{org}/properties/schema/{custom_property_name}"],getMembershipForAuthenticatedUser:["GET /user/memberships/orgs/{org}"],getMembershipForUser:["GET /orgs/{org}/memberships/{username}"],getOrgRole:["GET /orgs/{org}/organization-roles/{role_id}"],getOrgRulesetHistory:["GET /orgs/{org}/rulesets/{ruleset_id}/history"],getOrgRulesetVersion:["GET /orgs/{org}/rulesets/{ruleset_id}/history/{version_id}"],getWebhook:["GET /orgs/{org}/hooks/{hook_id}"],getWebhookConfigForOrg:["GET /orgs/{org}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}"],list:["GET /organizations"],listAppInstallations:["GET /orgs/{org}/installations"],listAttestations:["GET /orgs/{org}/attestations/{subject_digest}"],listBlockedUsers:["GET /orgs/{org}/blocks"],listCustomPropertiesValuesForRepos:["GET /orgs/{org}/properties/values"],listFailedInvitations:["GET /orgs/{org}/failed_invitations"],listForAuthenticatedUser:["GET /user/orgs"],listForUser:["GET /users/{username}/orgs"],listInvitationTeams:["GET /orgs/{org}/invitations/{invitation_id}/teams"],listIssueTypes:["GET /orgs/{org}/issue-types"],listMembers:["GET /orgs/{org}/members"],listMembershipsForAuthenticatedUser:["GET /user/memberships/orgs"],listOrgRoleTeams:["GET /orgs/{org}/organization-roles/{role_id}/teams"],listOrgRoleUsers:["GET /orgs/{org}/organization-roles/{role_id}/users"],listOrgRoles:["GET /orgs/{org}/organization-roles"],listOrganizationFineGrainedPermissions:["GET /orgs/{org}/organization-fine-grained-permissions"],listOutsideCollaborators:["GET /orgs/{org}/outside_collaborators"],listPatGrantRepositories:["GET /orgs/{org}/personal-access-tokens/{pat_id}/repositories"],listPatGrantRequestRepositories:["GET /orgs/{org}/personal-access-token-requests/{pat_request_id}/repositories"],listPatGrantRequests:["GET /orgs/{org}/personal-access-token-requests"],listPatGrants:["GET /orgs/{org}/personal-access-tokens"],listPendingInvitations:["GET /orgs/{org}/invitations"],listPublicMembers:["GET /orgs/{org}/public_members"],listSecurityManagerTeams:["GET /orgs/{org}/security-managers",{},{deprecated:"octokit.rest.orgs.listSecurityManagerTeams() is deprecated, see https://docs.github.com/rest/orgs/security-managers#list-security-manager-teams"}],listWebhookDeliveries:["GET /orgs/{org}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /orgs/{org}/hooks"],pingWebhook:["POST /orgs/{org}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeCustomProperty:["DELETE /orgs/{org}/properties/schema/{custom_property_name}"],removeMember:["DELETE /orgs/{org}/members/{username}"],removeMembershipForUser:["DELETE /orgs/{org}/memberships/{username}"],removeOutsideCollaborator:["DELETE /orgs/{org}/outside_collaborators/{username}"],removePublicMembershipForAuthenticatedUser:["DELETE /orgs/{org}/public_members/{username}"],removeSecurityManagerTeam:["DELETE /orgs/{org}/security-managers/teams/{team_slug}",{},{deprecated:"octokit.rest.orgs.removeSecurityManagerTeam() is deprecated, see https://docs.github.com/rest/orgs/security-managers#remove-a-security-manager-team"}],reviewPatGrantRequest:["POST /orgs/{org}/personal-access-token-requests/{pat_request_id}"],reviewPatGrantRequestsInBulk:["POST /orgs/{org}/personal-access-token-requests"],revokeAllOrgRolesTeam:["DELETE /orgs/{org}/organization-roles/teams/{team_slug}"],revokeAllOrgRolesUser:["DELETE /orgs/{org}/organization-roles/users/{username}"],revokeOrgRoleTeam:["DELETE /orgs/{org}/organization-roles/teams/{team_slug}/{role_id}"],revokeOrgRoleUser:["DELETE /orgs/{org}/organization-roles/users/{username}/{role_id}"],setMembershipForUser:["PUT /orgs/{org}/memberships/{username}"],setPublicMembershipForAuthenticatedUser:["PUT /orgs/{org}/public_members/{username}"],unblockUser:["DELETE /orgs/{org}/blocks/{username}"],update:["PATCH /orgs/{org}"],updateIssueType:["PUT /orgs/{org}/issue-types/{issue_type_id}"],updateMembershipForAuthenticatedUser:["PATCH /user/memberships/orgs/{org}"],updatePatAccess:["POST /orgs/{org}/personal-access-tokens/{pat_id}"],updatePatAccesses:["POST /orgs/{org}/personal-access-tokens"],updateWebhook:["PATCH /orgs/{org}/hooks/{hook_id}"],updateWebhookConfigForOrg:["PATCH /orgs/{org}/hooks/{hook_id}/config"]},packages:{deletePackageForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}"],deletePackageForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}"],deletePackageForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}"],deletePackageVersionForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getAllPackageVersionsForAPackageOwnedByAnOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByOrg"]}],getAllPackageVersionsForAPackageOwnedByTheAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByAuthenticatedUser"]}],getAllPackageVersionsForPackageOwnedByAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions"],getPackageForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}"],getPackageForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}"],getPackageForUser:["GET /users/{username}/packages/{package_type}/{package_name}"],getPackageVersionForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],listDockerMigrationConflictingPackagesForAuthenticatedUser:["GET /user/docker/conflicts"],listDockerMigrationConflictingPackagesForOrganization:["GET /orgs/{org}/docker/conflicts"],listDockerMigrationConflictingPackagesForUser:["GET /users/{username}/docker/conflicts"],listPackagesForAuthenticatedUser:["GET /user/packages"],listPackagesForOrganization:["GET /orgs/{org}/packages"],listPackagesForUser:["GET /users/{username}/packages"],restorePackageForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForUser:["POST /users/{username}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageVersionForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForUser:["POST /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"]},privateRegistries:{createOrgPrivateRegistry:["POST /orgs/{org}/private-registries"],deleteOrgPrivateRegistry:["DELETE /orgs/{org}/private-registries/{secret_name}"],getOrgPrivateRegistry:["GET /orgs/{org}/private-registries/{secret_name}"],getOrgPublicKey:["GET /orgs/{org}/private-registries/public-key"],listOrgPrivateRegistries:["GET /orgs/{org}/private-registries"],updateOrgPrivateRegistry:["PATCH /orgs/{org}/private-registries/{secret_name}"]},projects:{addCollaborator:["PUT /projects/{project_id}/collaborators/{username}",{},{deprecated:"octokit.rest.projects.addCollaborator() is deprecated, see https://docs.github.com/rest/projects/collaborators#add-project-collaborator"}],createCard:["POST /projects/columns/{column_id}/cards",{},{deprecated:"octokit.rest.projects.createCard() is deprecated, see https://docs.github.com/rest/projects/cards#create-a-project-card"}],createColumn:["POST /projects/{project_id}/columns",{},{deprecated:"octokit.rest.projects.createColumn() is deprecated, see https://docs.github.com/rest/projects/columns#create-a-project-column"}],createForAuthenticatedUser:["POST /user/projects",{},{deprecated:"octokit.rest.projects.createForAuthenticatedUser() is deprecated, see https://docs.github.com/rest/projects/projects#create-a-user-project"}],createForOrg:["POST /orgs/{org}/projects",{},{deprecated:"octokit.rest.projects.createForOrg() is deprecated, see https://docs.github.com/rest/projects/projects#create-an-organization-project"}],createForRepo:["POST /repos/{owner}/{repo}/projects",{},{deprecated:"octokit.rest.projects.createForRepo() is deprecated, see https://docs.github.com/rest/projects/projects#create-a-repository-project"}],delete:["DELETE /projects/{project_id}",{},{deprecated:"octokit.rest.projects.delete() is deprecated, see https://docs.github.com/rest/projects/projects#delete-a-project"}],deleteCard:["DELETE /projects/columns/cards/{card_id}",{},{deprecated:"octokit.rest.projects.deleteCard() is deprecated, see https://docs.github.com/rest/projects/cards#delete-a-project-card"}],deleteColumn:["DELETE /projects/columns/{column_id}",{},{deprecated:"octokit.rest.projects.deleteColumn() is deprecated, see https://docs.github.com/rest/projects/columns#delete-a-project-column"}],get:["GET /projects/{project_id}",{},{deprecated:"octokit.rest.projects.get() is deprecated, see https://docs.github.com/rest/projects/projects#get-a-project"}],getCard:["GET /projects/columns/cards/{card_id}",{},{deprecated:"octokit.rest.projects.getCard() is deprecated, see https://docs.github.com/rest/projects/cards#get-a-project-card"}],getColumn:["GET /projects/columns/{column_id}",{},{deprecated:"octokit.rest.projects.getColumn() is deprecated, see https://docs.github.com/rest/projects/columns#get-a-project-column"}],getPermissionForUser:["GET /projects/{project_id}/collaborators/{username}/permission",{},{deprecated:"octokit.rest.projects.getPermissionForUser() is deprecated, see https://docs.github.com/rest/projects/collaborators#get-project-permission-for-a-user"}],listCards:["GET /projects/columns/{column_id}/cards",{},{deprecated:"octokit.rest.projects.listCards() is deprecated, see https://docs.github.com/rest/projects/cards#list-project-cards"}],listCollaborators:["GET /projects/{project_id}/collaborators",{},{deprecated:"octokit.rest.projects.listCollaborators() is deprecated, see https://docs.github.com/rest/projects/collaborators#list-project-collaborators"}],listColumns:["GET /projects/{project_id}/columns",{},{deprecated:"octokit.rest.projects.listColumns() is deprecated, see https://docs.github.com/rest/projects/columns#list-project-columns"}],listForOrg:["GET /orgs/{org}/projects",{},{deprecated:"octokit.rest.projects.listForOrg() is deprecated, see https://docs.github.com/rest/projects/projects#list-organization-projects"}],listForRepo:["GET /repos/{owner}/{repo}/projects",{},{deprecated:"octokit.rest.projects.listForRepo() is deprecated, see https://docs.github.com/rest/projects/projects#list-repository-projects"}],listForUser:["GET /users/{username}/projects",{},{deprecated:"octokit.rest.projects.listForUser() is deprecated, see https://docs.github.com/rest/projects/projects#list-user-projects"}],moveCard:["POST /projects/columns/cards/{card_id}/moves",{},{deprecated:"octokit.rest.projects.moveCard() is deprecated, see https://docs.github.com/rest/projects/cards#move-a-project-card"}],moveColumn:["POST /projects/columns/{column_id}/moves",{},{deprecated:"octokit.rest.projects.moveColumn() is deprecated, see https://docs.github.com/rest/projects/columns#move-a-project-column"}],removeCollaborator:["DELETE /projects/{project_id}/collaborators/{username}",{},{deprecated:"octokit.rest.projects.removeCollaborator() is deprecated, see https://docs.github.com/rest/projects/collaborators#remove-user-as-a-collaborator"}],update:["PATCH /projects/{project_id}",{},{deprecated:"octokit.rest.projects.update() is deprecated, see https://docs.github.com/rest/projects/projects#update-a-project"}],updateCard:["PATCH /projects/columns/cards/{card_id}",{},{deprecated:"octokit.rest.projects.updateCard() is deprecated, see https://docs.github.com/rest/projects/cards#update-an-existing-project-card"}],updateColumn:["PATCH /projects/columns/{column_id}",{},{deprecated:"octokit.rest.projects.updateColumn() is deprecated, see https://docs.github.com/rest/projects/columns#update-an-existing-project-column"}]},pulls:{checkIfMerged:["GET /repos/{owner}/{repo}/pulls/{pull_number}/merge"],create:["POST /repos/{owner}/{repo}/pulls"],createReplyForReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments/{comment_id}/replies"],createReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],createReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments"],deletePendingReview:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],deleteReviewComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}"],dismissReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/dismissals"],get:["GET /repos/{owner}/{repo}/pulls/{pull_number}"],getReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],getReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}"],list:["GET /repos/{owner}/{repo}/pulls"],listCommentsForReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/comments"],listCommits:["GET /repos/{owner}/{repo}/pulls/{pull_number}/commits"],listFiles:["GET /repos/{owner}/{repo}/pulls/{pull_number}/files"],listRequestedReviewers:["GET /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],listReviewComments:["GET /repos/{owner}/{repo}/pulls/{pull_number}/comments"],listReviewCommentsForRepo:["GET /repos/{owner}/{repo}/pulls/comments"],listReviews:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],merge:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/merge"],removeRequestedReviewers:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],requestReviewers:["POST /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],submitReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/events"],update:["PATCH /repos/{owner}/{repo}/pulls/{pull_number}"],updateBranch:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/update-branch"],updateReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],updateReviewComment:["PATCH /repos/{owner}/{repo}/pulls/comments/{comment_id}"]},rateLimit:{get:["GET /rate_limit"]},reactions:{createForCommitComment:["POST /repos/{owner}/{repo}/comments/{comment_id}/reactions"],createForIssue:["POST /repos/{owner}/{repo}/issues/{issue_number}/reactions"],createForIssueComment:["POST /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],createForPullRequestReviewComment:["POST /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],createForRelease:["POST /repos/{owner}/{repo}/releases/{release_id}/reactions"],createForTeamDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],createForTeamDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"],deleteForCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}/reactions/{reaction_id}"],deleteForIssue:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/reactions/{reaction_id}"],deleteForIssueComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions/{reaction_id}"],deleteForPullRequestComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions/{reaction_id}"],deleteForRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}/reactions/{reaction_id}"],deleteForTeamDiscussion:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions/{reaction_id}"],deleteForTeamDiscussionComment:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions/{reaction_id}"],listForCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}/reactions"],listForIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/reactions"],listForIssueComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],listForPullRequestReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],listForRelease:["GET /repos/{owner}/{repo}/releases/{release_id}/reactions"],listForTeamDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],listForTeamDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"]},repos:{acceptInvitation:["PATCH /user/repository_invitations/{invitation_id}",{},{renamed:["repos","acceptInvitationForAuthenticatedUser"]}],acceptInvitationForAuthenticatedUser:["PATCH /user/repository_invitations/{invitation_id}"],addAppAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],addCollaborator:["PUT /repos/{owner}/{repo}/collaborators/{username}"],addStatusCheckContexts:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],addTeamAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],addUserAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],cancelPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployments/{pages_deployment_id}/cancel"],checkAutomatedSecurityFixes:["GET /repos/{owner}/{repo}/automated-security-fixes"],checkCollaborator:["GET /repos/{owner}/{repo}/collaborators/{username}"],checkPrivateVulnerabilityReporting:["GET /repos/{owner}/{repo}/private-vulnerability-reporting"],checkVulnerabilityAlerts:["GET /repos/{owner}/{repo}/vulnerability-alerts"],codeownersErrors:["GET /repos/{owner}/{repo}/codeowners/errors"],compareCommits:["GET /repos/{owner}/{repo}/compare/{base}...{head}"],compareCommitsWithBasehead:["GET /repos/{owner}/{repo}/compare/{basehead}"],createAttestation:["POST /repos/{owner}/{repo}/attestations"],createAutolink:["POST /repos/{owner}/{repo}/autolinks"],createCommitComment:["POST /repos/{owner}/{repo}/commits/{commit_sha}/comments"],createCommitSignatureProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],createCommitStatus:["POST /repos/{owner}/{repo}/statuses/{sha}"],createDeployKey:["POST /repos/{owner}/{repo}/keys"],createDeployment:["POST /repos/{owner}/{repo}/deployments"],createDeploymentBranchPolicy:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],createDeploymentProtectionRule:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],createDeploymentStatus:["POST /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],createDispatchEvent:["POST /repos/{owner}/{repo}/dispatches"],createForAuthenticatedUser:["POST /user/repos"],createFork:["POST /repos/{owner}/{repo}/forks"],createInOrg:["POST /orgs/{org}/repos"],createOrUpdateCustomPropertiesValues:["PATCH /repos/{owner}/{repo}/properties/values"],createOrUpdateEnvironment:["PUT /repos/{owner}/{repo}/environments/{environment_name}"],createOrUpdateFileContents:["PUT /repos/{owner}/{repo}/contents/{path}"],createOrgRuleset:["POST /orgs/{org}/rulesets"],createPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployments"],createPagesSite:["POST /repos/{owner}/{repo}/pages"],createRelease:["POST /repos/{owner}/{repo}/releases"],createRepoRuleset:["POST /repos/{owner}/{repo}/rulesets"],createUsingTemplate:["POST /repos/{template_owner}/{template_repo}/generate"],createWebhook:["POST /repos/{owner}/{repo}/hooks"],declineInvitation:["DELETE /user/repository_invitations/{invitation_id}",{},{renamed:["repos","declineInvitationForAuthenticatedUser"]}],declineInvitationForAuthenticatedUser:["DELETE /user/repository_invitations/{invitation_id}"],delete:["DELETE /repos/{owner}/{repo}"],deleteAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],deleteAdminBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],deleteAnEnvironment:["DELETE /repos/{owner}/{repo}/environments/{environment_name}"],deleteAutolink:["DELETE /repos/{owner}/{repo}/autolinks/{autolink_id}"],deleteBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection"],deleteCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}"],deleteCommitSignatureProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],deleteDeployKey:["DELETE /repos/{owner}/{repo}/keys/{key_id}"],deleteDeployment:["DELETE /repos/{owner}/{repo}/deployments/{deployment_id}"],deleteDeploymentBranchPolicy:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],deleteFile:["DELETE /repos/{owner}/{repo}/contents/{path}"],deleteInvitation:["DELETE /repos/{owner}/{repo}/invitations/{invitation_id}"],deleteOrgRuleset:["DELETE /orgs/{org}/rulesets/{ruleset_id}"],deletePagesSite:["DELETE /repos/{owner}/{repo}/pages"],deletePullRequestReviewProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],deleteRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}"],deleteReleaseAsset:["DELETE /repos/{owner}/{repo}/releases/assets/{asset_id}"],deleteRepoRuleset:["DELETE /repos/{owner}/{repo}/rulesets/{ruleset_id}"],deleteWebhook:["DELETE /repos/{owner}/{repo}/hooks/{hook_id}"],disableAutomatedSecurityFixes:["DELETE /repos/{owner}/{repo}/automated-security-fixes"],disableDeploymentProtectionRule:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],disablePrivateVulnerabilityReporting:["DELETE /repos/{owner}/{repo}/private-vulnerability-reporting"],disableVulnerabilityAlerts:["DELETE /repos/{owner}/{repo}/vulnerability-alerts"],downloadArchive:["GET /repos/{owner}/{repo}/zipball/{ref}",{},{renamed:["repos","downloadZipballArchive"]}],downloadTarballArchive:["GET /repos/{owner}/{repo}/tarball/{ref}"],downloadZipballArchive:["GET /repos/{owner}/{repo}/zipball/{ref}"],enableAutomatedSecurityFixes:["PUT /repos/{owner}/{repo}/automated-security-fixes"],enablePrivateVulnerabilityReporting:["PUT /repos/{owner}/{repo}/private-vulnerability-reporting"],enableVulnerabilityAlerts:["PUT /repos/{owner}/{repo}/vulnerability-alerts"],generateReleaseNotes:["POST /repos/{owner}/{repo}/releases/generate-notes"],get:["GET /repos/{owner}/{repo}"],getAccessRestrictions:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],getAdminBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],getAllDeploymentProtectionRules:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],getAllEnvironments:["GET /repos/{owner}/{repo}/environments"],getAllStatusCheckContexts:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts"],getAllTopics:["GET /repos/{owner}/{repo}/topics"],getAppsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps"],getAutolink:["GET /repos/{owner}/{repo}/autolinks/{autolink_id}"],getBranch:["GET /repos/{owner}/{repo}/branches/{branch}"],getBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection"],getBranchRules:["GET /repos/{owner}/{repo}/rules/branches/{branch}"],getClones:["GET /repos/{owner}/{repo}/traffic/clones"],getCodeFrequencyStats:["GET /repos/{owner}/{repo}/stats/code_frequency"],getCollaboratorPermissionLevel:["GET /repos/{owner}/{repo}/collaborators/{username}/permission"],getCombinedStatusForRef:["GET /repos/{owner}/{repo}/commits/{ref}/status"],getCommit:["GET /repos/{owner}/{repo}/commits/{ref}"],getCommitActivityStats:["GET /repos/{owner}/{repo}/stats/commit_activity"],getCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}"],getCommitSignatureProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],getCommunityProfileMetrics:["GET /repos/{owner}/{repo}/community/profile"],getContent:["GET /repos/{owner}/{repo}/contents/{path}"],getContributorsStats:["GET /repos/{owner}/{repo}/stats/contributors"],getCustomDeploymentProtectionRule:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],getCustomPropertiesValues:["GET /repos/{owner}/{repo}/properties/values"],getDeployKey:["GET /repos/{owner}/{repo}/keys/{key_id}"],getDeployment:["GET /repos/{owner}/{repo}/deployments/{deployment_id}"],getDeploymentBranchPolicy:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],getDeploymentStatus:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses/{status_id}"],getEnvironment:["GET /repos/{owner}/{repo}/environments/{environment_name}"],getLatestPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/latest"],getLatestRelease:["GET /repos/{owner}/{repo}/releases/latest"],getOrgRuleSuite:["GET /orgs/{org}/rulesets/rule-suites/{rule_suite_id}"],getOrgRuleSuites:["GET /orgs/{org}/rulesets/rule-suites"],getOrgRuleset:["GET /orgs/{org}/rulesets/{ruleset_id}"],getOrgRulesets:["GET /orgs/{org}/rulesets"],getPages:["GET /repos/{owner}/{repo}/pages"],getPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/{build_id}"],getPagesDeployment:["GET /repos/{owner}/{repo}/pages/deployments/{pages_deployment_id}"],getPagesHealthCheck:["GET /repos/{owner}/{repo}/pages/health"],getParticipationStats:["GET /repos/{owner}/{repo}/stats/participation"],getPullRequestReviewProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],getPunchCardStats:["GET /repos/{owner}/{repo}/stats/punch_card"],getReadme:["GET /repos/{owner}/{repo}/readme"],getReadmeInDirectory:["GET /repos/{owner}/{repo}/readme/{dir}"],getRelease:["GET /repos/{owner}/{repo}/releases/{release_id}"],getReleaseAsset:["GET /repos/{owner}/{repo}/releases/assets/{asset_id}"],getReleaseByTag:["GET /repos/{owner}/{repo}/releases/tags/{tag}"],getRepoRuleSuite:["GET /repos/{owner}/{repo}/rulesets/rule-suites/{rule_suite_id}"],getRepoRuleSuites:["GET /repos/{owner}/{repo}/rulesets/rule-suites"],getRepoRuleset:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}"],getRepoRulesetHistory:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}/history"],getRepoRulesetVersion:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}/history/{version_id}"],getRepoRulesets:["GET /repos/{owner}/{repo}/rulesets"],getStatusChecksProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],getTeamsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams"],getTopPaths:["GET /repos/{owner}/{repo}/traffic/popular/paths"],getTopReferrers:["GET /repos/{owner}/{repo}/traffic/popular/referrers"],getUsersWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users"],getViews:["GET /repos/{owner}/{repo}/traffic/views"],getWebhook:["GET /repos/{owner}/{repo}/hooks/{hook_id}"],getWebhookConfigForRepo:["GET /repos/{owner}/{repo}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}"],listActivities:["GET /repos/{owner}/{repo}/activity"],listAttestations:["GET /repos/{owner}/{repo}/attestations/{subject_digest}"],listAutolinks:["GET /repos/{owner}/{repo}/autolinks"],listBranches:["GET /repos/{owner}/{repo}/branches"],listBranchesForHeadCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/branches-where-head"],listCollaborators:["GET /repos/{owner}/{repo}/collaborators"],listCommentsForCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/comments"],listCommitCommentsForRepo:["GET /repos/{owner}/{repo}/comments"],listCommitStatusesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/statuses"],listCommits:["GET /repos/{owner}/{repo}/commits"],listContributors:["GET /repos/{owner}/{repo}/contributors"],listCustomDeploymentRuleIntegrations:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/apps"],listDeployKeys:["GET /repos/{owner}/{repo}/keys"],listDeploymentBranchPolicies:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],listDeploymentStatuses:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],listDeployments:["GET /repos/{owner}/{repo}/deployments"],listForAuthenticatedUser:["GET /user/repos"],listForOrg:["GET /orgs/{org}/repos"],listForUser:["GET /users/{username}/repos"],listForks:["GET /repos/{owner}/{repo}/forks"],listInvitations:["GET /repos/{owner}/{repo}/invitations"],listInvitationsForAuthenticatedUser:["GET /user/repository_invitations"],listLanguages:["GET /repos/{owner}/{repo}/languages"],listPagesBuilds:["GET /repos/{owner}/{repo}/pages/builds"],listPublic:["GET /repositories"],listPullRequestsAssociatedWithCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/pulls"],listReleaseAssets:["GET /repos/{owner}/{repo}/releases/{release_id}/assets"],listReleases:["GET /repos/{owner}/{repo}/releases"],listTags:["GET /repos/{owner}/{repo}/tags"],listTeams:["GET /repos/{owner}/{repo}/teams"],listWebhookDeliveries:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /repos/{owner}/{repo}/hooks"],merge:["POST /repos/{owner}/{repo}/merges"],mergeUpstream:["POST /repos/{owner}/{repo}/merge-upstream"],pingWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeAppAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],removeCollaborator:["DELETE /repos/{owner}/{repo}/collaborators/{username}"],removeStatusCheckContexts:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],removeStatusCheckProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],removeTeamAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],removeUserAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],renameBranch:["POST /repos/{owner}/{repo}/branches/{branch}/rename"],replaceAllTopics:["PUT /repos/{owner}/{repo}/topics"],requestPagesBuild:["POST /repos/{owner}/{repo}/pages/builds"],setAdminBranchProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],setAppAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],setStatusCheckContexts:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],setTeamAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],setUserAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],testPushWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/tests"],transfer:["POST /repos/{owner}/{repo}/transfer"],update:["PATCH /repos/{owner}/{repo}"],updateBranchProtection:["PUT /repos/{owner}/{repo}/branches/{branch}/protection"],updateCommitComment:["PATCH /repos/{owner}/{repo}/comments/{comment_id}"],updateDeploymentBranchPolicy:["PUT /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],updateInformationAboutPagesSite:["PUT /repos/{owner}/{repo}/pages"],updateInvitation:["PATCH /repos/{owner}/{repo}/invitations/{invitation_id}"],updateOrgRuleset:["PUT /orgs/{org}/rulesets/{ruleset_id}"],updatePullRequestReviewProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],updateRelease:["PATCH /repos/{owner}/{repo}/releases/{release_id}"],updateReleaseAsset:["PATCH /repos/{owner}/{repo}/releases/assets/{asset_id}"],updateRepoRuleset:["PUT /repos/{owner}/{repo}/rulesets/{ruleset_id}"],updateStatusCheckPotection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks",{},{renamed:["repos","updateStatusCheckProtection"]}],updateStatusCheckProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],updateWebhook:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}"],updateWebhookConfigForRepo:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}/config"],uploadReleaseAsset:["POST /repos/{owner}/{repo}/releases/{release_id}/assets{?name,label}",{baseUrl:"https://uploads.github.com"}]},search:{code:["GET /search/code"],commits:["GET /search/commits"],issuesAndPullRequests:["GET /search/issues",{},{deprecated:"octokit.rest.search.issuesAndPullRequests() is deprecated, see https://docs.github.com/rest/search/search#search-issues-and-pull-requests"}],labels:["GET /search/labels"],repos:["GET /search/repositories"],topics:["GET /search/topics"],users:["GET /search/users"]},secretScanning:{createPushProtectionBypass:["POST /repos/{owner}/{repo}/secret-scanning/push-protection-bypasses"],getAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"],getScanHistory:["GET /repos/{owner}/{repo}/secret-scanning/scan-history"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/secret-scanning/alerts"],listAlertsForOrg:["GET /orgs/{org}/secret-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/secret-scanning/alerts"],listLocationsForAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}/locations"],updateAlert:["PATCH /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"]},securityAdvisories:{createFork:["POST /repos/{owner}/{repo}/security-advisories/{ghsa_id}/forks"],createPrivateVulnerabilityReport:["POST /repos/{owner}/{repo}/security-advisories/reports"],createRepositoryAdvisory:["POST /repos/{owner}/{repo}/security-advisories"],createRepositoryAdvisoryCveRequest:["POST /repos/{owner}/{repo}/security-advisories/{ghsa_id}/cve"],getGlobalAdvisory:["GET /advisories/{ghsa_id}"],getRepositoryAdvisory:["GET /repos/{owner}/{repo}/security-advisories/{ghsa_id}"],listGlobalAdvisories:["GET /advisories"],listOrgRepositoryAdvisories:["GET /orgs/{org}/security-advisories"],listRepositoryAdvisories:["GET /repos/{owner}/{repo}/security-advisories"],updateRepositoryAdvisory:["PATCH /repos/{owner}/{repo}/security-advisories/{ghsa_id}"]},teams:{addOrUpdateMembershipForUserInOrg:["PUT /orgs/{org}/teams/{team_slug}/memberships/{username}"],addOrUpdateProjectPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/projects/{project_id}",{},{deprecated:"octokit.rest.teams.addOrUpdateProjectPermissionsInOrg() is deprecated, see https://docs.github.com/rest/teams/teams#add-or-update-team-project-permissions"}],addOrUpdateProjectPermissionsLegacy:["PUT /teams/{team_id}/projects/{project_id}",{},{deprecated:"octokit.rest.teams.addOrUpdateProjectPermissionsLegacy() is deprecated, see https://docs.github.com/rest/teams/teams#add-or-update-team-project-permissions-legacy"}],addOrUpdateRepoPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],checkPermissionsForProjectInOrg:["GET /orgs/{org}/teams/{team_slug}/projects/{project_id}",{},{deprecated:"octokit.rest.teams.checkPermissionsForProjectInOrg() is deprecated, see https://docs.github.com/rest/teams/teams#check-team-permissions-for-a-project"}],checkPermissionsForProjectLegacy:["GET /teams/{team_id}/projects/{project_id}",{},{deprecated:"octokit.rest.teams.checkPermissionsForProjectLegacy() is deprecated, see https://docs.github.com/rest/teams/teams#check-team-permissions-for-a-project-legacy"}],checkPermissionsForRepoInOrg:["GET /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],create:["POST /orgs/{org}/teams"],createDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],createDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions"],deleteDiscussionCommentInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],deleteDiscussionInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],deleteInOrg:["DELETE /orgs/{org}/teams/{team_slug}"],getByName:["GET /orgs/{org}/teams/{team_slug}"],getDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],getDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],getMembershipForUserInOrg:["GET /orgs/{org}/teams/{team_slug}/memberships/{username}"],list:["GET /orgs/{org}/teams"],listChildInOrg:["GET /orgs/{org}/teams/{team_slug}/teams"],listDiscussionCommentsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],listDiscussionsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions"],listForAuthenticatedUser:["GET /user/teams"],listMembersInOrg:["GET /orgs/{org}/teams/{team_slug}/members"],listPendingInvitationsInOrg:["GET /orgs/{org}/teams/{team_slug}/invitations"],listProjectsInOrg:["GET /orgs/{org}/teams/{team_slug}/projects",{},{deprecated:"octokit.rest.teams.listProjectsInOrg() is deprecated, see https://docs.github.com/rest/teams/teams#list-team-projects"}],listProjectsLegacy:["GET /teams/{team_id}/projects",{},{deprecated:"octokit.rest.teams.listProjectsLegacy() is deprecated, see https://docs.github.com/rest/teams/teams#list-team-projects-legacy"}],listReposInOrg:["GET /orgs/{org}/teams/{team_slug}/repos"],removeMembershipForUserInOrg:["DELETE /orgs/{org}/teams/{team_slug}/memberships/{username}"],removeProjectInOrg:["DELETE /orgs/{org}/teams/{team_slug}/projects/{project_id}",{},{deprecated:"octokit.rest.teams.removeProjectInOrg() is deprecated, see https://docs.github.com/rest/teams/teams#remove-a-project-from-a-team"}],removeProjectLegacy:["DELETE /teams/{team_id}/projects/{project_id}",{},{deprecated:"octokit.rest.teams.removeProjectLegacy() is deprecated, see https://docs.github.com/rest/teams/teams#remove-a-project-from-a-team-legacy"}],removeRepoInOrg:["DELETE /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],updateDiscussionCommentInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],updateDiscussionInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],updateInOrg:["PATCH /orgs/{org}/teams/{team_slug}"]},users:{addEmailForAuthenticated:["POST /user/emails",{},{renamed:["users","addEmailForAuthenticatedUser"]}],addEmailForAuthenticatedUser:["POST /user/emails"],addSocialAccountForAuthenticatedUser:["POST /user/social_accounts"],block:["PUT /user/blocks/{username}"],checkBlocked:["GET /user/blocks/{username}"],checkFollowingForUser:["GET /users/{username}/following/{target_user}"],checkPersonIsFollowedByAuthenticated:["GET /user/following/{username}"],createGpgKeyForAuthenticated:["POST /user/gpg_keys",{},{renamed:["users","createGpgKeyForAuthenticatedUser"]}],createGpgKeyForAuthenticatedUser:["POST /user/gpg_keys"],createPublicSshKeyForAuthenticated:["POST /user/keys",{},{renamed:["users","createPublicSshKeyForAuthenticatedUser"]}],createPublicSshKeyForAuthenticatedUser:["POST /user/keys"],createSshSigningKeyForAuthenticatedUser:["POST /user/ssh_signing_keys"],deleteEmailForAuthenticated:["DELETE /user/emails",{},{renamed:["users","deleteEmailForAuthenticatedUser"]}],deleteEmailForAuthenticatedUser:["DELETE /user/emails"],deleteGpgKeyForAuthenticated:["DELETE /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","deleteGpgKeyForAuthenticatedUser"]}],deleteGpgKeyForAuthenticatedUser:["DELETE /user/gpg_keys/{gpg_key_id}"],deletePublicSshKeyForAuthenticated:["DELETE /user/keys/{key_id}",{},{renamed:["users","deletePublicSshKeyForAuthenticatedUser"]}],deletePublicSshKeyForAuthenticatedUser:["DELETE /user/keys/{key_id}"],deleteSocialAccountForAuthenticatedUser:["DELETE /user/social_accounts"],deleteSshSigningKeyForAuthenticatedUser:["DELETE /user/ssh_signing_keys/{ssh_signing_key_id}"],follow:["PUT /user/following/{username}"],getAuthenticated:["GET /user"],getById:["GET /user/{account_id}"],getByUsername:["GET /users/{username}"],getContextForUser:["GET /users/{username}/hovercard"],getGpgKeyForAuthenticated:["GET /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","getGpgKeyForAuthenticatedUser"]}],getGpgKeyForAuthenticatedUser:["GET /user/gpg_keys/{gpg_key_id}"],getPublicSshKeyForAuthenticated:["GET /user/keys/{key_id}",{},{renamed:["users","getPublicSshKeyForAuthenticatedUser"]}],getPublicSshKeyForAuthenticatedUser:["GET /user/keys/{key_id}"],getSshSigningKeyForAuthenticatedUser:["GET /user/ssh_signing_keys/{ssh_signing_key_id}"],list:["GET /users"],listAttestations:["GET /users/{username}/attestations/{subject_digest}"],listBlockedByAuthenticated:["GET /user/blocks",{},{renamed:["users","listBlockedByAuthenticatedUser"]}],listBlockedByAuthenticatedUser:["GET /user/blocks"],listEmailsForAuthenticated:["GET /user/emails",{},{renamed:["users","listEmailsForAuthenticatedUser"]}],listEmailsForAuthenticatedUser:["GET /user/emails"],listFollowedByAuthenticated:["GET /user/following",{},{renamed:["users","listFollowedByAuthenticatedUser"]}],listFollowedByAuthenticatedUser:["GET /user/following"],listFollowersForAuthenticatedUser:["GET /user/followers"],listFollowersForUser:["GET /users/{username}/followers"],listFollowingForUser:["GET /users/{username}/following"],listGpgKeysForAuthenticated:["GET /user/gpg_keys",{},{renamed:["users","listGpgKeysForAuthenticatedUser"]}],listGpgKeysForAuthenticatedUser:["GET /user/gpg_keys"],listGpgKeysForUser:["GET /users/{username}/gpg_keys"],listPublicEmailsForAuthenticated:["GET /user/public_emails",{},{renamed:["users","listPublicEmailsForAuthenticatedUser"]}],listPublicEmailsForAuthenticatedUser:["GET /user/public_emails"],listPublicKeysForUser:["GET /users/{username}/keys"],listPublicSshKeysForAuthenticated:["GET /user/keys",{},{renamed:["users","listPublicSshKeysForAuthenticatedUser"]}],listPublicSshKeysForAuthenticatedUser:["GET /user/keys"],listSocialAccountsForAuthenticatedUser:["GET /user/social_accounts"],listSocialAccountsForUser:["GET /users/{username}/social_accounts"],listSshSigningKeysForAuthenticatedUser:["GET /user/ssh_signing_keys"],listSshSigningKeysForUser:["GET /users/{username}/ssh_signing_keys"],setPrimaryEmailVisibilityForAuthenticated:["PATCH /user/email/visibility",{},{renamed:["users","setPrimaryEmailVisibilityForAuthenticatedUser"]}],setPrimaryEmailVisibilityForAuthenticatedUser:["PATCH /user/email/visibility"],unblock:["DELETE /user/blocks/{username}"],unfollow:["DELETE /user/following/{username}"],updateAuthenticated:["PATCH /user"]}};var poe=foe;const ia=new Map;for(const[t,e]of Object.entries(poe))for(const[r,n]of Object.entries(e)){const[s,i,o]=n,[a,l]=s.split(/ /),c=Object.assign({method:a,url:l},i);ia.has(t)||ia.set(t,new Map),ia.get(t).set(r,{scope:t,methodName:r,endpointDefaults:c,decorations:o})}const moe={has({scope:t},e){return ia.get(t).has(e)},getOwnPropertyDescriptor(t,e){return{value:this.get(t,e),configurable:!0,writable:!0,enumerable:!0}},defineProperty(t,e,r){return Object.defineProperty(t.cache,e,r),!0},deleteProperty(t,e){return delete t.cache[e],!0},ownKeys({scope:t}){return[...ia.get(t).keys()]},set(t,e,r){return t.cache[e]=r},get({octokit:t,scope:e,cache:r},n){if(r[n])return r[n];const s=ia.get(e).get(n);if(!s)return;const{endpointDefaults:i,decorations:o}=s;return o?r[n]=voe(t,e,n,i,o):r[n]=t.request.defaults(i),r[n]}};function goe(t){const e={};for(const r of ia.keys())e[r]=new Proxy({octokit:t,scope:r,cache:{}},moe);return e}function voe(t,e,r,n,s){const i=t.request.defaults(n);function o(...a){let l=i.endpoint.merge(...a);if(s.mapToData)return l=Object.assign({},l,{data:l[s.mapToData],[s.mapToData]:void 0}),i(l);if(s.renamed){const[c,u]=s.renamed;t.log.warn(`octokit.${e}.${r}() has been renamed to octokit.${c}.${u}()`)}if(s.deprecated&&t.log.warn(s.deprecated),s.renamedParameters){const c=i.endpoint.merge(...a);for(const[u,d]of Object.entries(s.renamedParameters))u in c&&(t.log.warn(`"${u}" parameter is deprecated for "octokit.${e}.${r}()". Use "${d}" instead`),d in c||(c[d]=c[u]),delete c[u]);return i(c)}return i(...a)}return Object.assign(o,i)}function oB(t){const e=goe(t);return{...e,rest:e}}oB.VERSION=hoe;const yoe="21.1.1",aB=loe.plugin(rB,oB,iB).defaults({userAgent:`octokit-rest.js/${yoe}`}),lB=typeof window<"u"&&typeof localStorage<"u";function Vf(t){if(!lB)return null;try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.error(`Error reading from localStorage key "${t}":`,e),null}}function _oe(t,e){if(lB)try{localStorage.setItem(t,JSON.stringify(e))}catch(r){console.error(`Error writing to localStorage key "${t}":`,r)}}var jT={};function $T(t){return Array.isArray(t)?t:[t]}const Z_="",UT=" ",yy="\\",boe=/^\s+$/,woe=/(?:[^\\]|^)\\$/,xoe=/^\\!/,Soe=/^\\#/,Eoe=/\r?\n/g,Coe=/^\.*\/|^\.+$/,_y="/";let cB="node-ignore";typeof Symbol<"u"&&(cB=Symbol.for("node-ignore"));const HT=cB,koe=(t,e,r)=>Object.defineProperty(t,e,{value:r}),Toe=/([0-z])-([0-z])/g,uB=()=>!1,Aoe=t=>t.replace(Toe,(e,r,n)=>r.charCodeAt(0)<=n.charCodeAt(0)?e:Z_),Roe=t=>{const{length:e}=t;return t.slice(0,e-e%2)},Poe=[[/^\uFEFF/,()=>Z_],[/((?:\\\\)*?)(\\?\s+)$/,(t,e,r)=>e+(r.indexOf("\\")===0?UT:Z_)],[/(\\+?)\s/g,(t,e)=>{const{length:r}=e;return e.slice(0,r-r%2)+UT}],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,r)=>e+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,r)=>{const n=r.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>yy],[/\\\\/g,()=>yy],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,r,n,s)=>e===yy?`\\[${r}${Roe(n)}${s}`:s==="]"&&n.length%2===0?`[${Aoe(r)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],VT=Object.create(null),Ioe=(t,e)=>{let r=VT[t];return r||(r=Poe.reduce((n,[s,i])=>n.replace(s,i.bind(t)),t),VT[t]=r),e?new RegExp(r,"i"):new RegExp(r)},pS=t=>typeof t=="string",Ooe=t=>t&&pS(t)&&!boe.test(t)&&!woe.test(t)&&t.indexOf("#")!==0,Doe=t=>t.split(Eoe);class Moe{constructor(e,r,n,s){this.origin=e,this.pattern=r,this.negative=n,this.regex=s}}const Loe=(t,e)=>{const r=t;let n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(xoe,"!").replace(Soe,"#");const s=Ioe(t,e);return new Moe(r,t,n,s)},Noe=(t,e)=>{throw new e(t)},xi=(t,e,r)=>pS(t)?t?xi.isNotRelative(t)?r(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:r("path must not be empty",TypeError):r(`path must be a string, but got \`${e}\``,TypeError),dB=t=>Coe.test(t);xi.isNotRelative=dB;xi.convert=t=>t;class Boe{constructor({ignorecase:e=!0,ignoreCase:r=e,allowRelativePaths:n=!1}={}){koe(this,HT,!0),this._rules=[],this._ignoreCase=r,this._allowRelativePaths=n,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[HT]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(Ooe(e)){const r=Loe(e,this._ignoreCase);this._added=!0,this._rules.push(r)}}add(e){return this._added=!1,$T(pS(e)?Doe(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,r){let n=!1,s=!1;return this._rules.forEach(i=>{const{negative:o}=i;if(s===o&&n!==s||o&&!n&&!s&&!r)return;i.regex.test(e)&&(n=!o,s=o)}),{ignored:n,unignored:s}}_test(e,r,n,s){const i=e&&xi.convert(e);return xi(i,e,this._allowRelativePaths?uB:Noe),this._t(i,r,n,s)}_t(e,r,n,s){if(e in r)return r[e];if(s||(s=e.split(_y)),s.pop(),!s.length)return r[e]=this._testOne(e,n);const i=this._t(s.join(_y)+_y,r,n,s);return r[e]=i.ignored?i:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return $T(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}}const tm=t=>new Boe(t),Foe=t=>xi(t&&xi.convert(t),t,uB);tm.isPathValid=Foe;tm.default=tm;var joe=tm;if(typeof xt<"u"&&(jT&&jT.IGNORE_TEST_WIN32||xt.platform==="win32")){const t=r=>/^\\\\\?\\/.test(r)||/["<>|\u0000-\u001F]+/u.test(r)?r:r.replace(/\\/g,"/");xi.convert=t;const e=/^[a-z]:\//i;xi.isNotRelative=r=>e.test(r)||dB(r)}const $oe=Ql(joe),Uoe=["node_modules/**",".git/**","dist/**","build/**",".next/**","coverage/**",".cache/**",".vscode/**",".idea/**","**/*.log","**/.DS_Store","**/npm-debug.log*","**/yarn-debug.log*","**/yarn-error.log*"];$oe().add(Uoe);const Hoe=(t,e)=>`
<codeiaArtifact id="${e}" title="User Updated Files">
${Object.keys(t).map(r=>`
<codeiaAction type="file" filePath="${r}">
${t[r].content}
</codeiaAction>
`).join(`
`)}
</codeiaArtifact>
  `,GT=void 0,zT=jt(void 0),hB=jt(void 0);function Voe(){const t=uU(),{id:e}=dU(),[r]=l2(),[n,s]=k.useState([]),[i,o]=k.useState([]),[a,l]=k.useState(!1),[c,u]=k.useState();return k.useEffect(()=>{{l(!0);return}},[e,GT,t,r]),k.useCallback(async(d,h,f,v)=>{f||zT.get()},[GT]),k.useCallback(async(d,h)=>{const f=await Ui,v=h||{files:{}};v?.files&&(Object.entries(v.files).forEach(async([m,p])=>{m.startsWith(f.workdir)&&(m=m.replace(f.workdir,"")),p?.type==="folder"&&await f.fs.mkdir(m,{recursive:!0})}),Object.entries(v.files).forEach(async([m,p])=>{p?.type==="file"&&(m.startsWith(f.workdir)&&(m=m.replace(f.workdir,"")),await f.fs.writeFile(m,p.content,{encoding:p.isBinary?void 0:"utf8"}))}))},[]),{ready:!e||a,initialMessages:i,updateChatMestaData:async d=>{zT.get()},storeMessageHistory:async d=>{},duplicateCurrentChat:async d=>{},importChat:async(d,h,f)=>{},exportChat:async(d=c)=>{}}}function fB(t,e){let r=null,n=0,s=null;return function(...o){const a=Date.now();if(r=o,a-n<e){s||(s=setTimeout(()=>{s=null,n=Date.now(),r&&(t.apply(this,r),r=null)},e-(a-n)));return}n=a,t.apply(this,o),r=null}}const{saveAs:Goe}=bie;class pB{#r=new WN(Ui);#t=new iie(Ui);#e=new Ose(this.#t);#n=new gie(Ui);#s=new Set;artifacts=bo({});showWorkbench=jt(!1);currentView=jt("code");unsavedFiles=jt(new Set);actionAlert=jt(void 0);supabaseAlert=jt(void 0);deployAlert=jt(void 0);modifiedFiles=new Set;artifactIdList=[];#i=Promise.resolve();constructor(){}addToExecutionQueue(e){this.#i=this.#i.then(()=>e())}get previews(){return this.#r.previews}get files(){return this.#t.files}get currentDocument(){return this.#e.currentDocument}get selectedFile(){return this.#e.selectedFile}get firstArtifact(){return this.#o(this.artifactIdList[0])}get filesCount(){return this.#t.filesCount}get showTerminal(){return this.#n.showTerminal}get codeiaTerminal(){return this.#n.codeiaTerminal}get alert(){return this.actionAlert}clearAlert(){this.actionAlert.set(void 0)}get SupabaseAlert(){return this.supabaseAlert}clearSupabaseAlert(){this.supabaseAlert.set(void 0)}get DeployAlert(){return this.deployAlert}clearDeployAlert(){this.deployAlert.set(void 0)}toggleTerminal(e){this.#n.toggleTerminal(e)}attachTerminal(e){this.#n.attachTerminal(e)}attachCodeiaTerminal(e){this.#n.attachCodeiaTerminal(e)}onTerminalResize(e,r){this.#n.onTerminalResize(e,r)}setDocuments(e){if(this.#e.setDocuments(e),this.#t.filesCount>0&&this.currentDocument.get()===void 0){for(const[r,n]of Object.entries(e))if(n?.type==="file"){this.setSelectedFile(r);break}}}setShowWorkbench(e){this.showWorkbench.set(e)}setCurrentDocumentContent(e){const r=this.currentDocument.get()?.filePath;if(!r)return;const n=this.#t.getFile(r)?.content,s=n!==void 0&&n!==e;this.#e.updateFile(r,e);const i=this.currentDocument.get();if(i){const o=this.unsavedFiles.get();if(s&&o.has(i.filePath))return;const a=new Set(o);s?a.add(i.filePath):a.delete(i.filePath),this.unsavedFiles.set(a)}}setCurrentDocumentScrollPosition(e){const r=this.currentDocument.get();if(!r)return;const{filePath:n}=r;this.#e.updateScrollPosition(n,e)}setSelectedFile(e){this.#e.setSelectedFile(e)}async saveFile(e){const n=this.#e.documents.get()[e];if(n===void 0)return;await this.#t.saveFile(e,n.value);const s=new Set(this.unsavedFiles.get());s.delete(e),this.unsavedFiles.set(s)}async saveCurrentDocument(){const e=this.currentDocument.get();e!==void 0&&await this.saveFile(e.filePath)}resetCurrentDocument(){const e=this.currentDocument.get();if(e===void 0)return;const{filePath:r}=e,n=this.#t.getFile(r);n&&this.setCurrentDocumentContent(n.content)}async saveAllFiles(){for(const e of this.unsavedFiles.get())await this.saveFile(e)}getFileModifcations(){return this.#t.getFileModifications()}getModifiedFiles(){return this.#t.getModifiedFiles()}resetAllFileModifications(){this.#t.resetFileModifications()}lockFile(e){return this.#t.lockFile(e)}lockFolder(e){return this.#t.lockFolder(e)}unlockFile(e){return this.#t.unlockFile(e)}unlockFolder(e){return this.#t.unlockFolder(e)}isFileLocked(e){return this.#t.isFileLocked(e)}isFolderLocked(e){return this.#t.isFolderLocked(e)}async createFile(e,r=""){try{const n=await this.#t.createFile(e,r);if(n&&(this.setSelectedFile(e),typeof r=="string"&&r==="")){const s=new Set(this.unsavedFiles.get());s.delete(e),this.unsavedFiles.set(s)}return n}catch(n){throw console.error("Failed to create file:",n),n}}async createFolder(e){try{return await this.#t.createFolder(e)}catch(r){throw console.error("Failed to create folder:",r),r}}async deleteFile(e){try{const n=this.currentDocument.get()?.filePath===e,s=await this.#t.deleteFile(e);if(s){const i=new Set(this.unsavedFiles.get());if(i.has(e)&&(i.delete(e),this.unsavedFiles.set(i)),n){const o=this.files.get();let a;for(const[l,c]of Object.entries(o))if(c?.type==="file"){a=l;break}this.setSelectedFile(a)}}return s}catch(r){throw console.error("Failed to delete file:",r),r}}async deleteFolder(e){try{const n=this.currentDocument.get()?.filePath?.startsWith(e+"/"),s=await this.#t.deleteFolder(e);if(s){const i=this.unsavedFiles.get(),o=new Set;for(const a of i)a.startsWith(e+"/")||o.add(a);if(o.size!==i.size&&this.unsavedFiles.set(o),n){const a=this.files.get();let l;for(const[c,u]of Object.entries(a))if(u?.type==="file"){l=c;break}this.setSelectedFile(l)}}return s}catch(r){throw console.error("Failed to delete folder:",r),r}}abortAllActions(){}setReloadedMessages(e){this.#s=new Set(e)}addArtifact({messageId:e,title:r,id:n,type:s}){this.#o(e)||(this.artifactIdList.includes(e)||this.artifactIdList.push(e),this.artifacts.setKey(e,{id:n,title:r,closed:!1,type:s,runner:new kK(Ui,()=>this.codeiaTerminal,o=>{this.#s.has(e)||this.actionAlert.set(o)},o=>{this.#s.has(e)||this.supabaseAlert.set(o)},o=>{this.#s.has(e)||this.deployAlert.set(o)})}))}updateArtifact({messageId:e},r){const n=this.#o(e);n&&this.artifacts.setKey(e,{...n,...r})}addAction(e){this.addToExecutionQueue(()=>this._addAction(e))}async _addAction(e){const{messageId:r}=e,n=this.#o(r);return n||An("Artifact not found"),n.runner.addAction(e)}runAction(e,r=!1){r?this.actionStreamSampler(e,r):this.addToExecutionQueue(()=>this._runAction(e,r))}async _runAction(e,r=!1){const{messageId:n}=e,s=this.#o(n);s||An("Artifact not found");const i=s.runner.actions.get()[e.actionId];if(!(!i||i.executed))if(e.action.type==="file"){const o=await Ui,a=fr.join(o.workdir,e.action.filePath);this.selectedFile.value!==a&&this.setSelectedFile(a),this.currentView.value!=="code"&&this.currentView.set("code"),this.#e.documents.get()[a]||await s.runner.runAction(e,r),this.#e.updateFile(a,e.action.content),!r&&e.action.content&&await this.saveFile(a),r||(await s.runner.runAction(e),this.resetAllFileModifications())}else await s.runner.runAction(e)}actionStreamSampler=fB(async(e,r=!1)=>await this._runAction(e,r),100);#o(e){return this.artifacts.get()[e]}async downloadZip(){const e=new yie,r=this.files.get(),n=(hB.value??"project").toLocaleLowerCase().split(" ").join("_"),s=Date.now().toString(36).slice(-6),i=`${n}_${s}`;for(const[a,l]of Object.entries(r))if(l?.type==="file"&&!l.isBinary){const c=pu(a),u=c.split("/");if(u.length>1){let d=e;for(let h=0;h<u.length-1;h++)d=d.folder(u[h]);d.file(u[u.length-1],l.content)}else e.file(c,l.content)}const o=await e.generateAsync({type:"blob"});Goe(o,`${i}.zip`)}async syncFiles(e){const r=this.files.get(),n=[];for(const[s,i]of Object.entries(r))if(i?.type==="file"&&!i.isBinary){const o=pu(s),a=o.split("/");let l=e;for(let d=0;d<a.length-1;d++)l=await l.getDirectoryHandle(a[d],{create:!0});const u=await(await l.getFileHandle(a[a.length-1],{create:!0})).createWritable();await u.write(i.content),await u.close(),n.push(o)}return n}async pushToGitHub(e,r,n,s,i=!1){try{const o=s||Sr.get("githubToken"),a=n||Sr.get("githubUsername");if(!o||!a)throw new Error("GitHub token or username is not set in cookies or provided.");console.log(`pushToGitHub called with isPrivate=${i}`);const l=new aB({auth:o});let c,u=!1;try{if(c=(await l.repos.get({owner:a,repo:e})).data,console.log("Repository already exists, using existing repo"),c.private!==i){console.log(`Updating repository visibility from ${c.private?"private":"public"} to ${i?"private":"public"}`);try{const{data:m}=await l.repos.update({owner:a,repo:e,private:i});console.log("Repository visibility updated successfully"),c=m,u=!0,console.log("Waiting for visibility change to propagate..."),await new Promise(p=>setTimeout(p,3e3))}catch(m){console.error("Failed to update repository visibility:",m)}}}catch(v){if(v instanceof Error&&"status"in v&&v.status===404){console.log(`Creating new repository with private=${i}`);const m={name:e,private:i,auto_init:!0};console.log("Create repo options:",m);const{data:p}=await l.repos.createForAuthenticatedUser(m);console.log("Repository created:",p.html_url,"Private:",p.private),c=p,console.log("Waiting for repository to initialize..."),await new Promise(g=>setTimeout(g,2e3))}else throw console.error("Cannot create repo:",v),v}const d=this.files.get();if(!d||Object.keys(d).length===0)throw new Error("No files found to push");const h=async(v=1)=>{try{console.log(`Pushing files to repository (attempt ${v}/3)...`);const g=(await Promise.all(Object.entries(d).map(async([S,x])=>{if(x?.type==="file"&&x.content){const{data:T}=await l.git.createBlob({owner:c.owner.login,repo:c.name,content:Ht.from(x.content).toString("base64"),encoding:"base64"});return{path:pu(S),sha:T.sha}}return null}))).filter(Boolean);if(g.length===0)throw new Error("No valid files to push");c=(await l.repos.get({owner:a,repo:e})).data;const{data:_}=await l.git.getRef({owner:c.owner.login,repo:c.name,ref:`heads/${c.default_branch||"main"}`}),b=_.object.sha,{data:w}=await l.git.createTree({owner:c.owner.login,repo:c.name,base_tree:b,tree:g.map(S=>({path:S.path,mode:"100644",type:"blob",sha:S.sha}))}),{data:E}=await l.git.createCommit({owner:c.owner.login,repo:c.name,message:r||"Initial commit from your app",tree:w.sha,parents:[b]});return await l.git.updateRef({owner:c.owner.login,repo:c.name,ref:`heads/${c.default_branch||"main"}`,sha:E.sha}),console.log("Files successfully pushed to repository"),c.html_url}catch(p){if(console.error(`Error during push attempt ${v}:`,p),(u||v===1)&&v<3){const g=v*2e3;return console.log(`Waiting ${g}ms before retry...`),await new Promise(y=>setTimeout(y,g)),h(v+1)}throw p}};return await h()}catch(o){throw console.error("Error pushing to GitHub:",o),o}}}const Ie=new pB,zoe=Object.freeze(Object.defineProperty({__proto__:null,WorkbenchStore:pB,workbenchStore:Ie},Symbol.toStringTag,{value:"Module"})),kc=en("useMessageParser"),Woe=new wK({callbacks:{onArtifactOpen:t=>{kc.trace("onArtifactOpen",t),Ie.showWorkbench.set(!0),Ie.addArtifact(t)},onArtifactClose:t=>{kc.trace("onArtifactClose"),Ie.updateArtifact(t,{closed:!0})},onActionOpen:t=>{kc.trace("onActionOpen",t.action),t.action.type==="file"&&Ie.addAction(t)},onActionClose:t=>{kc.trace("onActionClose",t.action),t.action.type!=="file"&&Ie.addAction(t),Ie.runAction(t)},onActionStream:t=>{kc.trace("onActionStream",t.action),Ie.runAction(t,!0)}}}),Koe=t=>Array.isArray(t.content)?t.content.find(e=>e.type==="text")?.text||"":t.content;function qoe(){const[t,e]=k.useState({}),r=k.useCallback((n,s)=>{for(const[i,o]of n.entries())if(o.role==="assistant"||o.role==="user"){const a=Woe.parse(o.id,Koe(o));e(l=>({...l,[i]:(l[i]||"")+a}))}},[]);return{parsedMessages:t,parseMessages:r}}const WT=en("usePromptEnhancement");function Joe(){const[t,e]=k.useState(!1),[r,n]=k.useState(!1);return{enhancingPrompt:t,promptEnhanced:r,enhancePrompt:async(o,a,l,c,u)=>{e(!0),n(!1);const d={message:o,model:l,provider:c};u&&(d.apiKeys=u);const f=(await fetch("/api/enhancer",{method:"POST",body:JSON.stringify(d)})).body?.getReader(),v=o;if(f){const m=new TextDecoder;let p="",g;try{for(a("");;){const{value:y,done:_}=await f.read();if(_)break;p+=m.decode(y),WT.trace("Set input",p),a(p)}}catch(y){g=y,a(v)}finally{g&&WT.error(g),e(!1),n(!0),setTimeout(()=>{a(p)})}}},resetEnhancer:()=>{e(!1),n(!1)}}}const rm=[{id:"features",visible:!0,window:"user",order:0},{id:"data",visible:!0,window:"user",order:1},{id:"cloud-providers",visible:!0,window:"user",order:2},{id:"local-providers",visible:!0,window:"user",order:3},{id:"connection",visible:!0,window:"user",order:4},{id:"notifications",visible:!0,window:"user",order:5},{id:"event-logs",visible:!0,window:"user",order:6},{id:"profile",visible:!1,window:"user",order:7},{id:"settings",visible:!1,window:"user",order:8},{id:"task-manager",visible:!1,window:"user",order:9},{id:"service-status",visible:!1,window:"user",order:10},{id:"debug",visible:!1,window:"user",order:11},{id:"update",visible:!1,window:"user",order:12},{id:"features",visible:!0,window:"developer",order:0},{id:"data",visible:!0,window:"developer",order:1},{id:"cloud-providers",visible:!0,window:"developer",order:2},{id:"local-providers",visible:!0,window:"developer",order:3},{id:"connection",visible:!0,window:"developer",order:4},{id:"notifications",visible:!0,window:"developer",order:5},{id:"event-logs",visible:!0,window:"developer",order:6},{id:"profile",visible:!0,window:"developer",order:7},{id:"settings",visible:!0,window:"developer",order:8},{id:"task-manager",visible:!0,window:"developer",order:9},{id:"service-status",visible:!0,window:"developer",order:10},{id:"debug",visible:!0,window:"developer",order:11},{id:"update",visible:!0,window:"developer",order:12}],KT=t=>{let e;const r=new Set,n=(c,u)=>{const d=typeof c=="function"?c(e):c;if(!Object.is(d,e)){const h=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),r.forEach(f=>f(e,h))}},s=()=>e,a={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,s,a);return a},Yoe=t=>t?KT(t):KT,Zoe=t=>t;function Xoe(t,e=Zoe){const r=Re.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Re.useDebugValue(r),r}const qT=t=>{const e=Yoe(t),r=n=>Xoe(e,n);return Object.assign(r,e),r},Qoe=t=>t?qT(t):qT,mB=["OpenAILike","LMStudio","Ollama"];bo({toggleTheme:{key:"d",metaKey:!0,altKey:!0,shiftKey:!0,action:()=>fU(),description:"Toggle theme",isPreventDefault:!0},toggleTerminal:{key:"`",ctrlOrMetaKey:!0,action:()=>{},description:"Toggle terminal",isPreventDefault:!0}});const gB="provider_settings",nm=typeof window<"u",eae=()=>{const t={};if(bg.forEach(e=>{t[e.name]={...e,settings:{enabled:!mB.includes(e.name)}}}),nm){const e=localStorage.getItem(gB);if(e)try{const r=JSON.parse(e);Object.entries(r).forEach(([n,s])=>{t[n]&&(t[n].settings=s.settings)})}catch(r){console.error("Error parsing saved provider settings:",r)}}return t},mu=bo(eae()),tae=(t,e)=>{const r=mu.get(),n={...r[t],settings:{...r[t].settings,...e}};mu.setKey(t,n);const s=mu.get();localStorage.setItem(gB,JSON.stringify(s))},JT=jt(!1),zn={LATEST_BRANCH:"isLatestBranch",AUTO_SELECT_TEMPLATE:"autoSelectTemplate",CONTEXT_OPTIMIZATION:"contextOptimizationEnabled",EVENT_LOGS:"isEventLogsEnabled",PROMPT_ID:"promptId",DEVELOPER_MODE:"isDeveloperMode"},rae=()=>{const t=(e,r)=>{if(!nm)return r;const n=localStorage.getItem(e);if(n===null)return r;try{return JSON.parse(n)}catch{return r}};return{latestBranch:t(zn.LATEST_BRANCH,!1),autoSelectTemplate:t(zn.AUTO_SELECT_TEMPLATE,!0),contextOptimization:t(zn.CONTEXT_OPTIMIZATION,!0),eventLogs:t(zn.EVENT_LOGS,!0),promptId:nm&&localStorage.getItem(zn.PROMPT_ID)||"default",developerMode:t(zn.DEVELOPER_MODE,!1)}},Xd=rae(),vB=jt(Xd.latestBranch),yB=jt(Xd.autoSelectTemplate),_B=jt(Xd.contextOptimization),bB=jt(Xd.eventLogs),wB=jt(Xd.promptId),nae=t=>{vB.set(t),localStorage.setItem(zn.LATEST_BRANCH,JSON.stringify(t))},sae=t=>{yB.set(t),localStorage.setItem(zn.AUTO_SELECT_TEMPLATE,JSON.stringify(t))},iae=t=>{_B.set(t),localStorage.setItem(zn.CONTEXT_OPTIMIZATION,JSON.stringify(t))},oae=t=>{bB.set(t),localStorage.setItem(zn.EVENT_LOGS,JSON.stringify(t))},aae=t=>{wB.set(t),localStorage.setItem(zn.PROMPT_ID,t)},lae=()=>{const t={userTabs:rm.filter(e=>e.window==="user"),developerTabs:rm.filter(e=>e.window==="developer")};if(!nm)return t;try{const e=localStorage.getItem("codeia_tab_configuration");if(!e)return t;const r=JSON.parse(e);return!r?.userTabs||!r?.developerTabs?t:{userTabs:r.userTabs.filter(n=>n.window==="user"),developerTabs:r.developerTabs.filter(n=>n.window==="developer")}}catch(e){return console.warn("Failed to parse tab configuration:",e),t}},sm=bo(lae()),cae=t=>{const e=sm.get();console.log("Current tab configuration before update:",e);const n=t.window==="user"?"userTabs":"developerTabs",s=e[n].map(o=>o.id===t.id?{...t}:o);s.find(o=>o.id===t.id)||s.push(t);const i={...e,[n]:s};console.log("New tab configuration after update:",i),sm.set(i),Sr.set("tabConfiguration",JSON.stringify(i),{expires:365,path:"/",sameSite:"strict"})},uae=()=>{const t={userTabs:rm.filter(e=>e.window==="user"),developerTabs:rm.filter(e=>e.window==="developer")};sm.set(t),localStorage.setItem("codeia_tab_configuration",JSON.stringify(t))};Qoe(t=>({isOpen:!1,selectedTab:"user",openSettings:()=>{t({isOpen:!0,selectedTab:"user"})},closeSettings:()=>{t({isOpen:!1,selectedTab:"user"})},setSelectedTab:e=>{t({selectedTab:e})}}));typeof navigator<"u"&&navigator.platform.toLowerCase().includes("mac");typeof navigator<"u"&&navigator.platform.toLowerCase().includes("win");typeof navigator<"u"&&navigator.platform.toLowerCase().includes("linux");class dae{#r=new EventTarget;dispatch(e){this.#r.dispatchEvent(new Event(e))}on(e,r){return this.#r.addEventListener(e,r),()=>{this.#r.removeEventListener(e,r)}}}const hae=new dae,fae={damping:.7,stiffness:.05,mass:1.25},pae=70,mae=1e3/60,gae=350;let Eg=!1;globalThis.document?.addEventListener("mousedown",()=>{Eg=!0});globalThis.document?.addEventListener("mouseup",()=>{Eg=!1});globalThis.document?.addEventListener("click",()=>{Eg=!1});const vae=(t={})=>{const[e,r]=k.useState(!1),[n,s]=k.useState(t.initial!==!1),[i,o]=k.useState(!1),a=k.useRef(null);a.current=t;const l=k.useCallback(()=>{if(!Eg)return!1;const y=window.getSelection();if(!y||!y.rangeCount)return!1;const _=y.getRangeAt(0);return _.commonAncestorContainer.contains(p.current)||p.current?.contains(_.commonAncestorContainer)},[]),c=k.useCallback(y=>{d.isAtBottom=y,s(y)},[]),u=k.useCallback(y=>{d.escapedFromLock=y,r(y)},[]),d=k.useMemo(()=>{let y;return{escapedFromLock:e,isAtBottom:n,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){return p.current?.scrollTop??0},set scrollTop(_){p.current&&(p.current.scrollTop=_,d.ignoreScrollToTop=p.current.scrollTop)},get targetScrollTop(){return!p.current||!g.current?0:p.current.scrollHeight-1-p.current.clientHeight},get calculatedTargetScrollTop(){if(!p.current||!g.current)return 0;const{targetScrollTop:_}=this;if(!t.targetScrollTop)return _;if(y?.targetScrollTop===_)return y.calculatedScrollTop;const b=Math.max(Math.min(t.targetScrollTop(_,{scrollElement:p.current,contentElement:g.current}),_),0);return y={targetScrollTop:_,calculatedScrollTop:b},requestAnimationFrame(()=>{y=void 0}),b},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=pae}}},[]),h=k.useCallback((y={})=>{typeof y=="string"&&(y={animation:y}),y.preserveScrollPosition||c(!0);const _=Date.now()+(Number(y.wait)||0),b=wy(a.current,y.animation),{ignoreEscapes:w=!1}=y;let E,S=d.calculatedTargetScrollTop;y.duration instanceof Promise?y.duration.finally(()=>{E=Date.now()}):E=_+(y.duration??0);const x=async()=>{const T=new Promise(requestAnimationFrame).then(()=>{if(!d.isAtBottom)return d.animation=void 0,!1;const{scrollTop:D}=d,O=performance.now(),R=(O-(d.lastTick??O))/mae;if(d.animation||={behavior:b,promise:T,ignoreEscapes:w},d.animation.behavior===b&&(d.lastTick=O),l()||_>Date.now())return x();if(D<Math.min(S,d.calculatedTargetScrollTop)){if(d.animation?.behavior===b){if(b==="instant")return d.scrollTop=d.calculatedTargetScrollTop,x();d.velocity=(b.damping*d.velocity+b.stiffness*d.scrollDifference)/b.mass,d.accumulated+=d.velocity*R,d.scrollTop+=d.accumulated,d.scrollTop!==D&&(d.accumulated=0)}return x()}return E>Date.now()?(S=d.calculatedTargetScrollTop,x()):(d.animation=void 0,d.scrollTop<d.calculatedTargetScrollTop?h({animation:wy(a.current,a.current.resize),ignoreEscapes:w,duration:Math.max(0,E-Date.now())||void 0}):d.isAtBottom)});return T.then(D=>(requestAnimationFrame(()=>{d.animation||(d.lastTick=void 0,d.velocity=0)}),D))};return y.wait!==!0&&(d.animation=void 0),d.animation?.behavior===b?d.animation.promise:x()},[c,l,d]),f=k.useCallback(()=>{u(!0),c(!1)},[u,c]),v=k.useCallback(({target:y})=>{if(y!==p.current)return;const{scrollTop:_,ignoreScrollToTop:b}=d;let{lastScrollTop:w=_}=d;d.lastScrollTop=_,d.ignoreScrollToTop=void 0,b&&b>_&&(w=b),o(d.isNearBottom),setTimeout(()=>{if(d.resizeDifference||_===b)return;if(l()){u(!0),c(!1);return}const E=_>w,S=_<w;if(d.animation?.ignoreEscapes){d.scrollTop=w;return}S&&(u(!0),c(!1)),E&&u(!1),!d.escapedFromLock&&d.isNearBottom&&c(!0)},1)},[u,c,l,d]),m=k.useCallback(({target:y,deltaY:_})=>{let b=y;for(;!["scroll","auto"].includes(getComputedStyle(b).overflow);){if(!b.parentElement)return;b=b.parentElement}b===p.current&&_<0&&p.current.scrollHeight>p.current.clientHeight&&!d.animation?.ignoreEscapes&&(u(!0),c(!1))},[u,c,d]),p=YT(y=>{p.current?.removeEventListener("scroll",v),p.current?.removeEventListener("wheel",m),y?.addEventListener("scroll",v,{passive:!0}),y?.addEventListener("wheel",m,{passive:!0})},[]),g=YT(y=>{if(d.resizeObserver?.disconnect(),!y)return;let _;d.resizeObserver=new ResizeObserver(([b])=>{const{height:w}=b.contentRect,E=w-(_??w);if(d.resizeDifference=E,d.scrollTop>d.targetScrollTop&&(d.scrollTop=d.targetScrollTop),o(d.isNearBottom),E>=0){const S=wy(a.current,_?a.current.resize:a.current.initial);h({animation:S,wait:!0,preserveScrollPosition:!0,duration:S==="instant"?void 0:gae})}else d.isNearBottom&&(u(!1),c(!0));_=w,requestAnimationFrame(()=>{setTimeout(()=>{d.resizeDifference===E&&(d.resizeDifference=0)},1)})}),d.resizeObserver?.observe(y)},[]);return{contentRef:g,scrollRef:p,scrollToBottom:h,stopScroll:f,isAtBottom:n||i,isNearBottom:i,escapedFromLock:e,state:d}};function YT(t,e){const r=k.useCallback(n=>(r.current=n,t(n)),e);return r}const by=new Map;function wy(...t){const e={...fae};let r=!1;for(const s of t){if(s==="instant"){r=!0;continue}typeof s=="object"&&(r=!1,e.damping=s.damping??e.damping,e.stiffness=s.stiffness??e.stiffness,e.mass=s.mass??e.mass)}const n=JSON.stringify(e);return by.has(n)||by.set(n,Object.freeze(e)),r?"instant":by.get(n)}const xB=k.createContext(null),yae=typeof window<"u"?k.useLayoutEffect:k.useEffect;function X_({instance:t,children:e,resize:r,initial:n,mass:s,damping:i,stiffness:o,targetScrollTop:a,contextRef:l,...c}){const u=k.useRef(null),d=k.useCallback((w,E)=>(b?.targetScrollTop??a)?.(w,E)??w,[a]),h=vae({mass:s,damping:i,stiffness:o,resize:r,initial:n,targetScrollTop:d}),{scrollRef:f,contentRef:v,scrollToBottom:m,stopScroll:p,isAtBottom:g,escapedFromLock:y,state:_}=t??h,b=k.useMemo(()=>({scrollToBottom:m,stopScroll:p,scrollRef:f,isAtBottom:g,escapedFromLock:y,contentRef:v,state:_,get targetScrollTop(){return u.current},set targetScrollTop(w){u.current=w}}),[m,g,v,f,p,y,_]);return k.useImperativeHandle(l,()=>b,[b]),yae(()=>{f.current&&getComputedStyle(f.current).overflow==="visible"&&(f.current.style.overflow="auto")},[]),C.jsx(xB.Provider,{value:b,children:C.jsx("div",{...c,children:typeof e=="function"?e(b):e})})}function _ae({children:t,...e}){const r=SB();return C.jsx("div",{ref:r.scrollRef,className:"w-full h-auto",children:C.jsx("div",{...e,ref:r.contentRef,children:typeof t=="function"?t(r):t})})}X_.Content=_ae;function SB(){const t=k.useContext(xB);if(!t)throw new Error("use-stick-to-bottom component context must be used within a StickToBottom component");return t}const bae=(t=1024)=>{const[e,r]=k.useState(window.innerWidth<t);return k.useEffect(()=>{const n=()=>r(window.innerWidth<t);return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[t]),e},Tc=bo({started:!1,aborted:!1,showChat:!0}),ho=sc(.4,0,.2,1);function Cg(t,e){let r;return function(...s){const i=()=>{clearTimeout(r),t(...s)};clearTimeout(r),r=setTimeout(i,e)}}function wae(){const t=at(mu),e=at(JT),r=at(bB),n=at(wB),s=at(vB),i=at(yB),[o,a]=k.useState([]),l=at(_B),c=at(sm),[u,d]=k.useState(()=>{const x=Vf("settings");return{theme:x?.theme||"system",language:x?.language||"en",notifications:x?.notifications??!0,eventLogs:x?.eventLogs??!0,timezone:x?.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone,tabConfiguration:c}});k.useEffect(()=>{const x=Object.entries(t).filter(([T,D])=>D.settings.enabled).map(([T,D])=>D);a(x)},[t]);const h=k.useCallback(x=>{d(T=>{const D={...T,...x};return _oe("settings",D),D})},[]),f=k.useCallback((x,T)=>{tae(x,T)},[]),v=k.useCallback(x=>{JT.set(x),ln.logSystem(`Debug mode ${x?"enabled":"disabled"}`),Sr.set("isDebugEnabled",String(x))},[]),m=k.useCallback(x=>{oae(x),ln.logSystem(`Event logs ${x?"enabled":"disabled"}`)},[]),p=k.useCallback(x=>{aae(x),ln.logSystem(`Prompt template updated to ${x}`)},[]),g=k.useCallback(x=>{nae(x),ln.logSystem(`Main branch updates ${x?"enabled":"disabled"}`)},[]),y=k.useCallback(x=>{sae(x),ln.logSystem(`Auto select template ${x?"enabled":"disabled"}`)},[]),_=k.useCallback(x=>{iae(x),ln.logSystem(`Context optimization ${x?"enabled":"disabled"}`)},[]),b=k.useCallback(x=>{h({theme:x})},[h]),w=k.useCallback(x=>{h({language:x})},[h]),E=k.useCallback(x=>{h({notifications:x})},[h]),S=k.useCallback(x=>{h({timezone:x})},[h]);return k.useEffect(()=>{const x=mu.get(),T={};Object.keys(x).forEach(D=>{T[D]=x[D].settings}),Sr.set("providers",JSON.stringify(T))},[t]),{...u,providers:t,activeProviders:o,updateProviderSettings:f,debug:e,enableDebugMode:v,eventLogs:r,setEventLogs:m,promptId:n,setPromptId:p,isLatestBranch:s,enableLatestBranch:g,autoSelectTemplate:i,setAutoSelectTemplate:y,contextOptimizationEnabled:l,enableContextOptimization:_,setTheme:b,setLanguage:w,setNotifications:E,setTimezone:S,settings:u,tabConfiguration:c,updateTabConfiguration:cae,resetTabConfiguration:uae}}function Te(...t){let e="";for(const r of t)e=EB(e,xae(r));return e}function xae(t){if(typeof t=="string"||typeof t=="number")return t;if(typeof t!="object")return"";if(Array.isArray(t))return Te(...t);let e="";for(const r in t)t[r]&&(e=EB(e,r));return e}function EB(t,e){return e?t?t+" "+e:t+e:t}const hr=k.memo(k.forwardRef(({icon:t,size:e="xl",className:r,iconClassName:n,disabledClassName:s,disabled:i=!1,title:o,onClick:a,children:l},c)=>C.jsx("button",{ref:c,className:Te("flex items-center text-codeia-elements-item-contentDefault bg-transparent enabled:hover:text-codeia-elements-item-contentActive rounded-md p-1 enabled:hover:bg-codeia-elements-item-backgroundActive disabled:cursor-not-allowed focus:outline-none",{[Te("opacity-30",s)]:i},r),title:o,disabled:i,onClick:u=>{i||a?.(u)},children:l||C.jsx("div",{className:Te(t,Sae(e),n)})})));function Sae(t){return t==="sm"?"text-sm":t==="md"?"text-md":t==="lg"?"text-lg":t==="xl"?"text-xl":"text-2xl"}const CB=typeof document<"u"?Re.useLayoutEffect:()=>{};function Eae(t){const e=k.useRef(null);return CB(()=>{e.current=t},[t]),k.useCallback((...r)=>{const n=e.current;return n?.(...r)},[])}const So=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},zo=t=>t&&"window"in t&&t.window===t?t:So(t).defaultView||window;function Cae(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function kae(t){return Cae(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let Tae=!1;function mS(){return Tae}function kB(t,e){if(!mS())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:kae(r)?r=r.host:r=r.parentNode}return!1}const Q_=(t=document)=>{var e;if(!mS())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function TB(t){return mS()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function Aae(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(r=>t.test(r.brand)))||t.test(window.navigator.userAgent)}function Rae(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function AB(t){let e=null;return()=>(e==null&&(e=t()),e)}const Pae=AB(function(){return Rae(/^Mac/i)}),Iae=AB(function(){return Aae(/Android/i)});function RB(){let t=k.useRef(new Map),e=k.useCallback((s,i,o,a)=>{let l=a?.once?(...c)=>{t.current.delete(o),o(...c)}:o;t.current.set(o,{type:i,eventTarget:s,fn:l,options:a}),s.addEventListener(i,l,a)},[]),r=k.useCallback((s,i,o,a)=>{var l;let c=((l=t.current.get(o))===null||l===void 0?void 0:l.fn)||o;s.removeEventListener(i,c,a),t.current.delete(o)},[]),n=k.useCallback(()=>{t.current.forEach((s,i)=>{r(s.eventTarget,s.type,i,s.options)})},[r]);return k.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function Oae(t){return t.mozInputSource===0&&t.isTrusted?!0:Iae()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}class PB{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,r){this.nativeEvent=r,this.target=r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget,this.bubbles=r.bubbles,this.cancelable=r.cancelable,this.defaultPrevented=r.defaultPrevented,this.eventPhase=r.eventPhase,this.isTrusted=r.isTrusted,this.timeStamp=r.timeStamp,this.type=e}}function IB(t){let e=k.useRef({isFocused:!1,observer:null});CB(()=>{const n=e.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let r=Eae(n=>{t?.(n)});return k.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=n.target,i=o=>{e.current.isFocused=!1,s.disabled&&r(new PB("blur",o)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[r])}let Dae=!1,Qd=null,eb=new Set,gu=new Map,ma=!1,tb=!1;const Mae={Tab:!0,Escape:!0};function gS(t,e){for(let r of eb)r(t,e)}function Lae(t){return!(t.metaKey||!Pae()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function im(t){ma=!0,Lae(t)&&(Qd="keyboard",gS("keyboard",t))}function Pn(t){Qd="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(ma=!0,gS("pointer",t))}function OB(t){Oae(t)&&(ma=!0,Qd="virtual")}function DB(t){t.target===window||t.target===document||Dae||!t.isTrusted||(!ma&&!tb&&(Qd="virtual",gS("virtual",t)),ma=!1,tb=!1)}function MB(){ma=!1,tb=!0}function rb(t){if(typeof window>"u"||gu.get(zo(t)))return;const e=zo(t),r=So(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ma=!0,n.apply(this,arguments)},r.addEventListener("keydown",im,!0),r.addEventListener("keyup",im,!0),r.addEventListener("click",OB,!0),e.addEventListener("focus",DB,!0),e.addEventListener("blur",MB,!1),typeof PointerEvent<"u"?(r.addEventListener("pointerdown",Pn,!0),r.addEventListener("pointermove",Pn,!0),r.addEventListener("pointerup",Pn,!0)):(r.addEventListener("mousedown",Pn,!0),r.addEventListener("mousemove",Pn,!0),r.addEventListener("mouseup",Pn,!0)),e.addEventListener("beforeunload",()=>{LB(t)},{once:!0}),gu.set(e,{focus:n})}const LB=(t,e)=>{const r=zo(t),n=So(t);e&&n.removeEventListener("DOMContentLoaded",e),gu.has(r)&&(r.HTMLElement.prototype.focus=gu.get(r).focus,n.removeEventListener("keydown",im,!0),n.removeEventListener("keyup",im,!0),n.removeEventListener("click",OB,!0),r.removeEventListener("focus",DB,!0),r.removeEventListener("blur",MB,!1),typeof PointerEvent<"u"?(n.removeEventListener("pointerdown",Pn,!0),n.removeEventListener("pointermove",Pn,!0),n.removeEventListener("pointerup",Pn,!0)):(n.removeEventListener("mousedown",Pn,!0),n.removeEventListener("mousemove",Pn,!0),n.removeEventListener("mouseup",Pn,!0)),gu.delete(r))};function Nae(t){const e=So(t);let r;return e.readyState!=="loading"?rb(t):(r=()=>{rb(t)},e.addEventListener("DOMContentLoaded",r)),()=>LB(t,r)}typeof document<"u"&&Nae();function NB(){return Qd!=="pointer"}const Bae=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Fae(t,e,r){let n=So(r?.target);const s=typeof window<"u"?zo(r?.target).HTMLInputElement:HTMLInputElement,i=typeof window<"u"?zo(r?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?zo(r?.target).HTMLElement:HTMLElement,a=typeof window<"u"?zo(r?.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof s&&!Bae.has(n.activeElement.type)||n.activeElement instanceof i||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof a&&!Mae[r.key])}function jae(t,e,r){rb(),k.useEffect(()=>{let n=(s,i)=>{Fae(!!r?.isTextInput,s,i)&&t(NB())};return eb.add(n),()=>{eb.delete(n)}},e)}function $ae(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:s}=t;const i=k.useCallback(l=>{if(l.target===l.currentTarget)return n&&n(l),s&&s(!1),!0},[n,s]),o=IB(i),a=k.useCallback(l=>{const c=So(l.target),u=c?Q_(c):Q_();l.target===l.currentTarget&&u===TB(l.nativeEvent)&&(r&&r(l),s&&s(!0),o(l))},[s,r,o]);return{focusProps:{onFocus:!e&&(r||s||n)?a:void 0,onBlur:!e&&(n||s)?i:void 0}}}function Uae(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:s}=t,i=k.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:a}=RB(),l=k.useCallback(d=>{d.currentTarget.contains(d.target)&&i.current.isFocusWithin&&!d.currentTarget.contains(d.relatedTarget)&&(i.current.isFocusWithin=!1,a(),r&&r(d),s&&s(!1))},[r,s,i,a]),c=IB(l),u=k.useCallback(d=>{if(!d.currentTarget.contains(d.target))return;const h=So(d.target),f=Q_(h);if(!i.current.isFocusWithin&&f===TB(d.nativeEvent)){n&&n(d),s&&s(!0),i.current.isFocusWithin=!0,c(d);let v=d.currentTarget;o(h,"focus",m=>{if(i.current.isFocusWithin&&!kB(v,m.target)){let p=new PB("blur",new h.defaultView.FocusEvent("blur",{relatedTarget:m.target}));p.target=v,p.currentTarget=v,l(p)}},{capture:!0})}},[n,s,c,o,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:l}}}let om=!1,xy=0;function nb(){om=!0,setTimeout(()=>{om=!1},50)}function ZT(t){t.pointerType==="touch"&&nb()}function Hae(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",ZT):document.addEventListener("touchend",nb),xy++,()=>{xy--,!(xy>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",ZT):document.removeEventListener("touchend",nb))}}function Vae(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:s}=t,[i,o]=k.useState(!1),a=k.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;k.useEffect(Hae,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=RB(),{hoverProps:u,triggerHoverEnd:d}=k.useMemo(()=>{let h=(m,p)=>{if(a.pointerType=p,s||p==="touch"||a.isHovered||!m.currentTarget.contains(m.target))return;a.isHovered=!0;let g=m.currentTarget;a.target=g,l(So(m.target),"pointerover",y=>{a.isHovered&&a.target&&!kB(a.target,y.target)&&f(y,y.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:g,pointerType:p}),r&&r(!0),o(!0)},f=(m,p)=>{let g=a.target;a.pointerType="",a.target=null,!(p==="touch"||!a.isHovered||!g)&&(a.isHovered=!1,c(),n&&n({type:"hoverend",target:g,pointerType:p}),r&&r(!1),o(!1))},v={};return typeof PointerEvent<"u"?(v.onPointerEnter=m=>{om&&m.pointerType==="mouse"||h(m,m.pointerType)},v.onPointerLeave=m=>{!s&&m.currentTarget.contains(m.target)&&f(m,m.pointerType)}):(v.onTouchStart=()=>{a.ignoreEmulatedMouseEvents=!0},v.onMouseEnter=m=>{!a.ignoreEmulatedMouseEvents&&!om&&h(m,"mouse"),a.ignoreEmulatedMouseEvents=!1},v.onMouseLeave=m=>{!s&&m.currentTarget.contains(m.target)&&f(m,"mouse")}),{hoverProps:v,triggerHoverEnd:f}},[e,r,n,s,a,l,c]);return k.useEffect(()=>{s&&d({currentTarget:a.target},a.pointerType)},[s]),{hoverProps:u,isHovered:i}}function Gae(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,s=k.useRef({isFocused:!1,isFocusVisible:e||NB()}),[i,o]=k.useState(!1),[a,l]=k.useState(()=>s.current.isFocused&&s.current.isFocusVisible),c=k.useCallback(()=>l(s.current.isFocused&&s.current.isFocusVisible),[]),u=k.useCallback(f=>{s.current.isFocused=f,o(f),c()},[c]);jae(f=>{s.current.isFocusVisible=f,c()},[],{isTextInput:r});let{focusProps:d}=$ae({isDisabled:n,onFocusChange:u}),{focusWithinProps:h}=Uae({isDisabled:!n,onFocusWithinChange:u});return{isFocused:i,isFocusVisible:a,focusProps:n?h:d}}var zae=Object.defineProperty,Wae=(t,e,r)=>e in t?zae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sy=(t,e,r)=>(Wae(t,typeof e!="symbol"?e+"":e,r),r);let Kae=class{constructor(){Sy(this,"current",this.detect()),Sy(this,"handoffState","pending"),Sy(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},oa=new Kae;function eh(t){return oa.isServer?null:t instanceof Node?t.ownerDocument:t!=null&&t.hasOwnProperty("current")&&t.current instanceof Node?t.current.ownerDocument:document}function BB(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Ta(){let t=[],e={addEventListener(r,n,s,i){return r.addEventListener(n,s,i),e.add(()=>r.removeEventListener(n,s,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return e.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return BB(()=>{n.current&&r[0]()}),e.add(()=>{n.current=!1})},style(r,n,s){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:s}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=Ta();return r(n),this.add(()=>n.dispose())},add(r){return t.includes(r)||t.push(r),()=>{let n=t.indexOf(r);if(n>=0)for(let s of t.splice(n,1))s()}},dispose(){for(let r of t.splice(0))r()}};return e}function kg(){let[t]=k.useState(Ta);return k.useEffect(()=>()=>t.dispose(),[t]),t}let rr=(t,e)=>{oa.isServer?k.useEffect(t,e):k.useLayoutEffect(t,e)};function Si(t){let e=k.useRef(t);return rr(()=>{e.current=t},[t]),e}let st=function(t){let e=Si(t);return Re.useCallback((...r)=>e.current(...r),[e])};function qae(t){let e=t.width/2,r=t.height/2;return{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function Jae(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function Yae({disabled:t=!1}={}){let e=k.useRef(null),[r,n]=k.useState(!1),s=kg(),i=st(()=>{e.current=null,n(!1),s.dispose()}),o=st(a=>{if(s.dispose(),e.current===null){e.current=a.currentTarget,n(!0);{let l=eh(a.currentTarget);s.addEventListener(l,"pointerup",i,!1),s.addEventListener(l,"pointermove",c=>{if(e.current){let u=qae(c);n(Jae(u,e.current.getBoundingClientRect()))}},!1),s.addEventListener(l,"pointercancel",i,!1)}}});return{pressed:r,pressProps:t?{}:{onPointerDown:o,onPointerUp:i,onClick:i}}}function sb(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function Fn(t,e,...r){if(t in e){let s=e[t];return typeof s=="function"?s(...r):s}let n=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Fn),n}var Ul=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Ul||{}),Wi=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(Wi||{});function ns(){let t=Xae();return k.useCallback(e=>Zae({mergeRefs:t,...e}),[t])}function Zae({ourProps:t,theirProps:e,slot:r,defaultTag:n,features:s,visible:i=!0,name:o,mergeRefs:a}){a=a??Qae;let l=FB(e,t);if(i)return Yh(l,r,n,o,a);let c=s??0;if(c&2){let{static:u=!1,...d}=l;if(u)return Yh(d,r,n,o,a)}if(c&1){let{unmount:u=!0,...d}=l;return Fn(u?0:1,{0(){return null},1(){return Yh({...d,hidden:!0,style:{display:"none"}},r,n,o,a)}})}return Yh(l,r,n,o,a)}function Yh(t,e={},r,n,s){let{as:i=r,children:o,refName:a="ref",...l}=Ey(t,["unmount","static"]),c=t.ref!==void 0?{[a]:t.ref}:{},u=typeof o=="function"?o(e):o;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let d={};if(e){let h=!1,f=[];for(let[v,m]of Object.entries(e))typeof m=="boolean"&&(h=!0),m===!0&&f.push(v.replace(/([A-Z])/g,p=>`-${p.toLowerCase()}`));if(h){d["data-headlessui-state"]=f.join(" ");for(let v of f)d[`data-${v}`]=""}}if(i===k.Fragment&&(Object.keys(Fo(l)).length>0||Object.keys(Fo(d)).length>0))if(!k.isValidElement(u)||Array.isArray(u)&&u.length>1){if(Object.keys(Fo(l)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Fo(l)).concat(Object.keys(Fo(d))).map(h=>`  - ${h}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(h=>`  - ${h}`).join(`
`)].join(`
`))}else{let h=u.props,f=h?.className,v=typeof f=="function"?(...g)=>sb(f(...g),l.className):sb(f,l.className),m=v?{className:v}:{},p=FB(u.props,Fo(Ey(l,["ref"])));for(let g in d)g in p&&delete d[g];return k.cloneElement(u,Object.assign({},p,d,c,{ref:s(ele(u),c.ref)},m))}return k.createElement(i,Object.assign({},Ey(l,["ref"]),i!==k.Fragment&&c,i!==k.Fragment&&d),u)}function Xae(){let t=k.useRef([]),e=k.useCallback(r=>{for(let n of t.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return t.current=r,e}}function Qae(...t){return t.every(e=>e==null)?void 0:e=>{for(let r of t)r!=null&&(typeof r=="function"?r(e):r.current=e)}}function FB(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):e[s]=n[s];if(e.disabled||e["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[s=>{var i;return(i=s?.preventDefault)==null?void 0:i.call(s)}]);for(let n in r)Object.assign(e,{[n](s,...i){let o=r[n];for(let a of o){if((s instanceof Event||s?.nativeEvent instanceof Event)&&s.defaultPrevented)return;a(s,...i)}}});return e}function ib(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):e[s]=n[s];for(let n in r)Object.assign(e,{[n](...s){let i=r[n];for(let o of i)o?.(...s)}});return e}function wn(t){var e;return Object.assign(k.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Fo(t){let e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function Ey(t,e=[]){let r=Object.assign({},t);for(let n of e)n in r&&delete r[n];return r}function ele(t){return Re.version.split(".")[0]>="19"?t.props.ref:t.ref}let tle="span";var vd=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(vd||{});function rle(t,e){var r;let{features:n=1,...s}=t,i={ref:e,"aria-hidden":(n&2)===2?!0:(r=s["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ns()({ourProps:i,theirProps:s,slot:{},defaultTag:tle,name:"Hidden"})}let am=wn(rle);function jB(t){let e=t.parentElement,r=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(r=e),e=e.parentElement;let n=e?.getAttribute("disabled")==="";return n&&nle(r)?!1:n}function nle(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}let $B=Symbol();function UB(t,e=!0){return Object.assign(t,{[$B]:e})}function Qn(...t){let e=k.useRef(t);k.useEffect(()=>{e.current=t},[t]);let r=st(n=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(n):s.current=n)});return t.every(n=>n==null||n?.[$B])?void 0:r}var Fi=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Fi||{});let sle=k.createContext(()=>{});function ile({value:t,children:e}){return Re.createElement(sle.Provider,{value:t},e)}function ole(t){if(t===null)return{width:0,height:0};let{width:e,height:r}=t.getBoundingClientRect();return{width:e,height:r}}function ale(t,e=!1){let[r,n]=k.useReducer(()=>({}),{}),s=k.useMemo(()=>ole(t),[t,r]);return rr(()=>{if(!t)return;let i=new ResizeObserver(n);return i.observe(t),()=>{i.disconnect()}},[t]),e?{width:`${s.width}px`,height:`${s.height}px`}:s}let lle=class extends Map{constructor(e){super(),this.factory=e}get(e){let r=super.get(e);return r===void 0&&(r=this.factory(e),this.set(e,r)),r}};function HB(t,e){let r=t(),n=new Set;return{getSnapshot(){return r},subscribe(s){return n.add(s),()=>n.delete(s)},dispatch(s,...i){let o=e[s].call(r,...i);o&&(r=o,n.forEach(a=>a()))}}}function VB(t){return k.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}let cle=new lle(()=>HB(()=>[],{ADD(t){return this.includes(t)?this:[...this,t]},REMOVE(t){let e=this.indexOf(t);if(e===-1)return this;let r=this.slice();return r.splice(e,1),r}}));function GB(t,e){let r=cle.get(e),n=k.useId(),s=VB(r);if(rr(()=>{if(t)return r.dispatch("ADD",n),()=>r.dispatch("REMOVE",n)},[r,t]),!t)return!1;let i=s.indexOf(n),o=s.length;return i===-1&&(i=o,o+=1),i===o-1}function ule(t,e,r){let n=Si(s=>{let i=s.getBoundingClientRect();i.x===0&&i.y===0&&i.width===0&&i.height===0&&r()});k.useEffect(()=>{if(!t)return;let s=e===null?null:e instanceof HTMLElement?e:e.current;if(!s)return;let i=Ta();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>n.current(s));o.observe(s),i.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>n.current(s));o.observe(s),i.add(()=>o.disconnect())}return()=>i.dispose()},[e,n,t])}let ob=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),dle=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var hi=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(hi||{}),lm=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(lm||{}),hle=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(hle||{});function Tg(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(ob)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function fle(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(dle)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var vS=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(vS||{});function zB(t,e=0){var r;return t===((r=eh(t))==null?void 0:r.body)?!1:Fn(e,{0(){return t.matches(ob)},1(){let n=t;for(;n!==null;){if(n.matches(ob))return!0;n=n.parentElement}return!1}})}var ple=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(ple||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let mle=["textarea","input"].join(",");function gle(t){var e,r;return(r=(e=t?.matches)==null?void 0:e.call(t,mle))!=null?r:!1}function vle(t,e=r=>r){return t.slice().sort((r,n)=>{let s=e(r),i=e(n);if(s===null||i===null)return 0;let o=s.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Wo(t,e,{sorted:r=!0,relativeTo:n=null,skipElements:s=[]}={}){let i=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,o=Array.isArray(t)?r?vle(t):t:e&64?fle(t):Tg(t);s.length>0&&o.length>1&&(o=o.filter(f=>!s.some(v=>v!=null&&"current"in v?v?.current===f:v===f))),n=n??i.activeElement;let a=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(n))-1;if(e&4)return Math.max(0,o.indexOf(n))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=e&32?{preventScroll:!0}:{},u=0,d=o.length,h;do{if(u>=d||u+d<=0)return 0;let f=l+u;if(e&16)f=(f+d)%d;else{if(f<0)return 3;if(f>=d)return 1}h=o[f],h?.focus(c),u+=a}while(h!==i.activeElement);return e&6&&gle(h)&&h.select(),2}function WB(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function yle(){return/Android/gi.test(window.navigator.userAgent)}function _le(){return WB()||yle()}function Ac(t,e,r,n){let s=Si(r);k.useEffect(()=>{if(!t)return;function i(o){s.current(o)}return document.addEventListener(e,i,n),()=>document.removeEventListener(e,i,n)},[t,e,n])}function KB(t,e,r,n){let s=Si(r);k.useEffect(()=>{if(!t)return;function i(o){s.current(o)}return window.addEventListener(e,i,n),()=>window.removeEventListener(e,i,n)},[t,e,n])}const XT=30;function ble(t,e,r){let n=GB(t,"outside-click"),s=Si(r),i=k.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let d=function h(f){return typeof f=="function"?h(f()):Array.isArray(f)||f instanceof Set?f:[f]}(e);for(let h of d)if(h!==null&&(h.contains(u)||l.composed&&l.composedPath().includes(h)))return;return!zB(u,vS.Loose)&&u.tabIndex!==-1&&l.preventDefault(),s.current(l,u)},[s,e]),o=k.useRef(null);Ac(n,"pointerdown",l=>{var c,u;o.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target},!0),Ac(n,"mousedown",l=>{var c,u;o.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target},!0),Ac(n,"click",l=>{_le()||o.current&&(i(l,()=>o.current),o.current=null)},!0);let a=k.useRef({x:0,y:0});Ac(n,"touchstart",l=>{a.current.x=l.touches[0].clientX,a.current.y=l.touches[0].clientY},!0),Ac(n,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-a.current.x)>=XT||Math.abs(c.y-a.current.y)>=XT))return i(l,()=>l.target instanceof HTMLElement?l.target:null)},!0),KB(n,"blur",l=>i(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function cc(...t){return k.useMemo(()=>eh(...t),[...t])}function wle(t,e,r,n){let s=Si(r);k.useEffect(()=>{t=t??window;function i(o){s.current(o)}return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)},[t,e,n])}function xle(t,e){return k.useMemo(()=>{var r;if(t.type)return t.type;let n=(r=t.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||e?.tagName==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function Sle(){let t;return{before({doc:e}){var r;let n=e.documentElement,s=(r=e.defaultView)!=null?r:window;t=Math.max(0,s.innerWidth-n.clientWidth)},after({doc:e,d:r}){let n=e.documentElement,s=Math.max(0,n.clientWidth-n.offsetWidth),i=Math.max(0,t-s);r.style(n,"paddingRight",`${i}px`)}}}function Ele(){return WB()?{before({doc:t,d:e,meta:r}){function n(s){return r.containers.flatMap(i=>i()).some(i=>i.contains(s))}e.microTask(()=>{var s;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let a=Ta();a.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>a.dispose()))}let i=(s=window.scrollY)!=null?s:window.pageYOffset,o=null;e.addEventListener(t,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),u=t.querySelector(c);u&&!n(u)&&(o=u)}catch{}},!0),e.addEventListener(t,"touchstart",a=>{if(a.target instanceof HTMLElement)if(n(a.target)){let l=a.target;for(;l.parentElement&&n(l.parentElement);)l=l.parentElement;e.style(l,"overscrollBehavior","contain")}else e.style(a.target,"touchAction","none")}),e.addEventListener(t,"touchmove",a=>{if(a.target instanceof HTMLElement){if(a.target.tagName==="INPUT")return;if(n(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()}},{passive:!1}),e.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;i!==l&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function Cle(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function kle(t){let e={};for(let r of t)Object.assign(e,r(e));return e}let Ko=HB(()=>new Map,{PUSH(t,e){var r;let n=(r=this.get(t))!=null?r:{doc:t,count:0,d:Ta(),meta:new Set};return n.count++,n.meta.add(e),this.set(t,n),this},POP(t,e){let r=this.get(t);return r&&(r.count--,r.meta.delete(e)),this},SCROLL_PREVENT({doc:t,d:e,meta:r}){let n={doc:t,d:e,meta:kle(r)},s=[Ele(),Sle(),Cle()];s.forEach(({before:i})=>i?.(n)),s.forEach(({after:i})=>i?.(n))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});Ko.subscribe(()=>{let t=Ko.getSnapshot(),e=new Map;for(let[r]of t)e.set(r,r.documentElement.style.overflow);for(let r of t.values()){let n=e.get(r.doc)==="hidden",s=r.count!==0;(s&&!n||!s&&n)&&Ko.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Ko.dispatch("TEARDOWN",r)}});function Tle(t,e,r=()=>({containers:[]})){let n=VB(Ko),s=e?n.get(e):void 0,i=s?s.count>0:!1;return rr(()=>{if(!(!e||!t))return Ko.dispatch("PUSH",e,r),()=>Ko.dispatch("POP",e,r)},[t,e]),i}function Ale(t,e,r=()=>[document.body]){let n=GB(t,"scroll-lock");Tle(n,e,s=>{var i;return{containers:[...(i=s.containers)!=null?i:[],r]}})}function Rle(t=0){let[e,r]=k.useState(t),n=k.useCallback(l=>r(l),[e]),s=k.useCallback(l=>r(c=>c|l),[e]),i=k.useCallback(l=>(e&l)===l,[e]),o=k.useCallback(l=>r(c=>c&~l),[r]),a=k.useCallback(l=>r(c=>c^l),[r]);return{flags:e,setFlag:n,addFlag:s,hasFlag:i,removeFlag:o,toggleFlag:a}}var Ple={},QT,eA;typeof xt<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((QT=xt==null?void 0:Ple)==null?void 0:QT.NODE_ENV)==="test"&&typeof((eA=Element?.prototype)==null?void 0:eA.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var Ile=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(Ile||{});function yS(t){let e={};for(let r in t)t[r]===!0&&(e[`data-${r}`]="");return e}function _S(t,e,r,n){let[s,i]=k.useState(r),{hasFlag:o,addFlag:a,removeFlag:l}=Rle(t&&s?3:0),c=k.useRef(!1),u=k.useRef(!1),d=kg();return rr(()=>{var h;if(t){if(r&&i(!0),!e){r&&a(3);return}return(h=n?.start)==null||h.call(n,r),Ole(e,{inFlight:c,prepare(){u.current?u.current=!1:u.current=c.current,c.current=!0,!u.current&&(r?(a(3),l(4)):(a(4),l(2)))},run(){u.current?r?(l(3),a(4)):(l(4),a(3)):r?l(1):a(1)},done(){var f;u.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(c.current=!1,l(7),r||i(!1),(f=n?.end)==null||f.call(n,r))}})}},[t,r,e,d]),t?[s,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function Ole(t,{prepare:e,run:r,done:n,inFlight:s}){let i=Ta();return Mle(t,{prepare:e,inFlight:s}),i.nextFrame(()=>{r(),i.requestAnimationFrame(()=>{i.add(Dle(t,n))})}),i.dispose}function Dle(t,e){var r,n;let s=Ta();if(!t)return s.dispose;let i=!1;s.add(()=>{i=!0});let o=(n=(r=t.getAnimations)==null?void 0:r.call(t).filter(a=>a instanceof CSSTransition))!=null?n:[];return o.length===0?(e(),s.dispose):(Promise.allSettled(o.map(a=>a.finished)).then(()=>{i||e()}),s.dispose)}function Mle(t,{inFlight:e,prepare:r}){if(e!=null&&e.current){r();return}let n=t.style.transition;t.style.transition="none",r(),t.offsetHeight,t.style.transition=n}function Ag(){return typeof window<"u"}function uc(t){return qB(t)?(t.nodeName||"").toLowerCase():"#document"}function mn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Hs(t){var e;return(e=(qB(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function qB(t){return Ag()?t instanceof Node||t instanceof mn(t).Node:!1}function Fr(t){return Ag()?t instanceof Element||t instanceof mn(t).Element:!1}function Fs(t){return Ag()?t instanceof HTMLElement||t instanceof mn(t).HTMLElement:!1}function tA(t){return!Ag()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof mn(t).ShadowRoot}function th(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=es(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(s)}function Lle(t){return["table","td","th"].includes(uc(t))}function Rg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function bS(t){const e=wS(),r=Fr(t)?es(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Nle(t){let e=fo(t);for(;Fs(e)&&!Hl(e);){if(bS(e))return e;if(Rg(e))return null;e=fo(e)}return null}function wS(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Hl(t){return["html","body","#document"].includes(uc(t))}function es(t){return mn(t).getComputedStyle(t)}function Pg(t){return Fr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function fo(t){if(uc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||tA(t)&&t.host||Hs(t);return tA(e)?e.host:e}function JB(t){const e=fo(t);return Hl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Fs(e)&&th(e)?e:JB(e)}function yd(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=JB(t),i=s===((n=t.ownerDocument)==null?void 0:n.body),o=mn(s);if(i){const a=ab(o);return e.concat(o,o.visualViewport||[],th(s)?s:[],a&&r?yd(a):[])}return e.concat(s,yd(s,[],r))}function ab(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Ble(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:r,version:n}=e;return r+"/"+n}).join(" "):navigator.userAgent}const Fle=["top","right","bottom","left"],Ei=Math.min,Cr=Math.max,_d=Math.round,Zh=Math.floor,Ms=t=>({x:t,y:t}),jle={left:"right",right:"left",bottom:"top",top:"bottom"},$le={start:"end",end:"start"};function lb(t,e,r){return Cr(t,Ei(e,r))}function js(t,e){return typeof t=="function"?t(e):t}function Ci(t){return t.split("-")[0]}function dc(t){return t.split("-")[1]}function xS(t){return t==="x"?"y":"x"}function SS(t){return t==="y"?"height":"width"}function po(t){return["top","bottom"].includes(Ci(t))?"y":"x"}function ES(t){return xS(po(t))}function Ule(t,e,r){r===void 0&&(r=!1);const n=dc(t),s=ES(t),i=SS(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=cm(o)),[o,cm(o)]}function Hle(t){const e=cm(t);return[cb(t),e,cb(e)]}function cb(t){return t.replace(/start|end/g,e=>$le[e])}function Vle(t,e,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?s:n:e?n:s;case"left":case"right":return e?i:o;default:return[]}}function Gle(t,e,r,n){const s=dc(t);let i=Vle(Ci(t),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(cb)))),i}function cm(t){return t.replace(/left|right|bottom|top/g,e=>jle[e])}function zle(t){return{top:0,right:0,bottom:0,left:0,...t}}function YB(t){return typeof t!="number"?zle(t):{top:t,right:t,bottom:t,left:t}}function um(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function rA(t,e,r){let{reference:n,floating:s}=t;const i=po(e),o=ES(e),a=SS(o),l=Ci(e),c=i==="y",u=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,h=n[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:n.y-s.height};break;case"bottom":f={x:u,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:d};break;case"left":f={x:n.x-s.width,y:d};break;default:f={x:n.x,y:n.y}}switch(dc(e)){case"start":f[o]-=h*(r&&c?-1:1);break;case"end":f[o]+=h*(r&&c?-1:1);break}return f}const Wle=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:d}=rA(c,n,l),h=n,f={},v=0;for(let m=0;m<a.length;m++){const{name:p,fn:g}=a[m],{x:y,y:_,data:b,reset:w}=await g({x:u,y:d,initialPlacement:n,placement:h,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=y??u,d=_??d,f={...f,[p]:{...f[p],...b}},w&&v<=50&&(v++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(c=w.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):w.rects),{x:u,y:d}=rA(c,h,l)),m=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:f}};async function Vl(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=js(e,t),v=YB(f),p=a[h?d==="floating"?"reference":"floating":d],g=um(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(p)))==null||r?p:p.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=d==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(_))?await(i.getScale==null?void 0:i.getScale(_))||{x:1,y:1}:{x:1,y:1},w=um(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:_,strategy:l}):y);return{top:(g.top-w.top+v.top)/b.y,bottom:(w.bottom-g.bottom+v.bottom)/b.y,left:(g.left-w.left+v.left)/b.x,right:(w.right-g.right+v.right)/b.x}}const Kle=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=js(t,e)||{};if(c==null)return{};const d=YB(u),h={x:r,y:n},f=ES(s),v=SS(f),m=await o.getDimensions(c),p=f==="y",g=p?"top":"left",y=p?"bottom":"right",_=p?"clientHeight":"clientWidth",b=i.reference[v]+i.reference[f]-h[f]-i.floating[v],w=h[f]-i.reference[f],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let S=E?E[_]:0;(!S||!await(o.isElement==null?void 0:o.isElement(E)))&&(S=a.floating[_]||i.floating[v]);const x=b/2-w/2,T=S/2-m[v]/2-1,D=Ei(d[g],T),O=Ei(d[y],T),R=D,P=S-m[v]-O,A=S/2-m[v]/2+x,H=lb(R,A,P),K=!l.arrow&&dc(s)!=null&&A!==H&&i.reference[v]/2-(A<R?D:O)-m[v]/2<0,V=K?A<R?A-R:A-P:0;return{[f]:h[f]+V,data:{[f]:H,centerOffset:A-H-V,...K&&{alignmentOffset:V}},reset:K}}}),qle=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:m=!0,...p}=js(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const g=Ci(s),y=po(a),_=Ci(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=h||(_||!m?[cm(a)]:Hle(a)),E=v!=="none";!h&&E&&w.push(...Gle(a,m,v,b));const S=[a,...w],x=await Vl(e,p),T=[];let D=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&T.push(x[g]),d){const A=Ule(s,o,b);T.push(x[A[0]],x[A[1]])}if(D=[...D,{placement:s,overflows:T}],!T.every(A=>A<=0)){var O,R;const A=(((O=i.flip)==null?void 0:O.index)||0)+1,H=S[A];if(H)return{data:{index:A,overflows:D},reset:{placement:H}};let K=(R=D.filter(V=>V.overflows[0]<=0).sort((V,q)=>V.overflows[1]-q.overflows[1])[0])==null?void 0:R.placement;if(!K)switch(f){case"bestFit":{var P;const V=(P=D.filter(q=>{if(E){const I=po(q.placement);return I===y||I==="y"}return!0}).map(q=>[q.placement,q.overflows.filter(I=>I>0).reduce((I,$)=>I+$,0)]).sort((q,I)=>q[1]-I[1])[0])==null?void 0:P[0];V&&(K=V);break}case"initialPlacement":K=a;break}if(s!==K)return{reset:{placement:K}}}return{}}}};function nA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function sA(t){return Fle.some(e=>t[e]>=0)}const Jle=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=js(t,e);switch(n){case"referenceHidden":{const i=await Vl(e,{...s,elementContext:"reference"}),o=nA(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:sA(o)}}}case"escaped":{const i=await Vl(e,{...s,altBoundary:!0}),o=nA(i,r.floating);return{data:{escapedOffsets:o,escaped:sA(o)}}}default:return{}}}}};async function Yle(t,e){const{placement:r,platform:n,elements:s}=t,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=Ci(r),a=dc(r),l=po(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,d=js(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof v=="number"&&(f=a==="end"?v*-1:v),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const Zle=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await Yle(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},Xle=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:p=>{let{x:g,y}=p;return{x:g,y}}},...l}=js(t,e),c={x:r,y:n},u=await Vl(e,l),d=po(Ci(s)),h=xS(d);let f=c[h],v=c[d];if(i){const p=h==="y"?"top":"left",g=h==="y"?"bottom":"right",y=f+u[p],_=f-u[g];f=lb(y,f,_)}if(o){const p=d==="y"?"top":"left",g=d==="y"?"bottom":"right",y=v+u[p],_=v-u[g];v=lb(y,v,_)}const m=a.fn({...e,[h]:f,[d]:v});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[h]:i,[d]:o}}}}}},Qle=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=js(t,e),u={x:r,y:n},d=po(s),h=xS(d);let f=u[h],v=u[d];const m=js(a,e),p=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const _=h==="y"?"height":"width",b=i.reference[h]-i.floating[_]+p.mainAxis,w=i.reference[h]+i.reference[_]-p.mainAxis;f<b?f=b:f>w&&(f=w)}if(c){var g,y;const _=h==="y"?"width":"height",b=["top","left"].includes(Ci(s)),w=i.reference[d]-i.floating[_]+(b&&((g=o.offset)==null?void 0:g[d])||0)+(b?0:p.crossAxis),E=i.reference[d]+i.reference[_]+(b?0:((y=o.offset)==null?void 0:y[d])||0)-(b?p.crossAxis:0);v<w?v=w:v>E&&(v=E)}return{[h]:f,[d]:v}}}},ece=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=js(t,e),u=await Vl(e,c),d=Ci(s),h=dc(s),f=po(s)==="y",{width:v,height:m}=i.floating;let p,g;d==="top"||d==="bottom"?(p=d,g=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(g=d,p=h==="end"?"top":"bottom");const y=m-u.top-u.bottom,_=v-u.left-u.right,b=Ei(m-u[p],y),w=Ei(v-u[g],_),E=!e.middlewareData.shift;let S=b,x=w;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(x=_),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(S=y),E&&!h){const D=Cr(u.left,0),O=Cr(u.right,0),R=Cr(u.top,0),P=Cr(u.bottom,0);f?x=v-2*(D!==0||O!==0?D+O:Cr(u.left,u.right)):S=m-2*(R!==0||P!==0?R+P:Cr(u.top,u.bottom))}await l({...e,availableWidth:x,availableHeight:S});const T=await o.getDimensions(a.floating);return v!==T.width||m!==T.height?{reset:{rects:!0}}:{}}}};function ZB(t){const e=es(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Fs(t),i=s?t.offsetWidth:r,o=s?t.offsetHeight:n,a=_d(r)!==i||_d(n)!==o;return a&&(r=i,n=o),{width:r,height:n,$:a}}function CS(t){return Fr(t)?t:t.contextElement}function gl(t){const e=CS(t);if(!Fs(e))return Ms(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:i}=ZB(e);let o=(i?_d(r.width):r.width)/n,a=(i?_d(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const tce=Ms(0);function XB(t){const e=mn(t);return!wS()||!e.visualViewport?tce:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function rce(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==mn(t)?!1:e}function ga(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=CS(t);let o=Ms(1);e&&(n?Fr(n)&&(o=gl(n)):o=gl(t));const a=rce(i,r,n)?XB(i):Ms(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(i){const h=mn(i),f=n&&Fr(n)?mn(n):n;let v=h,m=ab(v);for(;m&&n&&f!==v;){const p=gl(m),g=m.getBoundingClientRect(),y=es(m),_=g.left+(m.clientLeft+parseFloat(y.paddingLeft))*p.x,b=g.top+(m.clientTop+parseFloat(y.paddingTop))*p.y;l*=p.x,c*=p.y,u*=p.x,d*=p.y,l+=_,c+=b,v=mn(m),m=ab(v)}}return um({width:u,height:d,x:l,y:c})}function kS(t,e){const r=Pg(t).scrollLeft;return e?e.left+r:ga(Hs(t)).left+r}function QB(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-(r?0:kS(t,n)),i=n.top+e.scrollTop;return{x:s,y:i}}function nce(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const i=s==="fixed",o=Hs(n),a=e?Rg(e.floating):!1;if(n===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=Ms(1);const u=Ms(0),d=Fs(n);if((d||!d&&!i)&&((uc(n)!=="body"||th(o))&&(l=Pg(n)),Fs(n))){const f=ga(n);c=gl(n),u.x=f.x+n.clientLeft,u.y=f.y+n.clientTop}const h=o&&!d&&!i?QB(o,l,!0):Ms(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:r.y*c.y-l.scrollTop*c.y+u.y+h.y}}function sce(t){return Array.from(t.getClientRects())}function ice(t){const e=Hs(t),r=Pg(t),n=t.ownerDocument.body,s=Cr(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Cr(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+kS(t);const a=-r.scrollTop;return es(n).direction==="rtl"&&(o+=Cr(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:a}}function oce(t,e){const r=mn(t),n=Hs(t),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=wS();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function ace(t,e){const r=ga(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,i=Fs(t)?gl(t):Ms(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=n*i.y;return{width:o,height:a,x:l,y:c}}function iA(t,e,r){let n;if(e==="viewport")n=oce(t,r);else if(e==="document")n=ice(Hs(t));else if(Fr(e))n=ace(e,r);else{const s=XB(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return um(n)}function eF(t,e){const r=fo(t);return r===e||!Fr(r)||Hl(r)?!1:es(r).position==="fixed"||eF(r,e)}function lce(t,e){const r=e.get(t);if(r)return r;let n=yd(t,[],!1).filter(a=>Fr(a)&&uc(a)!=="body"),s=null;const i=es(t).position==="fixed";let o=i?fo(t):t;for(;Fr(o)&&!Hl(o);){const a=es(o),l=bS(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||th(o)&&!l&&eF(t,o))?n=n.filter(u=>u!==o):s=a,o=fo(o)}return e.set(t,n),n}function cce(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const o=[...r==="clippingAncestors"?Rg(e)?[]:lce(e,this._c):[].concat(r),n],a=o[0],l=o.reduce((c,u)=>{const d=iA(e,u,s);return c.top=Cr(d.top,c.top),c.right=Ei(d.right,c.right),c.bottom=Ei(d.bottom,c.bottom),c.left=Cr(d.left,c.left),c},iA(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function uce(t){const{width:e,height:r}=ZB(t);return{width:e,height:r}}function dce(t,e,r){const n=Fs(e),s=Hs(e),i=r==="fixed",o=ga(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Ms(0);if(n||!n&&!i)if((uc(e)!=="body"||th(s))&&(a=Pg(e)),n){const h=ga(e,!0,i,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else s&&(l.x=kS(s));const c=s&&!n&&!i?QB(s,a):Ms(0),u=o.left+a.scrollLeft-l.x-c.x,d=o.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:o.width,height:o.height}}function Cy(t){return es(t).position==="static"}function oA(t,e){if(!Fs(t)||es(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return Hs(t)===r&&(r=r.ownerDocument.body),r}function tF(t,e){const r=mn(t);if(Rg(t))return r;if(!Fs(t)){let s=fo(t);for(;s&&!Hl(s);){if(Fr(s)&&!Cy(s))return s;s=fo(s)}return r}let n=oA(t,e);for(;n&&Lle(n)&&Cy(n);)n=oA(n,e);return n&&Hl(n)&&Cy(n)&&!bS(n)?r:n||Nle(t)||r}const hce=async function(t){const e=this.getOffsetParent||tF,r=this.getDimensions,n=await r(t.floating);return{reference:dce(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function fce(t){return es(t).direction==="rtl"}const pce={convertOffsetParentRelativeRectToViewportRelativeRect:nce,getDocumentElement:Hs,getClippingRect:cce,getOffsetParent:tF,getElementRects:hce,getClientRects:sce,getDimensions:uce,getScale:gl,isElement:Fr,isRTL:fce};function rF(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function mce(t,e){let r=null,n;const s=Hs(t);function i(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(a||e(),!h||!f)return;const v=Zh(d),m=Zh(s.clientWidth-(u+h)),p=Zh(s.clientHeight-(d+f)),g=Zh(u),_={rootMargin:-v+"px "+-m+"px "+-p+"px "+-g+"px",threshold:Cr(0,Ei(1,l))||1};let b=!0;function w(E){const S=E[0].intersectionRatio;if(S!==l){if(!b)return o();S?o(!1,S):n=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!rF(c,t.getBoundingClientRect())&&o(),b=!1}try{r=new IntersectionObserver(w,{..._,root:s.ownerDocument})}catch{r=new IntersectionObserver(w,_)}r.observe(t)}return o(!0),i}function nF(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=CS(t),u=s||i?[...c?yd(c):[],...yd(e)]:[];u.forEach(g=>{s&&g.addEventListener("scroll",r,{passive:!0}),i&&g.addEventListener("resize",r)});const d=c&&a?mce(c,r):null;let h=-1,f=null;o&&(f=new ResizeObserver(g=>{let[y]=g;y&&y.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var _;(_=f)==null||_.observe(e)})),r()}),c&&!l&&f.observe(c),f.observe(e));let v,m=l?ga(t):null;l&&p();function p(){const g=ga(t);m&&!rF(m,g)&&r(),m=g,v=requestAnimationFrame(p)}return r(),()=>{var g;u.forEach(y=>{s&&y.removeEventListener("scroll",r),i&&y.removeEventListener("resize",r)}),d?.(),(g=f)==null||g.disconnect(),f=null,l&&cancelAnimationFrame(v)}}const ky=Vl,gce=Zle,vce=Xle,yce=qle,_ce=ece,bce=Jle,aA=Kle,wce=Qle,xce=(t,e,r)=>{const n=new Map,s={platform:pce,...r},i={...s.platform,_c:n};return Wle(t,e,{...s,platform:i})};var Gf=typeof document<"u"?k.useLayoutEffect:k.useEffect;function dm(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!dm(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&t.$$typeof)&&!dm(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function sF(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function lA(t,e){const r=sF(t);return Math.round(e*r)/r}function Ty(t){const e=k.useRef(t);return Gf(()=>{e.current=t}),e}function iF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=k.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=k.useState(n);dm(h,n)||f(n);const[v,m]=k.useState(null),[p,g]=k.useState(null),y=k.useCallback(q=>{q!==E.current&&(E.current=q,m(q))},[]),_=k.useCallback(q=>{q!==S.current&&(S.current=q,g(q))},[]),b=i||v,w=o||p,E=k.useRef(null),S=k.useRef(null),x=k.useRef(u),T=l!=null,D=Ty(l),O=Ty(s),R=Ty(c),P=k.useCallback(()=>{if(!E.current||!S.current)return;const q={placement:e,strategy:r,middleware:h};O.current&&(q.platform=O.current),xce(E.current,S.current,q).then(I=>{const $={...I,isPositioned:R.current!==!1};A.current&&!dm(x.current,$)&&(x.current=$,Tl.flushSync(()=>{d($)}))})},[h,e,r,O,R]);Gf(()=>{c===!1&&x.current.isPositioned&&(x.current.isPositioned=!1,d(q=>({...q,isPositioned:!1})))},[c]);const A=k.useRef(!1);Gf(()=>(A.current=!0,()=>{A.current=!1}),[]),Gf(()=>{if(b&&(E.current=b),w&&(S.current=w),b&&w){if(D.current)return D.current(b,w,P);P()}},[b,w,P,D,T]);const H=k.useMemo(()=>({reference:E,floating:S,setReference:y,setFloating:_}),[y,_]),K=k.useMemo(()=>({reference:b,floating:w}),[b,w]),V=k.useMemo(()=>{const q={position:r,left:0,top:0};if(!K.floating)return q;const I=lA(K.floating,u.x),$=lA(K.floating,u.y);return a?{...q,transform:"translate("+I+"px, "+$+"px)",...sF(K.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:I,top:$}},[r,a,K.floating,u.x,u.y]);return k.useMemo(()=>({...u,update:P,refs:H,elements:K,floatingStyles:V}),[u,P,H,K,V])}const Sce=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?aA({element:n.current,padding:s}).fn(r):{}:n?aA({element:n,padding:s}).fn(r):{}}}},TS=(t,e)=>({...gce(t),options:[t,e]}),oF=(t,e)=>({...vce(t),options:[t,e]}),Ece=(t,e)=>({...wce(t),options:[t,e]}),aF=(t,e)=>({...yce(t),options:[t,e]}),lF=(t,e)=>({..._ce(t),options:[t,e]}),Cce=(t,e)=>({...bce(t),options:[t,e]}),kce=(t,e)=>({...Sce(t),options:[t,e]}),cF={...Al},Tce=cF.useInsertionEffect,Ace=Tce||(t=>t());function uF(t){const e=k.useRef(()=>{});return Ace(()=>{e.current=t}),k.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return e.current==null?void 0:e.current(...n)},[])}var ub=typeof document<"u"?k.useLayoutEffect:k.useEffect;let cA=!1,Rce=0;const uA=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Rce++;function Pce(){const[t,e]=k.useState(()=>cA?uA():void 0);return ub(()=>{t==null&&e(uA())},[]),k.useEffect(()=>{cA=!0},[]),t}const Ice=cF.useId,Oce=Ice||Pce;function Dce(){const t=new Map;return{emit(e,r){var n;(n=t.get(e))==null||n.forEach(s=>s(r))},on(e,r){t.set(e,[...t.get(e)||[],r])},off(e,r){var n;t.set(e,((n=t.get(e))==null?void 0:n.filter(s=>s!==r))||[])}}}const Mce=k.createContext(null),Lce=k.createContext(null),Nce=()=>{var t;return((t=k.useContext(Mce))==null?void 0:t.id)||null},Bce=()=>k.useContext(Lce),Fce="data-floating-ui-focusable";function jce(t){const{open:e=!1,onOpenChange:r,elements:n}=t,s=Oce(),i=k.useRef({}),[o]=k.useState(()=>Dce()),a=Nce()!=null,[l,c]=k.useState(n.reference),u=uF((f,v,m)=>{i.current.openEvent=f?v:void 0,o.emit("openchange",{open:f,event:v,reason:m,nested:a}),r?.(f,v,m)}),d=k.useMemo(()=>({setPositionReference:c}),[]),h=k.useMemo(()=>({reference:l||n.reference||null,floating:n.floating||null,domReference:n.reference}),[l,n.reference,n.floating]);return k.useMemo(()=>({dataRef:i,open:e,onOpenChange:u,elements:h,events:o,floatingId:s,refs:d}),[e,u,h,o,s,d])}function $ce(t){t===void 0&&(t={});const{nodeId:e}=t,r=jce({...t,elements:{reference:null,floating:null,...t.elements}}),n=t.rootContext||r,s=n.elements,[i,o]=k.useState(null),[a,l]=k.useState(null),u=s?.domReference||i,d=k.useRef(null),h=Bce();ub(()=>{u&&(d.current=u)},[u]);const f=iF({...t,elements:{...s,...a&&{reference:a}}}),v=k.useCallback(_=>{const b=Fr(_)?{getBoundingClientRect:()=>_.getBoundingClientRect(),contextElement:_}:_;l(b),f.refs.setReference(b)},[f.refs]),m=k.useCallback(_=>{(Fr(_)||_===null)&&(d.current=_,o(_)),(Fr(f.refs.reference.current)||f.refs.reference.current===null||_!==null&&!Fr(_))&&f.refs.setReference(_)},[f.refs]),p=k.useMemo(()=>({...f.refs,setReference:m,setPositionReference:v,domReference:d}),[f.refs,m,v]),g=k.useMemo(()=>({...f.elements,domReference:u}),[f.elements,u]),y=k.useMemo(()=>({...f,...n,refs:p,elements:g,nodeId:e}),[f,p,g,e,n]);return ub(()=>{n.dataRef.current.floatingContext=y;const _=h?.nodesRef.current.find(b=>b.id===e);_&&(_.context=y)}),k.useMemo(()=>({...f,context:y,refs:p,elements:g}),[f,p,g,y])}const dA="active",hA="selected";function Ay(t,e,r){const n=new Map,s=r==="item";let i=t;if(s&&t){const{[dA]:o,[hA]:a,...l}=t;i=l}return{...r==="floating"&&{tabIndex:-1,[Fce]:""},...i,...e.map(o=>{const a=o?o[r]:null;return typeof a=="function"?t?a(t):null:a}).concat(t).reduce((o,a)=>(a&&Object.entries(a).forEach(l=>{let[c,u]=l;if(!(s&&[dA,hA].includes(c)))if(c.indexOf("on")===0){if(n.has(c)||n.set(c,[]),typeof u=="function"){var d;(d=n.get(c))==null||d.push(u),o[c]=function(){for(var h,f=arguments.length,v=new Array(f),m=0;m<f;m++)v[m]=arguments[m];return(h=n.get(c))==null?void 0:h.map(p=>p(...v)).find(p=>p!==void 0)}}}else o[c]=u}),o),{})}}function Uce(t){t===void 0&&(t=[]);const e=t.map(a=>a?.reference),r=t.map(a=>a?.floating),n=t.map(a=>a?.item),s=k.useCallback(a=>Ay(a,t,"reference"),e),i=k.useCallback(a=>Ay(a,t,"floating"),r),o=k.useCallback(a=>Ay(a,t,"item"),n);return k.useMemo(()=>({getReferenceProps:s,getFloatingProps:i,getItemProps:o}),[s,i,o])}function fA(t,e){return{...t,rects:{...t.rects,floating:{...t.rects.floating,height:e}}}}const Hce=t=>({name:"inner",options:t,async fn(e){const{listRef:r,overflowRef:n,onFallbackChange:s,offset:i=0,index:o=0,minItemsVisible:a=4,referenceOverflowThreshold:l=0,scrollRef:c,...u}=js(t,e),{rects:d,elements:{floating:h}}=e,f=r.current[o],v=c?.current||h,m=h.clientTop||v.clientTop,p=h.clientTop!==0,g=v.clientTop!==0,y=h===v;if(!f)return{};const _={...e,...await TS(-f.offsetTop-h.clientTop-d.reference.height/2-f.offsetHeight/2-i).fn(e)},b=await ky(fA(_,v.scrollHeight+m+h.clientTop),u),w=await ky(_,{...u,elementContext:"reference"}),E=Cr(0,b.top),S=_.y+E,D=(v.scrollHeight>v.clientHeight?O=>O:_d)(Cr(0,v.scrollHeight+(p&&y||g?m*2:0)-E-Cr(0,b.bottom)));if(v.style.maxHeight=D+"px",v.scrollTop=E,s){const O=v.offsetHeight<f.offsetHeight*Ei(a,r.current.length)-1||w.top>=-l||w.bottom>=-l;Tl.flushSync(()=>s(O))}return n&&(n.current=await ky(fA({..._,y:S},v.offsetHeight+m+h.clientTop),u)),{y:S}}});function Vce(t,e){const{open:r,elements:n}=t,{enabled:s=!0,overflowRef:i,scrollRef:o,onChange:a}=e,l=uF(a),c=k.useRef(!1),u=k.useRef(null),d=k.useRef(null);k.useEffect(()=>{if(!s)return;function f(m){if(m.ctrlKey||!v||i.current==null)return;const p=m.deltaY,g=i.current.top>=-.5,y=i.current.bottom>=-.5,_=v.scrollHeight-v.clientHeight,b=p<0?-1:1,w=p<0?"max":"min";v.scrollHeight<=v.clientHeight||(!g&&p>0||!y&&p<0?(m.preventDefault(),Tl.flushSync(()=>{l(E=>E+Math[w](p,_*b))})):/firefox/i.test(Ble())&&(v.scrollTop+=p))}const v=o?.current||n.floating;if(r&&v)return v.addEventListener("wheel",f),requestAnimationFrame(()=>{u.current=v.scrollTop,i.current!=null&&(d.current={...i.current})}),()=>{u.current=null,d.current=null,v.removeEventListener("wheel",f)}},[s,r,n.floating,i,o,l]);const h=k.useMemo(()=>({onKeyDown(){c.current=!0},onWheel(){c.current=!1},onPointerMove(){c.current=!1},onScroll(){const f=o?.current||n.floating;if(!(!i.current||!f||!c.current)){if(u.current!==null){const v=f.scrollTop-u.current;(i.current.bottom<-.5&&v<-1||i.current.top<-.5&&v>1)&&Tl.flushSync(()=>l(m=>m+v))}requestAnimationFrame(()=>{u.current=f.scrollTop})}}}),[n.floating,l,i,o]);return k.useMemo(()=>s?{floating:h}:{},[s,h])}let rh=k.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});rh.displayName="FloatingContext";let AS=k.createContext(null);AS.displayName="PlacementContext";function Gce(t){return k.useMemo(()=>t?typeof t=="string"?{to:t}:t:null,[t])}function zce(){return k.useContext(rh).setReference}function Wce(){let{getFloatingProps:t,slot:e}=k.useContext(rh);return k.useCallback((...r)=>Object.assign({},t(...r),{"data-anchor":e.anchor}),[t,e])}function Kce(t=null){t===!1&&(t=null),typeof t=="string"&&(t={to:t});let e=k.useContext(AS),r=k.useMemo(()=>t,[JSON.stringify(t,(s,i)=>{var o;return(o=i?.outerHTML)!=null?o:i})]);rr(()=>{e?.(r??null)},[e,r]);let n=k.useContext(rh);return k.useMemo(()=>[n.setFloating,t?n.styles:{}],[n.setFloating,t,n.styles])}let pA=4;function qce({children:t,enabled:e=!0}){let[r,n]=k.useState(null),[s,i]=k.useState(0),o=k.useRef(null),[a,l]=k.useState(null);Jce(a);let c=e&&r!==null&&a!==null,{to:u="bottom",gap:d=0,offset:h=0,padding:f=0,inner:v}=Yce(r,a),[m,p="center"]=u.split(" ");rr(()=>{c&&i(0)},[c]);let{refs:g,floatingStyles:y,context:_}=$ce({open:c,placement:m==="selection"?p==="center"?"bottom":`bottom-${p}`:p==="center"?`${m}`:`${m}-${p}`,strategy:"absolute",transform:!1,middleware:[TS({mainAxis:m==="selection"?0:d,crossAxis:h}),oF({padding:f}),m!=="selection"&&aF({padding:f}),m==="selection"&&v?Hce({...v,padding:f,overflowRef:o,offset:s,minItemsVisible:pA,referenceOverflowThreshold:f,onFallbackChange(O){var R,P;if(!O)return;let A=_.elements.floating;if(!A)return;let H=parseFloat(getComputedStyle(A).scrollPaddingBottom)||0,K=Math.min(pA,A.childElementCount),V=0,q=0;for(let I of(P=(R=_.elements.floating)==null?void 0:R.childNodes)!=null?P:[])if(I instanceof HTMLElement){let $=I.offsetTop,j=$+I.clientHeight+H,U=A.scrollTop,J=U+A.clientHeight;if($>=U&&j<=J)K--;else{q=Math.max(0,Math.min(j,J)-Math.max($,U)),V=I.clientHeight;break}}K>=1&&i(I=>{let $=V*K-q+H;return I>=$?I:$})}}):null,lF({padding:f,apply({availableWidth:O,availableHeight:R,elements:P}){Object.assign(P.floating.style,{overflow:"auto",maxWidth:`${O}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${R}px)`})}})].filter(Boolean),whileElementsMounted:nF}),[b=m,w=p]=_.placement.split("-");m==="selection"&&(b="selection");let E=k.useMemo(()=>({anchor:[b,w].filter(Boolean).join(" ")}),[b,w]),S=Vce(_,{overflowRef:o,onChange:i}),{getReferenceProps:x,getFloatingProps:T}=Uce([S]),D=st(O=>{l(O),g.setFloating(O)});return k.createElement(AS.Provider,{value:n},k.createElement(rh.Provider,{value:{setFloating:D,setReference:g.setReference,styles:y,getReferenceProps:x,getFloatingProps:T,slot:E}},t))}function Jce(t){rr(()=>{if(!t)return;let e=new MutationObserver(()=>{let r=window.getComputedStyle(t).maxHeight,n=parseFloat(r);if(isNaN(n))return;let s=parseInt(r);isNaN(s)||n!==s&&(t.style.maxHeight=`${Math.ceil(n)}px`)});return e.observe(t,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[t])}function Yce(t,e){var r,n,s;let i=Ry((r=t?.gap)!=null?r:"var(--anchor-gap, 0)",e),o=Ry((n=t?.offset)!=null?n:"var(--anchor-offset, 0)",e),a=Ry((s=t?.padding)!=null?s:"var(--anchor-padding, 0)",e);return{...t,gap:i,offset:o,padding:a}}function Ry(t,e,r=void 0){let n=kg(),s=st((l,c)=>{if(l==null)return[r,null];if(typeof l=="number")return[l,null];if(typeof l=="string"){if(!c)return[r,null];let u=mA(l,c);return[u,d=>{let h=dF(l);{let f=h.map(v=>window.getComputedStyle(c).getPropertyValue(v));n.requestAnimationFrame(function v(){n.nextFrame(v);let m=!1;for(let[g,y]of h.entries()){let _=window.getComputedStyle(c).getPropertyValue(y);if(f[g]!==_){f[g]=_,m=!0;break}}if(!m)return;let p=mA(l,c);u!==p&&(d(p),u=p)})}return n.dispose}]}return[r,null]}),i=k.useMemo(()=>s(t,e)[0],[t,e]),[o=i,a]=k.useState();return rr(()=>{let[l,c]=s(t,e);if(a(l),!!c)return c(a)},[t,e]),o}function dF(t){let e=/var\((.*)\)/.exec(t);if(e){let r=e[1].indexOf(",");if(r===-1)return[e[1]];let n=e[1].slice(0,r).trim(),s=e[1].slice(r+1).trim();return s?[n,...dF(s)]:[n]}return[]}function mA(t,e){let r=document.createElement("div");e.appendChild(r),r.style.setProperty("margin-top","0px","important"),r.style.setProperty("margin-top",t,"important");let n=parseFloat(window.getComputedStyle(r).marginTop)||0;return e.removeChild(r),n}let Ig=k.createContext(null);Ig.displayName="OpenClosedContext";var dn=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(dn||{});function Og(){return k.useContext(Ig)}function hF({value:t,children:e}){return Re.createElement(Ig.Provider,{value:t},e)}function Zce({children:t}){return Re.createElement(Ig.Provider,{value:null},t)}function Xce(t){let e=st(t),r=k.useRef(!1);k.useEffect(()=>(r.current=!1,()=>{r.current=!0,BB(()=>{r.current&&e()})}),[e])}function Qce(){let t=typeof document>"u";return"useSyncExternalStore"in Al?(e=>e.useSyncExternalStore)(Al)(()=>()=>{},()=>!1,()=>!t):!1}function RS(){let t=Qce(),[e,r]=k.useState(oa.isHandoffComplete);return e&&oa.isHandoffComplete===!1&&r(!1),k.useEffect(()=>{e!==!0&&r(!0)},[e]),k.useEffect(()=>oa.handoff(),[]),t?!1:e}let eue=k.createContext(!1);function tue(){return k.useContext(eue)}function rue(t){let e=tue(),r=k.useContext(pF),n=cc(t),[s,i]=k.useState(()=>{var o;if(!e&&r!==null)return(o=r.current)!=null?o:null;if(oa.isServer)return null;let a=n?.getElementById("headlessui-portal-root");if(a)return a;if(n===null)return null;let l=n.createElement("div");return l.setAttribute("id","headlessui-portal-root"),n.body.appendChild(l)});return k.useEffect(()=>{s!==null&&(n!=null&&n.body.contains(s)||n==null||n.body.appendChild(s))},[s,n]),k.useEffect(()=>{e||r!==null&&i(r.current)},[r,i,e]),s}let fF=k.Fragment,nue=wn(function(t,e){let r=t,n=k.useRef(null),s=Qn(UB(d=>{n.current=d}),e),i=cc(n),o=rue(n),[a]=k.useState(()=>{var d;return oa.isServer?null:(d=i?.createElement("div"))!=null?d:null}),l=k.useContext(db),c=RS();rr(()=>{!o||!a||o.contains(a)||(a.setAttribute("data-headlessui-portal",""),o.appendChild(a))},[o,a]),rr(()=>{if(a&&l)return l.register(a)},[l,a]),Xce(()=>{var d;!o||!a||(a instanceof Node&&o.contains(a)&&o.removeChild(a),o.childNodes.length<=0&&((d=o.parentElement)==null||d.removeChild(o)))});let u=ns();return c?!o||!a?null:Tl.createPortal(u({ourProps:{ref:s},theirProps:r,slot:{},defaultTag:fF,name:"Portal"}),a):null});function sue(t,e){let r=Qn(e),{enabled:n=!0,...s}=t,i=ns();return n?Re.createElement(nue,{...s,ref:r}):i({ourProps:{ref:r},theirProps:s,slot:{},defaultTag:fF,name:"Portal"})}let iue=k.Fragment,pF=k.createContext(null);function oue(t,e){let{target:r,...n}=t,s={ref:Qn(e)},i=ns();return Re.createElement(pF.Provider,{value:r},i({ourProps:s,theirProps:n,defaultTag:iue,name:"Popover.Group"}))}let db=k.createContext(null);function aue(){let t=k.useContext(db),e=k.useRef([]),r=st(i=>(e.current.push(i),t&&t.register(i),()=>n(i))),n=st(i=>{let o=e.current.indexOf(i);o!==-1&&e.current.splice(o,1),t&&t.unregister(i)}),s=k.useMemo(()=>({register:r,unregister:n,portals:e}),[r,n,e]);return[e,k.useMemo(()=>function({children:i}){return Re.createElement(db.Provider,{value:s},i)},[s])]}let lue=wn(sue),cue=wn(oue),uue=Object.assign(lue,{Group:cue});function due({defaultContainers:t=[],portals:e,mainTreeNode:r}={}){let n=cc(r),s=st(()=>{var i,o;let a=[];for(let l of t)l!==null&&(l instanceof HTMLElement?a.push(l):"current"in l&&l.current instanceof HTMLElement&&a.push(l.current));if(e!=null&&e.current)for(let l of e.current)a.push(l);for(let l of(i=n?.querySelectorAll("html > *, body > *"))!=null?i:[])l!==document.body&&l!==document.head&&l instanceof HTMLElement&&l.id!=="headlessui-portal-root"&&(r&&(l.contains(r)||l.contains((o=r?.getRootNode())==null?void 0:o.host))||a.some(c=>l.contains(c))||a.push(l));return a});return{resolveContainers:s,contains:st(i=>s().some(o=>o.contains(i)))}}let mF=k.createContext(null);function gF({children:t,node:e}){let[r,n]=k.useState(null),s=vF(e??r);return Re.createElement(mF.Provider,{value:s},t,s===null&&Re.createElement(am,{features:vd.Hidden,ref:i=>{var o,a;if(i){for(let l of(a=(o=eh(i))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?a:[])if(l!==document.body&&l!==document.head&&l instanceof HTMLElement&&l!=null&&l.contains(i)){n(l);break}}}}))}function vF(t=null){var e;return(e=k.useContext(mF))!=null?e:t}function hue(){let t=k.useRef(!1);return rr(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var fi=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(fi||{});function yF(){let t=k.useRef(0);return KB(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function _F(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||((e=t.as)!=null?e:wF)!==k.Fragment||Re.Children.count(t.children)===1}let Dg=k.createContext(null);Dg.displayName="TransitionContext";var fue=(t=>(t.Visible="visible",t.Hidden="hidden",t))(fue||{});function pue(){let t=k.useContext(Dg);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function mue(){let t=k.useContext(Mg);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let Mg=k.createContext(null);Mg.displayName="NestingContext";function Lg(t){return"children"in t?Lg(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function bF(t,e){let r=Si(t),n=k.useRef([]),s=hue(),i=kg(),o=st((f,v=Wi.Hidden)=>{let m=n.current.findIndex(({el:p})=>p===f);m!==-1&&(Fn(v,{[Wi.Unmount](){n.current.splice(m,1)},[Wi.Hidden](){n.current[m].state="hidden"}}),i.microTask(()=>{var p;!Lg(n)&&s.current&&((p=r.current)==null||p.call(r))}))}),a=st(f=>{let v=n.current.find(({el:m})=>m===f);return v?v.state!=="visible"&&(v.state="visible"):n.current.push({el:f,state:"visible"}),()=>o(f,Wi.Unmount)}),l=k.useRef([]),c=k.useRef(Promise.resolve()),u=k.useRef({enter:[],leave:[]}),d=st((f,v,m)=>{l.current.splice(0),e&&(e.chains.current[v]=e.chains.current[v].filter(([p])=>p!==f)),e?.chains.current[v].push([f,new Promise(p=>{l.current.push(p)})]),e?.chains.current[v].push([f,new Promise(p=>{Promise.all(u.current[v].map(([g,y])=>y)).then(()=>p())})]),v==="enter"?c.current=c.current.then(()=>e?.wait.current).then(()=>m(v)):m(v)}),h=st((f,v,m)=>{Promise.all(u.current[v].splice(0).map(([p,g])=>g)).then(()=>{var p;(p=l.current.shift())==null||p()}).then(()=>m(v))});return k.useMemo(()=>({children:n,register:a,unregister:o,onStart:d,onStop:h,wait:c,chains:u}),[a,o,n,d,h,u,c])}let wF=k.Fragment,xF=Ul.RenderStrategy;function gue(t,e){var r,n;let{transition:s=!0,beforeEnter:i,afterEnter:o,beforeLeave:a,afterLeave:l,enter:c,enterFrom:u,enterTo:d,entered:h,leave:f,leaveFrom:v,leaveTo:m,...p}=t,[g,y]=k.useState(null),_=k.useRef(null),b=_F(t),w=Qn(...b?[_,e,y]:e===null?[]:[e]),E=(r=p.unmount)==null||r?Wi.Unmount:Wi.Hidden,{show:S,appear:x,initial:T}=pue(),[D,O]=k.useState(S?"visible":"hidden"),R=mue(),{register:P,unregister:A}=R;rr(()=>P(_),[P,_]),rr(()=>{if(E===Wi.Hidden&&_.current){if(S&&D!=="visible"){O("visible");return}return Fn(D,{hidden:()=>A(_),visible:()=>P(_)})}},[D,_,P,A,S,E]);let H=RS();rr(()=>{if(b&&H&&D==="visible"&&_.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[_,D,H,b]);let K=T&&!x,V=x&&S&&T,q=k.useRef(!1),I=bF(()=>{q.current||(O("hidden"),A(_))},R),$=st(re=>{q.current=!0;let F=re?"enter":"leave";I.onStart(_,F,X=>{X==="enter"?i?.():X==="leave"&&a?.()})}),j=st(re=>{let F=re?"enter":"leave";q.current=!1,I.onStop(_,F,X=>{X==="enter"?o?.():X==="leave"&&l?.()}),F==="leave"&&!Lg(I)&&(O("hidden"),A(_))});k.useEffect(()=>{b&&s||($(S),j(S))},[S,b,s]);let U=!(!s||!b||!H||K),[,J]=_S(U,g,S,{start:$,end:j}),ne=Fo({ref:w,className:((n=sb(p.className,V&&c,V&&u,J.enter&&c,J.enter&&J.closed&&u,J.enter&&!J.closed&&d,J.leave&&f,J.leave&&!J.closed&&v,J.leave&&J.closed&&m,!J.transition&&S&&h))==null?void 0:n.trim())||void 0,...yS(J)}),te=0;D==="visible"&&(te|=dn.Open),D==="hidden"&&(te|=dn.Closed),J.enter&&(te|=dn.Opening),J.leave&&(te|=dn.Closing);let me=ns();return Re.createElement(Mg.Provider,{value:I},Re.createElement(hF,{value:te},me({ourProps:ne,theirProps:p,defaultTag:wF,features:xF,visible:D==="visible",name:"Transition.Child"})))}function vue(t,e){let{show:r,appear:n=!1,unmount:s=!0,...i}=t,o=k.useRef(null),a=_F(t),l=Qn(...a?[o,e]:e===null?[]:[e]);RS();let c=Og();if(r===void 0&&c!==null&&(r=(c&dn.Open)===dn.Open),r===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,d]=k.useState(r?"visible":"hidden"),h=bF(()=>{r||d("hidden")}),[f,v]=k.useState(!0),m=k.useRef([r]);rr(()=>{f!==!1&&m.current[m.current.length-1]!==r&&(m.current.push(r),v(!1))},[m,r]);let p=k.useMemo(()=>({show:r,appear:n,initial:f}),[r,n,f]);rr(()=>{r?d("visible"):!Lg(h)&&o.current!==null&&d("hidden")},[r,h]);let g={unmount:s},y=st(()=>{var w;f&&v(!1),(w=t.beforeEnter)==null||w.call(t)}),_=st(()=>{var w;f&&v(!1),(w=t.beforeLeave)==null||w.call(t)}),b=ns();return Re.createElement(Mg.Provider,{value:h},Re.createElement(Dg.Provider,{value:p},b({ourProps:{...g,as:k.Fragment,children:Re.createElement(SF,{ref:l,...g,...i,beforeEnter:y,beforeLeave:_})},theirProps:{},defaultTag:k.Fragment,features:xF,visible:u==="visible",name:"Transition"})))}function yue(t,e){let r=k.useContext(Dg)!==null,n=Og()!==null;return Re.createElement(Re.Fragment,null,!r&&n?Re.createElement(hb,{ref:e,...t}):Re.createElement(SF,{ref:e,...t}))}let hb=wn(vue),SF=wn(gue),_ue=wn(yue),bue=Object.assign(hb,{Child:_ue,Root:hb});var wue=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(wue||{}),xue=(t=>(t[t.TogglePopover=0]="TogglePopover",t[t.ClosePopover=1]="ClosePopover",t[t.SetButton=2]="SetButton",t[t.SetButtonId=3]="SetButtonId",t[t.SetPanel=4]="SetPanel",t[t.SetPanelId=5]="SetPanelId",t))(xue||{});let Sue={0:t=>({...t,popoverState:Fn(t.popoverState,{0:1,1:0}),__demoMode:!1}),1(t){return t.popoverState===1?t:{...t,popoverState:1,__demoMode:!1}},2(t,e){return t.button===e.button?t:{...t,button:e.button}},3(t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},4(t,e){return t.panel===e.panel?t:{...t,panel:e.panel}},5(t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}}},PS=k.createContext(null);PS.displayName="PopoverContext";function Ng(t){let e=k.useContext(PS);if(e===null){let r=new Error(`<${t} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Ng),r}return e}let Bg=k.createContext(null);Bg.displayName="PopoverAPIContext";function IS(t){let e=k.useContext(Bg);if(e===null){let r=new Error(`<${t} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,IS),r}return e}let OS=k.createContext(null);OS.displayName="PopoverGroupContext";function EF(){return k.useContext(OS)}let Fg=k.createContext(null);Fg.displayName="PopoverPanelContext";function Eue(){return k.useContext(Fg)}function Cue(t,e){return Fn(e.type,Sue,t,e)}let kue="div";function Tue(t,e){var r;let{__demoMode:n=!1,...s}=t,i=k.useRef(null),o=Qn(e,UB(I=>{i.current=I})),a=k.useRef([]),l=k.useReducer(Cue,{__demoMode:n,popoverState:n?0:1,buttons:a,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:k.createRef(),afterPanelSentinel:k.createRef(),afterButtonSentinel:k.createRef()}),[{popoverState:c,button:u,buttonId:d,panel:h,panelId:f,beforePanelSentinel:v,afterPanelSentinel:m,afterButtonSentinel:p},g]=l,y=cc((r=i.current)!=null?r:u),_=k.useMemo(()=>{if(!u||!h)return!1;for(let te of document.querySelectorAll("body > *"))if(Number(te?.contains(u))^Number(te?.contains(h)))return!0;let I=Tg(),$=I.indexOf(u),j=($+I.length-1)%I.length,U=($+1)%I.length,J=I[j],ne=I[U];return!h.contains(J)&&!h.contains(ne)},[u,h]),b=Si(d),w=Si(f),E=k.useMemo(()=>({buttonId:b,panelId:w,close:()=>g({type:1})}),[b,w,g]),S=EF(),x=S?.registerPopover,T=st(()=>{var I;return(I=S?.isFocusWithinPopoverGroup())!=null?I:y?.activeElement&&(u?.contains(y.activeElement)||h?.contains(y.activeElement))});k.useEffect(()=>x?.(E),[x,E]);let[D,O]=aue(),R=vF(u),P=due({mainTreeNode:R,portals:D,defaultContainers:[u,h]});wle(y?.defaultView,"focus",I=>{var $,j,U,J,ne,te;I.target!==window&&I.target instanceof HTMLElement&&c===0&&(T()||u&&h&&(P.contains(I.target)||(j=($=v.current)==null?void 0:$.contains)!=null&&j.call($,I.target)||(J=(U=m.current)==null?void 0:U.contains)!=null&&J.call(U,I.target)||(te=(ne=p.current)==null?void 0:ne.contains)!=null&&te.call(ne,I.target)||g({type:1})))},!0),ble(c===0,P.resolveContainers,(I,$)=>{g({type:1}),zB($,vS.Loose)||(I.preventDefault(),u?.focus())});let A=st(I=>{g({type:1});let $=I?I instanceof HTMLElement?I:"current"in I&&I.current instanceof HTMLElement?I.current:u:u;$?.focus()}),H=k.useMemo(()=>({close:A,isPortalled:_}),[A,_]),K=k.useMemo(()=>({open:c===0,close:A}),[c,A]),V={ref:o},q=ns();return Re.createElement(gF,{node:R},Re.createElement(qce,null,Re.createElement(Fg.Provider,{value:null},Re.createElement(PS.Provider,{value:l},Re.createElement(Bg.Provider,{value:H},Re.createElement(ile,{value:A},Re.createElement(hF,{value:Fn(c,{0:dn.Open,1:dn.Closed})},Re.createElement(O,null,q({ourProps:V,theirProps:s,slot:K,defaultTag:kue,name:"Popover"})))))))))}let Aue="button";function Rue(t,e){let r=k.useId(),{id:n=`headlessui-popover-button-${r}`,disabled:s=!1,autoFocus:i=!1,...o}=t,[a,l]=Ng("Popover.Button"),{isPortalled:c}=IS("Popover.Button"),u=k.useRef(null),d=`headlessui-focus-sentinel-${k.useId()}`,h=EF(),f=h?.closeOthers,v=Eue()!==null;k.useEffect(()=>{if(!v)return l({type:3,buttonId:n}),()=>{l({type:3,buttonId:null})}},[v,n,l]);let[m]=k.useState(()=>Symbol()),p=Qn(u,e,zce(),st($=>{if(!v){if($)a.buttons.current.push(m);else{let j=a.buttons.current.indexOf(m);j!==-1&&a.buttons.current.splice(j,1)}a.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),$&&l({type:2,button:$})}})),g=Qn(u,e),y=cc(u),_=st($=>{var j,U,J;if(v){if(a.popoverState===1)return;switch($.key){case Fi.Space:case Fi.Enter:$.preventDefault(),(U=(j=$.target).click)==null||U.call(j),l({type:1}),(J=a.button)==null||J.focus();break}}else switch($.key){case Fi.Space:case Fi.Enter:$.preventDefault(),$.stopPropagation(),a.popoverState===1&&f?.(a.buttonId),l({type:0});break;case Fi.Escape:if(a.popoverState!==0)return f?.(a.buttonId);if(!u.current||y!=null&&y.activeElement&&!u.current.contains(y.activeElement))return;$.preventDefault(),$.stopPropagation(),l({type:1});break}}),b=st($=>{v||$.key===Fi.Space&&$.preventDefault()}),w=st($=>{var j,U;jB($.currentTarget)||s||(v?(l({type:1}),(j=a.button)==null||j.focus()):($.preventDefault(),$.stopPropagation(),a.popoverState===1&&f?.(a.buttonId),l({type:0}),(U=a.button)==null||U.focus()))}),E=st($=>{$.preventDefault(),$.stopPropagation()}),{isFocusVisible:S,focusProps:x}=Gae({autoFocus:i}),{isHovered:T,hoverProps:D}=Vae({isDisabled:s}),{pressed:O,pressProps:R}=Yae({disabled:s}),P=a.popoverState===0,A=k.useMemo(()=>({open:P,active:O||P,disabled:s,hover:T,focus:S,autofocus:i}),[P,T,S,O,s,i]),H=xle(t,a.button),K=ib(v?{ref:g,type:H,onKeyDown:_,onClick:w,disabled:s||void 0,autoFocus:i}:{ref:p,id:a.buttonId,type:H,"aria-expanded":a.popoverState===0,"aria-controls":a.panel?a.panelId:void 0,disabled:s||void 0,autoFocus:i,onKeyDown:_,onKeyUp:b,onClick:w,onMouseDown:E},x,D,R),V=yF(),q=st(()=>{let $=a.panel;if(!$)return;function j(){Fn(V.current,{[fi.Forwards]:()=>Wo($,hi.First),[fi.Backwards]:()=>Wo($,hi.Last)})===lm.Error&&Wo(Tg().filter(U=>U.dataset.headlessuiFocusGuard!=="true"),Fn(V.current,{[fi.Forwards]:hi.Next,[fi.Backwards]:hi.Previous}),{relativeTo:a.button})}j()}),I=ns();return Re.createElement(Re.Fragment,null,I({ourProps:K,theirProps:o,slot:A,defaultTag:Aue,name:"Popover.Button"}),P&&!v&&c&&Re.createElement(am,{id:d,ref:a.afterButtonSentinel,features:vd.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:q}))}let Pue="div",Iue=Ul.RenderStrategy|Ul.Static;function CF(t,e){let r=k.useId(),{id:n=`headlessui-popover-backdrop-${r}`,transition:s=!1,...i}=t,[{popoverState:o},a]=Ng("Popover.Backdrop"),[l,c]=k.useState(null),u=Qn(e,c),d=Og(),[h,f]=_S(s,l,d!==null?(d&dn.Open)===dn.Open:o===0),v=st(g=>{if(jB(g.currentTarget))return g.preventDefault();a({type:1})}),m=k.useMemo(()=>({open:o===0}),[o]),p={ref:u,id:n,"aria-hidden":!0,onClick:v,...yS(f)};return ns()({ourProps:p,theirProps:i,slot:m,defaultTag:Pue,features:Iue,visible:h,name:"Popover.Backdrop"})}let Oue="div",Due=Ul.RenderStrategy|Ul.Static;function Mue(t,e){let r=k.useId(),{id:n=`headlessui-popover-panel-${r}`,focus:s=!1,anchor:i,portal:o=!1,modal:a=!1,transition:l=!1,...c}=t,[u,d]=Ng("Popover.Panel"),{close:h,isPortalled:f}=IS("Popover.Panel"),v=`headlessui-focus-sentinel-before-${r}`,m=`headlessui-focus-sentinel-after-${r}`,p=k.useRef(null),g=Gce(i),[y,_]=Kce(g),b=Wce();g&&(o=!0);let[w,E]=k.useState(null),S=Qn(p,e,g?y:null,st($=>d({type:4,panel:$})),E),x=cc(p);rr(()=>(d({type:5,panelId:n}),()=>{d({type:5,panelId:null})}),[n,d]);let T=Og(),[D,O]=_S(l,w,T!==null?(T&dn.Open)===dn.Open:u.popoverState===0);ule(D,u.button,()=>{d({type:1})});let R=u.__demoMode?!1:a&&D;Ale(R,x);let P=st($=>{var j;switch($.key){case Fi.Escape:if(u.popoverState!==0||!p.current||x!=null&&x.activeElement&&!p.current.contains(x.activeElement))return;$.preventDefault(),$.stopPropagation(),d({type:1}),(j=u.button)==null||j.focus();break}});k.useEffect(()=>{var $;t.static||u.popoverState===1&&(($=t.unmount)==null||$)&&d({type:4,panel:null})},[u.popoverState,t.unmount,t.static,d]),k.useEffect(()=>{if(u.__demoMode||!s||u.popoverState!==0||!p.current)return;let $=x?.activeElement;p.current.contains($)||Wo(p.current,hi.First)},[u.__demoMode,s,p.current,u.popoverState]);let A=k.useMemo(()=>({open:u.popoverState===0,close:h}),[u.popoverState,h]),H=ib(g?b():{},{ref:S,id:n,onKeyDown:P,onBlur:s&&u.popoverState===0?$=>{var j,U,J,ne,te;let me=$.relatedTarget;me&&p.current&&((j=p.current)!=null&&j.contains(me)||(d({type:1}),((J=(U=u.beforePanelSentinel.current)==null?void 0:U.contains)!=null&&J.call(U,me)||(te=(ne=u.afterPanelSentinel.current)==null?void 0:ne.contains)!=null&&te.call(ne,me))&&me.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...c.style,..._,"--button-width":ale(u.button,!0).width},...yS(O)}),K=yF(),V=st(()=>{let $=p.current;if(!$)return;function j(){Fn(K.current,{[fi.Forwards]:()=>{var U;Wo($,hi.First)===lm.Error&&((U=u.afterPanelSentinel.current)==null||U.focus())},[fi.Backwards]:()=>{var U;(U=u.button)==null||U.focus({preventScroll:!0})}})}j()}),q=st(()=>{let $=p.current;if(!$)return;function j(){Fn(K.current,{[fi.Forwards]:()=>{if(!u.button)return;let U=Tg(),J=U.indexOf(u.button),ne=U.slice(0,J+1),te=[...U.slice(J+1),...ne];for(let me of te.slice())if(me.dataset.headlessuiFocusGuard==="true"||w!=null&&w.contains(me)){let re=te.indexOf(me);re!==-1&&te.splice(re,1)}Wo(te,hi.First,{sorted:!1})},[fi.Backwards]:()=>{var U;Wo($,hi.Previous)===lm.Error&&((U=u.button)==null||U.focus())}})}j()}),I=ns();return Re.createElement(Zce,null,Re.createElement(Fg.Provider,{value:n},Re.createElement(Bg.Provider,{value:{close:h,isPortalled:f}},Re.createElement(uue,{enabled:o?t.static||D:!1},D&&f&&Re.createElement(am,{id:v,ref:u.beforePanelSentinel,features:vd.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:V}),I({ourProps:H,theirProps:c,slot:A,defaultTag:Oue,features:Due,visible:D,name:"Popover.Panel"}),D&&f&&Re.createElement(am,{id:m,ref:u.afterPanelSentinel,features:vd.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:q})))))}let Lue="div";function Nue(t,e){let r=k.useRef(null),n=Qn(r,e),[s,i]=k.useState([]),o=st(m=>{i(p=>{let g=p.indexOf(m);if(g!==-1){let y=p.slice();return y.splice(g,1),y}return p})}),a=st(m=>(i(p=>[...p,m]),()=>o(m))),l=st(()=>{var m;let p=eh(r);if(!p)return!1;let g=p.activeElement;return(m=r.current)!=null&&m.contains(g)?!0:s.some(y=>{var _,b;return((_=p.getElementById(y.buttonId.current))==null?void 0:_.contains(g))||((b=p.getElementById(y.panelId.current))==null?void 0:b.contains(g))})}),c=st(m=>{for(let p of s)p.buttonId.current!==m&&p.close()}),u=k.useMemo(()=>({registerPopover:a,unregisterPopover:o,isFocusWithinPopoverGroup:l,closeOthers:c}),[a,o,l,c]),d=k.useMemo(()=>({}),[]),h=t,f={ref:n},v=ns();return Re.createElement(gF,null,Re.createElement(OS.Provider,{value:u},v({ourProps:f,theirProps:h,slot:d,defaultTag:Lue,name:"Popover.Group"})))}let Bue=wn(Tue),Fue=wn(Rue),jue=wn(CF),$ue=wn(CF),Uue=wn(Mue),Hue=wn(Nue),Py=Object.assign(Bue,{Button:Fue,Backdrop:$ue,Overlay:jue,Panel:Uue,Group:Hue});const kF=t=>({js:"javascript",jsx:"jsx",ts:"typescript",tsx:"tsx",json:"json",html:"html",css:"css",py:"python",java:"java",rb:"ruby",cpp:"cpp",c:"c",cs:"csharp",go:"go",rs:"rust",php:"php",swift:"swift",md:"plaintext",sh:"bash"})[t]||"typescript",TF=[{id:"abap",name:"ABAP",import:()=>ee(()=>import("./abap-DsBKuouk.js"),[])},{id:"actionscript-3",name:"ActionScript",import:()=>ee(()=>import("./actionscript-3-D_z4Izcz.js"),[])},{id:"ada",name:"Ada",import:()=>ee(()=>import("./ada-727ZlQH0.js"),[])},{id:"angular-html",name:"Angular HTML",import:()=>ee(()=>import("./angular-html-LfdN0zeE.js").then(t=>t.f),__vite__mapDeps([0,1,2,3]))},{id:"angular-ts",name:"Angular TypeScript",import:()=>ee(()=>import("./angular-ts-CKsD7JZE.js"),__vite__mapDeps([4,0,1,2,3,5]))},{id:"apache",name:"Apache Conf",import:()=>ee(()=>import("./apache-Dn00JSTd.js"),[])},{id:"apex",name:"Apex",import:()=>ee(()=>import("./apex-COJ4H7py.js"),[])},{id:"apl",name:"APL",import:()=>ee(()=>import("./apl-BBq3IX1j.js"),__vite__mapDeps([6,1,2,3,7,8,9]))},{id:"applescript",name:"AppleScript",import:()=>ee(()=>import("./applescript-Bu5BbsvL.js"),[])},{id:"ara",name:"Ara",import:()=>ee(()=>import("./ara-7O62HKoU.js"),[])},{id:"asciidoc",name:"AsciiDoc",aliases:["adoc"],import:()=>ee(()=>import("./asciidoc-BPT9niGB.js"),[])},{id:"asm",name:"Assembly",import:()=>ee(()=>import("./asm-Dhn9LcZ4.js"),[])},{id:"astro",name:"Astro",import:()=>ee(()=>import("./astro-CqkE3fuf.js"),__vite__mapDeps([10,9,2,11,3,12]))},{id:"awk",name:"AWK",import:()=>ee(()=>import("./awk-eg146-Ew.js"),[])},{id:"ballerina",name:"Ballerina",import:()=>ee(()=>import("./ballerina-Du268qiB.js"),[])},{id:"bat",name:"Batch File",aliases:["batch"],import:()=>ee(()=>import("./bat-fje9CFhw.js"),[])},{id:"beancount",name:"Beancount",import:()=>ee(()=>import("./beancount-BwXTMy5W.js"),[])},{id:"berry",name:"Berry",aliases:["be"],import:()=>ee(()=>import("./berry-3xVqZejG.js"),[])},{id:"bibtex",name:"BibTeX",import:()=>ee(()=>import("./bibtex-xW4inM5L.js"),[])},{id:"bicep",name:"Bicep",import:()=>ee(()=>import("./bicep-DHo0CJ0O.js"),[])},{id:"blade",name:"Blade",import:()=>ee(()=>import("./blade-a8OxSdnT.js"),__vite__mapDeps([13,1,2,3,7,8,14,9]))},{id:"bsl",name:"1C (Enterprise)",aliases:["1c"],import:()=>ee(()=>import("./bsl-Dgyn0ogV.js"),__vite__mapDeps([15,16]))},{id:"c",name:"C",import:()=>ee(()=>import("./c-C3t2pwGQ.js"),[])},{id:"cadence",name:"Cadence",aliases:["cdc"],import:()=>ee(()=>import("./cadence-DNquZEk8.js"),[])},{id:"cairo",name:"Cairo",import:()=>ee(()=>import("./cairo--RitsXJZ.js"),__vite__mapDeps([17,18]))},{id:"clarity",name:"Clarity",import:()=>ee(()=>import("./clarity-BHOwM8T6.js"),[])},{id:"clojure",name:"Clojure",aliases:["clj"],import:()=>ee(()=>import("./clojure-DxSadP1t.js"),[])},{id:"cmake",name:"CMake",import:()=>ee(()=>import("./cmake-DbXoA79R.js"),[])},{id:"cobol",name:"COBOL",import:()=>ee(()=>import("./cobol-PTqiYgYu.js"),__vite__mapDeps([19,1,2,3,8]))},{id:"codeowners",name:"CODEOWNERS",import:()=>ee(()=>import("./codeowners-Bp6g37R7.js"),[])},{id:"codeql",name:"CodeQL",aliases:["ql"],import:()=>ee(()=>import("./codeql-sacFqUAJ.js"),[])},{id:"coffee",name:"CoffeeScript",aliases:["coffeescript"],import:()=>ee(()=>import("./coffee-dyiR41kL.js"),__vite__mapDeps([20,2]))},{id:"common-lisp",name:"Common Lisp",aliases:["lisp"],import:()=>ee(()=>import("./common-lisp-C7gG9l05.js"),[])},{id:"coq",name:"Coq",import:()=>ee(()=>import("./coq-Dsg_Bt_b.js"),[])},{id:"cpp",name:"C++",aliases:["c++"],import:()=>ee(()=>import("./cpp-BksuvNSY.js"),__vite__mapDeps([21,22,23,24,14]))},{id:"crystal",name:"Crystal",import:()=>ee(()=>import("./crystal-DtDmRg-F.js"),__vite__mapDeps([25,1,2,3,14,24,26]))},{id:"csharp",name:"C#",aliases:["c#","cs"],import:()=>ee(()=>import("./csharp-D9R-vmeu.js"),[])},{id:"css",name:"CSS",import:()=>ee(()=>import("./css-BPhBrDlE.js"),[])},{id:"csv",name:"CSV",import:()=>ee(()=>import("./csv-B0qRVHPH.js"),[])},{id:"cue",name:"CUE",import:()=>ee(()=>import("./cue-DtFQj3wx.js"),[])},{id:"cypher",name:"Cypher",aliases:["cql"],import:()=>ee(()=>import("./cypher-m2LEI-9-.js"),[])},{id:"d",name:"D",import:()=>ee(()=>import("./d-BoXegm-a.js"),[])},{id:"dart",name:"Dart",import:()=>ee(()=>import("./dart-B9wLZaAG.js"),[])},{id:"dax",name:"DAX",import:()=>ee(()=>import("./dax-ClGRhx96.js"),[])},{id:"desktop",name:"Desktop",import:()=>ee(()=>import("./desktop-DEIpsLCJ.js"),[])},{id:"diff",name:"Diff",import:()=>ee(()=>import("./diff-BgYniUM_.js"),[])},{id:"docker",name:"Dockerfile",aliases:["dockerfile"],import:()=>ee(()=>import("./docker-COcR7UxN.js"),[])},{id:"dotenv",name:"dotEnv",import:()=>ee(()=>import("./dotenv-BI07GJ_i.js"),__vite__mapDeps([27,28,29]))},{id:"dream-maker",name:"Dream Maker",import:()=>ee(()=>import("./dream-maker-C-nORZOA.js"),[])},{id:"edge",name:"Edge",import:()=>ee(()=>import("./edge-D5gP-w-T.js"),__vite__mapDeps([30,11,1,2,3,31]))},{id:"elixir",name:"Elixir",import:()=>ee(()=>import("./elixir-CLiX3zqd.js"),__vite__mapDeps([32,1,2,3]))},{id:"elm",name:"Elm",import:()=>ee(()=>import("./elm-CmHSxxaM.js"),__vite__mapDeps([33,23,24]))},{id:"emacs-lisp",name:"Emacs Lisp",aliases:["elisp"],import:()=>ee(()=>import("./emacs-lisp-BX77sIaO.js"),[])},{id:"erb",name:"ERB",import:()=>ee(()=>import("./erb-BYTLMnw6.js"),__vite__mapDeps([34,1,2,3,35,36,7,8,14,37,11,38,39,21,22,23,24,26,40,41]))},{id:"erlang",name:"Erlang",aliases:["erl"],import:()=>ee(()=>import("./erlang-B-DoSBHF.js"),[])},{id:"fennel",name:"Fennel",import:()=>ee(()=>import("./fennel-bCA53EVm.js"),[])},{id:"fish",name:"Fish",import:()=>ee(()=>import("./fish-w-ucz2PV.js"),[])},{id:"fluent",name:"Fluent",aliases:["ftl"],import:()=>ee(()=>import("./fluent-Dayu4EKP.js"),[])},{id:"fortran-fixed-form",name:"Fortran (Fixed Form)",aliases:["f","for","f77"],import:()=>ee(()=>import("./fortran-fixed-form-TqA4NnZg.js"),__vite__mapDeps([42,43]))},{id:"fortran-free-form",name:"Fortran (Free Form)",aliases:["f90","f95","f03","f08","f18"],import:()=>ee(()=>import("./fortran-free-form-DKXYxT9g.js"),[])},{id:"fsharp",name:"F#",aliases:["f#","fs"],import:()=>ee(()=>import("./fsharp-XplgxFYe.js"),__vite__mapDeps([44,45]))},{id:"gdresource",name:"GDResource",import:()=>ee(()=>import("./gdresource-BHYsBjWJ.js"),__vite__mapDeps([46,47,48]))},{id:"gdscript",name:"GDScript",import:()=>ee(()=>import("./gdscript-DfxzS6Rs.js"),[])},{id:"gdshader",name:"GDShader",import:()=>ee(()=>import("./gdshader-SKMF96pI.js"),[])},{id:"genie",name:"Genie",import:()=>ee(()=>import("./genie-ajMbGru0.js"),[])},{id:"gherkin",name:"Gherkin",import:()=>ee(()=>import("./gherkin--30QC5Em.js"),[])},{id:"git-commit",name:"Git Commit Message",import:()=>ee(()=>import("./git-commit-i4q6IMui.js"),__vite__mapDeps([49,50]))},{id:"git-rebase",name:"Git Rebase Message",import:()=>ee(()=>import("./git-rebase-B-v9cOL2.js"),__vite__mapDeps([51,26]))},{id:"gleam",name:"Gleam",import:()=>ee(()=>import("./gleam-B430Bg39.js"),[])},{id:"glimmer-js",name:"Glimmer JS",aliases:["gjs"],import:()=>ee(()=>import("./glimmer-js-D-cwc0-E.js"),__vite__mapDeps([52,2,11,3,1]))},{id:"glimmer-ts",name:"Glimmer TS",aliases:["gts"],import:()=>ee(()=>import("./glimmer-ts-pgjy16dm.js"),__vite__mapDeps([53,11,3,2,1]))},{id:"glsl",name:"GLSL",import:()=>ee(()=>import("./glsl-DBO2IWDn.js"),__vite__mapDeps([23,24]))},{id:"gnuplot",name:"Gnuplot",import:()=>ee(()=>import("./gnuplot-CM8KxXT1.js"),[])},{id:"go",name:"Go",import:()=>ee(()=>import("./go-B1SYOhNW.js"),[])},{id:"graphql",name:"GraphQL",aliases:["gql"],import:()=>ee(()=>import("./graphql-cDcHW_If.js"),__vite__mapDeps([37,2,11,38,39]))},{id:"groovy",name:"Groovy",import:()=>ee(()=>import("./groovy-DkBy-JyN.js"),[])},{id:"hack",name:"Hack",import:()=>ee(()=>import("./hack-D1yCygmZ.js"),__vite__mapDeps([54,1,2,3,14]))},{id:"haml",name:"Ruby Haml",import:()=>ee(()=>import("./haml-B2EZWmdv.js"),__vite__mapDeps([36,2,3]))},{id:"handlebars",name:"Handlebars",aliases:["hbs"],import:()=>ee(()=>import("./handlebars-BQGss363.js"),__vite__mapDeps([55,1,2,3,41]))},{id:"haskell",name:"Haskell",aliases:["hs"],import:()=>ee(()=>import("./haskell-BILxekzW.js"),[])},{id:"haxe",name:"Haxe",import:()=>ee(()=>import("./haxe-C5wWYbrZ.js"),[])},{id:"hcl",name:"HashiCorp HCL",import:()=>ee(()=>import("./hcl-HzYwdGDm.js"),[])},{id:"hjson",name:"Hjson",import:()=>ee(()=>import("./hjson-T-Tgc4AT.js"),[])},{id:"hlsl",name:"HLSL",import:()=>ee(()=>import("./hlsl-ifBTmRxC.js"),[])},{id:"html",name:"HTML",import:()=>ee(()=>import("./html-C2L_23MC.js"),__vite__mapDeps([1,2,3]))},{id:"html-derivative",name:"HTML (Derivative)",import:()=>ee(()=>import("./html-derivative-CSfWNPLT.js"),__vite__mapDeps([31,1,2,3]))},{id:"http",name:"HTTP",import:()=>ee(()=>import("./http-FRrOvY1W.js"),__vite__mapDeps([56,26,9,7,8,37,2,11,38,39]))},{id:"hxml",name:"HXML",import:()=>ee(()=>import("./hxml-TIA70rKU.js"),__vite__mapDeps([57,58]))},{id:"hy",name:"Hy",import:()=>ee(()=>import("./hy-BMj5Y0dO.js"),[])},{id:"imba",name:"Imba",import:()=>ee(()=>import("./imba-bv_oIlVt.js"),__vite__mapDeps([59,11]))},{id:"ini",name:"INI",aliases:["properties"],import:()=>ee(()=>import("./ini-BjABl1g7.js"),[])},{id:"java",name:"Java",import:()=>ee(()=>import("./java-xI-RfyKK.js"),[])},{id:"javascript",name:"JavaScript",aliases:["js"],import:()=>ee(()=>import("./javascript-ySlJ1b_l.js"),[])},{id:"jinja",name:"Jinja",import:()=>ee(()=>import("./jinja-DGy0s7-h.js"),__vite__mapDeps([60,1,2,3]))},{id:"jison",name:"Jison",import:()=>ee(()=>import("./jison-BqZprYcd.js"),__vite__mapDeps([61,2]))},{id:"json",name:"JSON",import:()=>ee(()=>import("./json-BQoSv7ci.js"),[])},{id:"json5",name:"JSON5",import:()=>ee(()=>import("./json5-w8dY5SsB.js"),[])},{id:"jsonc",name:"JSON with Comments",import:()=>ee(()=>import("./jsonc-TU54ms6u.js"),[])},{id:"jsonl",name:"JSON Lines",import:()=>ee(()=>import("./jsonl-DREVFZK8.js"),[])},{id:"jsonnet",name:"Jsonnet",import:()=>ee(()=>import("./jsonnet-BfivnA6A.js"),[])},{id:"jssm",name:"JSSM",aliases:["fsl"],import:()=>ee(()=>import("./jssm-P4WzXJd0.js"),[])},{id:"jsx",name:"JSX",import:()=>ee(()=>import("./jsx-BAng5TT0.js"),[])},{id:"julia",name:"Julia",aliases:["jl"],import:()=>ee(()=>import("./julia-BBuGR-5E.js"),__vite__mapDeps([62,21,22,23,24,14,18,2,63]))},{id:"kotlin",name:"Kotlin",aliases:["kt","kts"],import:()=>ee(()=>import("./kotlin-B5lbUyaz.js"),[])},{id:"kusto",name:"Kusto",aliases:["kql"],import:()=>ee(()=>import("./kusto-mebxcVVE.js"),[])},{id:"latex",name:"LaTeX",import:()=>ee(()=>import("./latex-C-cWTeAZ.js"),__vite__mapDeps([64,65,63]))},{id:"lean",name:"Lean 4",aliases:["lean4"],import:()=>ee(()=>import("./lean-XBlWyCtg.js"),[])},{id:"less",name:"Less",import:()=>ee(()=>import("./less-BfCpw3nA.js"),[])},{id:"liquid",name:"Liquid",import:()=>ee(()=>import("./liquid-D3W5UaiH.js"),__vite__mapDeps([66,1,2,3,9]))},{id:"log",name:"Log file",import:()=>ee(()=>import("./log-Cc5clBb7.js"),[])},{id:"logo",name:"Logo",import:()=>ee(()=>import("./logo-IuBKFhSY.js"),[])},{id:"lua",name:"Lua",import:()=>ee(()=>import("./lua-CvWAzNxB.js"),__vite__mapDeps([40,24]))},{id:"luau",name:"Luau",import:()=>ee(()=>import("./luau-Du5NY7AG.js"),[])},{id:"make",name:"Makefile",aliases:["makefile"],import:()=>ee(()=>import("./make-Bvotw-X0.js"),[])},{id:"markdown",name:"Markdown",aliases:["md"],import:()=>ee(()=>import("./markdown-UIAJJxZW.js"),[])},{id:"marko",name:"Marko",import:()=>ee(()=>import("./marko-z0MBrx5-.js"),__vite__mapDeps([67,3,68,5,2]))},{id:"matlab",name:"MATLAB",import:()=>ee(()=>import("./matlab-D9-PGadD.js"),[])},{id:"mdc",name:"MDC",import:()=>ee(()=>import("./mdc-DB_EDNY_.js"),__vite__mapDeps([69,45,41,31,1,2,3]))},{id:"mdx",name:"MDX",import:()=>ee(()=>import("./mdx-sdHcTMYB.js"),[])},{id:"mermaid",name:"Mermaid",aliases:["mmd"],import:()=>ee(()=>import("./mermaid-Ci6OQyBP.js"),[])},{id:"mipsasm",name:"MIPS Assembly",aliases:["mips"],import:()=>ee(()=>import("./mipsasm-BC5c_5Pe.js"),[])},{id:"mojo",name:"Mojo",import:()=>ee(()=>import("./mojo-Tz6hzZYG.js"),[])},{id:"move",name:"Move",import:()=>ee(()=>import("./move-DB_GagMm.js"),[])},{id:"narrat",name:"Narrat Language",aliases:["nar"],import:()=>ee(()=>import("./narrat-DLbgOhZU.js"),[])},{id:"nextflow",name:"Nextflow",aliases:["nf"],import:()=>ee(()=>import("./nextflow-B0XVJmRM.js"),[])},{id:"nginx",name:"Nginx",import:()=>ee(()=>import("./nginx-D_VnBJ67.js"),__vite__mapDeps([70,40,24]))},{id:"nim",name:"Nim",import:()=>ee(()=>import("./nim-ZlGxZxc3.js"),__vite__mapDeps([71,24,1,2,3,7,8,23,45]))},{id:"nix",name:"Nix",import:()=>ee(()=>import("./nix-shcSOmrb.js"),[])},{id:"nushell",name:"nushell",aliases:["nu"],import:()=>ee(()=>import("./nushell-D4Tzg5kh.js"),[])},{id:"objective-c",name:"Objective-C",aliases:["objc"],import:()=>ee(()=>import("./objective-c-Deuh7S70.js"),[])},{id:"objective-cpp",name:"Objective-C++",import:()=>ee(()=>import("./objective-cpp-BUEGK8hf.js"),[])},{id:"ocaml",name:"OCaml",import:()=>ee(()=>import("./ocaml-BNioltXt.js"),[])},{id:"pascal",name:"Pascal",import:()=>ee(()=>import("./pascal-JqZropPD.js"),[])},{id:"perl",name:"Perl",import:()=>ee(()=>import("./perl-CHQXSrWU.js"),__vite__mapDeps([72,1,2,3,7,8,14]))},{id:"php",name:"PHP",import:()=>ee(()=>import("./php-B5ebYQev.js"),__vite__mapDeps([73,1,2,3,7,8,14,9]))},{id:"plsql",name:"PL/SQL",import:()=>ee(()=>import("./plsql-LKU2TuZ1.js"),[])},{id:"po",name:"Gettext PO",aliases:["pot","potx"],import:()=>ee(()=>import("./po-BFLt1xDp.js"),[])},{id:"polar",name:"Polar",import:()=>ee(()=>import("./polar-DKykz6zU.js"),[])},{id:"postcss",name:"PostCSS",import:()=>ee(()=>import("./postcss-B3ZDOciz.js"),[])},{id:"powerquery",name:"PowerQuery",import:()=>ee(()=>import("./powerquery-CSHBycmS.js"),[])},{id:"powershell",name:"PowerShell",aliases:["ps","ps1"],import:()=>ee(()=>import("./powershell-BIEUsx6d.js"),[])},{id:"prisma",name:"Prisma",import:()=>ee(()=>import("./prisma-B48N-Iqd.js"),[])},{id:"prolog",name:"Prolog",import:()=>ee(()=>import("./prolog-BY-TUvya.js"),[])},{id:"proto",name:"Protocol Buffer 3",aliases:["protobuf"],import:()=>ee(()=>import("./proto-zocC4JxJ.js"),[])},{id:"pug",name:"Pug",aliases:["jade"],import:()=>ee(()=>import("./pug-CM9l7STV.js"),__vite__mapDeps([74,2,3,1]))},{id:"puppet",name:"Puppet",import:()=>ee(()=>import("./puppet-Cza_XSSt.js"),[])},{id:"purescript",name:"PureScript",import:()=>ee(()=>import("./purescript-Bg-kzb6g.js"),[])},{id:"python",name:"Python",aliases:["py"],import:()=>ee(()=>import("./python-DhUJRlN_.js"),[])},{id:"qml",name:"QML",import:()=>ee(()=>import("./qml-D8XfuvdV.js"),__vite__mapDeps([75,2]))},{id:"qmldir",name:"QML Directory",import:()=>ee(()=>import("./qmldir-C8lEn-DE.js"),[])},{id:"qss",name:"Qt Style Sheets",import:()=>ee(()=>import("./qss-DhMKtDLN.js"),[])},{id:"r",name:"R",import:()=>ee(()=>import("./r-CwjWoCRV.js"),[])},{id:"racket",name:"Racket",import:()=>ee(()=>import("./racket-CzouJOBO.js"),[])},{id:"raku",name:"Raku",aliases:["perl6"],import:()=>ee(()=>import("./raku-B1bQXN8T.js"),[])},{id:"razor",name:"ASP.NET Razor",import:()=>ee(()=>import("./razor-CNLDkMZG.js"),__vite__mapDeps([76,1,2,3,77]))},{id:"reg",name:"Windows Registry Script",import:()=>ee(()=>import("./reg-5LuOXUq_.js"),[])},{id:"regexp",name:"RegExp",aliases:["regex"],import:()=>ee(()=>import("./regexp-DWJ3fJO_.js"),[])},{id:"rel",name:"Rel",import:()=>ee(()=>import("./rel-DJlmqQ1C.js"),[])},{id:"riscv",name:"RISC-V",import:()=>ee(()=>import("./riscv-QhoSD0DR.js"),[])},{id:"rst",name:"reStructuredText",import:()=>ee(()=>import("./rst-4NLicBqY.js"),__vite__mapDeps([78,31,1,2,3,21,22,23,24,14,18,26,41,79,35,36,7,8,37,11,38,39,40]))},{id:"ruby",name:"Ruby",aliases:["rb"],import:()=>ee(()=>import("./ruby-DeZ3UC14.js"),__vite__mapDeps([35,1,2,3,36,7,8,14,37,11,38,39,21,22,23,24,26,40,41]))},{id:"rust",name:"Rust",aliases:["rs"],import:()=>ee(()=>import("./rust-Be6lgOlo.js"),[])},{id:"sas",name:"SAS",import:()=>ee(()=>import("./sas-BmTFh92c.js"),__vite__mapDeps([80,14]))},{id:"sass",name:"Sass",import:()=>ee(()=>import("./sass-BJ4Li9vH.js"),[])},{id:"scala",name:"Scala",import:()=>ee(()=>import("./scala-DQVVAn-B.js"),[])},{id:"scheme",name:"Scheme",import:()=>ee(()=>import("./scheme-BJGe-b2p.js"),[])},{id:"scss",name:"SCSS",import:()=>ee(()=>import("./scss-C31hgJw-.js"),__vite__mapDeps([5,3]))},{id:"sdbl",name:"1C (Query)",aliases:["1c-query"],import:()=>ee(()=>import("./sdbl-BLhTXw86.js"),[])},{id:"shaderlab",name:"ShaderLab",aliases:["shader"],import:()=>ee(()=>import("./shaderlab-B7qAK45m.js"),__vite__mapDeps([81,82]))},{id:"shellscript",name:"Shell",aliases:["bash","sh","shell","zsh"],import:()=>ee(()=>import("./shellscript-atvbtKCR.js"),[])},{id:"shellsession",name:"Shell Session",aliases:["console"],import:()=>ee(()=>import("./shellsession-C_rIy8kc.js"),__vite__mapDeps([83,26]))},{id:"smalltalk",name:"Smalltalk",import:()=>ee(()=>import("./smalltalk-DkLiglaE.js"),[])},{id:"solidity",name:"Solidity",import:()=>ee(()=>import("./solidity-C1w2a3ep.js"),[])},{id:"soy",name:"Closure Templates",aliases:["closure-templates"],import:()=>ee(()=>import("./soy-C-lX7w71.js"),__vite__mapDeps([84,1,2,3]))},{id:"sparql",name:"SPARQL",import:()=>ee(()=>import("./sparql-bYkjHRlG.js"),__vite__mapDeps([85,86]))},{id:"splunk",name:"Splunk Query Language",aliases:["spl"],import:()=>ee(()=>import("./splunk-Cf8iN4DR.js"),[])},{id:"sql",name:"SQL",import:()=>ee(()=>import("./sql-COK4E0Yg.js"),[])},{id:"ssh-config",name:"SSH Config",import:()=>ee(()=>import("./ssh-config-BknIz3MU.js"),[])},{id:"stata",name:"Stata",import:()=>ee(()=>import("./stata-DorPZHa4.js"),__vite__mapDeps([87,14]))},{id:"stylus",name:"Stylus",aliases:["styl"],import:()=>ee(()=>import("./stylus-BeQkCIfX.js"),[])},{id:"svelte",name:"Svelte",import:()=>ee(()=>import("./svelte-MSaWC3Je.js"),__vite__mapDeps([88,2,11,3,12]))},{id:"swift",name:"Swift",import:()=>ee(()=>import("./swift-BSxZ-RaX.js"),[])},{id:"system-verilog",name:"SystemVerilog",import:()=>ee(()=>import("./system-verilog-C7L56vO4.js"),[])},{id:"systemd",name:"Systemd Units",import:()=>ee(()=>import("./systemd-CUnW07Te.js"),[])},{id:"talonscript",name:"TalonScript",aliases:["talon"],import:()=>ee(()=>import("./talonscript-C1XDQQGZ.js"),[])},{id:"tasl",name:"Tasl",import:()=>ee(()=>import("./tasl-CQjiPCtT.js"),[])},{id:"tcl",name:"Tcl",import:()=>ee(()=>import("./tcl-DQ1-QYvQ.js"),[])},{id:"templ",name:"Templ",import:()=>ee(()=>import("./templ-dwX3ZSMB.js"),__vite__mapDeps([89,90,2,3]))},{id:"terraform",name:"Terraform",aliases:["tf","tfvars"],import:()=>ee(()=>import("./terraform-BbSNqyBO.js"),[])},{id:"tex",name:"TeX",import:()=>ee(()=>import("./tex-rYs2v40G.js"),__vite__mapDeps([65,63]))},{id:"toml",name:"TOML",import:()=>ee(()=>import("./toml-CB2ApiWb.js"),[])},{id:"ts-tags",name:"TypeScript with Tags",aliases:["lit"],import:()=>ee(()=>import("./ts-tags-CipyTH0X.js"),__vite__mapDeps([91,11,3,2,23,24,1,14,7,8]))},{id:"tsv",name:"TSV",import:()=>ee(()=>import("./tsv-B_m7g4N7.js"),[])},{id:"tsx",name:"TSX",import:()=>ee(()=>import("./tsx-B6W0miNI.js"),[])},{id:"turtle",name:"Turtle",import:()=>ee(()=>import("./turtle-BMR_PYu6.js"),[])},{id:"twig",name:"Twig",import:()=>ee(()=>import("./twig-NC5TFiHP.js"),__vite__mapDeps([92,3,2,5,73,1,7,8,14,9,18,35,36,37,11,38,39,21,22,23,24,26,40,41]))},{id:"typescript",name:"TypeScript",aliases:["ts"],import:()=>ee(()=>import("./typescript-Dj6nwHGl.js"),[])},{id:"typespec",name:"TypeSpec",aliases:["tsp"],import:()=>ee(()=>import("./typespec-BpWG_bgh.js"),[])},{id:"typst",name:"Typst",aliases:["typ"],import:()=>ee(()=>import("./typst-BVUVsWT6.js"),[])},{id:"v",name:"V",import:()=>ee(()=>import("./v-CAQ2eGtk.js"),[])},{id:"vala",name:"Vala",import:()=>ee(()=>import("./vala-BFOHcciG.js"),[])},{id:"vb",name:"Visual Basic",aliases:["cmd"],import:()=>ee(()=>import("./vb-CdO5JTpU.js"),[])},{id:"verilog",name:"Verilog",import:()=>ee(()=>import("./verilog-CJaU5se_.js"),[])},{id:"vhdl",name:"VHDL",import:()=>ee(()=>import("./vhdl-DYoNaHQp.js"),[])},{id:"viml",name:"Vim Script",aliases:["vim","vimscript"],import:()=>ee(()=>import("./viml-m4uW47V2.js"),[])},{id:"vue",name:"Vue",import:()=>ee(()=>import("./vue-BuYVFjOK.js"),__vite__mapDeps([93,1,2,3,11,9,31]))},{id:"vue-html",name:"Vue HTML",import:()=>ee(()=>import("./vue-html-xdeiXROB.js"),__vite__mapDeps([94,93,1,2,3,11,9,31]))},{id:"vyper",name:"Vyper",aliases:["vy"],import:()=>ee(()=>import("./vyper-nyqBNV6O.js"),[])},{id:"wasm",name:"WebAssembly",import:()=>ee(()=>import("./wasm-C6j12Q_x.js"),[])},{id:"wenyan",name:"Wenyan",aliases:["文言"],import:()=>ee(()=>import("./wenyan-7A4Fjokl.js"),[])},{id:"wgsl",name:"WGSL",import:()=>ee(()=>import("./wgsl-CB0Krxn9.js"),[])},{id:"wikitext",name:"Wikitext",aliases:["mediawiki","wiki"],import:()=>ee(()=>import("./wikitext-DCE3LsBG.js"),[])},{id:"wolfram",name:"Wolfram",aliases:["wl"],import:()=>ee(()=>import("./wolfram-C3FkfJm5.js"),[])},{id:"xml",name:"XML",import:()=>ee(()=>import("./xml-e3z08dGr.js"),__vite__mapDeps([7,8]))},{id:"xsl",name:"XSL",import:()=>ee(()=>import("./xsl-Dd0NUgwM.js"),__vite__mapDeps([95,7,8]))},{id:"yaml",name:"YAML",aliases:["yml"],import:()=>ee(()=>import("./yaml-CVw76BM1.js"),[])},{id:"zenscript",name:"ZenScript",import:()=>ee(()=>import("./zenscript-HnGAYVZD.js"),[])},{id:"zig",name:"Zig",import:()=>ee(()=>import("./zig-BVz_zdnA.js"),[])}],Vue=Object.fromEntries(TF.map(t=>[t.id,t.import])),Gue=Object.fromEntries(TF.flatMap(t=>t.aliases?.map(e=>[e,t.import])||[])),zue={...Vue,...Gue},Wue=[{id:"andromeeda",displayName:"Andromeeda",type:"dark",import:()=>ee(()=>import("./andromeeda-C3khCPGq.js"),[])},{id:"aurora-x",displayName:"Aurora X",type:"dark",import:()=>ee(()=>import("./aurora-x-D-2ljcwZ.js"),[])},{id:"ayu-dark",displayName:"Ayu Dark",type:"dark",import:()=>ee(()=>import("./ayu-dark-Cv9koXgw.js"),[])},{id:"catppuccin-frappe",displayName:"Catppuccin Frappé",type:"dark",import:()=>ee(()=>import("./catppuccin-frappe-CD_QflpE.js"),[])},{id:"catppuccin-latte",displayName:"Catppuccin Latte",type:"light",import:()=>ee(()=>import("./catppuccin-latte-DRW-0cLl.js"),[])},{id:"catppuccin-macchiato",displayName:"Catppuccin Macchiato",type:"dark",import:()=>ee(()=>import("./catppuccin-macchiato-C-_shW-Y.js"),[])},{id:"catppuccin-mocha",displayName:"Catppuccin Mocha",type:"dark",import:()=>ee(()=>import("./catppuccin-mocha-LGGdnPYs.js"),[])},{id:"dark-plus",displayName:"Dark Plus",type:"dark",import:()=>ee(()=>import("./dark-plus-C3mMm8J8.js"),[])},{id:"dracula",displayName:"Dracula Theme",type:"dark",import:()=>ee(()=>import("./dracula-BzJJZx-M.js"),[])},{id:"dracula-soft",displayName:"Dracula Theme Soft",type:"dark",import:()=>ee(()=>import("./dracula-soft-BXkSAIEj.js"),[])},{id:"everforest-dark",displayName:"Everforest Dark",type:"dark",import:()=>ee(()=>import("./everforest-dark-BgDCqdQA.js"),[])},{id:"everforest-light",displayName:"Everforest Light",type:"light",import:()=>ee(()=>import("./everforest-light-C8M2exoo.js"),[])},{id:"github-dark",displayName:"GitHub Dark",type:"dark",import:()=>ee(()=>import("./github-dark-DHJKELXO.js"),[])},{id:"github-dark-default",displayName:"GitHub Dark Default",type:"dark",import:()=>ee(()=>import("./github-dark-default-Cuk6v7N8.js"),[])},{id:"github-dark-dimmed",displayName:"GitHub Dark Dimmed",type:"dark",import:()=>ee(()=>import("./github-dark-dimmed-DH5Ifo-i.js"),[])},{id:"github-dark-high-contrast",displayName:"GitHub Dark High Contrast",type:"dark",import:()=>ee(()=>import("./github-dark-high-contrast-E3gJ1_iC.js"),[])},{id:"github-light",displayName:"GitHub Light",type:"light",import:()=>ee(()=>import("./github-light-DAi9KRSo.js"),[])},{id:"github-light-default",displayName:"GitHub Light Default",type:"light",import:()=>ee(()=>import("./github-light-default-D7oLnXFd.js"),[])},{id:"github-light-high-contrast",displayName:"GitHub Light High Contrast",type:"light",import:()=>ee(()=>import("./github-light-high-contrast-BfjtVDDH.js"),[])},{id:"houston",displayName:"Houston",type:"dark",import:()=>ee(()=>import("./houston-DnULxvSX.js"),[])},{id:"kanagawa-dragon",displayName:"Kanagawa Dragon",type:"dark",import:()=>ee(()=>import("./kanagawa-dragon-CkXjmgJE.js"),[])},{id:"kanagawa-lotus",displayName:"Kanagawa Lotus",type:"light",import:()=>ee(()=>import("./kanagawa-lotus-CfQXZHmo.js"),[])},{id:"kanagawa-wave",displayName:"Kanagawa Wave",type:"dark",import:()=>ee(()=>import("./kanagawa-wave-DWedfzmr.js"),[])},{id:"laserwave",displayName:"LaserWave",type:"dark",import:()=>ee(()=>import("./laserwave-DUszq2jm.js"),[])},{id:"light-plus",displayName:"Light Plus",type:"light",import:()=>ee(()=>import("./light-plus-B7mTdjB0.js"),[])},{id:"material-theme",displayName:"Material Theme",type:"dark",import:()=>ee(()=>import("./material-theme-D5KoaKCx.js"),[])},{id:"material-theme-darker",displayName:"Material Theme Darker",type:"dark",import:()=>ee(()=>import("./material-theme-darker-BfHTSMKl.js"),[])},{id:"material-theme-lighter",displayName:"Material Theme Lighter",type:"light",import:()=>ee(()=>import("./material-theme-lighter-B0m2ddpp.js"),[])},{id:"material-theme-ocean",displayName:"Material Theme Ocean",type:"dark",import:()=>ee(()=>import("./material-theme-ocean-CyktbL80.js"),[])},{id:"material-theme-palenight",displayName:"Material Theme Palenight",type:"dark",import:()=>ee(()=>import("./material-theme-palenight-Csfq5Kiy.js"),[])},{id:"min-dark",displayName:"Min Dark",type:"dark",import:()=>ee(()=>import("./min-dark-CafNBF8u.js"),[])},{id:"min-light",displayName:"Min Light",type:"light",import:()=>ee(()=>import("./min-light-CTRr51gU.js"),[])},{id:"monokai",displayName:"Monokai",type:"dark",import:()=>ee(()=>import("./monokai-D4h5O-jR.js"),[])},{id:"night-owl",displayName:"Night Owl",type:"dark",import:()=>ee(()=>import("./night-owl-C39BiMTA.js"),[])},{id:"nord",displayName:"Nord",type:"dark",import:()=>ee(()=>import("./nord-Ddv68eIx.js"),[])},{id:"one-dark-pro",displayName:"One Dark Pro",type:"dark",import:()=>ee(()=>import("./one-dark-pro-GBQ2dnAY.js"),[])},{id:"one-light",displayName:"One Light",type:"light",import:()=>ee(()=>import("./one-light-PoHY5YXO.js"),[])},{id:"plastic",displayName:"Plastic",type:"dark",import:()=>ee(()=>import("./plastic-3e1v2bzS.js"),[])},{id:"poimandres",displayName:"Poimandres",type:"dark",import:()=>ee(()=>import("./poimandres-CS3Unz2-.js"),[])},{id:"red",displayName:"Red",type:"dark",import:()=>ee(()=>import("./red-bN70gL4F.js"),[])},{id:"rose-pine",displayName:"Rosé Pine",type:"dark",import:()=>ee(()=>import("./rose-pine-CmCqftbK.js"),[])},{id:"rose-pine-dawn",displayName:"Rosé Pine Dawn",type:"light",import:()=>ee(()=>import("./rose-pine-dawn-Ds-gbosJ.js"),[])},{id:"rose-pine-moon",displayName:"Rosé Pine Moon",type:"dark",import:()=>ee(()=>import("./rose-pine-moon-CjDtw9vr.js"),[])},{id:"slack-dark",displayName:"Slack Dark",type:"dark",import:()=>ee(()=>import("./slack-dark-BthQWCQV.js"),[])},{id:"slack-ochin",displayName:"Slack Ochin",type:"light",import:()=>ee(()=>import("./slack-ochin-DqwNpetd.js"),[])},{id:"snazzy-light",displayName:"Snazzy Light",type:"light",import:()=>ee(()=>import("./snazzy-light-Bw305WKR.js"),[])},{id:"solarized-dark",displayName:"Solarized Dark",type:"dark",import:()=>ee(()=>import("./solarized-dark-DXbdFlpD.js"),[])},{id:"solarized-light",displayName:"Solarized Light",type:"light",import:()=>ee(()=>import("./solarized-light-L9t79GZl.js"),[])},{id:"synthwave-84",displayName:"Synthwave '84",type:"dark",import:()=>ee(()=>import("./synthwave-84-CbfX1IO0.js"),[])},{id:"tokyo-night",displayName:"Tokyo Night",type:"dark",import:()=>ee(()=>import("./tokyo-night-DBQeEorK.js"),[])},{id:"vesper",displayName:"Vesper",type:"dark",import:()=>ee(()=>import("./vesper-BEBZ7ncR.js"),[])},{id:"vitesse-black",displayName:"Vitesse Black",type:"dark",import:()=>ee(()=>import("./vitesse-black-Bkuqu6BP.js"),[])},{id:"vitesse-dark",displayName:"Vitesse Dark",type:"dark",import:()=>ee(()=>import("./vitesse-dark-D0r3Knsf.js"),[])},{id:"vitesse-light",displayName:"Vitesse Light",type:"light",import:()=>ee(()=>import("./vitesse-light-CVO1_9PV.js"),[])}],Kue=Object.fromEntries(Wue.map(t=>[t.id,t.import]));let mi=class extends Error{constructor(e){super(e),this.name="ShikiError"}},DS=class extends Error{constructor(e){super(e),this.name="ShikiError"}};function que(){return 2147483648}function Jue(){return typeof performance<"u"?performance.now():Date.now()}const Yue=(t,e)=>t+(e-t%e)%e;async function Zue(t){let e,r;const n={};function s(f){r=f,n.HEAPU8=new Uint8Array(f),n.HEAPU32=new Uint32Array(f)}function i(f,v,m){n.HEAPU8.copyWithin(f,v,v+m)}function o(f){try{return e.grow(f-r.byteLength+65535>>>16),s(e.buffer),1}catch{}}function a(f){const v=n.HEAPU8.length;f=f>>>0;const m=que();if(f>m)return!1;for(let p=1;p<=4;p*=2){let g=v*(1+.2/p);g=Math.min(g,f+100663296);const y=Math.min(m,Yue(Math.max(f,g),65536));if(o(y))return!0}return!1}const l=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function c(f,v,m=1024){const p=v+m;let g=v;for(;f[g]&&!(g>=p);)++g;if(g-v>16&&f.buffer&&l)return l.decode(f.subarray(v,g));let y="";for(;v<g;){let _=f[v++];if(!(_&128)){y+=String.fromCharCode(_);continue}const b=f[v++]&63;if((_&224)===192){y+=String.fromCharCode((_&31)<<6|b);continue}const w=f[v++]&63;if((_&240)===224?_=(_&15)<<12|b<<6|w:_=(_&7)<<18|b<<12|w<<6|f[v++]&63,_<65536)y+=String.fromCharCode(_);else{const E=_-65536;y+=String.fromCharCode(55296|E>>10,56320|E&1023)}}return y}function u(f,v){return f?c(n.HEAPU8,f,v):""}const d={emscripten_get_now:Jue,emscripten_memcpy_big:i,emscripten_resize_heap:a,fd_write:()=>0};async function h(){const v=await t({env:d,wasi_snapshot_preview1:d});e=v.memory,s(e.buffer),Object.assign(n,v),n.UTF8ToString=u}return await h(),n}var Xue=Object.defineProperty,Que=(t,e,r)=>e in t?Xue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kt=(t,e,r)=>(Que(t,typeof e!="symbol"?e+"":e,r),r);let Qt=null;function ede(t){throw new DS(t.UTF8ToString(t.getLastOnigError()))}class jg{constructor(e){Kt(this,"utf16Length"),Kt(this,"utf8Length"),Kt(this,"utf16Value"),Kt(this,"utf8Value"),Kt(this,"utf16OffsetToUtf8"),Kt(this,"utf8OffsetToUtf16");const r=e.length,n=jg._utf8ByteLength(e),s=n!==r,i=s?new Uint32Array(r+1):null;s&&(i[r]=n);const o=s?new Uint32Array(n+1):null;s&&(o[n]=r);const a=new Uint8Array(n);let l=0;for(let c=0;c<r;c++){const u=e.charCodeAt(c);let d=u,h=!1;if(u>=55296&&u<=56319&&c+1<r){const f=e.charCodeAt(c+1);f>=56320&&f<=57343&&(d=(u-55296<<10)+65536|f-56320,h=!0)}s&&(i[c]=l,h&&(i[c+1]=l),d<=127?o[l+0]=c:d<=2047?(o[l+0]=c,o[l+1]=c):d<=65535?(o[l+0]=c,o[l+1]=c,o[l+2]=c):(o[l+0]=c,o[l+1]=c,o[l+2]=c,o[l+3]=c)),d<=127?a[l++]=d:d<=2047?(a[l++]=192|(d&1984)>>>6,a[l++]=128|(d&63)>>>0):d<=65535?(a[l++]=224|(d&61440)>>>12,a[l++]=128|(d&4032)>>>6,a[l++]=128|(d&63)>>>0):(a[l++]=240|(d&1835008)>>>18,a[l++]=128|(d&258048)>>>12,a[l++]=128|(d&4032)>>>6,a[l++]=128|(d&63)>>>0),h&&c++}this.utf16Length=r,this.utf8Length=n,this.utf16Value=e,this.utf8Value=a,this.utf16OffsetToUtf8=i,this.utf8OffsetToUtf16=o}static _utf8ByteLength(e){let r=0;for(let n=0,s=e.length;n<s;n++){const i=e.charCodeAt(n);let o=i,a=!1;if(i>=55296&&i<=56319&&n+1<s){const l=e.charCodeAt(n+1);l>=56320&&l<=57343&&(o=(i-55296<<10)+65536|l-56320,a=!0)}o<=127?r+=1:o<=2047?r+=2:o<=65535?r+=3:r+=4,a&&n++}return r}createString(e){const r=e.omalloc(this.utf8Length);return e.HEAPU8.set(this.utf8Value,r),r}}const ps=class{constructor(t){if(Kt(this,"id",++ps.LAST_ID),Kt(this,"_onigBinding"),Kt(this,"content"),Kt(this,"utf16Length"),Kt(this,"utf8Length"),Kt(this,"utf16OffsetToUtf8"),Kt(this,"utf8OffsetToUtf16"),Kt(this,"ptr"),!Qt)throw new DS("Must invoke loadWasm first.");this._onigBinding=Qt,this.content=t;const e=new jg(t);this.utf16Length=e.utf16Length,this.utf8Length=e.utf8Length,this.utf16OffsetToUtf8=e.utf16OffsetToUtf8,this.utf8OffsetToUtf16=e.utf8OffsetToUtf16,this.utf8Length<1e4&&!ps._sharedPtrInUse?(ps._sharedPtr||(ps._sharedPtr=Qt.omalloc(1e4)),ps._sharedPtrInUse=!0,Qt.HEAPU8.set(e.utf8Value,ps._sharedPtr),this.ptr=ps._sharedPtr):this.ptr=e.createString(Qt)}convertUtf8OffsetToUtf16(t){return this.utf8OffsetToUtf16?t<0?0:t>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[t]:t}convertUtf16OffsetToUtf8(t){return this.utf16OffsetToUtf8?t<0?0:t>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[t]:t}dispose(){this.ptr===ps._sharedPtr?ps._sharedPtrInUse=!1:this._onigBinding.ofree(this.ptr)}};let nh=ps;Kt(nh,"LAST_ID",0);Kt(nh,"_sharedPtr",0);Kt(nh,"_sharedPtrInUse",!1);class tde{constructor(e){if(Kt(this,"_onigBinding"),Kt(this,"_ptr"),!Qt)throw new DS("Must invoke loadWasm first.");const r=[],n=[];for(let a=0,l=e.length;a<l;a++){const c=new jg(e[a]);r[a]=c.createString(Qt),n[a]=c.utf8Length}const s=Qt.omalloc(4*e.length);Qt.HEAPU32.set(r,s/4);const i=Qt.omalloc(4*e.length);Qt.HEAPU32.set(n,i/4);const o=Qt.createOnigScanner(s,i,e.length);for(let a=0,l=e.length;a<l;a++)Qt.ofree(r[a]);Qt.ofree(i),Qt.ofree(s),o===0&&ede(Qt),this._onigBinding=Qt,this._ptr=o}dispose(){this._onigBinding.freeOnigScanner(this._ptr)}findNextMatchSync(e,r,n){let s=0;if(typeof n=="number"&&(s=n),typeof e=="string"){e=new nh(e);const i=this._findNextMatchSync(e,r,!1,s);return e.dispose(),i}return this._findNextMatchSync(e,r,!1,s)}_findNextMatchSync(e,r,n,s){const i=this._onigBinding,o=i.findNextOnigScannerMatch(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(r),s);if(o===0)return null;const a=i.HEAPU32;let l=o/4;const c=a[l++],u=a[l++],d=[];for(let h=0;h<u;h++){const f=e.convertUtf8OffsetToUtf16(a[l++]),v=e.convertUtf8OffsetToUtf16(a[l++]);d[h]={start:f,end:v,length:v-f}}return{index:c,captureIndices:d}}}function rde(t){return typeof t.instantiator=="function"}function nde(t){return typeof t.default=="function"}function sde(t){return typeof t.data<"u"}function ide(t){return typeof Response<"u"&&t instanceof Response}function ode(t){return typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||ArrayBuffer.isView(t))||typeof Ht<"u"&&Ht.isBuffer?.(t)||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer||typeof Uint32Array<"u"&&t instanceof Uint32Array}let Xh;function ade(t){if(Xh)return Xh;async function e(){Qt=await Zue(async r=>{let n=t;return n=await n,typeof n=="function"&&(n=await n(r)),typeof n=="function"&&(n=await n(r)),rde(n)?n=await n.instantiator(r):nde(n)?n=await n.default(r):(sde(n)&&(n=n.data),ide(n)?typeof WebAssembly.instantiateStreaming=="function"?n=await lde(n)(r):n=await cde(n)(r):ode(n)?n=await Iy(n)(r):n instanceof WebAssembly.Module?n=await Iy(n)(r):"default"in n&&n.default instanceof WebAssembly.Module&&(n=await Iy(n.default)(r))),"instance"in n&&(n=n.instance),"exports"in n&&(n=n.exports),n})}return Xh=e(),Xh}function Iy(t){return e=>WebAssembly.instantiate(t,e)}function lde(t){return e=>WebAssembly.instantiateStreaming(t,e)}function cde(t){return async e=>{const r=await t.arrayBuffer();return WebAssembly.instantiate(r,e)}}let ude;function dde(){return ude}async function AF(t){return t&&await ade(t),{createScanner(e){return new tde(e.map(r=>typeof r=="string"?r:r.source))},createString(e){return new nh(e)}}}function hde(t){return MS(t)}function MS(t){return Array.isArray(t)?fde(t):t instanceof RegExp?t:typeof t=="object"?pde(t):t}function fde(t){let e=[];for(let r=0,n=t.length;r<n;r++)e[r]=MS(t[r]);return e}function pde(t){let e={};for(let r in t)e[r]=MS(t[r]);return e}function RF(t,...e){return e.forEach(r=>{for(let n in r)t[n]=r[n]}),t}function PF(t){const e=~t.lastIndexOf("/")||~t.lastIndexOf("\\");return e===0?t:~e===t.length-1?PF(t.substring(0,t.length-1)):t.substr(~e+1)}var Oy=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g,Qh=class{static hasCaptures(t){return t===null?!1:(Oy.lastIndex=0,Oy.test(t))}static replaceCaptures(t,e,r){return t.replace(Oy,(n,s,i,o)=>{let a=r[parseInt(s||i,10)];if(a){let l=e.substring(a.start,a.end);for(;l[0]===".";)l=l.substring(1);switch(o){case"downcase":return l.toLowerCase();case"upcase":return l.toUpperCase();default:return l}}else return n})}};function IF(t,e){return t<e?-1:t>e?1:0}function OF(t,e){if(t===null&&e===null)return 0;if(!t)return-1;if(!e)return 1;let r=t.length,n=e.length;if(r===n){for(let s=0;s<r;s++){let i=IF(t[s],e[s]);if(i!==0)return i}return 0}return r-n}function gA(t){return!!(/^#[0-9a-f]{6}$/i.test(t)||/^#[0-9a-f]{8}$/i.test(t)||/^#[0-9a-f]{3}$/i.test(t)||/^#[0-9a-f]{4}$/i.test(t))}function DF(t){return t.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")}var MF=class{constructor(t){this.fn=t}cache=new Map;get(t){if(this.cache.has(t))return this.cache.get(t);const e=this.fn(t);return this.cache.set(t,e),e}},hm=class{constructor(t,e,r){this._colorMap=t,this._defaults=e,this._root=r}static createFromRawTheme(t,e){return this.createFromParsedTheme(vde(t),e)}static createFromParsedTheme(t,e){return _de(t,e)}_cachedMatchRoot=new MF(t=>this._root.match(t));getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(t){if(t===null)return this._defaults;const e=t.scopeName,n=this._cachedMatchRoot.get(e).find(s=>mde(t.parent,s.parentScopes));return n?new LF(n.fontStyle,n.foreground,n.background):null}},Dy=class zf{constructor(e,r){this.parent=e,this.scopeName=r}static push(e,r){for(const n of r)e=new zf(e,n);return e}static from(...e){let r=null;for(let n=0;n<e.length;n++)r=new zf(r,e[n]);return r}push(e){return new zf(this,e)}getSegments(){let e=this;const r=[];for(;e;)r.push(e.scopeName),e=e.parent;return r.reverse(),r}toString(){return this.getSegments().join(" ")}extends(e){return this===e?!0:this.parent===null?!1:this.parent.extends(e)}getExtensionIfDefined(e){const r=[];let n=this;for(;n&&n!==e;)r.push(n.scopeName),n=n.parent;return n===e?r.reverse():void 0}};function mde(t,e){if(e.length===0)return!0;for(let r=0;r<e.length;r++){let n=e[r],s=!1;if(n===">"){if(r===e.length-1)return!1;n=e[++r],s=!0}for(;t&&!gde(t.scopeName,n);){if(s)return!1;t=t.parent}if(!t)return!1;t=t.parent}return!0}function gde(t,e){return e===t||t.startsWith(e)&&t[e.length]==="."}var LF=class{constructor(t,e,r){this.fontStyle=t,this.foregroundId=e,this.backgroundId=r}};function vde(t){if(!t)return[];if(!t.settings||!Array.isArray(t.settings))return[];let e=t.settings,r=[],n=0;for(let s=0,i=e.length;s<i;s++){let o=e[s];if(!o.settings)continue;let a;if(typeof o.scope=="string"){let d=o.scope;d=d.replace(/^[,]+/,""),d=d.replace(/[,]+$/,""),a=d.split(",")}else Array.isArray(o.scope)?a=o.scope:a=[""];let l=-1;if(typeof o.settings.fontStyle=="string"){l=0;let d=o.settings.fontStyle.split(" ");for(let h=0,f=d.length;h<f;h++)switch(d[h]){case"italic":l=l|1;break;case"bold":l=l|2;break;case"underline":l=l|4;break;case"strikethrough":l=l|8;break}}let c=null;typeof o.settings.foreground=="string"&&gA(o.settings.foreground)&&(c=o.settings.foreground);let u=null;typeof o.settings.background=="string"&&gA(o.settings.background)&&(u=o.settings.background);for(let d=0,h=a.length;d<h;d++){let v=a[d].trim().split(" "),m=v[v.length-1],p=null;v.length>1&&(p=v.slice(0,v.length-1),p.reverse()),r[n++]=new yde(m,p,s,l,c,u)}}return r}var yde=class{constructor(t,e,r,n,s,i){this.scope=t,this.parentScopes=e,this.index=r,this.fontStyle=n,this.foreground=s,this.background=i}},pi=(t=>(t[t.NotSet=-1]="NotSet",t[t.None=0]="None",t[t.Italic=1]="Italic",t[t.Bold=2]="Bold",t[t.Underline=4]="Underline",t[t.Strikethrough=8]="Strikethrough",t))(pi||{});function _de(t,e){t.sort((l,c)=>{let u=IF(l.scope,c.scope);return u!==0||(u=OF(l.parentScopes,c.parentScopes),u!==0)?u:l.index-c.index});let r=0,n="#000000",s="#ffffff";for(;t.length>=1&&t[0].scope==="";){let l=t.shift();l.fontStyle!==-1&&(r=l.fontStyle),l.foreground!==null&&(n=l.foreground),l.background!==null&&(s=l.background)}let i=new bde(e),o=new LF(r,i.getId(n),i.getId(s)),a=new xde(new fb(0,null,-1,0,0),[]);for(let l=0,c=t.length;l<c;l++){let u=t[l];a.insert(0,u.scope,u.parentScopes,u.fontStyle,i.getId(u.foreground),i.getId(u.background))}return new hm(i,o,a)}var bde=class{_isFrozen;_lastColorId;_id2color;_color2id;constructor(t){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(t)){this._isFrozen=!0;for(let e=0,r=t.length;e<r;e++)this._color2id[t[e]]=e,this._id2color[e]=t[e]}else this._isFrozen=!1}getId(t){if(t===null)return 0;t=t.toUpperCase();let e=this._color2id[t];if(e)return e;if(this._isFrozen)throw new Error(`Missing color in color map - ${t}`);return e=++this._lastColorId,this._color2id[t]=e,this._id2color[e]=t,e}getColorMap(){return this._id2color.slice(0)}},wde=Object.freeze([]),fb=class NF{scopeDepth;parentScopes;fontStyle;foreground;background;constructor(e,r,n,s,i){this.scopeDepth=e,this.parentScopes=r||wde,this.fontStyle=n,this.foreground=s,this.background=i}clone(){return new NF(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(e){let r=[];for(let n=0,s=e.length;n<s;n++)r[n]=e[n].clone();return r}acceptOverwrite(e,r,n,s){this.scopeDepth>e?console.log("how did this happen?"):this.scopeDepth=e,r!==-1&&(this.fontStyle=r),n!==0&&(this.foreground=n),s!==0&&(this.background=s)}},xde=class pb{constructor(e,r=[],n={}){this._mainRule=e,this._children=n,this._rulesWithParentScopes=r}_rulesWithParentScopes;static _cmpBySpecificity(e,r){if(e.scopeDepth!==r.scopeDepth)return r.scopeDepth-e.scopeDepth;let n=0,s=0;for(;e.parentScopes[n]===">"&&n++,r.parentScopes[s]===">"&&s++,!(n>=e.parentScopes.length||s>=r.parentScopes.length);){const i=r.parentScopes[s].length-e.parentScopes[n].length;if(i!==0)return i;n++,s++}return r.parentScopes.length-e.parentScopes.length}match(e){if(e!==""){let n=e.indexOf("."),s,i;if(n===-1?(s=e,i=""):(s=e.substring(0,n),i=e.substring(n+1)),this._children.hasOwnProperty(s))return this._children[s].match(i)}const r=this._rulesWithParentScopes.concat(this._mainRule);return r.sort(pb._cmpBySpecificity),r}insert(e,r,n,s,i,o){if(r===""){this._doInsertHere(e,n,s,i,o);return}let a=r.indexOf("."),l,c;a===-1?(l=r,c=""):(l=r.substring(0,a),c=r.substring(a+1));let u;this._children.hasOwnProperty(l)?u=this._children[l]:(u=new pb(this._mainRule.clone(),fb.cloneArr(this._rulesWithParentScopes)),this._children[l]=u),u.insert(e+1,c,n,s,i,o)}_doInsertHere(e,r,n,s,i){if(r===null){this._mainRule.acceptOverwrite(e,n,s,i);return}for(let o=0,a=this._rulesWithParentScopes.length;o<a;o++){let l=this._rulesWithParentScopes[o];if(OF(l.parentScopes,r)===0){l.acceptOverwrite(e,n,s,i);return}}n===-1&&(n=this._mainRule.fontStyle),s===0&&(s=this._mainRule.foreground),i===0&&(i=this._mainRule.background),this._rulesWithParentScopes.push(new fb(e,r,n,s,i))}},Gl=class Cn{static toBinaryStr(e){return e.toString(2).padStart(32,"0")}static print(e){const r=Cn.getLanguageId(e),n=Cn.getTokenType(e),s=Cn.getFontStyle(e),i=Cn.getForeground(e),o=Cn.getBackground(e);console.log({languageId:r,tokenType:n,fontStyle:s,foreground:i,background:o})}static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static set(e,r,n,s,i,o,a){let l=Cn.getLanguageId(e),c=Cn.getTokenType(e),u=Cn.containsBalancedBrackets(e)?1:0,d=Cn.getFontStyle(e),h=Cn.getForeground(e),f=Cn.getBackground(e);return r!==0&&(l=r),n!==8&&(c=n),s!==null&&(u=s?1:0),i!==-1&&(d=i),o!==0&&(h=o),a!==0&&(f=a),(l<<0|c<<8|u<<10|d<<11|h<<15|f<<24)>>>0}};function fm(t,e){const r=[],n=Sde(t);let s=n.next();for(;s!==null;){let l=0;if(s.length===2&&s.charAt(1)===":"){switch(s.charAt(0)){case"R":l=1;break;case"L":l=-1;break;default:console.log(`Unknown priority ${s} in scope selector`)}s=n.next()}let c=o();if(r.push({matcher:c,priority:l}),s!==",")break;s=n.next()}return r;function i(){if(s==="-"){s=n.next();const l=i();return c=>!!l&&!l(c)}if(s==="("){s=n.next();const l=a();return s===")"&&(s=n.next()),l}if(vA(s)){const l=[];do l.push(s),s=n.next();while(vA(s));return c=>e(l,c)}return null}function o(){const l=[];let c=i();for(;c;)l.push(c),c=i();return u=>l.every(d=>d(u))}function a(){const l=[];let c=o();for(;c&&(l.push(c),s==="|"||s===",");){do s=n.next();while(s==="|"||s===",");c=o()}return u=>l.some(d=>d(u))}}function vA(t){return!!t&&!!t.match(/[\w\.:]+/)}function Sde(t){let e=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,r=e.exec(t);return{next:()=>{if(!r)return null;const n=r[0];return r=e.exec(t),n}}}function BF(t){typeof t.dispose=="function"&&t.dispose()}var bd=class{constructor(t){this.scopeName=t}toKey(){return this.scopeName}},Ede=class{constructor(t,e){this.scopeName=t,this.ruleName=e}toKey(){return`${this.scopeName}#${this.ruleName}`}},Cde=class{_references=[];_seenReferenceKeys=new Set;get references(){return this._references}visitedRule=new Set;add(t){const e=t.toKey();this._seenReferenceKeys.has(e)||(this._seenReferenceKeys.add(e),this._references.push(t))}},kde=class{constructor(t,e){this.repo=t,this.initialScopeName=e,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new bd(this.initialScopeName)]}seenFullScopeRequests=new Set;seenPartialScopeRequests=new Set;Q;processQueue(){const t=this.Q;this.Q=[];const e=new Cde;for(const r of t)Tde(r,this.initialScopeName,this.repo,e);for(const r of e.references)if(r instanceof bd){if(this.seenFullScopeRequests.has(r.scopeName))continue;this.seenFullScopeRequests.add(r.scopeName),this.Q.push(r)}else{if(this.seenFullScopeRequests.has(r.scopeName)||this.seenPartialScopeRequests.has(r.toKey()))continue;this.seenPartialScopeRequests.add(r.toKey()),this.Q.push(r)}}};function Tde(t,e,r,n){const s=r.lookup(t.scopeName);if(!s){if(t.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const i=r.lookup(e);t instanceof bd?Wf({baseGrammar:i,selfGrammar:s},n):mb(t.ruleName,{baseGrammar:i,selfGrammar:s,repository:s.repository},n);const o=r.injections(t.scopeName);if(o)for(const a of o)n.add(new bd(a))}function mb(t,e,r){if(e.repository&&e.repository[t]){const n=e.repository[t];pm([n],e,r)}}function Wf(t,e){t.selfGrammar.patterns&&Array.isArray(t.selfGrammar.patterns)&&pm(t.selfGrammar.patterns,{...t,repository:t.selfGrammar.repository},e),t.selfGrammar.injections&&pm(Object.values(t.selfGrammar.injections),{...t,repository:t.selfGrammar.repository},e)}function pm(t,e,r){for(const n of t){if(r.visitedRule.has(n))continue;r.visitedRule.add(n);const s=n.repository?RF({},e.repository,n.repository):e.repository;Array.isArray(n.patterns)&&pm(n.patterns,{...e,repository:s},r);const i=n.include;if(!i)continue;const o=FF(i);switch(o.kind){case 0:Wf({...e,selfGrammar:e.baseGrammar},r);break;case 1:Wf(e,r);break;case 2:mb(o.ruleName,{...e,repository:s},r);break;case 3:case 4:const a=o.scopeName===e.selfGrammar.scopeName?e.selfGrammar:o.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(a){const l={baseGrammar:e.baseGrammar,selfGrammar:a,repository:s};o.kind===4?mb(o.ruleName,l,r):Wf(l,r)}else o.kind===4?r.add(new Ede(o.scopeName,o.ruleName)):r.add(new bd(o.scopeName));break}}}var Ade=class{kind=0},Rde=class{kind=1},Pde=class{constructor(t){this.ruleName=t}kind=2},Ide=class{constructor(t){this.scopeName=t}kind=3},Ode=class{constructor(t,e){this.scopeName=t,this.ruleName=e}kind=4};function FF(t){if(t==="$base")return new Ade;if(t==="$self")return new Rde;const e=t.indexOf("#");if(e===-1)return new Ide(t);if(e===0)return new Pde(t.substring(1));{const r=t.substring(0,e),n=t.substring(e+1);return new Ode(r,n)}}var Dde=/\\(\d+)/,yA=/\\(\d+)/g,Mde=-1,jF=-2;var sh=class{$location;id;_nameIsCapturing;_name;_contentNameIsCapturing;_contentName;constructor(e,r,n,s){this.$location=e,this.id=r,this._name=n||null,this._nameIsCapturing=Qh.hasCaptures(this._name),this._contentName=s||null,this._contentNameIsCapturing=Qh.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${PF(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,r){return!this._nameIsCapturing||this._name===null||e===null||r===null?this._name:Qh.replaceCaptures(this._name,e,r)}getContentName(e,r){return!this._contentNameIsCapturing||this._contentName===null?this._contentName:Qh.replaceCaptures(this._contentName,e,r)}},Lde=class extends sh{retokenizeCapturedWithRuleId;constructor(t,e,r,n,s){super(t,e,r,n),this.retokenizeCapturedWithRuleId=s}dispose(){}collectPatterns(t,e){throw new Error("Not supported!")}compile(t,e){throw new Error("Not supported!")}compileAG(t,e,r,n){throw new Error("Not supported!")}},Nde=class extends sh{_match;captures;_cachedCompiledPatterns;constructor(t,e,r,n,s){super(t,e,r,null),this._match=new wd(n,this.id),this.captures=s,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(t,e){e.push(this._match)}compile(t,e){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t).compileAG(t,r,n)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new xd,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}},_A=class extends sh{hasMissingPatterns;patterns;_cachedCompiledPatterns;constructor(t,e,r,n,s){super(t,e,r,n),this.patterns=s.patterns,this.hasMissingPatterns=s.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(t,e){for(const r of this.patterns)t.getRule(r).collectPatterns(t,e)}compile(t,e){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t).compileAG(t,r,n)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new xd,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}},gb=class extends sh{_begin;beginCaptures;_end;endHasBackReferences;endCaptures;applyEndPatternLast;hasMissingPatterns;patterns;_cachedCompiledPatterns;constructor(t,e,r,n,s,i,o,a,l,c){super(t,e,r,n),this._begin=new wd(s,this.id),this.beginCaptures=i,this._end=new wd(o||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=a,this.applyEndPatternLast=l||!1,this.patterns=c.patterns,this.hasMissingPatterns=c.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(t,e){return this._end.resolveBackReferences(t,e)}collectPatterns(t,e){e.push(this._begin)}compile(t,e){return this._getCachedCompiledPatterns(t,e).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t,e).compileAG(t,r,n)}_getCachedCompiledPatterns(t,e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new xd;for(const r of this.patterns)t.getRule(r).collectPatterns(t,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,e):this._cachedCompiledPatterns.setSource(0,e)),this._cachedCompiledPatterns}},mm=class extends sh{_begin;beginCaptures;whileCaptures;_while;whileHasBackReferences;hasMissingPatterns;patterns;_cachedCompiledPatterns;_cachedCompiledWhilePatterns;constructor(t,e,r,n,s,i,o,a,l){super(t,e,r,n),this._begin=new wd(s,this.id),this.beginCaptures=i,this.whileCaptures=a,this._while=new wd(o,jF),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=l.patterns,this.hasMissingPatterns=l.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(t,e){return this._while.resolveBackReferences(t,e)}collectPatterns(t,e){e.push(this._begin)}compile(t,e){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t).compileAG(t,r,n)}_getCachedCompiledPatterns(t){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new xd;for(const e of this.patterns)t.getRule(e).collectPatterns(t,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(t,e){return this._getCachedCompiledWhilePatterns(t,e).compile(t)}compileWhileAG(t,e,r,n){return this._getCachedCompiledWhilePatterns(t,e).compileAG(t,r,n)}_getCachedCompiledWhilePatterns(t,e){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new xd,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,e||"￿"),this._cachedCompiledWhilePatterns}},$F=class br{static createCaptureRule(e,r,n,s,i){return e.registerRule(o=>new Lde(r,o,n,s,i))}static getCompiledRuleId(e,r,n){return e.id||r.registerRule(s=>{if(e.id=s,e.match)return new Nde(e.$vscodeTextmateLocation,e.id,e.name,e.match,br._compileCaptures(e.captures,r,n));if(typeof e.begin>"u"){e.repository&&(n=RF({},n,e.repository));let i=e.patterns;return typeof i>"u"&&e.include&&(i=[{include:e.include}]),new _A(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,br._compilePatterns(i,r,n))}return e.while?new mm(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,br._compileCaptures(e.beginCaptures||e.captures,r,n),e.while,br._compileCaptures(e.whileCaptures||e.captures,r,n),br._compilePatterns(e.patterns,r,n)):new gb(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,br._compileCaptures(e.beginCaptures||e.captures,r,n),e.end,br._compileCaptures(e.endCaptures||e.captures,r,n),e.applyEndPatternLast,br._compilePatterns(e.patterns,r,n))}),e.id}static _compileCaptures(e,r,n){let s=[];if(e){let i=0;for(const o in e){if(o==="$vscodeTextmateLocation")continue;const a=parseInt(o,10);a>i&&(i=a)}for(let o=0;o<=i;o++)s[o]=null;for(const o in e){if(o==="$vscodeTextmateLocation")continue;const a=parseInt(o,10);let l=0;e[o].patterns&&(l=br.getCompiledRuleId(e[o],r,n)),s[a]=br.createCaptureRule(r,e[o].$vscodeTextmateLocation,e[o].name,e[o].contentName,l)}}return s}static _compilePatterns(e,r,n){let s=[];if(e)for(let i=0,o=e.length;i<o;i++){const a=e[i];let l=-1;if(a.include){const c=FF(a.include);switch(c.kind){case 0:case 1:l=br.getCompiledRuleId(n[a.include],r,n);break;case 2:let u=n[c.ruleName];u&&(l=br.getCompiledRuleId(u,r,n));break;case 3:case 4:const d=c.scopeName,h=c.kind===4?c.ruleName:null,f=r.getExternalGrammar(d,n);if(f)if(h){let v=f.repository[h];v&&(l=br.getCompiledRuleId(v,r,f.repository))}else l=br.getCompiledRuleId(f.repository.$self,r,f.repository);break}}else l=br.getCompiledRuleId(a,r,n);if(l!==-1){const c=r.getRule(l);let u=!1;if((c instanceof _A||c instanceof gb||c instanceof mm)&&c.hasMissingPatterns&&c.patterns.length===0&&(u=!0),u)continue;s.push(l)}}return{patterns:s,hasMissingPatterns:(e?e.length:0)!==s.length}}},wd=class UF{source;ruleId;hasAnchor;hasBackReferences;_anchorCache;constructor(e,r){if(e&&typeof e=="string"){const n=e.length;let s=0,i=[],o=!1;for(let a=0;a<n;a++)if(e.charAt(a)==="\\"&&a+1<n){const c=e.charAt(a+1);c==="z"?(i.push(e.substring(s,a)),i.push("$(?!\\n)(?<!\\n)"),s=a+2):(c==="A"||c==="G")&&(o=!0),a++}this.hasAnchor=o,s===0?this.source=e:(i.push(e.substring(s,n)),this.source=i.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=r,typeof this.source=="string"?this.hasBackReferences=Dde.test(this.source):this.hasBackReferences=!1}clone(){return new UF(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,r){if(typeof this.source!="string")throw new Error("This method should only be called if the source is a string");let n=r.map(s=>e.substring(s.start,s.end));return yA.lastIndex=0,this.source.replace(yA,(s,i)=>DF(n[parseInt(i,10)]||""))}_buildAnchorCache(){if(typeof this.source!="string")throw new Error("This method should only be called if the source is a string");let e=[],r=[],n=[],s=[],i,o,a,l;for(i=0,o=this.source.length;i<o;i++)a=this.source.charAt(i),e[i]=a,r[i]=a,n[i]=a,s[i]=a,a==="\\"&&i+1<o&&(l=this.source.charAt(i+1),l==="A"?(e[i+1]="￿",r[i+1]="￿",n[i+1]="A",s[i+1]="A"):l==="G"?(e[i+1]="￿",r[i+1]="G",n[i+1]="￿",s[i+1]="G"):(e[i+1]=l,r[i+1]=l,n[i+1]=l,s[i+1]=l),i++);return{A0_G0:e.join(""),A0_G1:r.join(""),A1_G0:n.join(""),A1_G1:s.join("")}}resolveAnchors(e,r){return!this.hasAnchor||!this._anchorCache||typeof this.source!="string"?this.source:e?r?this._anchorCache.A1_G1:this._anchorCache.A1_G0:r?this._anchorCache.A0_G1:this._anchorCache.A0_G0}},xd=class{_items;_hasAnchors;_cached;_anchorCache;constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(t){this._items.push(t),this._hasAnchors=this._hasAnchors||t.hasAnchor}unshift(t){this._items.unshift(t),this._hasAnchors=this._hasAnchors||t.hasAnchor}length(){return this._items.length}setSource(t,e){this._items[t].source!==e&&(this._disposeCaches(),this._items[t].setSource(e))}compile(t){if(!this._cached){let e=this._items.map(r=>r.source);this._cached=new bA(t,e,this._items.map(r=>r.ruleId))}return this._cached}compileAG(t,e,r){return this._hasAnchors?e?r?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(t,e,r)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(t,e,r)),this._anchorCache.A1_G0):r?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(t,e,r)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(t,e,r)),this._anchorCache.A0_G0):this.compile(t)}_resolveAnchors(t,e,r){let n=this._items.map(s=>s.resolveAnchors(e,r));return new bA(t,n,this._items.map(s=>s.ruleId))}},bA=class{constructor(t,e,r){this.regExps=e,this.rules=r,this.scanner=t.createOnigScanner(e)}scanner;dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const t=[];for(let e=0,r=this.rules.length;e<r;e++)t.push("   - "+this.rules[e]+": "+this.regExps[e]);return t.join(`
`)}findNextMatchSync(t,e,r){const n=this.scanner.findNextMatchSync(t,e,r);return n?{ruleId:this.rules[n.index],captureIndices:n.captureIndices}:null}},My=class{constructor(t,e){this.languageId=t,this.tokenType=e}},Bde=class vb{_defaultAttributes;_embeddedLanguagesMatcher;constructor(e,r){this._defaultAttributes=new My(e,8),this._embeddedLanguagesMatcher=new Fde(Object.entries(r||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(e){return e===null?vb._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(e)}static _NULL_SCOPE_METADATA=new My(0,0);_getBasicScopeAttributes=new MF(e=>{const r=this._scopeToLanguage(e),n=this._toStandardTokenType(e);return new My(r,n)});_scopeToLanguage(e){return this._embeddedLanguagesMatcher.match(e)||0}_toStandardTokenType(e){const r=e.match(vb.STANDARD_TOKEN_TYPE_REGEXP);if(!r)return 8;switch(r[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}static STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/},Fde=class{values;scopesRegExp;constructor(t){if(t.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(t);const e=t.map(([r,n])=>DF(r));e.sort(),e.reverse(),this.scopesRegExp=new RegExp(`^((${e.join(")|(")}))($|\\.)`,"")}}match(t){if(!this.scopesRegExp)return;const e=t.match(this.scopesRegExp);if(e)return this.values.get(e[1])}},wA=class{constructor(t,e){this.stack=t,this.stoppedEarly=e}};function HF(t,e,r,n,s,i,o,a){const l=e.content.length;let c=!1,u=-1;if(o){const f=jde(t,e,r,n,s,i);s=f.stack,n=f.linePos,r=f.isFirstLine,u=f.anchorPosition}const d=Date.now();for(;!c;){if(a!==0&&Date.now()-d>a)return new wA(s,!0);h()}return new wA(s,!1);function h(){const f=$de(t,e,r,n,s,u);if(!f){i.produce(s,l),c=!0;return}const v=f.captureIndices,m=f.matchedRuleId,p=v&&v.length>0?v[0].end>n:!1;if(m===Mde){const g=s.getRule(t);i.produce(s,v[0].start),s=s.withContentNameScopesList(s.nameScopesList),Gc(t,e,r,s,i,g.endCaptures,v),i.produce(s,v[0].end);const y=s;if(s=s.parent,u=y.getAnchorPos(),!p&&y.getEnterPos()===n){s=y,i.produce(s,l),c=!0;return}}else{const g=t.getRule(m);i.produce(s,v[0].start);const y=s,_=g.getName(e.content,v),b=s.contentNameScopesList.pushAttributed(_,t);if(s=s.push(m,n,u,v[0].end===l,null,b,b),g instanceof gb){const w=g;Gc(t,e,r,s,i,w.beginCaptures,v),i.produce(s,v[0].end),u=v[0].end;const E=w.getContentName(e.content,v),S=b.pushAttributed(E,t);if(s=s.withContentNameScopesList(S),w.endHasBackReferences&&(s=s.withEndRule(w.getEndWithResolvedBackReferences(e.content,v))),!p&&y.hasSameRuleAs(s)){s=s.pop(),i.produce(s,l),c=!0;return}}else if(g instanceof mm){const w=g;Gc(t,e,r,s,i,w.beginCaptures,v),i.produce(s,v[0].end),u=v[0].end;const E=w.getContentName(e.content,v),S=b.pushAttributed(E,t);if(s=s.withContentNameScopesList(S),w.whileHasBackReferences&&(s=s.withEndRule(w.getWhileWithResolvedBackReferences(e.content,v))),!p&&y.hasSameRuleAs(s)){s=s.pop(),i.produce(s,l),c=!0;return}}else if(Gc(t,e,r,s,i,g.captures,v),i.produce(s,v[0].end),s=s.pop(),!p){s=s.safePop(),i.produce(s,l),c=!0;return}}v[0].end>n&&(n=v[0].end,r=!1)}}function jde(t,e,r,n,s,i){let o=s.beginRuleCapturedEOL?0:-1;const a=[];for(let l=s;l;l=l.pop()){const c=l.getRule(t);c instanceof mm&&a.push({rule:c,stack:l})}for(let l=a.pop();l;l=a.pop()){const{ruleScanner:c,findOptions:u}=Vde(l.rule,t,l.stack.endRule,r,n===o),d=c.findNextMatchSync(e,n,u);if(d){if(d.ruleId!==jF){s=l.stack.pop();break}d.captureIndices&&d.captureIndices.length&&(i.produce(l.stack,d.captureIndices[0].start),Gc(t,e,r,l.stack,i,l.rule.whileCaptures,d.captureIndices),i.produce(l.stack,d.captureIndices[0].end),o=d.captureIndices[0].end,d.captureIndices[0].end>n&&(n=d.captureIndices[0].end,r=!1))}else{s=l.stack.pop();break}}return{stack:s,linePos:n,anchorPosition:o,isFirstLine:r}}function $de(t,e,r,n,s,i){const o=Ude(t,e,r,n,s,i),a=t.getInjections();if(a.length===0)return o;const l=Hde(a,t,e,r,n,s,i);if(!l)return o;if(!o)return l;const c=o.captureIndices[0].start,u=l.captureIndices[0].start;return u<c||l.priorityMatch&&u===c?l:o}function Ude(t,e,r,n,s,i){const o=s.getRule(t),{ruleScanner:a,findOptions:l}=VF(o,t,s.endRule,r,n===i),c=a.findNextMatchSync(e,n,l);return c?{captureIndices:c.captureIndices,matchedRuleId:c.ruleId}:null}function Hde(t,e,r,n,s,i,o){let a=Number.MAX_VALUE,l=null,c,u=0;const d=i.contentNameScopesList.getScopeNames();for(let h=0,f=t.length;h<f;h++){const v=t[h];if(!v.matcher(d))continue;const m=e.getRule(v.ruleId),{ruleScanner:p,findOptions:g}=VF(m,e,null,n,s===o),y=p.findNextMatchSync(r,s,g);if(!y)continue;const _=y.captureIndices[0].start;if(!(_>=a)&&(a=_,l=y.captureIndices,c=y.ruleId,u=v.priority,a===s))break}return l?{priorityMatch:u===-1,captureIndices:l,matchedRuleId:c}:null}function VF(t,e,r,n,s){return{ruleScanner:t.compileAG(e,r,n,s),findOptions:0}}function Vde(t,e,r,n,s){return{ruleScanner:t.compileWhileAG(e,r,n,s),findOptions:0}}function Gc(t,e,r,n,s,i,o){if(i.length===0)return;const a=e.content,l=Math.min(i.length,o.length),c=[],u=o[0].end;for(let d=0;d<l;d++){const h=i[d];if(h===null)continue;const f=o[d];if(f.length===0)continue;if(f.start>u)break;for(;c.length>0&&c[c.length-1].endPos<=f.start;)s.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop();if(c.length>0?s.produceFromScopes(c[c.length-1].scopes,f.start):s.produce(n,f.start),h.retokenizeCapturedWithRuleId){const m=h.getName(a,o),p=n.contentNameScopesList.pushAttributed(m,t),g=h.getContentName(a,o),y=p.pushAttributed(g,t),_=n.push(h.retokenizeCapturedWithRuleId,f.start,-1,!1,null,p,y),b=t.createOnigString(a.substring(0,f.end));HF(t,b,r&&f.start===0,f.start,_,s,!1,0),BF(b);continue}const v=h.getName(a,o);if(v!==null){const p=(c.length>0?c[c.length-1].scopes:n.contentNameScopesList).pushAttributed(v,t);c.push(new Gde(p,f.end))}}for(;c.length>0;)s.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop()}var Gde=class{scopes;endPos;constructor(t,e){this.scopes=t,this.endPos=e}};function zde(t,e,r,n,s,i,o,a){return new Kde(t,e,r,n,s,i,o,a)}function xA(t,e,r,n,s){const i=fm(e,gm),o=$F.getCompiledRuleId(r,n,s.repository);for(const a of i)t.push({debugSelector:e,matcher:a.matcher,ruleId:o,grammar:s,priority:a.priority})}function gm(t,e){if(e.length<t.length)return!1;let r=0;return t.every(n=>{for(let s=r;s<e.length;s++)if(Wde(e[s],n))return r=s+1,!0;return!1})}function Wde(t,e){if(!t)return!1;if(t===e)return!0;const r=e.length;return t.length>r&&t.substr(0,r)===e&&t[r]==="."}var Kde=class{constructor(t,e,r,n,s,i,o,a){if(this._rootScopeName=t,this.balancedBracketSelectors=i,this._onigLib=a,this._basicScopeAttributesProvider=new Bde(r,n),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=o,this._grammar=SA(e,null),this._injections=null,this._tokenTypeMatchers=[],s)for(const l of Object.keys(s)){const c=fm(l,gm);for(const u of c)this._tokenTypeMatchers.push({matcher:u.matcher,type:s[l]})}}_rootId;_lastRuleId;_ruleId2desc;_includedGrammars;_grammarRepository;_grammar;_injections;_basicScopeAttributesProvider;_tokenTypeMatchers;get themeProvider(){return this._grammarRepository}dispose(){for(const t of this._ruleId2desc)t&&t.dispose()}createOnigScanner(t){return this._onigLib.createOnigScanner(t)}createOnigString(t){return this._onigLib.createOnigString(t)}getMetadataForScope(t){return this._basicScopeAttributesProvider.getBasicScopeAttributes(t)}_collectInjections(){const t={lookup:s=>s===this._rootScopeName?this._grammar:this.getExternalGrammar(s),injections:s=>this._grammarRepository.injections(s)},e=[],r=this._rootScopeName,n=t.lookup(r);if(n){const s=n.injections;if(s)for(let o in s)xA(e,o,s[o],this,n);const i=this._grammarRepository.injections(r);i&&i.forEach(o=>{const a=this.getExternalGrammar(o);if(a){const l=a.injectionSelector;l&&xA(e,l,a,this,a)}})}return e.sort((s,i)=>s.priority-i.priority),e}getInjections(){return this._injections===null&&(this._injections=this._collectInjections()),this._injections}registerRule(t){const e=++this._lastRuleId,r=t(e);return this._ruleId2desc[e]=r,r}getRule(t){return this._ruleId2desc[t]}getExternalGrammar(t,e){if(this._includedGrammars[t])return this._includedGrammars[t];if(this._grammarRepository){const r=this._grammarRepository.lookup(t);if(r)return this._includedGrammars[t]=SA(r,e&&e.$base),this._includedGrammars[t]}}tokenizeLine(t,e,r=0){const n=this._tokenize(t,e,!1,r);return{tokens:n.lineTokens.getResult(n.ruleStack,n.lineLength),ruleStack:n.ruleStack,stoppedEarly:n.stoppedEarly}}tokenizeLine2(t,e,r=0){const n=this._tokenize(t,e,!0,r);return{tokens:n.lineTokens.getBinaryResult(n.ruleStack,n.lineLength),ruleStack:n.ruleStack,stoppedEarly:n.stoppedEarly}}_tokenize(t,e,r,n){this._rootId===-1&&(this._rootId=$F.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections());let s;if(!e||e===yb.NULL){s=!0;const c=this._basicScopeAttributesProvider.getDefaultAttributes(),u=this.themeProvider.getDefaults(),d=Gl.set(0,c.languageId,c.tokenType,null,u.fontStyle,u.foregroundId,u.backgroundId),h=this.getRule(this._rootId).getName(null,null);let f;h?f=vu.createRootAndLookUpScopeName(h,d,this):f=vu.createRoot("unknown",d),e=new yb(null,this._rootId,-1,-1,!1,null,f,f)}else s=!1,e.reset();t=t+`
`;const i=this.createOnigString(t),o=i.content.length,a=new Jde(r,t,this._tokenTypeMatchers,this.balancedBracketSelectors),l=HF(this,i,s,0,e,a,!0,n);return BF(i),{lineLength:o,lineTokens:a,ruleStack:l.stack,stoppedEarly:l.stoppedEarly}}};function SA(t,e){return t=hde(t),t.repository=t.repository||{},t.repository.$self={$vscodeTextmateLocation:t.$vscodeTextmateLocation,patterns:t.patterns,name:t.scopeName},t.repository.$base=e||t.repository.$self,t}var vu=class ms{constructor(e,r,n){this.parent=e,this.scopePath=r,this.tokenAttributes=n}static fromExtension(e,r){let n=e,s=e?.scopePath??null;for(const i of r)s=Dy.push(s,i.scopeNames),n=new ms(n,s,i.encodedTokenAttributes);return n}static createRoot(e,r){return new ms(null,new Dy(null,e),r)}static createRootAndLookUpScopeName(e,r,n){const s=n.getMetadataForScope(e),i=new Dy(null,e),o=n.themeProvider.themeMatch(i),a=ms.mergeAttributes(r,s,o);return new ms(null,i,a)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(e){return ms.equals(this,e)}static equals(e,r){do{if(e===r||!e&&!r)return!0;if(!e||!r||e.scopeName!==r.scopeName||e.tokenAttributes!==r.tokenAttributes)return!1;e=e.parent,r=r.parent}while(!0)}static mergeAttributes(e,r,n){let s=-1,i=0,o=0;return n!==null&&(s=n.fontStyle,i=n.foregroundId,o=n.backgroundId),Gl.set(e,r.languageId,r.tokenType,null,s,i,o)}pushAttributed(e,r){if(e===null)return this;if(e.indexOf(" ")===-1)return ms._pushAttributed(this,e,r);const n=e.split(/ /g);let s=this;for(const i of n)s=ms._pushAttributed(s,i,r);return s}static _pushAttributed(e,r,n){const s=n.getMetadataForScope(r),i=e.scopePath.push(r),o=n.themeProvider.themeMatch(i),a=ms.mergeAttributes(e.tokenAttributes,s,o);return new ms(e,i,a)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(e){const r=[];let n=this;for(;n&&n!==e;)r.push({encodedTokenAttributes:n.tokenAttributes,scopeNames:n.scopePath.getExtensionIfDefined(n.parent?.scopePath??null)}),n=n.parent;return n===e?r.reverse():void 0}},yb=class jo{constructor(e,r,n,s,i,o,a,l){this.parent=e,this.ruleId=r,this.beginRuleCapturedEOL=i,this.endRule=o,this.nameScopesList=a,this.contentNameScopesList=l,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=n,this._anchorPos=s}_stackElementBrand=void 0;static NULL=new jo(null,0,0,0,!1,null,null,null);_enterPos;_anchorPos;depth;equals(e){return e===null?!1:jo._equals(this,e)}static _equals(e,r){return e===r?!0:this._structuralEquals(e,r)?vu.equals(e.contentNameScopesList,r.contentNameScopesList):!1}static _structuralEquals(e,r){do{if(e===r||!e&&!r)return!0;if(!e||!r||e.depth!==r.depth||e.ruleId!==r.ruleId||e.endRule!==r.endRule)return!1;e=e.parent,r=r.parent}while(!0)}clone(){return this}static _reset(e){for(;e;)e._enterPos=-1,e._anchorPos=-1,e=e.parent}reset(){jo._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(e,r,n,s,i,o,a){return new jo(this,e,r,n,s,i,o,a)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(e){return e.getRule(this.ruleId)}toString(){const e=[];return this._writeString(e,0),"["+e.join(",")+"]"}_writeString(e,r){return this.parent&&(r=this.parent._writeString(e,r)),e[r++]=`(${this.ruleId}, ${this.nameScopesList?.toString()}, ${this.contentNameScopesList?.toString()})`,r}withContentNameScopesList(e){return this.contentNameScopesList===e?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,e)}withEndRule(e){return this.endRule===e?this:new jo(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,e,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(e){let r=this;for(;r&&r._enterPos===e._enterPos;){if(r.ruleId===e.ruleId)return!0;r=r.parent}return!1}toStateStackFrame(){return{ruleId:this.ruleId,beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:this.nameScopesList?.getExtensionIfDefined(this.parent?.nameScopesList??null)??[],contentNameScopesList:this.contentNameScopesList?.getExtensionIfDefined(this.nameScopesList)??[]}}static pushFrame(e,r){const n=vu.fromExtension(e?.nameScopesList??null,r.nameScopesList);return new jo(e,r.ruleId,r.enterPos??-1,r.anchorPos??-1,r.beginRuleCapturedEOL,r.endRule,n,vu.fromExtension(n,r.contentNameScopesList))}},qde=class{balancedBracketScopes;unbalancedBracketScopes;allowAny=!1;constructor(t,e){this.balancedBracketScopes=t.flatMap(r=>r==="*"?(this.allowAny=!0,[]):fm(r,gm).map(n=>n.matcher)),this.unbalancedBracketScopes=e.flatMap(r=>fm(r,gm).map(n=>n.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(t){for(const e of this.unbalancedBracketScopes)if(e(t))return!1;for(const e of this.balancedBracketScopes)if(e(t))return!0;return this.allowAny}},Jde=class{constructor(t,e,r,n){this.balancedBracketSelectors=n,this._emitBinaryTokens=t,this._tokenTypeOverrides=r,this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}_emitBinaryTokens;_lineText;_tokens;_binaryTokens;_lastTokenEndIndex;_tokenTypeOverrides;produce(t,e){this.produceFromScopes(t.contentNameScopesList,e)}produceFromScopes(t,e){if(this._lastTokenEndIndex>=e)return;if(this._emitBinaryTokens){let n=t?.tokenAttributes??0,s=!1;if(this.balancedBracketSelectors?.matchesAlways&&(s=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const i=t?.getScopeNames()??[];for(const o of this._tokenTypeOverrides)o.matcher(i)&&(n=Gl.set(n,0,o.type,null,-1,0,0));this.balancedBracketSelectors&&(s=this.balancedBracketSelectors.match(i))}if(s&&(n=Gl.set(n,0,8,s,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===n){this._lastTokenEndIndex=e;return}this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(n),this._lastTokenEndIndex=e;return}const r=t?.getScopeNames()??[];this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:e,scopes:r}),this._lastTokenEndIndex=e}getResult(t,e){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===e-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,e),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(t,e){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===e-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,e),this._binaryTokens[this._binaryTokens.length-2]=0);const r=new Uint32Array(this._binaryTokens.length);for(let n=0,s=this._binaryTokens.length;n<s;n++)r[n]=this._binaryTokens[n];return r}},Yde=class{constructor(t,e){this._onigLib=e,this._theme=t}_grammars=new Map;_rawGrammars=new Map;_injectionGrammars=new Map;_theme;dispose(){for(const t of this._grammars.values())t.dispose()}setTheme(t){this._theme=t}getColorMap(){return this._theme.getColorMap()}addGrammar(t,e){this._rawGrammars.set(t.scopeName,t),e&&this._injectionGrammars.set(t.scopeName,e)}lookup(t){return this._rawGrammars.get(t)}injections(t){return this._injectionGrammars.get(t)}getDefaults(){return this._theme.getDefaults()}themeMatch(t){return this._theme.match(t)}grammarForScopeName(t,e,r,n,s){if(!this._grammars.has(t)){let i=this._rawGrammars.get(t);if(!i)return null;this._grammars.set(t,zde(t,i,e,r,n,s,this,this._onigLib))}return this._grammars.get(t)}},Zde=class{_options;_syncRegistry;_ensureGrammarCache;constructor(e){this._options=e,this._syncRegistry=new Yde(hm.createFromRawTheme(e.theme,e.colorMap),e.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(e,r){this._syncRegistry.setTheme(hm.createFromRawTheme(e,r))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(e,r,n){return this.loadGrammarWithConfiguration(e,r,{embeddedLanguages:n})}loadGrammarWithConfiguration(e,r,n){return this._loadGrammar(e,r,n.embeddedLanguages,n.tokenTypes,new qde(n.balancedBracketSelectors||[],n.unbalancedBracketSelectors||[]))}loadGrammar(e){return this._loadGrammar(e,0,null,null,null)}_loadGrammar(e,r,n,s,i){const o=new kde(this._syncRegistry,e);for(;o.Q.length>0;)o.Q.map(a=>this._loadSingleGrammar(a.scopeName)),o.processQueue();return this._grammarForScopeName(e,r,n,s,i)}_loadSingleGrammar(e){this._ensureGrammarCache.has(e)||(this._doLoadSingleGrammar(e),this._ensureGrammarCache.set(e,!0))}_doLoadSingleGrammar(e){const r=this._options.loadGrammar(e);if(r){const n=typeof this._options.getInjections=="function"?this._options.getInjections(e):void 0;this._syncRegistry.addGrammar(r,n)}}addGrammar(e,r=[],n=0,s=null){return this._syncRegistry.addGrammar(e,r),this._grammarForScopeName(e.scopeName,n,s)}_grammarForScopeName(e,r=0,n=null,s=null,i=null){return this._syncRegistry.grammarForScopeName(e,r,n,s,i)}},_b=yb.NULL;const Xde=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class ih{constructor(e,r,n){this.normal=r,this.property=e,n&&(this.space=n)}}ih.prototype.normal={};ih.prototype.property={};ih.prototype.space=void 0;function GF(t,e){const r={},n={};for(const s of t)Object.assign(r,s.property),Object.assign(n,s.normal);return new ih(r,n,e)}function bb(t){return t.toLowerCase()}class tn{constructor(e,r){this.attribute=r,this.property=e}}tn.prototype.attribute="";tn.prototype.booleanish=!1;tn.prototype.boolean=!1;tn.prototype.commaOrSpaceSeparated=!1;tn.prototype.commaSeparated=!1;tn.prototype.defined=!1;tn.prototype.mustUseProperty=!1;tn.prototype.number=!1;tn.prototype.overloadedBoolean=!1;tn.prototype.property="";tn.prototype.spaceSeparated=!1;tn.prototype.space=void 0;let Qde=0;const Ke=Aa(),Ut=Aa(),zF=Aa(),ke=Aa(),wt=Aa(),vl=Aa(),sn=Aa();function Aa(){return 2**++Qde}const wb=Object.freeze(Object.defineProperty({__proto__:null,boolean:Ke,booleanish:Ut,commaOrSpaceSeparated:sn,commaSeparated:vl,number:ke,overloadedBoolean:zF,spaceSeparated:wt},Symbol.toStringTag,{value:"Module"})),Ly=Object.keys(wb);class LS extends tn{constructor(e,r,n,s){let i=-1;if(super(e,r),EA(this,"space",s),typeof n=="number")for(;++i<Ly.length;){const o=Ly[i];EA(this,Ly[i],(n&wb[o])===wb[o])}}}LS.prototype.defined=!0;function EA(t,e,r){r&&(t[e]=r)}function hc(t){const e={},r={};for(const[n,s]of Object.entries(t.properties)){const i=new LS(n,t.transform(t.attributes||{},n),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),e[n]=i,r[bb(n)]=n,r[bb(i.attribute)]=n}return new ih(e,r,t.space)}const WF=hc({properties:{ariaActiveDescendant:null,ariaAtomic:Ut,ariaAutoComplete:null,ariaBusy:Ut,ariaChecked:Ut,ariaColCount:ke,ariaColIndex:ke,ariaColSpan:ke,ariaControls:wt,ariaCurrent:null,ariaDescribedBy:wt,ariaDetails:null,ariaDisabled:Ut,ariaDropEffect:wt,ariaErrorMessage:null,ariaExpanded:Ut,ariaFlowTo:wt,ariaGrabbed:Ut,ariaHasPopup:null,ariaHidden:Ut,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:wt,ariaLevel:ke,ariaLive:null,ariaModal:Ut,ariaMultiLine:Ut,ariaMultiSelectable:Ut,ariaOrientation:null,ariaOwns:wt,ariaPlaceholder:null,ariaPosInSet:ke,ariaPressed:Ut,ariaReadOnly:Ut,ariaRelevant:null,ariaRequired:Ut,ariaRoleDescription:wt,ariaRowCount:ke,ariaRowIndex:ke,ariaRowSpan:ke,ariaSelected:Ut,ariaSetSize:ke,ariaSort:null,ariaValueMax:ke,ariaValueMin:ke,ariaValueNow:ke,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function KF(t,e){return e in t?t[e]:e}function qF(t,e){return KF(t,e.toLowerCase())}const ehe=hc({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:vl,acceptCharset:wt,accessKey:wt,action:null,allow:null,allowFullScreen:Ke,allowPaymentRequest:Ke,allowUserMedia:Ke,alt:null,as:null,async:Ke,autoCapitalize:null,autoComplete:wt,autoFocus:Ke,autoPlay:Ke,blocking:wt,capture:null,charSet:null,checked:Ke,cite:null,className:wt,cols:ke,colSpan:null,content:null,contentEditable:Ut,controls:Ke,controlsList:wt,coords:ke|vl,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Ke,defer:Ke,dir:null,dirName:null,disabled:Ke,download:zF,draggable:Ut,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Ke,formTarget:null,headers:wt,height:ke,hidden:Ke,high:ke,href:null,hrefLang:null,htmlFor:wt,httpEquiv:wt,id:null,imageSizes:null,imageSrcSet:null,inert:Ke,inputMode:null,integrity:null,is:null,isMap:Ke,itemId:null,itemProp:wt,itemRef:wt,itemScope:Ke,itemType:wt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Ke,low:ke,manifest:null,max:null,maxLength:ke,media:null,method:null,min:null,minLength:ke,multiple:Ke,muted:Ke,name:null,nonce:null,noModule:Ke,noValidate:Ke,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Ke,optimum:ke,pattern:null,ping:wt,placeholder:null,playsInline:Ke,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Ke,referrerPolicy:null,rel:wt,required:Ke,reversed:Ke,rows:ke,rowSpan:ke,sandbox:wt,scope:null,scoped:Ke,seamless:Ke,selected:Ke,shadowRootClonable:Ke,shadowRootDelegatesFocus:Ke,shadowRootMode:null,shape:null,size:ke,sizes:null,slot:null,span:ke,spellCheck:Ut,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ke,step:null,style:null,tabIndex:ke,target:null,title:null,translate:null,type:null,typeMustMatch:Ke,useMap:null,value:Ut,width:ke,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:wt,axis:null,background:null,bgColor:null,border:ke,borderColor:null,bottomMargin:ke,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Ke,declare:Ke,event:null,face:null,frame:null,frameBorder:null,hSpace:ke,leftMargin:ke,link:null,longDesc:null,lowSrc:null,marginHeight:ke,marginWidth:ke,noResize:Ke,noHref:Ke,noShade:Ke,noWrap:Ke,object:null,profile:null,prompt:null,rev:null,rightMargin:ke,rules:null,scheme:null,scrolling:Ut,standby:null,summary:null,text:null,topMargin:ke,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ke,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Ke,disableRemotePlayback:Ke,prefix:null,property:null,results:ke,security:null,unselectable:null},space:"html",transform:qF}),the=hc({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:sn,accentHeight:ke,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ke,amplitude:ke,arabicForm:null,ascent:ke,attributeName:null,attributeType:null,azimuth:ke,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ke,by:null,calcMode:null,capHeight:ke,className:wt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ke,diffuseConstant:ke,direction:null,display:null,dur:null,divisor:ke,dominantBaseline:null,download:Ke,dx:null,dy:null,edgeMode:null,editable:null,elevation:ke,enableBackground:null,end:null,event:null,exponent:ke,externalResourcesRequired:null,fill:null,fillOpacity:ke,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:vl,g2:vl,glyphName:vl,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ke,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ke,horizOriginX:ke,horizOriginY:ke,id:null,ideographic:ke,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ke,k:ke,k1:ke,k2:ke,k3:ke,k4:ke,kernelMatrix:sn,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ke,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ke,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ke,overlineThickness:ke,paintOrder:null,panose1:null,path:null,pathLength:ke,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:wt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ke,pointsAtY:ke,pointsAtZ:ke,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:sn,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:sn,rev:sn,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:sn,requiredFeatures:sn,requiredFonts:sn,requiredFormats:sn,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ke,specularExponent:ke,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ke,strikethroughThickness:ke,string:null,stroke:null,strokeDashArray:sn,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ke,strokeOpacity:ke,strokeWidth:null,style:null,surfaceScale:ke,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:sn,tabIndex:ke,tableValues:null,target:null,targetX:ke,targetY:ke,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:sn,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ke,underlineThickness:ke,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ke,values:null,vAlphabetic:ke,vMathematical:ke,vectorEffect:null,vHanging:ke,vIdeographic:ke,version:null,vertAdvY:ke,vertOriginX:ke,vertOriginY:ke,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ke,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:KF}),JF=hc({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),YF=hc({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:qF}),ZF=hc({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),rhe=/[A-Z]/g,CA=/-[a-z]/g,nhe=/^data[-\w.:]+$/i;function she(t,e){const r=bb(e);let n=e,s=tn;if(r in t.normal)return t.property[t.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&nhe.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(CA,ohe);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!CA.test(i)){let o=i.replace(rhe,ihe);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=LS}return new s(n,e)}function ihe(t){return"-"+t.toLowerCase()}function ohe(t){return t.charAt(1).toUpperCase()}const ahe=GF([WF,ehe,JF,YF,ZF],"html"),XF=GF([WF,the,JF,YF,ZF],"svg"),kA={}.hasOwnProperty;function lhe(t,e){const r=e||{};function n(s,...i){let o=n.invalid;const a=n.handlers;if(s&&kA.call(s,t)){const l=String(s[t]);o=kA.call(a,l)?a[l]:n.unknown}if(o)return o.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}const che=/["&'<>`]/g,uhe=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,dhe=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,hhe=/[|\\{}()[\]^$+*?.]/g,TA=new WeakMap;function fhe(t,e){if(t=t.replace(e.subset?phe(e.subset):che,n),e.subset||e.escapeOnly)return t;return t.replace(uhe,r).replace(dhe,n);function r(s,i,o){return e.format((s.charCodeAt(0)-55296)*1024+s.charCodeAt(1)-56320+65536,o.charCodeAt(i+2),e)}function n(s,i,o){return e.format(s.charCodeAt(0),o.charCodeAt(i+1),e)}}function phe(t){let e=TA.get(t);return e||(e=mhe(t),TA.set(t,e)),e}function mhe(t){const e=[];let r=-1;for(;++r<t.length;)e.push(t[r].replace(hhe,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}const ghe=/[\dA-Fa-f]/;function vhe(t,e,r){const n="&#x"+t.toString(16).toUpperCase();return r&&e&&!ghe.test(String.fromCharCode(e))?n:n+";"}const yhe=/\d/;function _he(t,e,r){const n="&#"+String(t);return r&&e&&!yhe.test(String.fromCharCode(e))?n:n+";"}const bhe=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Ny={nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",fnof:"ƒ",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",bull:"•",hellip:"…",prime:"′",Prime:"″",oline:"‾",frasl:"⁄",weierp:"℘",image:"ℑ",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",quot:'"',amp:"&",lt:"<",gt:">",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",permil:"‰",lsaquo:"‹",rsaquo:"›",euro:"€"},whe=["cent","copy","divide","gt","lt","not","para","times"],QF={}.hasOwnProperty,xb={};let ef;for(ef in Ny)QF.call(Ny,ef)&&(xb[Ny[ef]]=ef);const xhe=/[^\dA-Za-z]/;function She(t,e,r,n){const s=String.fromCharCode(t);if(QF.call(xb,s)){const i=xb[s],o="&"+i;return r&&bhe.includes(i)&&!whe.includes(i)&&(!n||e&&e!==61&&xhe.test(String.fromCharCode(e)))?o:o+";"}return""}function Ehe(t,e,r){let n=vhe(t,e,r.omitOptionalSemicolons),s;if((r.useNamedReferences||r.useShortestReferences)&&(s=She(t,e,r.omitOptionalSemicolons,r.attribute)),(r.useShortestReferences||!s)&&r.useShortestReferences){const i=_he(t,e,r.omitOptionalSemicolons);i.length<n.length&&(n=i)}return s&&(!r.useShortestReferences||s.length<n.length)?s:n}function yl(t,e){return fhe(t,Object.assign({format:Ehe},e))}const Che=/^>|^->|<!--|-->|--!>|<!-$/g,khe=[">"],The=["<",">"];function Ahe(t,e,r,n){return n.settings.bogusComments?"<?"+yl(t.value,Object.assign({},n.settings.characterReferences,{subset:khe}))+">":"<!--"+t.value.replace(Che,s)+"-->";function s(i){return yl(i,Object.assign({},n.settings.characterReferences,{subset:The}))}}function Rhe(t,e,r,n){return"<!"+(n.settings.upperDoctype?"DOCTYPE":"doctype")+(n.settings.tightDoctype?"":" ")+"html>"}function AA(t,e){const r=String(t);if(typeof e!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(e);for(;s!==-1;)n++,s=r.indexOf(e,s+e.length);return n}function Phe(t,e){const r=e||{};return(t[t.length-1]===""?[...t,""]:t).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}function Ihe(t){return t.join(" ").trim()}const Ohe=/[ \t\n\f\r]/g;function NS(t){return typeof t=="object"?t.type==="text"?RA(t.value):!1:RA(t)}function RA(t){return t.replace(Ohe,"")===""}const Zt=t3(1),e3=t3(-1),Dhe=[];function t3(t){return e;function e(r,n,s){const i=r?r.children:Dhe;let o=(n||0)+t,a=i[o];if(!s)for(;a&&NS(a);)o+=t,a=i[o];return a}}const Mhe={}.hasOwnProperty;function r3(t){return e;function e(r,n,s){return Mhe.call(t,r.tagName)&&t[r.tagName](r,n,s)}}const BS=r3({body:Nhe,caption:By,colgroup:By,dd:$he,dt:jhe,head:By,html:Lhe,li:Fhe,optgroup:Uhe,option:Hhe,p:Bhe,rp:PA,rt:PA,tbody:Ghe,td:IA,tfoot:zhe,th:IA,thead:Vhe,tr:Whe});function By(t,e,r){const n=Zt(r,e,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&NS(n.value.charAt(0)))}function Lhe(t,e,r){const n=Zt(r,e);return!n||n.type!=="comment"}function Nhe(t,e,r){const n=Zt(r,e);return!n||n.type!=="comment"}function Bhe(t,e,r){const n=Zt(r,e);return n?n.type==="element"&&(n.tagName==="address"||n.tagName==="article"||n.tagName==="aside"||n.tagName==="blockquote"||n.tagName==="details"||n.tagName==="div"||n.tagName==="dl"||n.tagName==="fieldset"||n.tagName==="figcaption"||n.tagName==="figure"||n.tagName==="footer"||n.tagName==="form"||n.tagName==="h1"||n.tagName==="h2"||n.tagName==="h3"||n.tagName==="h4"||n.tagName==="h5"||n.tagName==="h6"||n.tagName==="header"||n.tagName==="hgroup"||n.tagName==="hr"||n.tagName==="main"||n.tagName==="menu"||n.tagName==="nav"||n.tagName==="ol"||n.tagName==="p"||n.tagName==="pre"||n.tagName==="section"||n.tagName==="table"||n.tagName==="ul"):!r||!(r.type==="element"&&(r.tagName==="a"||r.tagName==="audio"||r.tagName==="del"||r.tagName==="ins"||r.tagName==="map"||r.tagName==="noscript"||r.tagName==="video"))}function Fhe(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&n.tagName==="li"}function jhe(t,e,r){const n=Zt(r,e);return!!(n&&n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd"))}function $he(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd")}function PA(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&(n.tagName==="rp"||n.tagName==="rt")}function Uhe(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&n.tagName==="optgroup"}function Hhe(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&(n.tagName==="option"||n.tagName==="optgroup")}function Vhe(t,e,r){const n=Zt(r,e);return!!(n&&n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot"))}function Ghe(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot")}function zhe(t,e,r){return!Zt(r,e)}function Whe(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&n.tagName==="tr"}function IA(t,e,r){const n=Zt(r,e);return!n||n.type==="element"&&(n.tagName==="td"||n.tagName==="th")}const Khe=r3({body:Yhe,colgroup:Zhe,head:Jhe,html:qhe,tbody:Xhe});function qhe(t){const e=Zt(t,-1);return!e||e.type!=="comment"}function Jhe(t){const e=new Set;for(const n of t.children)if(n.type==="element"&&(n.tagName==="base"||n.tagName==="title")){if(e.has(n.tagName))return!1;e.add(n.tagName)}const r=t.children[0];return!r||r.type==="element"}function Yhe(t){const e=Zt(t,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&NS(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function Zhe(t,e,r){const n=e3(r,e),s=Zt(t,-1,!0);return r&&n&&n.type==="element"&&n.tagName==="colgroup"&&BS(n,r.children.indexOf(n),r)?!1:!!(s&&s.type==="element"&&s.tagName==="col")}function Xhe(t,e,r){const n=e3(r,e),s=Zt(t,-1);return r&&n&&n.type==="element"&&(n.tagName==="thead"||n.tagName==="tbody")&&BS(n,r.children.indexOf(n),r)?!1:!!(s&&s.type==="element"&&s.tagName==="tr")}const tf={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Qhe(t,e,r,n){const s=n.schema,i=s.space==="svg"?!1:n.settings.omitOptionalTags;let o=s.space==="svg"?n.settings.closeEmptyElements:n.settings.voids.includes(t.tagName.toLowerCase());const a=[];let l;s.space==="html"&&t.tagName==="svg"&&(n.schema=XF);const c=efe(n,t.properties),u=n.all(s.space==="html"&&t.tagName==="template"?t.content:t);return n.schema=s,u&&(o=!1),(c||!i||!Khe(t,e,r))&&(a.push("<",t.tagName,c?" "+c:""),o&&(s.space==="svg"||n.settings.closeSelfClosing)&&(l=c.charAt(c.length-1),(!n.settings.tightSelfClosing||l==="/"||l&&l!=='"'&&l!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!i||!BS(t,e,r))&&a.push("</"+t.tagName+">"),a.join("")}function efe(t,e){const r=[];let n=-1,s;if(e){for(s in e)if(e[s]!==null&&e[s]!==void 0){const i=tfe(t,s,e[s]);i&&r.push(i)}}for(;++n<r.length;){const i=t.settings.tightAttributes?r[n].charAt(r[n].length-1):void 0;n!==r.length-1&&i!=='"'&&i!=="'"&&(r[n]+=" ")}return r.join("")}function tfe(t,e,r){const n=she(t.schema,e),s=t.settings.allowParseErrors&&t.schema.space==="html"?0:1,i=t.settings.allowDangerousCharacters?0:1;let o=t.quote,a;if(n.overloadedBoolean&&(r===n.attribute||r==="")?r=!0:(n.boolean||n.overloadedBoolean)&&(typeof r!="string"||r===n.attribute||r==="")&&(r=!!r),r==null||r===!1||typeof r=="number"&&Number.isNaN(r))return"";const l=yl(n.attribute,Object.assign({},t.settings.characterReferences,{subset:tf.name[s][i]}));return r===!0||(r=Array.isArray(r)?(n.commaSeparated?Phe:Ihe)(r,{padLeft:!t.settings.tightCommaSeparatedLists}):String(r),t.settings.collapseEmptyAttributes&&!r)?l:(t.settings.preferUnquoted&&(a=yl(r,Object.assign({},t.settings.characterReferences,{attribute:!0,subset:tf.unquoted[s][i]}))),a!==r&&(t.settings.quoteSmart&&AA(r,o)>AA(r,t.alternative)&&(o=t.alternative),a=o+yl(r,Object.assign({},t.settings.characterReferences,{subset:(o==="'"?tf.single:tf.double)[s][i],attribute:!0}))+o),l+(a&&"="+a))}const rfe=["<","&"];function n3(t,e,r,n){return r&&r.type==="element"&&(r.tagName==="script"||r.tagName==="style")?t.value:yl(t.value,Object.assign({},n.settings.characterReferences,{subset:rfe}))}function nfe(t,e,r,n){return n.settings.allowDangerousHtml?t.value:n3(t,e,r,n)}function sfe(t,e,r,n){return n.all(t)}const ife=lhe("type",{invalid:ofe,unknown:afe,handlers:{comment:Ahe,doctype:Rhe,element:Qhe,raw:nfe,root:sfe,text:n3}});function ofe(t){throw new Error("Expected node, not `"+t+"`")}function afe(t){const e=t;throw new Error("Cannot compile unknown node `"+e.type+"`")}const lfe={},cfe={},ufe=[];function dfe(t,e){const r=lfe,n=r.quote||'"',s=n==='"'?"'":'"';if(n!=='"'&&n!=="'")throw new Error("Invalid quote `"+n+"`, expected `'` or `\"`");return{one:hfe,all:ffe,settings:{omitOptionalTags:r.omitOptionalTags||!1,allowParseErrors:r.allowParseErrors||!1,allowDangerousCharacters:r.allowDangerousCharacters||!1,quoteSmart:r.quoteSmart||!1,preferUnquoted:r.preferUnquoted||!1,tightAttributes:r.tightAttributes||!1,upperDoctype:r.upperDoctype||!1,tightDoctype:r.tightDoctype||!1,bogusComments:r.bogusComments||!1,tightCommaSeparatedLists:r.tightCommaSeparatedLists||!1,tightSelfClosing:r.tightSelfClosing||!1,collapseEmptyAttributes:r.collapseEmptyAttributes||!1,allowDangerousHtml:r.allowDangerousHtml||!1,voids:r.voids||Xde,characterReferences:r.characterReferences||cfe,closeSelfClosing:r.closeSelfClosing||!1,closeEmptyElements:r.closeEmptyElements||!1},schema:r.space==="svg"?XF:ahe,quote:n,alternative:s}.one(Array.isArray(t)?{type:"root",children:t}:t,void 0,void 0)}function hfe(t,e,r){return ife(t,e,r,this)}function ffe(t){const e=[],r=t&&t.children||ufe;let n=-1;for(;++n<r.length;)e[n]=this.one(r[n],n,t);return e.join("")}function pfe(t){return Array.isArray(t)?t:[t]}function $g(t,e=!1){const r=t.split(/(\r?\n)/g);let n=0;const s=[];for(let i=0;i<r.length;i+=2){const o=e?r[i]+(r[i+1]||""):r[i];s.push([o,n]),n+=r[i].length,n+=r[i+1]?.length||0}return s}function FS(t){return!t||["plaintext","txt","text","plain"].includes(t)}function s3(t){return t==="ansi"||FS(t)}function jS(t){return t==="none"}function i3(t){return jS(t)}function o3(t,e){if(!e)return t;t.properties||={},t.properties.class||=[],typeof t.properties.class=="string"&&(t.properties.class=t.properties.class.split(/\s+/g)),Array.isArray(t.properties.class)||(t.properties.class=[]);const r=Array.isArray(e)?e:e.split(/\s+/g);for(const n of r)n&&!t.properties.class.includes(n)&&t.properties.class.push(n);return t}function mfe(t,e){let r=0;const n=[];for(const s of e)s>r&&n.push({...t,content:t.content.slice(r,s),offset:t.offset+r}),r=s;return r<t.content.length&&n.push({...t,content:t.content.slice(r),offset:t.offset+r}),n}function gfe(t,e){const r=Array.from(e instanceof Set?e:new Set(e)).sort((n,s)=>n-s);return r.length?t.map(n=>n.flatMap(s=>{const i=r.filter(o=>s.offset<o&&o<s.offset+s.content.length).map(o=>o-s.offset).sort((o,a)=>o-a);return i.length?mfe(s,i):s})):t}async function a3(t){return Promise.resolve(typeof t=="function"?t():t).then(e=>e.default||e)}function vm(t,e){const r=typeof t=="string"?{}:{...t.colorReplacements},n=typeof t=="string"?t:t.name;for(const[s,i]of Object.entries(e?.colorReplacements||{}))typeof i=="string"?r[s]=i:s===n&&Object.assign(r,i);return r}function qo(t,e){return t&&(e?.[t?.toLowerCase()]||t)}function l3(t){const e={};return t.color&&(e.color=t.color),t.bgColor&&(e["background-color"]=t.bgColor),t.fontStyle&&(t.fontStyle&pi.Italic&&(e["font-style"]="italic"),t.fontStyle&pi.Bold&&(e["font-weight"]="bold"),t.fontStyle&pi.Underline&&(e["text-decoration"]="underline")),e}function vfe(t){return typeof t=="string"?t:Object.entries(t).map(([e,r])=>`${e}:${r}`).join(";")}function yfe(t){const e=$g(t,!0).map(([s])=>s);function r(s){if(s===t.length)return{line:e.length-1,character:e[e.length-1].length};let i=s,o=0;for(const a of e){if(i<a.length)break;i-=a.length,o++}return{line:o,character:i}}function n(s,i){let o=0;for(let a=0;a<s;a++)o+=e[a].length;return o+=i,o}return{lines:e,indexToPos:r,posToIndex:n}}class Nr extends Error{constructor(e){super(e),this.name="ShikiError"}}const c3=new WeakMap;function Ug(t,e){c3.set(t,e)}function Sd(t){return c3.get(t)}class fc{_stacks={};lang;get themes(){return Object.keys(this._stacks)}get theme(){return this.themes[0]}get _stack(){return this._stacks[this.theme]}static initial(e,r){return new fc(Object.fromEntries(pfe(r).map(n=>[n,_b])),e)}constructor(...e){if(e.length===2){const[r,n]=e;this.lang=n,this._stacks=r}else{const[r,n,s]=e;this.lang=n,this._stacks={[s]:r}}}getInternalStack(e=this.theme){return this._stacks[e]}get scopes(){return OA(this._stacks[this.theme])}getScopes(e=this.theme){return OA(this._stacks[e])}toJSON(){return{lang:this.lang,theme:this.theme,themes:this.themes,scopes:this.scopes}}}function OA(t){const e=[],r=new Set;function n(s){if(r.has(s))return;r.add(s);const i=s?.nameScopesList?.scopeName;i&&e.push(i),s.parent&&n(s.parent)}return n(t),e}function _fe(t,e){if(!(t instanceof fc))throw new Nr("Invalid grammar state");return t.getInternalStack(e)}function bfe(){const t=new WeakMap;function e(r){if(!t.has(r.meta)){let n=function(o){if(typeof o=="number"){if(o<0||o>r.source.length)throw new Nr(`Invalid decoration offset: ${o}. Code length: ${r.source.length}`);return{...s.indexToPos(o),offset:o}}else{const a=s.lines[o.line];if(a===void 0)throw new Nr(`Invalid decoration position ${JSON.stringify(o)}. Lines length: ${s.lines.length}`);if(o.character<0||o.character>a.length)throw new Nr(`Invalid decoration position ${JSON.stringify(o)}. Line ${o.line} length: ${a.length}`);return{...o,offset:s.posToIndex(o.line,o.character)}}};const s=yfe(r.source),i=(r.options.decorations||[]).map(o=>({...o,start:n(o.start),end:n(o.end)}));wfe(i),t.set(r.meta,{decorations:i,converter:s,source:r.source})}return t.get(r.meta)}return{name:"shiki:decorations",tokens(r){if(!this.options.decorations?.length)return;const s=e(this).decorations.flatMap(o=>[o.start.offset,o.end.offset]);return gfe(r,s)},code(r){if(!this.options.decorations?.length)return;const n=e(this),s=Array.from(r.children).filter(u=>u.type==="element"&&u.tagName==="span");if(s.length!==n.converter.lines.length)throw new Nr(`Number of lines in code element (${s.length}) does not match the number of lines in the source (${n.converter.lines.length}). Failed to apply decorations.`);function i(u,d,h,f){const v=s[u];let m="",p=-1,g=-1;if(d===0&&(p=0),h===0&&(g=0),h===Number.POSITIVE_INFINITY&&(g=v.children.length),p===-1||g===-1)for(let _=0;_<v.children.length;_++)m+=u3(v.children[_]),p===-1&&m.length===d&&(p=_+1),g===-1&&m.length===h&&(g=_+1);if(p===-1)throw new Nr(`Failed to find start index for decoration ${JSON.stringify(f.start)}`);if(g===-1)throw new Nr(`Failed to find end index for decoration ${JSON.stringify(f.end)}`);const y=v.children.slice(p,g);if(!f.alwaysWrap&&y.length===v.children.length)a(v,f,"line");else if(!f.alwaysWrap&&y.length===1&&y[0].type==="element")a(y[0],f,"token");else{const _={type:"element",tagName:"span",properties:{},children:y};a(_,f,"wrapper"),v.children.splice(p,y.length,_)}}function o(u,d){s[u]=a(s[u],d,"line")}function a(u,d,h){const f=d.properties||{},v=d.transform||(m=>m);return u.tagName=d.tagName||"span",u.properties={...u.properties,...f,class:u.properties.class},d.properties?.class&&o3(u,d.properties.class),u=v(u,h)||u,u}const l=[],c=n.decorations.sort((u,d)=>d.start.offset-u.start.offset);for(const u of c){const{start:d,end:h}=u;if(d.line===h.line)i(d.line,d.character,h.character,u);else if(d.line<h.line){i(d.line,d.character,Number.POSITIVE_INFINITY,u);for(let f=d.line+1;f<h.line;f++)l.unshift(()=>o(f,u));i(h.line,0,h.character,u)}}l.forEach(u=>u())}}}function wfe(t){for(let e=0;e<t.length;e++){const r=t[e];if(r.start.offset>r.end.offset)throw new Nr(`Invalid decoration range: ${JSON.stringify(r.start)} - ${JSON.stringify(r.end)}`);for(let n=e+1;n<t.length;n++){const s=t[n],i=r.start.offset<s.start.offset&&s.start.offset<r.end.offset,o=r.start.offset<s.end.offset&&s.end.offset<r.end.offset,a=s.start.offset<r.start.offset&&r.start.offset<s.end.offset,l=s.start.offset<r.end.offset&&r.end.offset<s.end.offset;if(i||o||a||l){if(o&&o||a&&l)continue;throw new Nr(`Decorations ${JSON.stringify(r.start)} and ${JSON.stringify(s.start)} intersect.`)}}}}function u3(t){return t.type==="text"?t.value:t.type==="element"?t.children.map(u3).join(""):""}const xfe=[bfe()];function ym(t){return[...t.transformers||[],...xfe]}var Jo=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],Fy={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function Sfe(t,e){const r=t.indexOf("\x1B[",e);if(r!==-1){const n=t.indexOf("m",r);return{sequence:t.substring(r+2,n).split(";"),startPosition:r,position:n+1}}return{position:t.length}}function DA(t,e){let r=1;const n=t[e+r++];let s;if(n==="2"){const i=[t[e+r++],t[e+r++],t[e+r]].map(o=>Number.parseInt(o));i.length===3&&!i.some(o=>Number.isNaN(o))&&(s={type:"rgb",rgb:i})}else if(n==="5"){const i=Number.parseInt(t[e+r]);Number.isNaN(i)||(s={type:"table",index:Number(i)})}return[r,s]}function Efe(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r],s=Number.parseInt(n);if(!Number.isNaN(s))if(s===0)e.push({type:"resetAll"});else if(s<=9)Fy[s]&&e.push({type:"setDecoration",value:Fy[s]});else if(s<=29){const i=Fy[s-20];i&&e.push({type:"resetDecoration",value:i})}else if(s<=37)e.push({type:"setForegroundColor",value:{type:"named",name:Jo[s-30]}});else if(s===38){const[i,o]=DA(t,r);o&&e.push({type:"setForegroundColor",value:o}),r+=i}else if(s===39)e.push({type:"resetForegroundColor"});else if(s<=47)e.push({type:"setBackgroundColor",value:{type:"named",name:Jo[s-40]}});else if(s===48){const[i,o]=DA(t,r);o&&e.push({type:"setBackgroundColor",value:o}),r+=i}else s===49?e.push({type:"resetBackgroundColor"}):s>=90&&s<=97?e.push({type:"setForegroundColor",value:{type:"named",name:Jo[s-90+8]}}):s>=100&&s<=107&&e.push({type:"setBackgroundColor",value:{type:"named",name:Jo[s-100+8]}})}return e}function Cfe(){let t=null,e=null,r=new Set;return{parse(n){const s=[];let i=0;do{const o=Sfe(n,i),a=o.sequence?n.substring(i,o.startPosition):n.substring(i);if(a.length>0&&s.push({value:a,foreground:t,background:e,decorations:new Set(r)}),o.sequence){const l=Efe(o.sequence);for(const c of l)c.type==="resetAll"?(t=null,e=null,r.clear()):c.type==="resetForegroundColor"?t=null:c.type==="resetBackgroundColor"?e=null:c.type==="resetDecoration"&&r.delete(c.value);for(const c of l)c.type==="setForegroundColor"?t=c.value:c.type==="setBackgroundColor"?e=c.value:c.type==="setDecoration"&&r.add(c.value)}i=o.position}while(i<n.length);return s}}}var kfe={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function Tfe(t=kfe){function e(a){return t[a]}function r(a){return`#${a.map(l=>Math.max(0,Math.min(l,255)).toString(16).padStart(2,"0")).join("")}`}let n;function s(){if(n)return n;n=[];for(let c=0;c<Jo.length;c++)n.push(e(Jo[c]));let a=[0,95,135,175,215,255];for(let c=0;c<6;c++)for(let u=0;u<6;u++)for(let d=0;d<6;d++)n.push(r([a[c],a[u],a[d]]));let l=8;for(let c=0;c<24;c++,l+=10)n.push(r([l,l,l]));return n}function i(a){return s()[a]}function o(a){switch(a.type){case"named":return e(a.name);case"rgb":return r(a.rgb);case"table":return i(a.index)}}return{value:o}}function Afe(t,e,r){const n=vm(t,r),s=$g(e),i=Tfe(Object.fromEntries(Jo.map(a=>[a,t.colors?.[`terminal.ansi${a[0].toUpperCase()}${a.substring(1)}`]]))),o=Cfe();return s.map(a=>o.parse(a[0]).map(l=>{let c,u;l.decorations.has("reverse")?(c=l.background?i.value(l.background):t.bg,u=l.foreground?i.value(l.foreground):t.fg):(c=l.foreground?i.value(l.foreground):t.fg,u=l.background?i.value(l.background):void 0),c=qo(c,n),u=qo(u,n),l.decorations.has("dim")&&(c=Rfe(c));let d=pi.None;return l.decorations.has("bold")&&(d|=pi.Bold),l.decorations.has("italic")&&(d|=pi.Italic),l.decorations.has("underline")&&(d|=pi.Underline),{content:l.value,offset:a[1],color:c,bgColor:u,fontStyle:d}}))}function Rfe(t){const e=t.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(e)if(e[3]){const n=Math.round(Number.parseInt(e[3],16)/2).toString(16).padStart(2,"0");return`#${e[1]}${e[2]}${n}`}else return e[2]?`#${e[1]}${e[2]}80`:`#${Array.from(e[1]).map(n=>`${n}${n}`).join("")}80`;const r=t.match(/var\((--[\w-]+-ansi-[\w-]+)\)/);return r?`var(${r[1]}-dim)`:t}function $S(t,e,r={}){const{lang:n="text",theme:s=t.getLoadedThemes()[0]}=r;if(FS(n)||jS(s))return $g(e).map(l=>[{content:l[0],offset:l[1]}]);const{theme:i,colorMap:o}=t.setTheme(s);if(n==="ansi")return Afe(i,e,r);const a=t.getLanguage(n);if(r.grammarState){if(r.grammarState.lang!==a.name)throw new mi(`Grammar state language "${r.grammarState.lang}" does not match highlight language "${a.name}"`);if(!r.grammarState.themes.includes(i.name))throw new mi(`Grammar state themes "${r.grammarState.themes}" do not contain highlight theme "${i.name}"`)}return Ife(e,a,i,o,r)}function Pfe(...t){if(t.length===2)return Sd(t[1]);const[e,r,n={}]=t,{lang:s="text",theme:i=e.getLoadedThemes()[0]}=n;if(FS(s)||jS(i))throw new mi("Plain language does not have grammar state");if(s==="ansi")throw new mi("ANSI language does not have grammar state");const{theme:o,colorMap:a}=e.setTheme(i),l=e.getLanguage(s);return new fc(_m(r,l,o,a,n).stateStack,l.name,o.name)}function Ife(t,e,r,n,s){const i=_m(t,e,r,n,s),o=new fc(_m(t,e,r,n,s).stateStack,e.name,r.name);return Ug(i.tokens,o),i.tokens}function _m(t,e,r,n,s){const i=vm(r,s),{tokenizeMaxLineLength:o=0,tokenizeTimeLimit:a=500}=s,l=$g(t);let c=s.grammarState?_fe(s.grammarState,r.name)??_b:s.grammarContextCode!=null?_m(s.grammarContextCode,e,r,n,{...s,grammarState:void 0,grammarContextCode:void 0}).stateStack:_b,u=[];const d=[];for(let h=0,f=l.length;h<f;h++){const[v,m]=l[h];if(v===""){u=[],d.push([]);continue}if(o>0&&v.length>=o){u=[],d.push([{content:v,offset:m,color:"",fontStyle:0}]);continue}let p,g,y;s.includeExplanation&&(p=e.tokenizeLine(v,c),g=p.tokens,y=0);const _=e.tokenizeLine2(v,c,a),b=_.tokens.length/2;for(let w=0;w<b;w++){const E=_.tokens[2*w],S=w+1<b?_.tokens[2*w+2]:v.length;if(E===S)continue;const x=_.tokens[2*w+1],T=qo(n[Gl.getForeground(x)],i),D=Gl.getFontStyle(x),O={content:v.substring(E,S),offset:m+E,color:T,fontStyle:D};if(s.includeExplanation){const R=[];if(s.includeExplanation!=="scopeName")for(const A of r.settings){let H;switch(typeof A.scope){case"string":H=A.scope.split(/,/).map(K=>K.trim());break;case"object":H=A.scope;break;default:continue}R.push({settings:A,selectors:H.map(K=>K.split(/ /))})}O.explanation=[];let P=0;for(;E+P<S;){const A=g[y],H=v.substring(A.startIndex,A.endIndex);P+=H.length,O.explanation.push({content:H,scopes:s.includeExplanation==="scopeName"?Ofe(A.scopes):Dfe(R,A.scopes)}),y+=1}}u.push(O)}d.push(u),u=[],c=_.ruleStack}return{tokens:d,stateStack:c}}function Ofe(t){return t.map(e=>({scopeName:e}))}function Dfe(t,e){const r=[];for(let n=0,s=e.length;n<s;n++){const i=e[n];r[n]={scopeName:i,themeMatches:Lfe(t,i,e.slice(0,n))}}return r}function MA(t,e){return t===e||e.substring(0,t.length)===t&&e[t.length]==="."}function Mfe(t,e,r){if(!MA(t[t.length-1],e))return!1;let n=t.length-2,s=r.length-1;for(;n>=0&&s>=0;)MA(t[n],r[s])&&(n-=1),s-=1;return n===-1}function Lfe(t,e,r){const n=[];for(const{selectors:s,settings:i}of t)for(const o of s)if(Mfe(o,e,r)){n.push(i);break}return n}function d3(t,e,r){const n=Object.entries(r.themes).filter(l=>l[1]).map(l=>({color:l[0],theme:l[1]})),s=n.map(l=>{const c=$S(t,e,{...r,theme:l.theme}),u=Sd(c),d=typeof l.theme=="string"?l.theme:l.theme.name;return{tokens:c,state:u,theme:d}}),i=Nfe(...s.map(l=>l.tokens)),o=i[0].map((l,c)=>l.map((u,d)=>{const h={content:u.content,variants:{},offset:u.offset};return"includeExplanation"in r&&r.includeExplanation&&(h.explanation=u.explanation),i.forEach((f,v)=>{const{content:m,explanation:p,offset:g,...y}=f[c][d];h.variants[n[v].color]=y}),h})),a=s[0].state?new fc(Object.fromEntries(s.map(l=>[l.theme,l.state?.getInternalStack(l.theme)])),s[0].state.lang):void 0;return a&&Ug(o,a),o}function Nfe(...t){const e=t.map(()=>[]),r=t.length;for(let n=0;n<t[0].length;n++){const s=t.map(l=>l[n]),i=e.map(()=>[]);e.forEach((l,c)=>l.push(i[c]));const o=s.map(()=>0),a=s.map(l=>l[0]);for(;a.every(l=>l);){const l=Math.min(...a.map(c=>c.content.length));for(let c=0;c<r;c++){const u=a[c];u.content.length===l?(i[c].push(u),o[c]+=1,a[c]=s[c][o[c]]):(i[c].push({...u,content:u.content.slice(0,l)}),a[c]={...u,content:u.content.slice(l),offset:u.offset+l})}}}return e}function bm(t,e,r){let n,s,i,o,a,l;if("themes"in r){const{defaultColor:c="light",cssVariablePrefix:u="--shiki-"}=r,d=Object.entries(r.themes).filter(p=>p[1]).map(p=>({color:p[0],theme:p[1]})).sort((p,g)=>p.color===c?-1:g.color===c?1:0);if(d.length===0)throw new mi("`themes` option must not be empty");const h=d3(t,e,r);if(l=Sd(h),c&&!d.find(p=>p.color===c))throw new mi(`\`themes\` option must contain the defaultColor key \`${c}\``);const f=d.map(p=>t.getTheme(p.theme)),v=d.map(p=>p.color);i=h.map(p=>p.map(g=>Bfe(g,v,u,c))),l&&Ug(i,l);const m=d.map(p=>vm(p.theme,r));s=d.map((p,g)=>(g===0&&c?"":`${u+p.color}:`)+(qo(f[g].fg,m[g])||"inherit")).join(";"),n=d.map((p,g)=>(g===0&&c?"":`${u+p.color}-bg:`)+(qo(f[g].bg,m[g])||"inherit")).join(";"),o=`shiki-themes ${f.map(p=>p.name).join(" ")}`,a=c?void 0:[s,n].join(";")}else if("theme"in r){const c=vm(r.theme,r);i=$S(t,e,r);const u=t.getTheme(r.theme);n=qo(u.bg,c),s=qo(u.fg,c),o=u.name,l=Sd(i)}else throw new mi("Invalid options, either `theme` or `themes` must be provided");return{tokens:i,fg:s,bg:n,themeName:o,rootStyle:a,grammarState:l}}function Bfe(t,e,r,n){const s={content:t.content,explanation:t.explanation,offset:t.offset},i=e.map(l=>l3(t.variants[l])),o=new Set(i.flatMap(l=>Object.keys(l))),a={};return i.forEach((l,c)=>{for(const u of o){const d=l[u]||"inherit";if(c===0&&n)a[u]=d;else{const h=u==="color"?"":u==="background-color"?"-bg":`-${u}`,f=r+e[c]+(u==="color"?"":h);a[f]=d}}}),s.htmlStyle=a,s}function wm(t,e,r,n={meta:{},options:r,codeToHast:(s,i)=>wm(t,s,i),codeToTokens:(s,i)=>bm(t,s,i)}){let s=e;for(const f of ym(r))s=f.preprocess?.call(n,s,r)||s;let{tokens:i,fg:o,bg:a,themeName:l,rootStyle:c,grammarState:u}=bm(t,s,r);const{mergeWhitespaces:d=!0}=r;d===!0?i=jfe(i):d==="never"&&(i=$fe(i));const h={...n,get source(){return s}};for(const f of ym(r))i=f.tokens?.call(h,i)||i;return Ffe(i,{...r,fg:o,bg:a,themeName:l,rootStyle:c},h,u)}function Ffe(t,e,r,n=Sd(t)){const s=ym(e),i=[],o={type:"root",children:[]},{structure:a="classic",tabindex:l="0"}=e;let c={type:"element",tagName:"pre",properties:{class:`shiki ${e.themeName||""}`,style:e.rootStyle||`background-color:${e.bg};color:${e.fg}`,...l!==!1&&l!=null?{tabindex:l.toString()}:{},...Object.fromEntries(Array.from(Object.entries(e.meta||{})).filter(([v])=>!v.startsWith("_")))},children:[]},u={type:"element",tagName:"code",properties:{},children:i};const d=[],h={...r,structure:a,addClassToHast:o3,get source(){return r.source},get tokens(){return t},get options(){return e},get root(){return o},get pre(){return c},get code(){return u},get lines(){return d}};if(t.forEach((v,m)=>{m&&(a==="inline"?o.children.push({type:"element",tagName:"br",properties:{},children:[]}):a==="classic"&&i.push({type:"text",value:`
`}));let p={type:"element",tagName:"span",properties:{class:"line"},children:[]},g=0;for(const y of v){let _={type:"element",tagName:"span",properties:{...y.htmlAttrs},children:[{type:"text",value:y.content}]};y.htmlStyle;const b=vfe(y.htmlStyle||l3(y));b&&(_.properties.style=b);for(const w of s)_=w?.span?.call(h,_,m+1,g,p,y)||_;a==="inline"?o.children.push(_):a==="classic"&&p.children.push(_),g+=y.content.length}if(a==="classic"){for(const y of s)p=y?.line?.call(h,p,m+1)||p;d.push(p),i.push(p)}}),a==="classic"){for(const v of s)u=v?.code?.call(h,u)||u;c.children.push(u);for(const v of s)c=v?.pre?.call(h,c)||c;o.children.push(c)}let f=o;for(const v of s)f=v?.root?.call(h,f)||f;return n&&Ug(f,n),f}function jfe(t){return t.map(e=>{const r=[];let n="",s=0;return e.forEach((i,o)=>{const l=!(i.fontStyle&&i.fontStyle&pi.Underline);l&&i.content.match(/^\s+$/)&&e[o+1]?(s||(s=i.offset),n+=i.content):n?(l?r.push({...i,offset:s,content:n+i.content}):r.push({content:n,offset:s},i),s=0,n=""):r.push(i)}),r})}function $fe(t){return t.map(e=>e.flatMap(r=>{if(r.content.match(/^\s+$/))return r;const n=r.content.match(/^(\s*)(.*?)(\s*)$/);if(!n)return r;const[,s,i,o]=n;if(!s&&!o)return r;const a=[{...r,offset:r.offset+s.length,content:i}];return s&&a.unshift({content:s,offset:r.offset}),o&&a.push({content:o,offset:r.offset+s.length+i.length}),a}))}function Ufe(t,e,r){const n={meta:{},options:r,codeToHast:(i,o)=>wm(t,i,o),codeToTokens:(i,o)=>bm(t,i,o)};let s=dfe(wm(t,e,r,n));for(const i of ym(r))s=i.postprocess?.call(n,s,r)||s;return s}const LA={light:"#333333",dark:"#bbbbbb"},NA={light:"#fffffe",dark:"#1e1e1e"},BA="__shiki_resolved";function US(t){if(t?.[BA])return t;const e={...t};e.tokenColors&&!e.settings&&(e.settings=e.tokenColors,delete e.tokenColors),e.type||="dark",e.colorReplacements={...e.colorReplacements},e.settings||=[];let{bg:r,fg:n}=e;if(!r||!n){const a=e.settings?e.settings.find(l=>!l.name&&!l.scope):void 0;a?.settings?.foreground&&(n=a.settings.foreground),a?.settings?.background&&(r=a.settings.background),!n&&e?.colors?.["editor.foreground"]&&(n=e.colors["editor.foreground"]),!r&&e?.colors?.["editor.background"]&&(r=e.colors["editor.background"]),n||(n=e.type==="light"?LA.light:LA.dark),r||(r=e.type==="light"?NA.light:NA.dark),e.fg=n,e.bg=r}e.settings[0]&&e.settings[0].settings&&!e.settings[0].scope||e.settings.unshift({settings:{foreground:e.fg,background:e.bg}});let s=0;const i=new Map;function o(a){if(i.has(a))return i.get(a);s+=1;const l=`#${s.toString(16).padStart(8,"0").toLowerCase()}`;return e.colorReplacements?.[`#${l}`]?o(a):(i.set(a,l),l)}e.settings=e.settings.map(a=>{const l=a.settings?.foreground&&!a.settings.foreground.startsWith("#"),c=a.settings?.background&&!a.settings.background.startsWith("#");if(!l&&!c)return a;const u={...a,settings:{...a.settings}};if(l){const d=o(a.settings.foreground);e.colorReplacements[d]=a.settings.foreground,u.settings.foreground=d}if(c){const d=o(a.settings.background);e.colorReplacements[d]=a.settings.background,u.settings.background=d}return u});for(const a of Object.keys(e.colors||{}))if((a==="editor.foreground"||a==="editor.background"||a.startsWith("terminal.ansi"))&&!e.colors[a]?.startsWith("#")){const l=o(e.colors[a]);e.colorReplacements[l]=e.colors[a],e.colors[a]=l}return Object.defineProperty(e,BA,{enumerable:!1,writable:!1,value:!0}),e}async function h3(t){return Array.from(new Set((await Promise.all(t.filter(e=>!s3(e)).map(async e=>await a3(e).then(r=>Array.isArray(r)?r:[r])))).flat()))}async function f3(t){return(await Promise.all(t.map(async r=>i3(r)?null:US(await a3(r))))).filter(r=>!!r)}class Hfe extends Zde{constructor(e,r,n,s={}){super(e),this._resolver=e,this._themes=r,this._langs=n,this._alias=s,this._themes.map(i=>this.loadTheme(i)),this.loadLanguages(this._langs)}_resolvedThemes=new Map;_resolvedGrammars=new Map;_langMap=new Map;_langGraph=new Map;_textmateThemeCache=new WeakMap;_loadedThemesCache=null;_loadedLanguagesCache=null;getTheme(e){return typeof e=="string"?this._resolvedThemes.get(e):this.loadTheme(e)}loadTheme(e){const r=US(e);return r.name&&(this._resolvedThemes.set(r.name,r),this._loadedThemesCache=null),r}getLoadedThemes(){return this._loadedThemesCache||(this._loadedThemesCache=[...this._resolvedThemes.keys()]),this._loadedThemesCache}setTheme(e){let r=this._textmateThemeCache.get(e);r||(r=hm.createFromRawTheme(e),this._textmateThemeCache.set(e,r)),this._syncRegistry.setTheme(r)}getGrammar(e){if(this._alias[e]){const r=new Set([e]);for(;this._alias[e];){if(e=this._alias[e],r.has(e))throw new Nr(`Circular alias \`${Array.from(r).join(" -> ")} -> ${e}\``);r.add(e)}}return this._resolvedGrammars.get(e)}loadLanguage(e){if(this.getGrammar(e.name))return;const r=new Set([...this._langMap.values()].filter(i=>i.embeddedLangsLazy?.includes(e.name)));this._resolver.addLanguage(e);const n={balancedBracketSelectors:e.balancedBracketSelectors||["*"],unbalancedBracketSelectors:e.unbalancedBracketSelectors||[]};this._syncRegistry._rawGrammars.set(e.scopeName,e);const s=this.loadGrammarWithConfiguration(e.scopeName,1,n);if(s.name=e.name,this._resolvedGrammars.set(e.name,s),e.aliases&&e.aliases.forEach(i=>{this._alias[i]=e.name}),this._loadedLanguagesCache=null,r.size)for(const i of r)this._resolvedGrammars.delete(i.name),this._loadedLanguagesCache=null,this._syncRegistry?._injectionGrammars?.delete(i.scopeName),this._syncRegistry?._grammars?.delete(i.scopeName),this.loadLanguage(this._langMap.get(i.name))}dispose(){super.dispose(),this._resolvedThemes.clear(),this._resolvedGrammars.clear(),this._langMap.clear(),this._langGraph.clear(),this._loadedThemesCache=null}loadLanguages(e){for(const s of e)this.resolveEmbeddedLanguages(s);const r=Array.from(this._langGraph.entries()),n=r.filter(([s,i])=>!i);if(n.length){const s=r.filter(([i,o])=>o&&o.embeddedLangs?.some(a=>n.map(([l])=>l).includes(a))).filter(i=>!n.includes(i));throw new Nr(`Missing languages ${n.map(([i])=>`\`${i}\``).join(", ")}, required by ${s.map(([i])=>`\`${i}\``).join(", ")}`)}for(const[s,i]of r)this._resolver.addLanguage(i);for(const[s,i]of r)this.loadLanguage(i)}getLoadedLanguages(){return this._loadedLanguagesCache||(this._loadedLanguagesCache=[...new Set([...this._resolvedGrammars.keys(),...Object.keys(this._alias)])]),this._loadedLanguagesCache}resolveEmbeddedLanguages(e){if(this._langMap.set(e.name,e),this._langGraph.set(e.name,e),e.embeddedLangs)for(const r of e.embeddedLangs)this._langGraph.set(r,this._langMap.get(r))}}class Vfe{_langs=new Map;_scopeToLang=new Map;_injections=new Map;_onigLib;constructor(e,r){this._onigLib={createOnigScanner:n=>e.createScanner(n),createOnigString:n=>e.createString(n)},r.forEach(n=>this.addLanguage(n))}get onigLib(){return this._onigLib}getLangRegistration(e){return this._langs.get(e)}loadGrammar(e){return this._scopeToLang.get(e)}addLanguage(e){this._langs.set(e.name,e),e.aliases&&e.aliases.forEach(r=>{this._langs.set(r,e)}),this._scopeToLang.set(e.scopeName,e),e.injectTo&&e.injectTo.forEach(r=>{this._injections.get(r)||this._injections.set(r,[]),this._injections.get(r).push(e.scopeName)})}getInjections(e){const r=e.split(".");let n=[];for(let s=1;s<=r.length;s++){const i=r.slice(0,s).join(".");n=[...n,...this._injections.get(i)||[]]}return n}}let Rc=0;function Gfe(t){Rc+=1,t.warnings!==!1&&Rc>=10&&Rc%10===0&&console.warn(`[Shiki] ${Rc} instances have been created. Shiki is supposed to be used as a singleton, consider refactoring your code to cache your highlighter instance; Or call \`highlighter.dispose()\` to release unused instances.`);let e=!1;if(!t.engine)throw new Nr("`engine` option is required for synchronous mode");const r=(t.langs||[]).flat(1),n=(t.themes||[]).flat(1).map(US),s=new Vfe(t.engine,r),i=new Hfe(s,n,r,t.langAlias);let o;function a(y){p();const _=i.getGrammar(typeof y=="string"?y:y.name);if(!_)throw new Nr(`Language \`${y}\` not found, you may need to load it first`);return _}function l(y){if(y==="none")return{bg:"",fg:"",name:"none",settings:[],type:"dark"};p();const _=i.getTheme(y);if(!_)throw new Nr(`Theme \`${y}\` not found, you may need to load it first`);return _}function c(y){p();const _=l(y);o!==y&&(i.setTheme(_),o=y);const b=i.getColorMap();return{theme:_,colorMap:b}}function u(){return p(),i.getLoadedThemes()}function d(){return p(),i.getLoadedLanguages()}function h(...y){p(),i.loadLanguages(y.flat(1))}async function f(...y){return h(await h3(y))}function v(...y){p();for(const _ of y.flat(1))i.loadTheme(_)}async function m(...y){return p(),v(await f3(y))}function p(){if(e)throw new Nr("Shiki instance has been disposed")}function g(){e||(e=!0,i.dispose(),Rc-=1)}return{setTheme:c,getTheme:l,getLanguage:a,getLoadedThemes:u,getLoadedLanguages:d,loadLanguage:f,loadLanguageSync:h,loadTheme:m,loadThemeSync:v,dispose:g,[Symbol.dispose]:g}}async function zfe(t={}){t.loadWasm;const[e,r,n]=await Promise.all([f3(t.themes||[]),h3(t.langs||[]),t.engine||AF(t.loadWasm||dde())]);return Gfe({...t,themes:e,langs:r,engine:n})}async function Wfe(t={}){const e=await zfe(t);return{getLastGrammarState:(...r)=>Pfe(e,...r),codeToTokensBase:(r,n)=>$S(e,r,n),codeToTokensWithThemes:(r,n)=>d3(e,r,n),codeToTokens:(r,n)=>bm(e,r,n),codeToHast:(r,n)=>wm(e,r,n),codeToHtml:(r,n)=>Ufe(e,r,n),...e,getInternalContext:()=>e}}function Kfe(t,e,r){let n,s,i;{const a=t;n=a.langs,s=a.themes,i=a.engine}async function o(a){function l(f){if(typeof f=="string"){if(s3(f))return[];const v=n[f];if(!v)throw new mi(`Language \`${f}\` is not included in this bundle. You may want to load it from external source.`);return v}return f}function c(f){if(i3(f))return"none";if(typeof f=="string"){const v=s[f];if(!v)throw new mi(`Theme \`${f}\` is not included in this bundle. You may want to load it from external source.`);return v}return f}const u=(a.themes??[]).map(f=>c(f)),d=(a.langs??[]).map(f=>l(f)),h=await Wfe({engine:a.engine??i(),...a,themes:u,langs:d});return{...h,loadLanguage(...f){return h.loadLanguage(...f.map(l))},loadTheme(...f){return h.loadTheme(...f.map(c))}}}return o}const qfe=Kfe({langs:zue,themes:Kue,engine:()=>AF(ee(()=>import("./wasm-CG6Dc4jp.js"),[]))}),Jfe=t=>qfe(t),Yfe=k.memo(({onClick:t,isFullscreen:e})=>C.jsx("button",{onClick:t,className:"ml-4 p-1 rounded hover:bg-codeia-elements-background-depth-3 text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary transition-colors",title:e?"Exit Fullscreen":"Enter Fullscreen",children:C.jsx("div",{className:e?"i-ph:corners-in":"i-ph:corners-out"})})),Zfe=k.memo(({isFullscreen:t,children:e})=>t?C.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/50 flex items-center justify-center p-6",children:C.jsx("div",{className:"w-full h-full max-w-[90vw] max-h-[90vh] bg-codeia-elements-background-depth-2 rounded-lg border border-codeia-elements-borderColor shadow-xl overflow-hidden",children:e})}):C.jsx(C.Fragment,{children:e})),Xfe=1024*1024,Qfe=/[\x00-\x08\x0E-\x1F]/,FA=t=>t.length>Xfe||Qfe.test(t),epe=(t,e)=>{try{if(FA(t)||FA(e))return{beforeLines:[],afterLines:[],hasChanges:!1,lineChanges:{before:new Set,after:new Set},unifiedBlocks:[],isBinary:!0};const r=u=>u.replace(/\r\n/g,`
`).split(`
`).map(d=>d.trimEnd()),n=r(t),s=r(e);if(n.join(`
`)===s.join(`
`))return{beforeLines:n,afterLines:s,hasChanges:!1,lineChanges:{before:new Set,after:new Set},unifiedBlocks:[],isBinary:!1};const i={before:new Set,after:new Set},o=[];let a=0,l=0;for(;a<n.length||l<s.length;)if(a<n.length&&l<s.length&&n[a]===s[l])o.push({lineNumber:l,content:s[l],type:"unchanged",correspondingLine:a}),a++,l++;else{let u=!1;const d=3;for(let h=1;h<=d&&a+h<n.length&&l+h<s.length;h++)if(n[a+h]===s[l]){for(let f=0;f<h;f++)i.before.add(a+f),o.push({lineNumber:a+f,content:n[a+f],type:"removed",correspondingLine:l,charChanges:[{value:n[a+f],type:"removed"}]});a+=h,u=!0;break}else if(n[a]===s[l+h]){for(let f=0;f<h;f++)i.after.add(l+f),o.push({lineNumber:l+f,content:s[l+f],type:"added",correspondingLine:a,charChanges:[{value:s[l+f],type:"added"}]});l+=h,u=!0;break}if(!u)if(a<n.length&&l<s.length){const h=n[a],f=s[l];let v=0;for(;v<h.length&&v<f.length&&h[v]===f[v];)v++;let m=0;for(;m<h.length-v&&m<f.length-v&&h[h.length-1-m]===f[f.length-1-m];)m++;const p=h.slice(0,v),g=h.slice(v,h.length-m),y=f.slice(v,f.length-m),_=h.slice(h.length-m);g||y?(g&&(i.before.add(a),o.push({lineNumber:a,content:h,type:"removed",correspondingLine:l,charChanges:[{value:p,type:"unchanged"},{value:g,type:"removed"},{value:_,type:"unchanged"}]}),a++),y&&(i.after.add(l),o.push({lineNumber:l,content:f,type:"added",correspondingLine:a-1,charChanges:[{value:p,type:"unchanged"},{value:y,type:"added"},{value:_,type:"unchanged"}]}),l++)):(a<n.length&&(i.before.add(a),o.push({lineNumber:a,content:n[a],type:"removed",correspondingLine:l,charChanges:[{value:n[a],type:"removed"}]}),a++),l<s.length&&(i.after.add(l),o.push({lineNumber:l,content:s[l],type:"added",correspondingLine:a-1,charChanges:[{value:s[l],type:"added"}]}),l++))}else a<n.length&&(i.before.add(a),o.push({lineNumber:a,content:n[a],type:"removed",correspondingLine:l,charChanges:[{value:n[a],type:"removed"}]}),a++),l<s.length&&(i.after.add(l),o.push({lineNumber:l,content:s[l],type:"added",correspondingLine:a-1,charChanges:[{value:s[l],type:"added"}]}),l++)}const c=o.sort((u,d)=>u.lineNumber-d.lineNumber);return{beforeLines:n,afterLines:s,hasChanges:i.before.size>0||i.after.size>0,lineChanges:i,unifiedBlocks:c,isBinary:!1}}catch(r){return console.error("Error processing changes:",r),{beforeLines:[],afterLines:[],hasChanges:!1,lineChanges:{before:new Set,after:new Set},unifiedBlocks:[],error:!0,isBinary:!1}}},p3="w-9 shrink-0 pl-2 py-1 text-left font-mono text-codeia-elements-textTertiary border-r border-codeia-elements-borderColor bg-codeia-elements-background-depth-1",m3="px-1 py-1 font-mono whitespace-pre flex-1 group-hover:bg-codeia-elements-background-depth-2 text-codeia-elements-textPrimary",tpe="h-full overflow-auto diff-panel-content",rpe={added:"bg-green-500/10 dark:bg-green-500/20 border-l-4 border-green-500",removed:"bg-red-500/10 dark:bg-red-500/20 border-l-4 border-red-500",unchanged:""},npe={added:"text-green-700 dark:text-green-500 bg-green-500/10 dark:bg-green-500/20",removed:"text-red-700 dark:text-red-500 bg-red-500/10 dark:bg-red-500/20",unchanged:"text-codeia-elements-textPrimary"},spe=t=>C.jsx("div",{className:"h-full flex items-center justify-center p-4",children:C.jsxs("div",{className:"text-center text-codeia-elements-textTertiary",children:[C.jsx("div",{className:`i-ph:${t==="binary"?"file-x":"warning-circle"} text-4xl text-red-400 mb-2 mx-auto`}),C.jsx("p",{className:"font-medium text-codeia-elements-textPrimary",children:t==="binary"?"Binary file detected":"Error processing file"}),C.jsx("p",{className:"text-sm mt-1",children:t==="binary"?"Diff view is not available for binary files":"Could not generate diff preview"})]})}),ipe=k.memo(({beforeCode:t,language:e,highlighter:r,theme:n})=>C.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-4",children:[C.jsxs("div",{className:"text-center text-codeia-elements-textTertiary",children:[C.jsx("div",{className:"i-ph:files text-4xl text-green-400 mb-2 mx-auto"}),C.jsx("p",{className:"font-medium text-codeia-elements-textPrimary",children:"Files are identical"}),C.jsx("p",{className:"text-sm mt-1",children:"Both versions match exactly"})]}),C.jsxs("div",{className:"mt-4 w-full max-w-2xl bg-codeia-elements-background-depth-1 rounded-lg border border-codeia-elements-borderColor overflow-hidden",children:[C.jsx("div",{className:"p-2 text-xs font-bold text-codeia-elements-textTertiary border-b border-codeia-elements-borderColor",children:"Current Content"}),C.jsx("div",{className:"overflow-auto max-h-96",children:t.split(`
`).map((s,i)=>C.jsxs("div",{className:"flex group min-w-fit",children:[C.jsx("div",{className:p3,children:i+1}),C.jsxs("div",{className:m3,children:[C.jsx("span",{className:"mr-2",children:" "}),C.jsx("span",{dangerouslySetInnerHTML:{__html:r?r.codeToHtml(s,{lang:e,theme:n==="dark"?"github-dark":"github-light"}).replace(/<\/?pre[^>]*>/g,"").replace(/<\/?code[^>]*>/g,""):s}})]})]},i))})]})]})),ope=(t,e)=>k.useMemo(()=>epe(t,e),[t,e]),ape=k.memo(({lineNumber:t,content:e,type:r,highlighter:n,language:s,block:i,theme:o})=>{const a=rpe[r],l=()=>{if(r==="unchanged"||!i.charChanges){const c=n?n.codeToHtml(e,{lang:s,theme:o==="dark"?"github-dark":"github-light"}).replace(/<\/?pre[^>]*>/g,"").replace(/<\/?code[^>]*>/g,""):e;return C.jsx("span",{dangerouslySetInnerHTML:{__html:c}})}return C.jsx(C.Fragment,{children:i.charChanges.map((c,u)=>{const d=npe[c.type],h=n?n.codeToHtml(c.value,{lang:s,theme:o==="dark"?"github-dark":"github-light"}).replace(/<\/?pre[^>]*>/g,"").replace(/<\/?code[^>]*>/g,""):c.value;return C.jsx("span",{className:d,dangerouslySetInnerHTML:{__html:h}},u)})})};return C.jsxs("div",{className:"flex group min-w-fit",children:[C.jsx("div",{className:p3,children:t+1}),C.jsxs("div",{className:`${m3} ${a}`,children:[C.jsxs("span",{className:"mr-2 text-codeia-elements-textTertiary",children:[r==="added"&&C.jsx("span",{className:"text-green-700 dark:text-green-500",children:"+"}),r==="removed"&&C.jsx("span",{className:"text-red-700 dark:text-red-500",children:"-"}),r==="unchanged"&&" "]}),l()]})]})}),lpe=k.memo(({filename:t,hasChanges:e,onToggleFullscreen:r,isFullscreen:n,beforeCode:s,afterCode:i})=>{const{additions:o,deletions:a}=k.useMemo(()=>e?$l(s,i,{newlineIsToken:!1,ignoreWhitespace:!0,ignoreCase:!1}).reduce((u,d)=>(d.added&&(u.additions+=d.value.split(`
`).length),d.removed&&(u.deletions+=d.value.split(`
`).length),u),{additions:0,deletions:0}):{additions:0,deletions:0},[e,s,i]),l=o>0||a>0;return C.jsxs("div",{className:"flex items-center bg-codeia-elements-background-depth-1 p-2 text-sm text-codeia-elements-textPrimary shrink-0",children:[C.jsx("div",{className:"i-ph:file mr-2 h-4 w-4 shrink-0"}),C.jsx("span",{className:"truncate",children:t}),C.jsxs("span",{className:"ml-auto shrink-0 flex items-center gap-2",children:[e?C.jsxs(C.Fragment,{children:[l&&C.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[o>0&&C.jsxs("span",{className:"text-green-700 dark:text-green-500",children:["+",o]}),a>0&&C.jsxs("span",{className:"text-red-700 dark:text-red-500",children:["-",a]})]}),C.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:"Modified"}),C.jsx("span",{className:"text-codeia-elements-textTertiary text-xs",children:new Date().toLocaleTimeString()})]}):C.jsx("span",{className:"text-green-700 dark:text-green-400",children:"No Changes"}),C.jsx(Yfe,{onClick:r,isFullscreen:n})]})]})}),cpe=k.memo(({beforeCode:t,afterCode:e,filename:r,language:n})=>{const[s,i]=k.useState(!1),[o,a]=k.useState(null),l=at(up),c=k.useCallback(()=>{i(v=>!v)},[]),{unifiedBlocks:u,hasChanges:d,isBinary:h,error:f}=ope(t,e);return k.useEffect(()=>{Jfe({themes:["github-dark","github-light"],langs:["typescript","javascript","json","html","css","jsx","tsx","python","php","java","c","cpp","csharp","go","ruby","rust","plaintext"]}).then(a)},[]),h||f?spe(h?"binary":"error"):C.jsx(Zfe,{isFullscreen:s,children:C.jsxs("div",{className:"w-full h-full flex flex-col",children:[C.jsx(lpe,{filename:r,hasChanges:d,onToggleFullscreen:c,isFullscreen:s,beforeCode:t,afterCode:e}),C.jsx("div",{className:tpe,children:d?C.jsx("div",{className:"overflow-x-auto min-w-full",children:u.map((v,m)=>C.jsx(ape,{lineNumber:v.lineNumber,content:v.content,type:v.type,highlighter:o,language:n,block:v,theme:l},`${v.lineNumber}-${m}`))}):C.jsx(ipe,{beforeCode:t,language:n,highlighter:o,theme:l})})]})})}),upe=k.memo(({fileHistory:t,setFileHistory:e})=>{const r=at(Ie.files),n=at(Ie.selectedFile),s=at(Ie.currentDocument),i=at(Ie.unsavedFiles);if(k.useEffect(()=>{if(n&&s){const h=r[n];if(!h||!("content"in h))return;const f=t[n],v=s.value,m=v.replace(/\r\n/g,`
`).trim(),p=(f?.originalContent||h.content).replace(/\r\n/g,`
`).trim();if(!f){if(m!==p){const w=$l(h.content,v);e(E=>({...E,[n]:{originalContent:h.content,lastModified:Date.now(),changes:w,versions:[{timestamp:Date.now(),content:v}],changeSource:"auto-save"}}))}return}const y=f.versions[f.versions.length-1]?.content.replace(/\r\n/g,`
`).trim();if(m===y)return;const _=pu(n);if(jN(_,f.originalContent,v)){const w=$l(f.originalContent,v);if(w.some(S=>(S.added||S.removed)&&S.value.trim().length>0)){const S={originalContent:f.originalContent,lastModified:Date.now(),changes:[...f.changes,...w].slice(-100),versions:[...f.versions,{timestamp:Date.now(),content:v}].slice(-10),changeSource:"auto-save"};e(x=>({...x,[n]:S}))}}}},[n,s?.value,r,e,i]),!n||!s)return C.jsx("div",{className:"flex w-full h-full justify-center items-center bg-codeia-elements-background-depth-1 text-codeia-elements-textPrimary",children:"Select a file to view differences"});const o=r[n],a=o&&"content"in o?o.content:"",l=s.value,u=t[n]?.originalContent||a,d=kF(n.split(".").pop()||"");try{return C.jsx("div",{className:"h-full overflow-hidden",children:C.jsx(cpe,{beforeCode:u,afterCode:l,language:d,filename:n,lightTheme:"github-light",darkTheme:"github-dark"})})}catch(h){return console.error("DiffView render error:",h),C.jsx("div",{className:"flex w-full h-full justify-center items-center bg-codeia-elements-background-depth-1 text-red-400",children:C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"i-ph:warning-circle text-4xl mb-2"}),C.jsx("p",{children:"Failed to render diff view"})]})})}});let Sb=[],g3=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,r=0;e<t.length;e++)(e%2?g3:Sb).push(r=r+t[e])})();function dpe(t){if(t<768)return!1;for(let e=0,r=Sb.length;;){let n=e+r>>1;if(t<Sb[n])r=n;else if(t>=g3[n])e=n+1;else return!0;if(e==r)return!1}}function jA(t){return t>=127462&&t<=127487}const $A=8205;function hpe(t,e,r=!0,n=!0){return(r?v3:fpe)(t,e,n)}function v3(t,e,r){if(e==t.length)return e;e&&y3(t.charCodeAt(e))&&_3(t.charCodeAt(e-1))&&e--;let n=jy(t,e);for(e+=UA(n);e<t.length;){let s=jy(t,e);if(n==$A||s==$A||r&&dpe(s))e+=UA(s),n=s;else if(jA(s)){let i=0,o=e-2;for(;o>=0&&jA(jy(t,o));)i++,o-=2;if(i%2==0)break;e+=2}else break}return e}function fpe(t,e,r){for(;e>0;){let n=v3(t,e-2,r);if(n<e)return n;e--}return 0}function jy(t,e){let r=t.charCodeAt(e);if(!_3(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return y3(n)?(r-55296<<10)+(n-56320)+65536:r}function y3(t){return t>=56320&&t<57344}function _3(t){return t>=55296&&t<56320}function UA(t){return t<65536?1:2}let ht=class b3{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,n){[e,r]=zl(this,e,r);let s=[];return this.decompose(0,e,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(r,this.length,s,1),Es.from(s,this.length-(r-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){[e,r]=zl(this,e,r);let n=[];return this.decompose(e,r,n,0),Es.from(n,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),s=new yu(this),i=new yu(e);for(let o=r,a=r;;){if(s.next(o),i.next(o),o=0,s.lineBreak!=i.lineBreak||s.done!=i.done||s.value!=i.value)return!1;if(a+=s.value.length,s.done||a>=n)return!0}}iter(e=1){return new yu(this,e)}iterRange(e,r=this.length){return new w3(this,e,r)}iterLines(e,r){let n;if(e==null)n=this.iter();else{r==null&&(r=this.lines+1);let s=this.line(e).from;n=this.iterRange(s,Math.max(s,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new x3(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?b3.empty:e.length<=32?new Ft(e):Es.from(Ft.split(e,[]))}};class Ft extends ht{constructor(e,r=ppe(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,n,s){for(let i=0;;i++){let o=this.text[i],a=s+o.length;if((r?n:a)>=e)return new mpe(s,a,n,o);s=a+1,n++}}decompose(e,r,n,s){let i=e<=0&&r>=this.length?this:new Ft(HA(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(s&1){let o=n.pop(),a=Kf(i.text,o.text.slice(),0,i.length);if(a.length<=32)n.push(new Ft(a,o.length+i.length));else{let l=a.length>>1;n.push(new Ft(a.slice(0,l)),new Ft(a.slice(l)))}}else n.push(i)}replace(e,r,n){if(!(n instanceof Ft))return super.replace(e,r,n);[e,r]=zl(this,e,r);let s=Kf(this.text,Kf(n.text,HA(this.text,0,e)),r),i=this.length+n.length-(r-e);return s.length<=32?new Ft(s,i):Es.from(Ft.split(s,[]),i)}sliceString(e,r=this.length,n=`
`){[e,r]=zl(this,e,r);let s="";for(let i=0,o=0;i<=r&&o<this.text.length;o++){let a=this.text[o],l=i+a.length;i>e&&o&&(s+=n),e<l&&r>i&&(s+=a.slice(Math.max(0,e-i),r-i)),i=l+1}return s}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let n=[],s=-1;for(let i of e)n.push(i),s+=i.length+1,n.length==32&&(r.push(new Ft(n,s)),n=[],s=-1);return s>-1&&r.push(new Ft(n,s)),r}}class Es extends ht{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,r,n,s){for(let i=0;;i++){let o=this.children[i],a=s+o.length,l=n+o.lines-1;if((r?l:a)>=e)return o.lineInner(e,r,n,s);s=a+1,n=l+1}}decompose(e,r,n,s){for(let i=0,o=0;o<=r&&i<this.children.length;i++){let a=this.children[i],l=o+a.length;if(e<=l&&r>=o){let c=s&((o<=e?1:0)|(l>=r?2:0));o>=e&&l<=r&&!c?n.push(a):a.decompose(e-o,r-o,n,c)}o=l+1}}replace(e,r,n){if([e,r]=zl(this,e,r),n.lines<this.lines)for(let s=0,i=0;s<this.children.length;s++){let o=this.children[s],a=i+o.length;if(e>=i&&r<=a){let l=o.replace(e-i,r-i,n),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[s]=l,new Es(u,this.length-(r-e)+n.length)}return super.replace(i,a,l)}i=a+1}return super.replace(e,r,n)}sliceString(e,r=this.length,n=`
`){[e,r]=zl(this,e,r);let s="";for(let i=0,o=0;i<this.children.length&&o<=r;i++){let a=this.children[i],l=o+a.length;o>e&&i&&(s+=n),e<l&&r>o&&(s+=a.sliceString(e-o,r-o,n)),o=l+1}return s}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof Es))return 0;let n=0,[s,i,o,a]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=r,i+=r){if(s==o||i==a)return n;let l=this.children[s],c=e.children[i];if(l!=c)return n+l.scanIdentical(c,r);n+=l.length+1}}static from(e,r=e.reduce((n,s)=>n+s.length+1,-1)){let n=0;for(let f of e)n+=f.lines;if(n<32){let f=[];for(let v of e)v.flatten(f);return new Ft(f,r)}let s=Math.max(32,n>>5),i=s<<1,o=s>>1,a=[],l=0,c=-1,u=[];function d(f){let v;if(f.lines>i&&f instanceof Es)for(let m of f.children)d(m);else f.lines>o&&(l>o||!l)?(h(),a.push(f)):f instanceof Ft&&l&&(v=u[u.length-1])instanceof Ft&&f.lines+v.lines<=32?(l+=f.lines,c+=f.length+1,u[u.length-1]=new Ft(v.text.concat(f.text),v.length+1+f.length)):(l+f.lines>s&&h(),l+=f.lines,c+=f.length+1,u.push(f))}function h(){l!=0&&(a.push(u.length==1?u[0]:Es.from(u,c)),c=-1,l=u.length=0)}for(let f of e)d(f);return h(),a.length==1?a[0]:new Es(a,r)}}ht.empty=new Ft([""],0);function ppe(t){let e=-1;for(let r of t)e+=r.length+1;return e}function Kf(t,e,r=0,n=1e9){for(let s=0,i=0,o=!0;i<t.length&&s<=n;i++){let a=t[i],l=s+a.length;l>=r&&(l>n&&(a=a.slice(0,n-s)),s<r&&(a=a.slice(r-s)),o?(e[e.length-1]+=a,o=!1):e.push(a)),s=l+1}return e}function HA(t,e,r){return Kf(t,[""],e,r)}class yu{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof Ft?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],i=this.offsets[n],o=i>>1,a=s instanceof Ft?s.text.length:s.children.length;if(o==(r>0?a:0)){if(n==0)return this.done=!0,this.value="",this;r>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((i&1)==(r>0?0:1)){if(this.offsets[n]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof Ft){let l=s.text[o+(r<0?-1:0)];if(this.offsets[n]+=r,l.length>Math.max(0,e))return this.value=e==0?l:r>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=s.children[o+(r<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=r):(r<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(r>0?1:(l instanceof Ft?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class w3{constructor(e,r,n){this.value="",this.done=!1,this.cursor=new yu(e,r>n?-1:1),this.pos=r>n?e.length:0,this.from=Math.min(r,n),this.to=Math.max(r,n)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let n=r<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*r,this.value=s.length<=n?s:r<0?s.slice(s.length-n):s.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class x3{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:n,value:s}=this.inner.next(e);return r&&this.afterBreak?(this.value="",this.afterBreak=!1):r?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(ht.prototype[Symbol.iterator]=function(){return this.iter()},yu.prototype[Symbol.iterator]=w3.prototype[Symbol.iterator]=x3.prototype[Symbol.iterator]=function(){return this});class mpe{constructor(e,r,n,s){this.from=e,this.to=r,this.number=n,this.text=s}get length(){return this.to-this.from}}function zl(t,e,r){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,r))]}function mr(t,e,r=!0,n=!0){return hpe(t,e,r,n)}function gpe(t){return t>=56320&&t<57344}function vpe(t){return t>=55296&&t<56320}function Wn(t,e){let r=t.charCodeAt(e);if(!vpe(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return gpe(n)?(r-55296<<10)+(n-56320)+65536:r}function HS(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function li(t){return t<65536?1:2}const Eb=/\r\n?|\n/;var kr=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(kr||(kr={}));class Ls{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r+1];e+=n<0?this.sections[r]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,n=0,s=0;r<this.sections.length;){let i=this.sections[r++],o=this.sections[r++];o<0?(e(n,s,i),s+=i):s+=o,n+=i}}iterChangedRanges(e,r=!1){Cb(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let n=this.sections[r++],s=this.sections[r++];s<0?e.push(n,s):e.push(s,n)}return new Ls(e)}composeDesc(e){return this.empty?e:e.empty?this:S3(this,e)}mapDesc(e,r=!1){return e.empty?this:kb(this,e,r)}mapPos(e,r=-1,n=kr.Simple){let s=0,i=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],c=s+a;if(l<0){if(c>e)return i+(e-s);i+=a}else{if(n!=kr.Simple&&c>=e&&(n==kr.TrackDel&&s<e&&c>e||n==kr.TrackBefore&&s<e||n==kr.TrackAfter&&c>e))return null;if(c>e||c==e&&r<0&&!a)return e==s||r<0?i:i+l;i+=l}s=c}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return i}touchesRange(e,r=e){for(let n=0,s=0;n<this.sections.length&&s<=r;){let i=this.sections[n++],o=this.sections[n++],a=s+i;if(o>=0&&s<=r&&a>=e)return s<e&&a>r?"cover":!0;s=a}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let n=this.sections[r++],s=this.sections[r++];e+=(e?" ":"")+n+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ls(e)}static create(e){return new Ls(e)}}class qt extends Ls{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Cb(this,(r,n,s,i,o)=>e=e.replace(s,s+(n-r),o),!1),e}mapDesc(e,r=!1){return kb(this,e,r,!0)}invert(e){let r=this.sections.slice(),n=[];for(let s=0,i=0;s<r.length;s+=2){let o=r[s],a=r[s+1];if(a>=0){r[s]=a,r[s+1]=o;let l=s>>1;for(;n.length<l;)n.push(ht.empty);n.push(o?e.slice(i,i+o):ht.empty)}i+=o}return new qt(r,n)}compose(e){return this.empty?e:e.empty?this:S3(this,e,!0)}map(e,r=!1){return e.empty?this:kb(this,e,r,!0)}iterChanges(e,r=!1){Cb(this,e,r)}get desc(){return Ls.create(this.sections)}filter(e){let r=[],n=[],s=[],i=new Ed(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&i.len==0;){if(i.done)break e;let u=Math.min(i.len,l-a);Er(s,u,-1);let d=i.ins==-1?-1:i.off==0?i.ins:0;Er(r,u,d),d>0&&Ki(n,r,i.text),i.forward(u),a+=u}let c=e[o++];for(;a<c;){if(i.done)break e;let u=Math.min(i.len,c-a);Er(r,u,-1),Er(s,u,i.ins==-1?-1:i.off==0?i.ins:0),i.forward(u),a+=u}}return{changes:new qt(r,n),filtered:Ls.create(s)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r],s=this.sections[r+1];s<0?e.push(n):s==0?e.push([n]):e.push([n].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,n){let s=[],i=[],o=0,a=null;function l(u=!1){if(!u&&!s.length)return;o<r&&Er(s,r-o,-1);let d=new qt(s,i);a=a?a.compose(d.map(a)):d,s=[],i=[],o=0}function c(u){if(Array.isArray(u))for(let d of u)c(d);else if(u instanceof qt){if(u.length!=r)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${r})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:d,to:h=d,insert:f}=u;if(d>h||d<0||h>r)throw new RangeError(`Invalid change range ${d} to ${h} (in doc of length ${r})`);let v=f?typeof f=="string"?ht.of(f.split(n||Eb)):f:ht.empty,m=v.length;if(d==h&&m==0)return;d<o&&l(),d>o&&Er(s,d-o,-1),Er(s,h-d,m),Ki(i,s,v),o=h}}return c(e),l(!a),a}static empty(e){return new qt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],n=[];for(let s=0;s<e.length;s++){let i=e[s];if(typeof i=="number")r.push(i,-1);else{if(!Array.isArray(i)||typeof i[0]!="number"||i.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(i.length==1)r.push(i[0],0);else{for(;n.length<s;)n.push(ht.empty);n[s]=ht.of(i.slice(1)),r.push(i[0],n[s].length)}}}return new qt(r,n)}static createSet(e,r){return new qt(e,r)}}function Er(t,e,r,n=!1){if(e==0&&r<=0)return;let s=t.length-2;s>=0&&r<=0&&r==t[s+1]?t[s]+=e:s>=0&&e==0&&t[s]==0?t[s+1]+=r:n?(t[s]+=e,t[s+1]+=r):t.push(e,r)}function Ki(t,e,r){if(r.length==0)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(r);else{for(;t.length<n;)t.push(ht.empty);t.push(r)}}function Cb(t,e,r){let n=t.inserted;for(let s=0,i=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)s+=a,i+=a;else{let c=s,u=i,d=ht.empty;for(;c+=a,u+=l,l&&n&&(d=d.append(n[o-2>>1])),!(r||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(s,c,i,u,d),s=c,i=u}}}function kb(t,e,r,n=!1){let s=[],i=n?[]:null,o=new Ed(t),a=new Ed(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let c=Math.min(o.len,a.len);Er(s,c,-1),o.forward(c),a.forward(c)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!r))){let c=a.len;for(Er(s,a.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=u&&(Er(s,0,o.ins),i&&Ki(i,s,o.text),l=o.i),o.forward(u),c-=u}a.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(a.ins==-1){let d=Math.min(u,a.len);c+=d,u-=d,a.forward(d)}else if(a.ins==0&&a.len<u)u-=a.len,a.next();else break;Er(s,c,l<o.i?o.ins:0),i&&l<o.i&&Ki(i,s,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&a.done)return i?qt.createSet(s,i):Ls.create(s);throw new Error("Mismatched change set lengths")}}}function S3(t,e,r=!1){let n=[],s=r?[]:null,i=new Ed(t),o=new Ed(e);for(let a=!1;;){if(i.done&&o.done)return s?qt.createSet(n,s):Ls.create(n);if(i.ins==0)Er(n,i.len,0,a),i.next();else if(o.len==0&&!o.done)Er(n,0,o.ins,a),s&&Ki(s,n,o.text),o.next();else{if(i.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(i.len2,o.len),c=n.length;if(i.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;Er(n,l,u,a),s&&u&&Ki(s,n,o.text)}else o.ins==-1?(Er(n,i.off?0:i.len,l,a),s&&Ki(s,n,i.textBit(l))):(Er(n,i.off?0:i.len,o.off?0:o.ins,a),s&&!o.off&&Ki(s,n,o.text));a=(i.ins>l||o.ins>=0&&o.len>l)&&(a||n.length>c),i.forward2(l),o.forward(l)}}}}class Ed{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?ht.empty:e[r]}textBit(e){let{inserted:r}=this.set,n=this.i-2>>1;return n>=r.length&&!e?ht.empty:r[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Yo{constructor(e,r,n){this.from=e,this.to=r,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,r=-1){let n,s;return this.empty?n=s=e.mapPos(this.from,r):(n=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),n==this.from&&s==this.to?this:new Yo(n,s,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return xe.range(e,r);let n=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return xe.range(this.anchor,n)}eq(e,r=!1){return this.anchor==e.anchor&&this.head==e.head&&(!r||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return xe.range(e.anchor,e.head)}static create(e,r,n){return new Yo(e,r,n)}}class xe{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:xe.create(this.ranges.map(n=>n.map(e,r)),this.mainIndex)}eq(e,r=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],r))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new xe([this.main],0)}addRange(e,r=!0){return xe.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let n=this.ranges.slice();return n[r]=e,xe.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new xe(e.ranges.map(r=>Yo.fromJSON(r)),e.main)}static single(e,r=e){return new xe([xe.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,s=0;s<e.length;s++){let i=e[s];if(i.empty?i.from<=n:i.from<n)return xe.normalized(e.slice(),r);n=i.to}return new xe(e,r)}static cursor(e,r=0,n,s){return Yo.create(e,e,(r==0?0:r<0?8:16)|(n==null?7:Math.min(6,n))|(s??16777215)<<6)}static range(e,r,n,s){let i=(n??16777215)<<6|(s==null?7:Math.min(6,s));return r<e?Yo.create(r,e,48|i):Yo.create(e,r,(r>e?8:0)|i)}static normalized(e,r=0){let n=e[r];e.sort((s,i)=>s.from-i.from),r=e.indexOf(n);for(let s=1;s<e.length;s++){let i=e[s],o=e[s-1];if(i.empty?i.from<=o.to:i.from<o.to){let a=o.from,l=Math.max(i.to,o.to);s<=r&&r--,e.splice(--s,2,i.anchor>i.head?xe.range(l,a):xe.range(a,l))}}return new xe(e,r)}}function E3(t,e){for(let r of t.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}let VS=0;class je{constructor(e,r,n,s,i){this.combine=e,this.compareInput=r,this.compare=n,this.isStatic=s,this.id=VS++,this.default=e([]),this.extensions=typeof i=="function"?i(this):i}get reader(){return this}static define(e={}){return new je(e.combine||(r=>r),e.compareInput||((r,n)=>r===n),e.compare||(e.combine?(r,n)=>r===n:GS),!!e.static,e.enables)}of(e){return new qf([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new qf(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new qf(e,this,2,r)}from(e,r){return r||(r=n=>n),this.compute([e],n=>r(n.field(e)))}}function GS(t,e){return t==e||t.length==e.length&&t.every((r,n)=>r===e[n])}class qf{constructor(e,r,n,s){this.dependencies=e,this.facet=r,this.type=n,this.value=s,this.id=VS++}dynamicSlot(e){var r;let n=this.value,s=this.facet.compareInput,i=this.id,o=e[i]>>1,a=this.type==2,l=!1,c=!1,u=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?c=!0:((r=e[d.id])!==null&&r!==void 0?r:1)&1||u.push(e[d.id]);return{create(d){return d.values[o]=n(d),1},update(d,h){if(l&&h.docChanged||c&&(h.docChanged||h.selection)||Tb(d,u)){let f=n(d);if(a?!VA(f,d.values[o],s):!s(f,d.values[o]))return d.values[o]=f,1}return 0},reconfigure:(d,h)=>{let f,v=h.config.address[i];if(v!=null){let m=Sm(h,v);if(this.dependencies.every(p=>p instanceof je?h.facet(p)===d.facet(p):p instanceof sr?h.field(p,!1)==d.field(p,!1):!0)||(a?VA(f=n(d),m,s):s(f=n(d),m)))return d.values[o]=m,0}else f=n(d);return d.values[o]=f,1}}}}function VA(t,e,r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}function Tb(t,e){let r=!1;for(let n of e)_u(t,n)&1&&(r=!0);return r}function ype(t,e,r){let n=r.map(l=>t[l.id]),s=r.map(l=>l.type),i=n.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let c=[];for(let u=0;u<n.length;u++){let d=Sm(l,n[u]);if(s[u]==2)for(let h of d)c.push(h);else c.push(d)}return e.combine(c)}return{create(l){for(let c of n)_u(l,c);return l.values[o]=a(l),1},update(l,c){if(!Tb(l,i))return 0;let u=a(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,c){let u=Tb(l,n),d=c.config.facets[e.id],h=c.facet(e);if(d&&!u&&GS(r,d))return l.values[o]=h,0;let f=a(l);return e.compare(f,h)?(l.values[o]=h,0):(l.values[o]=f,1)}}}const rf=je.define({static:!0});class sr{constructor(e,r,n,s,i){this.id=e,this.createF=r,this.updateF=n,this.compareF=s,this.spec=i,this.provides=void 0}static define(e){let r=new sr(VS++,e.create,e.update,e.compare||((n,s)=>n===s),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(rf).find(n=>n.field==this);return(r?.create||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:n=>(n.values[r]=this.create(n),1),update:(n,s)=>{let i=n.values[r],o=this.updateF(i,s);return this.compareF(i,o)?0:(n.values[r]=o,1)},reconfigure:(n,s)=>{let i=n.facet(rf),o=s.facet(rf),a;return(a=i.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(n.values[r]=a.create(n),1):s.config.address[this.id]!=null?(n.values[r]=s.field(this),0):(n.values[r]=this.create(n),1)}}}init(e){return[this,rf.of({field:this,create:e})]}get extension(){return this}}const Ho={lowest:4,low:3,default:2,high:1,highest:0};function Pc(t){return e=>new C3(e,t)}const Eo={highest:Pc(Ho.highest),high:Pc(Ho.high),default:Pc(Ho.default),low:Pc(Ho.low),lowest:Pc(Ho.lowest)};class C3{constructor(e,r){this.inner=e,this.prec=r}}class va{of(e){return new Ab(this,e)}reconfigure(e){return va.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Ab{constructor(e,r){this.compartment=e,this.inner=r}}class xm{constructor(e,r,n,s,i,o){for(this.base=e,this.compartments=r,this.dynamicSlots=n,this.address=s,this.staticValues=i,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,n){let s=[],i=Object.create(null),o=new Map;for(let h of _pe(e,r,o))h instanceof sr?s.push(h):(i[h.facet.id]||(i[h.facet.id]=[])).push(h);let a=Object.create(null),l=[],c=[];for(let h of s)a[h.id]=c.length<<1,c.push(f=>h.slot(f));let u=n?.config.facets;for(let h in i){let f=i[h],v=f[0].facet,m=u&&u[h]||[];if(f.every(p=>p.type==0))if(a[v.id]=l.length<<1|1,GS(m,f))l.push(n.facet(v));else{let p=v.combine(f.map(g=>g.value));l.push(n&&v.compare(p,n.facet(v))?n.facet(v):p)}else{for(let p of f)p.type==0?(a[p.id]=l.length<<1|1,l.push(p.value)):(a[p.id]=c.length<<1,c.push(g=>p.dynamicSlot(g)));a[v.id]=c.length<<1,c.push(p=>ype(p,v,f))}}let d=c.map(h=>h(a));return new xm(e,o,d,a,l,i)}}function _pe(t,e,r){let n=[[],[],[],[],[]],s=new Map;function i(o,a){let l=s.get(o);if(l!=null){if(l<=a)return;let c=n[l].indexOf(o);c>-1&&n[l].splice(c,1),o instanceof Ab&&r.delete(o.compartment)}if(s.set(o,a),Array.isArray(o))for(let c of o)i(c,a);else if(o instanceof Ab){if(r.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;r.set(o.compartment,c),i(c,a)}else if(o instanceof C3)i(o.inner,o.prec);else if(o instanceof sr)n[a].push(o),o.provides&&i(o.provides,a);else if(o instanceof qf)n[a].push(o),o.facet.extensions&&i(o.facet.extensions,Ho.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);i(c,a)}}return i(t,Ho.default),n.reduce((o,a)=>o.concat(a))}function _u(t,e){if(e&1)return 2;let r=e>>1,n=t.status[r];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;t.status[r]=4;let s=t.computeSlot(t,t.config.dynamicSlots[r]);return t.status[r]=2|s}function Sm(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const k3=je.define(),Rb=je.define({combine:t=>t.some(e=>e),static:!0}),T3=je.define({combine:t=>t.length?t[0]:void 0,static:!0}),A3=je.define(),R3=je.define(),P3=je.define(),I3=je.define({combine:t=>t.length?t[0]:!1});class Ai{constructor(e,r){this.type=e,this.value=r}static define(){return new bpe}}class bpe{of(e){return new Ai(this,e)}}class wpe{constructor(e){this.map=e}of(e){return new Qe(this,e)}}class Qe{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new Qe(this.type,r)}is(e){return this.type==e}static define(e={}){return new wpe(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let n=[];for(let s of e){let i=s.map(r);i&&n.push(i)}return n}}Qe.reconfigure=Qe.define();Qe.appendConfig=Qe.define();class Gt{constructor(e,r,n,s,i,o){this.startState=e,this.changes=r,this.selection=n,this.effects=s,this.annotations=i,this.scrollIntoView=o,this._doc=null,this._state=null,n&&E3(n,r.newLength),i.some(a=>a.type==Gt.time)||(this.annotations=i.concat(Gt.time.of(Date.now())))}static create(e,r,n,s,i,o){return new Gt(e,r,n,s,i,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(Gt.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}}Gt.time=Ai.define();Gt.userEvent=Ai.define();Gt.addToHistory=Ai.define();Gt.remote=Ai.define();function xpe(t,e){let r=[];for(let n=0,s=0;;){let i,o;if(n<t.length&&(s==e.length||e[s]>=t[n]))i=t[n++],o=t[n++];else if(s<e.length)i=e[s++],o=e[s++];else return r;!r.length||r[r.length-1]<i?r.push(i,o):r[r.length-1]<o&&(r[r.length-1]=o)}}function O3(t,e,r){var n;let s,i,o;return r?(s=e.changes,i=qt.empty(e.changes.length),o=t.changes.compose(e.changes)):(s=e.changes.map(t.changes),i=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(s)),{changes:o,selection:e.selection?e.selection.map(i):(n=t.selection)===null||n===void 0?void 0:n.map(s),effects:Qe.mapEffects(t.effects,s).concat(Qe.mapEffects(e.effects,i)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Pb(t,e,r){let n=e.selection,s=_l(e.annotations);return e.userEvent&&(s=s.concat(Gt.userEvent.of(e.userEvent))),{changes:e.changes instanceof qt?e.changes:qt.of(e.changes||[],r,t.facet(T3)),selection:n&&(n instanceof xe?n:xe.single(n.anchor,n.head)),effects:_l(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function D3(t,e,r){let n=Pb(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let i=1;i<e.length;i++){e[i].filter===!1&&(r=!1);let o=!!e[i].sequential;n=O3(n,Pb(t,e[i],o?n.changes.newLength:t.doc.length),o)}let s=Gt.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Epe(r?Spe(s):s)}function Spe(t){let e=t.startState,r=!0;for(let s of e.facet(A3)){let i=s(t);if(i===!1){r=!1;break}Array.isArray(i)&&(r=r===!0?i:xpe(r,i))}if(r!==!0){let s,i;if(r===!1)i=t.changes.invertedDesc,s=qt.empty(e.doc.length);else{let o=t.changes.filter(r);s=o.changes,i=o.filtered.mapDesc(o.changes).invertedDesc}t=Gt.create(e,s,t.selection&&t.selection.map(i),Qe.mapEffects(t.effects,i),t.annotations,t.scrollIntoView)}let n=e.facet(R3);for(let s=n.length-1;s>=0;s--){let i=n[s](t);i instanceof Gt?t=i:Array.isArray(i)&&i.length==1&&i[0]instanceof Gt?t=i[0]:t=D3(e,_l(i),!1)}return t}function Epe(t){let e=t.startState,r=e.facet(P3),n=t;for(let s=r.length-1;s>=0;s--){let i=r[s](t);i&&Object.keys(i).length&&(n=O3(n,Pb(e,i,t.changes.newLength),!0))}return n==t?t:Gt.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}const Cpe=[];function _l(t){return t==null?Cpe:Array.isArray(t)?t:[t]}var zt=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(zt||(zt={}));const kpe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Ib;try{Ib=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Tpe(t){if(Ib)return Ib.test(t);for(let e=0;e<t.length;e++){let r=t[e];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||kpe.test(r)))return!0}return!1}function Ape(t){return e=>{if(!/\S/.test(e))return zt.Space;if(Tpe(e))return zt.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return zt.Word;return zt.Other}}class ot{constructor(e,r,n,s,i,o){this.config=e,this.doc=r,this.selection=n,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=i,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)_u(this,a<<1);this.computeSlot=null}field(e,r=!0){let n=this.config.address[e.id];if(n==null){if(r)throw new RangeError("Field is not present in this state");return}return _u(this,n),Sm(this,n)}update(...e){return D3(this,e,!0)}applyTransaction(e){let r=this.config,{base:n,compartments:s}=r;for(let a of e.effects)a.is(va.reconfigure)?(r&&(s=new Map,r.compartments.forEach((l,c)=>s.set(c,l)),r=null),s.set(a.value.compartment,a.value.extension)):a.is(Qe.reconfigure)?(r=null,n=a.value):a.is(Qe.appendConfig)&&(r=null,n=_l(n).concat(a.value));let i;r?i=e.startState.values.slice():(r=xm.resolve(n,s,this),i=new ot(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=e.startState.facet(Rb)?e.newSelection:e.newSelection.asSingle();new ot(r,e.newDoc,o,i,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:xe.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,n=e(r.ranges[0]),s=this.changes(n.changes),i=[n.range],o=_l(n.effects);for(let a=1;a<r.ranges.length;a++){let l=e(r.ranges[a]),c=this.changes(l.changes),u=c.map(s);for(let h=0;h<a;h++)i[h]=i[h].map(u);let d=s.mapDesc(c,!0);i.push(l.range.map(d)),s=s.compose(u),o=Qe.mapEffects(o,u).concat(Qe.mapEffects(_l(l.effects),d))}return{changes:s,selection:xe.create(i,r.mainIndex),effects:o}}changes(e=[]){return e instanceof qt?e:qt.of(e,this.doc.length,this.facet(ot.lineSeparator))}toText(e){return ht.of(e.split(this.facet(ot.lineSeparator)||Eb))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:(_u(this,r),Sm(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let s=e[n];s instanceof sr&&this.config.address[s.id]!=null&&(r[n]=s.spec.toJSON(this.field(e[n]),this))}return r}static fromJSON(e,r={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(n){for(let i in n)if(Object.prototype.hasOwnProperty.call(e,i)){let o=n[i],a=e[i];s.push(o.init(l=>o.spec.fromJSON(a,l)))}}return ot.create({doc:e.doc,selection:xe.fromJSON(e.selection),extensions:r.extensions?s.concat([r.extensions]):s})}static create(e={}){let r=xm.resolve(e.extensions||[],new Map),n=e.doc instanceof ht?e.doc:ht.of((e.doc||"").split(r.staticFacet(ot.lineSeparator)||Eb)),s=e.selection?e.selection instanceof xe?e.selection:xe.single(e.selection.anchor,e.selection.head):xe.single(0);return E3(s,n.length),r.staticFacet(Rb)||(s=s.asSingle()),new ot(r,n,s,r.dynamicSlots.map(()=>null),(i,o)=>o.create(i),null)}get tabSize(){return this.facet(ot.tabSize)}get lineBreak(){return this.facet(ot.lineSeparator)||`
`}get readOnly(){return this.facet(I3)}phrase(e,...r){for(let n of this.facet(ot.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(n,s)=>{if(s=="$")return"$";let i=+(s||1);return!i||i>r.length?n:r[i-1]})),e}languageDataAt(e,r,n=-1){let s=[];for(let i of this.facet(k3))for(let o of i(this,r,n))Object.prototype.hasOwnProperty.call(o,e)&&s.push(o[e]);return s}charCategorizer(e){return Ape(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:r,from:n,length:s}=this.doc.lineAt(e),i=this.charCategorizer(e),o=e-n,a=e-n;for(;o>0;){let l=mr(r,o,!1);if(i(r.slice(l,o))!=zt.Word)break;o=l}for(;a<s;){let l=mr(r,a);if(i(r.slice(a,l))!=zt.Word)break;a=l}return o==a?null:xe.range(o+n,a+n)}}ot.allowMultipleSelections=Rb;ot.tabSize=je.define({combine:t=>t.length?t[0]:4});ot.lineSeparator=T3;ot.readOnly=I3;ot.phrases=je.define({compare(t,e){let r=Object.keys(t),n=Object.keys(e);return r.length==n.length&&r.every(s=>t[s]==e[s])}});ot.languageData=k3;ot.changeFilter=A3;ot.transactionFilter=R3;ot.transactionExtender=P3;va.reconfigure=Qe.define();function Ra(t,e,r={}){let n={};for(let s of t)for(let i of Object.keys(s)){let o=s[i],a=n[i];if(a===void 0)n[i]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(r,i))n[i]=r[i](a,o);else throw new Error("Config merge conflict for field "+i)}for(let s in e)n[s]===void 0&&(n[s]=e[s]);return n}class ya{eq(e){return this==e}range(e,r=e){return Ob.create(e,r,this)}}ya.prototype.startSide=ya.prototype.endSide=0;ya.prototype.point=!1;ya.prototype.mapMode=kr.TrackDel;let Ob=class M3{constructor(e,r,n){this.from=e,this.to=r,this.value=n}static create(e,r,n){return new M3(e,r,n)}};function Db(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class zS{constructor(e,r,n,s){this.from=e,this.to=r,this.value=n,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,r,n,s=0){let i=n?this.to:this.from;for(let o=s,a=i.length;;){if(o==a)return o;let l=o+a>>1,c=i[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-r;if(l==o)return c>=0?o:a;c>=0?a=l:o=l+1}}between(e,r,n,s){for(let i=this.findIndex(r,-1e9,!0),o=this.findIndex(n,1e9,!1,i);i<o;i++)if(s(this.from[i]+e,this.to[i]+e,this.value[i])===!1)return!1}map(e,r){let n=[],s=[],i=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,d=this.to[l]+e,h,f;if(u==d){let v=r.mapPos(u,c.startSide,c.mapMode);if(v==null||(h=f=v,c.startSide!=c.endSide&&(f=r.mapPos(u,c.endSide),f<h)))continue}else if(h=r.mapPos(u,c.startSide),f=r.mapPos(d,c.endSide),h>f||h==f&&c.startSide>0&&c.endSide<=0)continue;(f-h||c.endSide-c.startSide)<0||(o<0&&(o=h),c.point&&(a=Math.max(a,f-h)),n.push(c),s.push(h-o),i.push(f-o))}return{mapped:n.length?new zS(s,i,n,a):null,pos:o}}}class ut{constructor(e,r,n,s){this.chunkPos=e,this.chunk=r,this.nextLayer=n,this.maxPoint=s}static create(e,r,n,s){return new ut(e,r,n,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:n=!1,filterFrom:s=0,filterTo:i=this.length}=e,o=e.filter;if(r.length==0&&!o)return this;if(n&&(r=r.slice().sort(Db)),this.isEmpty)return r.length?ut.of(r):this;let a=new L3(this,null,-1).goto(0),l=0,c=[],u=new _a;for(;a.value||l<r.length;)if(l<r.length&&(a.from-r[l].from||a.startSide-r[l].value.startSide)>=0){let d=r[l++];u.addInner(d.from,d.to,d.value)||c.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==r.length||this.chunkEnd(a.chunkIndex)<r[l].from)&&(!o||s>this.chunkEnd(a.chunkIndex)||i<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||s>a.to||i<a.from||o(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||c.push(Ob.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?ut.empty:this.nextLayer.update({add:c,filter:o,filterFrom:s,filterTo:i}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],n=[],s=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],c=e.touchesRange(a,a+l.length);if(c===!1)s=Math.max(s,l.maxPoint),r.push(l),n.push(e.mapPos(a));else if(c===!0){let{mapped:u,pos:d}=l.map(a,e);u&&(s=Math.max(s,u.maxPoint),r.push(u),n.push(d))}}let i=this.nextLayer.map(e);return r.length==0?i:new ut(n,r,i||ut.empty,s)}between(e,r,n){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let i=this.chunkPos[s],o=this.chunk[s];if(r>=i&&e<=i+o.length&&o.between(i,e-i,r-i,n)===!1)return}this.nextLayer.between(e,r,n)}}iter(e=0){return Cd.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return Cd.from(e).goto(r)}static compare(e,r,n,s,i=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=i),a=r.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=i),l=GA(o,a,n),c=new Ic(o,l,i),u=new Ic(a,l,i);n.iterGaps((d,h,f)=>zA(c,d,u,h,f,s)),n.empty&&n.length==0&&zA(c,0,u,0,0,s)}static eq(e,r,n=0,s){s==null&&(s=999999999);let i=e.filter(u=>!u.isEmpty&&r.indexOf(u)<0),o=r.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(i.length!=o.length)return!1;if(!i.length)return!0;let a=GA(i,o),l=new Ic(i,a,0).goto(n),c=new Ic(o,a,0).goto(n);for(;;){if(l.to!=c.to||!Mb(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>s)return!0;l.next(),c.next()}}static spans(e,r,n,s,i=-1){let o=new Ic(e,null,i).goto(r),a=r,l=o.openStart;for(;;){let c=Math.min(o.to,n);if(o.point){let u=o.activeForPoint(o.to),d=o.pointFrom<r?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);s.point(a,c,o.point,u,d,o.pointRank),l=Math.min(o.openEnd(c),u.length)}else c>a&&(s.span(a,c,o.active,l),l=o.openEnd(c));if(o.to>n)return l+(o.point&&o.to>n?1:0);a=o.to,o.next()}}static of(e,r=!1){let n=new _a;for(let s of e instanceof Ob?[e]:r?Rpe(e):e)n.add(s.from,s.to,s.value);return n.finish()}static join(e){if(!e.length)return ut.empty;let r=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let s=e[n];s!=ut.empty;s=s.nextLayer)r=new ut(s.chunkPos,s.chunk,r,Math.max(s.maxPoint,r.maxPoint));return r}}ut.empty=new ut([],[],null,-1);function Rpe(t){if(t.length>1)for(let e=t[0],r=1;r<t.length;r++){let n=t[r];if(Db(e,n)>0)return t.slice().sort(Db);e=n}return t}ut.empty.nextLayer=ut.empty;class _a{finishChunk(e){this.chunks.push(new zS(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,r,n){this.addInner(e,r,n)||(this.nextLayer||(this.nextLayer=new _a)).add(e,r,n)}addInner(e,r,n){let s=e-this.lastTo||n.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=r,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let n=r.value.length-1;return this.last=r.value[n],this.lastFrom=r.from[n]+e,this.lastTo=r.to[n]+e,!0}finish(){return this.finishInner(ut.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=ut.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}}function GA(t,e,r){let n=new Map;for(let i of t)for(let o=0;o<i.chunk.length;o++)i.chunk[o].maxPoint<=0&&n.set(i.chunk[o],i.chunkPos[o]);let s=new Set;for(let i of e)for(let o=0;o<i.chunk.length;o++){let a=n.get(i.chunk[o]);a!=null&&(r?r.mapPos(a):a)==i.chunkPos[o]&&!r?.touchesRange(a,a+i.chunk[o].length)&&s.add(i.chunk[o])}return s}class L3{constructor(e,r,n,s=0){this.layer=e,this.skip=r,this.minPoint=n,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,n){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!n||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],n=e+r.from[this.rangeIndex];if(this.from=n,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Cd{constructor(e){this.heap=e}static from(e,r=null,n=-1){let s=[];for(let i=0;i<e.length;i++)for(let o=e[i];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&s.push(new L3(o,r,n,i));return s.length==1?s[0]:new Cd(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let n of this.heap)n.goto(e,r);for(let n=this.heap.length>>1;n>=0;n--)$y(this.heap,n);return this.next(),this}forward(e,r){for(let n of this.heap)n.forward(e,r);for(let n=this.heap.length>>1;n>=0;n--)$y(this.heap,n);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),$y(this.heap,0)}}}function $y(t,e){for(let r=t[e];;){let n=(e<<1)+1;if(n>=t.length)break;let s=t[n];if(n+1<t.length&&s.compare(t[n+1])>=0&&(s=t[n+1],n++),r.compare(s)<0)break;t[n]=r,t[e]=s,e=n}}class Ic{constructor(e,r,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Cd.from(e,r,n)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){nf(this.active,e),nf(this.activeTo,e),nf(this.activeRank,e),this.minActive=WA(this.active,this.activeTo)}addActive(e){let r=0,{value:n,to:s,rank:i}=this.cursor;for(;r<this.activeRank.length&&(i-this.activeRank[r]||s-this.activeTo[r])>0;)r++;sf(this.active,r,n),sf(this.activeTo,r,s),sf(this.activeRank,r,i),e&&sf(e,r,this.cursor.from),this.minActive=WA(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),n&&nf(n,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let i=this.cursor.value;if(!i.point)this.addActive(n),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=i,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=i.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let s=n.length-1;s>=0&&n[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&r.push(this.active[n]);return r.reverse()}openEnd(e){let r=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)r++;return r}}function zA(t,e,r,n,s,i){t.goto(e),r.goto(n);let o=n+s,a=n,l=n-e;for(;;){let c=t.to+l-r.to,u=c||t.endSide-r.endSide,d=u<0?t.to+l:r.to,h=Math.min(d,o);if(t.point||r.point?t.point&&r.point&&(t.point==r.point||t.point.eq(r.point))&&Mb(t.activeForPoint(t.to),r.activeForPoint(r.to))||i.comparePoint(a,h,t.point,r.point):h>a&&!Mb(t.active,r.active)&&i.compareRange(a,h,t.active,r.active),d>o)break;(c||t.openEnd!=r.openEnd)&&i.boundChange&&i.boundChange(d),a=d,u<=0&&t.next(),u>=0&&r.next()}}function Mb(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r]&&!t[r].eq(e[r]))return!1;return!0}function nf(t,e){for(let r=e,n=t.length-1;r<n;r++)t[r]=t[r+1];t.pop()}function sf(t,e,r){for(let n=t.length-1;n>=e;n--)t[n+1]=t[n];t[e]=r}function WA(t,e){let r=-1,n=1e9;for(let s=0;s<e.length;s++)(e[s]-n||t[s].endSide-t[r].endSide)<0&&(r=s,n=e[s]);return r}function Hg(t,e,r=t.length){let n=0;for(let s=0;s<r&&s<t.length;)t.charCodeAt(s)==9?(n+=e-n%e,s++):(n++,s=mr(t,s));return n}function Ppe(t,e,r,n){for(let s=0,i=0;;){if(i>=e)return s;if(s==t.length)break;i+=t.charCodeAt(s)==9?r-i%r:1,s=mr(t,s)}return t.length}const Lb="ͼ",KA=typeof Symbol>"u"?"__"+Lb:Symbol.for(Lb),Nb=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),qA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class mo{constructor(e,r){this.rules=[];let{finish:n}=r||{};function s(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function i(o,a,l,c){let u=[],d=/^@(\w+)\b/.exec(o[0]),h=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let f in a){let v=a[f];if(/&/.test(f))i(f.split(/,\s*/).map(m=>o.map(p=>m.replace(/&/,p))).reduce((m,p)=>m.concat(p)),v,l);else if(v&&typeof v=="object"){if(!d)throw new RangeError("The value of a property ("+f+") should be a primitive value.");i(s(f),v,u,h)}else v!=null&&u.push(f.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+v+";")}(u.length||h)&&l.push((n&&!d&&!c?o.map(n):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)i(s(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=qA[KA]||1;return qA[KA]=e+1,Lb+e.toString(36)}static mount(e,r,n){let s=e[Nb],i=n&&n.nonce;s?i&&s.setNonce(i):s=new Ipe(e,i),s.mount(Array.isArray(r)?r:[r],e)}}let JA=new Map;class Ipe{constructor(e,r){let n=e.ownerDocument||e,s=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let i=JA.get(n);if(i)return e[Nb]=i;this.sheet=new s.CSSStyleSheet,JA.set(n,this)}else this.styleTag=n.createElement("style"),r&&this.styleTag.setAttribute("nonce",r);this.modules=[],e[Nb]=this}mount(e,r){let n=this.sheet,s=0,i=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<i&&l>-1&&(this.modules.splice(l,1),i--,l=-1),l==-1){if(this.modules.splice(i++,0,a),n)for(let c=0;c<a.rules.length;c++)n.insertRule(a.rules[c],s++)}else{for(;i<l;)s+=this.modules[i++].rules.length;s+=a.rules.length,i++}}if(n)r.adoptedStyleSheets.indexOf(this.sheet)<0&&(r.adoptedStyleSheets=[this.sheet,...r.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=r.head||r;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var go={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},kd={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ope=typeof navigator<"u"&&/Mac/.test(navigator.platform),Dpe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var pr=0;pr<10;pr++)go[48+pr]=go[96+pr]=String(pr);for(var pr=1;pr<=24;pr++)go[pr+111]="F"+pr;for(var pr=65;pr<=90;pr++)go[pr]=String.fromCharCode(pr+32),kd[pr]=String.fromCharCode(pr);for(var Uy in go)kd.hasOwnProperty(Uy)||(kd[Uy]=go[Uy]);function Mpe(t){var e=Ope&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Dpe&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?kd:go)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}function Td(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function Bb(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function Jf(t,e){if(!e.anchorNode)return!1;try{return Bb(t,e.anchorNode)}catch{return!1}}function Ad(t){return t.nodeType==3?wa(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function bu(t,e,r,n){return r?YA(t,e,r,n,-1)||YA(t,e,r,n,1):!1}function ba(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function Em(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function YA(t,e,r,n,s){for(;;){if(t==r&&e==n)return!0;if(e==(s<0?0:$s(t))){if(t.nodeName=="DIV")return!1;let i=t.parentNode;if(!i||i.nodeType!=1)return!1;e=ba(t)+(s<0?0:1),t=i}else if(t.nodeType==1){if(t=t.childNodes[e+(s<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=s<0?$s(t):0}else return!1}}function $s(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Vg(t,e){let r=e?t.left:t.right;return{left:r,right:r,top:t.top,bottom:t.bottom}}function Lpe(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function N3(t,e){let r=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.width-t.offsetWidth)<1)&&(r=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:r,scaleY:n}}function Npe(t,e,r,n,s,i,o,a){let l=t.ownerDocument,c=l.defaultView||window;for(let u=t,d=!1;u&&!d;)if(u.nodeType==1){let h,f=u==l.body,v=1,m=1;if(f)h=Lpe(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(d=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let y=u.getBoundingClientRect();({scaleX:v,scaleY:m}=N3(u,y)),h={left:y.left,right:y.left+u.clientWidth*v,top:y.top,bottom:y.top+u.clientHeight*m}}let p=0,g=0;if(s=="nearest")e.top<h.top?(g=e.top-(h.top+o),r>0&&e.bottom>h.bottom+g&&(g=e.bottom-h.bottom+o)):e.bottom>h.bottom&&(g=e.bottom-h.bottom+o,r<0&&e.top-g<h.top&&(g=e.top-(h.top+o)));else{let y=e.bottom-e.top,_=h.bottom-h.top;g=(s=="center"&&y<=_?e.top+y/2-_/2:s=="start"||s=="center"&&r<0?e.top-o:e.bottom-_+o)-h.top}if(n=="nearest"?e.left<h.left?(p=e.left-(h.left+i),r>0&&e.right>h.right+p&&(p=e.right-h.right+i)):e.right>h.right&&(p=e.right-h.right+i,r<0&&e.left<h.left+p&&(p=e.left-(h.left+i))):p=(n=="center"?e.left+(e.right-e.left)/2-(h.right-h.left)/2:n=="start"==a?e.left-i:e.right-(h.right-h.left)+i)-h.left,p||g)if(f)c.scrollBy(p,g);else{let y=0,_=0;if(g){let b=u.scrollTop;u.scrollTop+=g/m,_=(u.scrollTop-b)*m}if(p){let b=u.scrollLeft;u.scrollLeft+=p/v,y=(u.scrollLeft-b)*v}e={left:e.left-y,top:e.top-_,right:e.right-y,bottom:e.bottom-_},y&&Math.abs(y-p)<1&&(n="nearest"),_&&Math.abs(_-g)<1&&(s="nearest")}if(f)break;(e.top<h.top||e.bottom>h.bottom||e.left<h.left||e.right>h.right)&&(e={left:Math.max(e.left,h.left),right:Math.min(e.right,h.right),top:Math.max(e.top,h.top),bottom:Math.min(e.bottom,h.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function Bpe(t){let e=t.ownerDocument,r,n;for(let s=t.parentNode;s&&!(s==e.body||r&&n);)if(s.nodeType==1)!n&&s.scrollHeight>s.clientHeight&&(n=s),!r&&s.scrollWidth>s.clientWidth&&(r=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:r,y:n}}class Fpe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:r,focusNode:n}=e;this.set(r,Math.min(e.anchorOffset,r?$s(r):0),n,Math.min(e.focusOffset,n?$s(n):0))}set(e,r,n,s){this.anchorNode=e,this.anchorOffset=r,this.focusNode=n,this.focusOffset=s}}let $a=null;function B3(t){if(t.setActive)return t.setActive();if($a)return t.focus($a);let e=[];for(let r=t;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(t.focus($a==null?{get preventScroll(){return $a={preventScroll:!0},!0}}:void 0),!$a){$a=!1;for(let r=0;r<e.length;){let n=e[r++],s=e[r++],i=e[r++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=i&&(n.scrollLeft=i)}}}let ZA;function wa(t,e,r=e){let n=ZA||(ZA=document.createRange());return n.setEnd(t,r),n.setStart(t,e),n}function bl(t,e,r,n){let s={key:e,code:e,keyCode:r,which:r,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let i=new KeyboardEvent("keydown",s);i.synthetic=!0,t.dispatchEvent(i);let o=new KeyboardEvent("keyup",s);return o.synthetic=!0,t.dispatchEvent(o),i.defaultPrevented||o.defaultPrevented}function jpe(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function F3(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function $pe(t,e){let r=e.focusNode,n=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=n)return!1;for(n=Math.min(n,$s(r));;)if(n){if(r.nodeType!=1)return!1;let s=r.childNodes[n-1];s.contentEditable=="false"?n--:(r=s,n=$s(r))}else{if(r==t)return!0;n=ba(r),r=r.parentNode}}function j3(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function $3(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n>0)return{node:r,offset:n};if(r.nodeType==1&&n>0){if(r.contentEditable=="false")return null;r=r.childNodes[n-1],n=$s(r)}else if(r.parentNode&&!Em(r))n=ba(r),r=r.parentNode;else return null}}function U3(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n<r.nodeValue.length)return{node:r,offset:n};if(r.nodeType==1&&n<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[n],n=0}else if(r.parentNode&&!Em(r))n=ba(r)+1,r=r.parentNode;else return null}}class Tr{constructor(e,r,n=!0){this.node=e,this.offset=r,this.precise=n}static before(e,r){return new Tr(e.parentNode,ba(e),r)}static after(e,r){return new Tr(e.parentNode,ba(e)+1,r)}}const WS=[];class _t{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let r=this.posAtStart;for(let n of this.children){if(n==e)return r;r+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,r){if(this.flags&2){let n=this.dom,s=null,i;for(let o of this.children){if(o.flags&7){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let a=_t.get(i);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(e,r),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,r&&!r.written&&r.node==n&&i!=o.dom&&(r.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=XA(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&r&&r.node==n&&(r.written=!0);i;)i=XA(i)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,r),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,r){let n;if(e==this.dom)n=this.dom.childNodes[r];else{let s=$s(e)==0?0:r==0?-1:1;for(;;){let i=e.parentNode;if(i==this.dom)break;s==0&&i.firstChild!=i.lastChild&&(e==i.firstChild?s=-1:s=1),e=i}s<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!_t.get(n);)n=n.nextSibling;if(!n)return this.length;for(let s=0,i=0;;s++){let o=this.children[s];if(o.dom==n)return i;i+=o.length+o.breakAfter}}domBoundsAround(e,r,n=0){let s=-1,i=-1,o=-1,a=-1;for(let l=0,c=n,u=n;l<this.children.length;l++){let d=this.children[l],h=c+d.length;if(c<e&&h>r)return d.domBoundsAround(e,r,c);if(h>=e&&s==-1&&(s=l,i=c),c>r&&d.dom.parentNode==this.dom){o=l,a=u;break}u=h,c=h+d.breakAfter}return{from:i,to:a<0?n+this.length:a,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let r=this.parent;r;r=r.parent){if(e&&(r.flags|=2),r.flags&1)return;r.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let r=e.parent;if(!r)return e;e=r}}replaceChildren(e,r,n=WS){this.markDirty();for(let s=e;s<r;s++){let i=this.children[s];i.parent==this&&n.indexOf(i)<0&&i.destroy()}n.length<250?this.children.splice(e,r-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(r));for(let s=0;s<n.length;s++)n[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new H3(this.children,e,this.children.length)}childPos(e,r=1){return this.childCursor().findPos(e,r)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,r,n,s,i,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}_t.prototype.breakAfter=0;function XA(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class H3{constructor(e,r,n){this.children=e,this.pos=r,this.i=n,this.off=0}findPos(e,r=1){for(;;){if(e>this.pos||e==this.pos&&(r>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function V3(t,e,r,n,s,i,o,a,l){let{children:c}=t,u=c.length?c[e]:null,d=i.length?i[i.length-1]:null,h=d?d.breakAfter:o;if(!(e==n&&u&&!o&&!h&&i.length<2&&u.merge(r,s,i.length?d:null,r==0,a,l))){if(n<c.length){let f=c[n];f&&(s<f.length||f.breakAfter&&d?.breakAfter)?(e==n&&(f=f.split(s),s=0),!h&&d&&f.merge(0,s,d,!0,0,l)?i[i.length-1]=f:((s||f.children.length&&!f.children[0].length)&&f.merge(0,s,null,!1,0,l),i.push(f))):f?.breakAfter&&(d?d.breakAfter=1:o=1),n++}for(u&&(u.breakAfter=o,r>0&&(!o&&i.length&&u.merge(r,u.length,i[0],!1,a,0)?u.breakAfter=i.shift().breakAfter:(r<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(r,u.length,null,!1,a,0),e++));e<n&&i.length;)if(c[n-1].become(i[i.length-1]))n--,i.pop(),l=i.length?0:a;else if(c[e].become(i[0]))e++,i.shift(),a=i.length?0:l;else break;!i.length&&e&&n<c.length&&!c[e-1].breakAfter&&c[n].merge(0,0,c[e-1],!1,a,l)&&e--,(e<n||i.length)&&t.replaceChildren(e,n,i)}}function G3(t,e,r,n,s,i){let o=t.childCursor(),{i:a,off:l}=o.findPos(r,1),{i:c,off:u}=o.findPos(e,-1),d=e-r;for(let h of n)d+=h.length;t.length+=d,V3(t,c,u,a,l,n,0,s,i)}let qr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Fb=typeof document<"u"?document:{documentElement:{style:{}}};const jb=/Edge\/(\d+)/.exec(qr.userAgent),z3=/MSIE \d/.test(qr.userAgent),$b=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(qr.userAgent),Gg=!!(z3||$b||jb),QA=!Gg&&/gecko\/(\d+)/i.test(qr.userAgent),Hy=!Gg&&/Chrome\/(\d+)/.exec(qr.userAgent),Upe="webkitFontSmoothing"in Fb.documentElement.style,W3=!Gg&&/Apple Computer/.test(qr.vendor),eR=W3&&(/Mobile\/\w+/.test(qr.userAgent)||qr.maxTouchPoints>2);var Le={mac:eR||/Mac/.test(qr.platform),windows:/Win/.test(qr.platform),linux:/Linux|X11/.test(qr.platform),ie:Gg,ie_version:z3?Fb.documentMode||6:$b?+$b[1]:jb?+jb[1]:0,gecko:QA,gecko_version:QA?+(/Firefox\/(\d+)/.exec(qr.userAgent)||[0,0])[1]:0,chrome:!!Hy,chrome_version:Hy?+Hy[1]:0,ios:eR,android:/Android\b/.test(qr.userAgent),safari:W3,webkit_version:Upe?+(/\bAppleWebKit\/(\d+)/.exec(qr.userAgent)||[0,0])[1]:0,tabSize:Fb.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Hpe=256;class ts extends _t{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,r){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(r&&r.node==this.dom&&(r.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,r,n){return this.flags&8||n&&(!(n instanceof ts)||this.length-(r-e)+n.length>Hpe||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(r),this.markDirty(),!0)}split(e){let r=new ts(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),r.flags|=this.flags&8,r}localPosFromDOM(e,r){return e==this.dom?r:r?this.text.length:0}domAtPos(e){return new Tr(this.dom,e)}domBoundsAround(e,r,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,r){return Vpe(this.dom,e,r)}}class ki extends _t{constructor(e,r=[],n=0){super(),this.mark=e,this.children=r,this.length=n;for(let s of r)s.setParent(this)}setAttrs(e){if(F3(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let r in this.mark.attrs)e.setAttribute(r,this.mark.attrs[r]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,r){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,r)}merge(e,r,n,s,i,o){return n&&(!(n instanceof ki&&n.mark.eq(this.mark))||e&&i<=0||r<this.length&&o<=0)?!1:(G3(this,e,r,n?n.children.slice():[],i-1,o-1),this.markDirty(),!0)}split(e){let r=[],n=0,s=-1,i=0;for(let a of this.children){let l=n+a.length;l>e&&r.push(n<e?a.split(e-n):a),s<0&&n>=e&&(s=i),n=l,i++}let o=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new ki(this.mark,r,o)}domAtPos(e){return K3(this,e)}coordsAt(e,r){return J3(this,e,r)}}function Vpe(t,e,r){let n=t.nodeValue.length;e>n&&(e=n);let s=e,i=e,o=0;e==0&&r<0||e==n&&r>=0?Le.chrome||Le.gecko||(e?(s--,o=1):i<n&&(i++,o=-1)):r<0?s--:i<n&&i++;let a=wa(t,s,i).getClientRects();if(!a.length)return null;let l=a[(o?o<0:r>=0)?0:a.length-1];return Le.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),o?Vg(l,o<0):l||null}class Zo extends _t{static create(e,r,n){return new Zo(e,r,n)}constructor(e,r,n){super(),this.widget=e,this.length=r,this.side=n,this.prevWidget=null}split(e){let r=Zo.create(this.widget,this.length-e,this.side);return this.length-=e,r}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,r,n,s,i,o){return n&&(!(n instanceof Zo)||!this.widget.compare(n.widget)||e>0&&i<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}become(e){return e instanceof Zo&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return ht.empty;let e=this;for(;e.parent;)e=e.parent;let{view:r}=e,n=r&&r.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):ht.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Tr.before(this.dom):Tr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);if(n)return n;let s=this.dom.getClientRects(),i=null;if(!s.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?s.length-1:0;i=s[a],!(e>0?a==0:a==s.length-1||i.top<i.bottom);a+=o?-1:1);return Vg(i,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Wl extends _t{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Wl&&e.side==this.side}split(){return new Wl(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Tr.before(this.dom):Tr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ht.empty}get isHidden(){return!0}}ts.prototype.children=Zo.prototype.children=Wl.prototype.children=WS;function K3(t,e){let r=t.dom,{children:n}=t,s=0;for(let i=0;s<n.length;s++){let o=n[s],a=i+o.length;if(!(a==i&&o.getSide()<=0)){if(e>i&&e<a&&o.dom.parentNode==r)return o.domAtPos(e-i);if(e<=i)break;i=a}}for(let i=s;i>0;i--){let o=n[i-1];if(o.dom.parentNode==r)return o.domAtPos(o.length)}for(let i=s;i<n.length;i++){let o=n[i];if(o.dom.parentNode==r)return o.domAtPos(0)}return new Tr(r,0)}function q3(t,e,r){let n,{children:s}=t;r>0&&e instanceof ki&&s.length&&(n=s[s.length-1])instanceof ki&&n.mark.eq(e.mark)?q3(n,e.children[0],r-1):(s.push(e),e.setParent(t)),t.length+=e.length}function J3(t,e,r){let n=null,s=-1,i=null,o=-1;function a(c,u){for(let d=0,h=0;d<c.children.length&&h<=u;d++){let f=c.children[d],v=h+f.length;v>=u&&(f.children.length?a(f,u-h):(!i||i.isHidden&&(r>0||zpe(i,f)))&&(v>u||h==v&&f.getSide()>0)?(i=f,o=u-h):(h<u||h==v&&f.getSide()<0&&!f.isHidden)&&(n=f,s=u-h)),h=v}}a(t,e);let l=(r<0?n:i)||n||i;return l?l.coordsAt(Math.max(0,l==n?s:o),r):Gpe(t)}function Gpe(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let r=Ad(e);return r[r.length-1]||null}function zpe(t,e){let r=t.coordsAt(0,1),n=e.coordsAt(0,1);return r&&n&&n.top<r.bottom}function Ub(t,e){for(let r in t)r=="class"&&e.class?e.class+=" "+t.class:r=="style"&&e.style?e.style+=";"+t.style:e[r]=t[r];return e}const tR=Object.create(null);function Cm(t,e,r){if(t==e)return!0;t||(t=tR),e||(e=tR);let n=Object.keys(t),s=Object.keys(e);if(n.length-(r&&n.indexOf(r)>-1?1:0)!=s.length-(r&&s.indexOf(r)>-1?1:0))return!1;for(let i of n)if(i!=r&&(s.indexOf(i)==-1||t[i]!==e[i]))return!1;return!0}function Hb(t,e,r){let n=!1;if(e)for(let s in e)r&&s in r||(n=!0,s=="style"?t.style.cssText="":t.removeAttribute(s));if(r)for(let s in r)e&&e[s]==r[s]||(n=!0,s=="style"?t.style.cssText=r[s]:t.setAttribute(s,r[s]));return n}function Wpe(t){let e=Object.create(null);for(let r=0;r<t.attributes.length;r++){let n=t.attributes[r];e[n.name]=n.value}return e}class Pa{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,r,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var jr=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(jr||(jr={}));class rt extends ya{constructor(e,r,n,s){super(),this.startSide=e,this.endSide=r,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(e){return new oh(e)}static widget(e){let r=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return r+=n&&!e.inlineOrder?r>0?3e8:-4e8:r>0?1e8:-1e8,new vo(e,r,r,n,e.widget||null,!1)}static replace(e){let r=!!e.block,n,s;if(e.isBlockGap)n=-5e8,s=4e8;else{let{start:i,end:o}=Y3(e,r);n=(i?r?-3e8:-1:5e8)-1,s=(o?r?2e8:1:-6e8)+1}return new vo(e,n,s,r,e.widget||null,!0)}static line(e){return new ah(e)}static set(e,r=!1){return ut.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}rt.none=ut.empty;class oh extends rt{constructor(e){let{start:r,end:n}=Y3(e);super(r?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var r,n;return this==e||e instanceof oh&&this.tagName==e.tagName&&(this.class||((r=this.attrs)===null||r===void 0?void 0:r.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Cm(this.attrs,e.attrs,"class")}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}}oh.prototype.point=!1;class ah extends rt{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ah&&this.spec.class==e.spec.class&&Cm(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}}ah.prototype.mapMode=kr.TrackBefore;ah.prototype.point=!0;class vo extends rt{constructor(e,r,n,s,i,o){super(r,n,i,e),this.block=s,this.isReplace=o,this.mapMode=s?r<=0?kr.TrackBefore:kr.TrackAfter:kr.TrackDel}get type(){return this.startSide!=this.endSide?jr.WidgetRange:this.startSide<=0?jr.WidgetBefore:jr.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof vo&&Kpe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}}vo.prototype.point=!0;function Y3(t,e=!1){let{inclusiveStart:r,inclusiveEnd:n}=t;return r==null&&(r=t.inclusive),n==null&&(n=t.inclusive),{start:r??e,end:n??e}}function Kpe(t,e){return t==e||!!(t&&e&&t.compare(e))}function Yf(t,e,r,n=0){let s=r.length-1;s>=0&&r[s]+n>=t?r[s]=Math.max(r[s],e):r.push(t,e)}class Vt extends _t{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,r,n,s,i,o){if(n){if(!(n instanceof Vt))return!1;this.dom||n.transferDOM(this)}return s&&this.setDeco(n?n.attrs:null),G3(this,e,r,n?n.children.slice():[],i,o),!0}split(e){let r=new Vt;if(r.breakAfter=this.breakAfter,this.length==0)return r;let{i:n,off:s}=this.childPos(e);s&&(r.append(this.children[n].split(s),0),this.children[n].merge(s,this.children[n].length,null,!1,0,0),n++);for(let i=n;i<this.children.length;i++)r.append(this.children[i],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,r}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Cm(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,r){q3(this,e,r)}addLineDeco(e){let r=e.spec.attributes,n=e.spec.class;r&&(this.attrs=Ub(r,this.attrs||{})),n&&(this.attrs=Ub({class:n},this.attrs||{}))}domAtPos(e){return K3(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,r){var n;this.dom?this.flags&4&&(F3(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Hb(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,r);let s=this.dom.lastChild;for(;s&&_t.get(s)instanceof ki;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((n=_t.get(s))===null||n===void 0?void 0:n.isEditable)==!1&&(!Le.ios||!this.children.some(i=>i instanceof ts))){let i=document.createElement("BR");i.cmIgnore=!0,this.dom.appendChild(i)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,r;for(let n of this.children){if(!(n instanceof ts)||/[^ -~]/.test(n.text))return null;let s=Ad(n.dom);if(s.length!=1)return null;e+=s[0].width,r=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:r}:null}coordsAt(e,r){let n=J3(this,e,r);if(!this.children.length&&n&&this.parent){let{heightOracle:s}=this.parent.view.viewState,i=n.bottom-n.top;if(Math.abs(i-s.lineHeight)<2&&s.textHeight<i){let o=(i-s.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return e instanceof Vt&&this.children.length==0&&e.children.length==0&&Cm(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,r){for(let n=0,s=0;n<e.children.length;n++){let i=e.children[n],o=s+i.length;if(o>=r){if(i instanceof Vt)return i;if(o>r)break}s=o+i.breakAfter}return null}}class gi extends _t{constructor(e,r,n){super(),this.widget=e,this.length=r,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,r,n,s,i,o){return n&&(!(n instanceof gi)||!this.widget.compare(n.widget)||e>0&&i<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}domAtPos(e){return e==0?Tr.before(this.dom):Tr.after(this.dom,e==this.length)}split(e){let r=this.length-e;this.length=e;let n=new gi(this.widget,r,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return WS}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ht.empty}domBoundsAround(){return null}become(e){return e instanceof gi&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);return n||(this.widget instanceof Vb?null:Vg(this.dom.getBoundingClientRect(),this.length?e==0:r<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:r,endSide:n}=this.deco;return r==n?!1:e<0?r<0:n>0}}class Vb extends Pa{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class wu{constructor(e,r,n,s){this.doc=e,this.pos=r,this.end=n,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=r}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof gi&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Vt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(of(new Wl(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof gi)&&this.getLine()}buildText(e,r,n){for(;e>0;){if(this.textOff==this.text.length){let{value:i,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=i,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(r.slice(r.length-n)),this.getLine().append(of(new ts(this.text.slice(this.textOff,this.textOff+s)),r),n),this.atCursorPos=!0,this.textOff+=s,e-=s,n=0}}span(e,r,n,s){this.buildText(r-e,n,s),this.pos=r,this.openStart<0&&(this.openStart=s)}point(e,r,n,s,i,o){if(this.disallowBlockEffectsFor[o]&&n instanceof vo){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(r>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=r-e;if(n instanceof vo)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new gi(n.widget||Kl.block,a,n));else{let l=Zo.create(n.widget||Kl.inline,a,a?0:n.startSide),c=this.atCursorPos&&!l.isEditable&&i<=s.length&&(e<r||n.startSide>0),u=!l.isEditable&&(e<r||i>s.length||n.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),c&&(d.append(of(new Wl(1),s),i),i=s.length+Math.max(0,i-s.length)),d.append(of(l,s),i),this.atCursorPos=u,this.pendingBuffer=u?e<r||i>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=r),this.openStart<0&&(this.openStart=i)}static build(e,r,n,s,i){let o=new wu(e,r,n,i);return o.openEnd=ut.spans(s,r,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function of(t,e){for(let r of e)t=new ki(r,[t],t.length);return t}class Kl extends Pa{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Kl.inline=new Kl("span");Kl.block=new Kl("div");var At=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(At||(At={}));const xa=At.LTR,KS=At.RTL;function Z3(t){let e=[];for(let r=0;r<t.length;r++)e.push(1<<+t[r]);return e}const qpe=Z3("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Jpe=Z3("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Gb=Object.create(null),ds=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),r=t.charCodeAt(1);Gb[e]=r,Gb[r]=-e}function X3(t){return t<=247?qpe[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?Jpe[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const Ype=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class qi{get dir(){return this.level%2?KS:xa}constructor(e,r,n){this.from=e,this.to=r,this.level=n}side(e,r){return this.dir==r==e?this.to:this.from}forward(e,r){return e==(this.dir==r)}static find(e,r,n,s){let i=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=r&&a.to>=r){if(a.level==n)return o;(i<0||(s!=0?s<0?a.from<r:a.to>r:e[i].level>a.level))&&(i=o)}}if(i<0)throw new RangeError("Index out of range");return i}}function Q3(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++){let n=t[r],s=e[r];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!Q3(n.inner,s.inner))return!1}return!0}const yt=[];function Zpe(t,e,r,n,s){for(let i=0;i<=n.length;i++){let o=i?n[i-1].to:e,a=i<n.length?n[i].from:r,l=i?256:s;for(let c=o,u=l,d=l;c<a;c++){let h=X3(t.charCodeAt(c));h==512?h=u:h==8&&d==4&&(h=16),yt[c]=h==4?2:h,h&7&&(d=h),u=h}for(let c=o,u=l,d=l;c<a;c++){let h=yt[c];if(h==128)c<a-1&&u==yt[c+1]&&u&24?h=yt[c]=u:yt[c]=256;else if(h==64){let f=c+1;for(;f<a&&yt[f]==64;)f++;let v=c&&u==8||f<r&&yt[f]==8?d==1?1:8:256;for(let m=c;m<f;m++)yt[m]=v;c=f-1}else h==8&&d==1&&(yt[c]=1);u=h,h&7&&(d=h)}}}function Xpe(t,e,r,n,s){let i=s==1?2:1;for(let o=0,a=0,l=0;o<=n.length;o++){let c=o?n[o-1].to:e,u=o<n.length?n[o].from:r;for(let d=c,h,f,v;d<u;d++)if(f=Gb[h=t.charCodeAt(d)])if(f<0){for(let m=a-3;m>=0;m-=3)if(ds[m+1]==-f){let p=ds[m+2],g=p&2?s:p&4?p&1?i:s:0;g&&(yt[d]=yt[ds[m]]=g),a=m;break}}else{if(ds.length==189)break;ds[a++]=d,ds[a++]=h,ds[a++]=l}else if((v=yt[d])==2||v==1){let m=v==s;l=m?0:1;for(let p=a-3;p>=0;p-=3){let g=ds[p+2];if(g&2)break;if(m)ds[p+2]|=2;else{if(g&4)break;ds[p+2]|=4}}}}}function Qpe(t,e,r,n){for(let s=0,i=n;s<=r.length;s++){let o=s?r[s-1].to:t,a=s<r.length?r[s].from:e;for(let l=o;l<a;){let c=yt[l];if(c==256){let u=l+1;for(;;)if(u==a){if(s==r.length)break;u=r[s++].to,a=s<r.length?r[s].from:e}else if(yt[u]==256)u++;else break;let d=i==1,h=(u<e?yt[u]:n)==1,f=d==h?d?1:2:n;for(let v=u,m=s,p=m?r[m-1].to:t;v>l;)v==p&&(v=r[--m].from,p=m?r[m-1].to:t),yt[--v]=f;l=u}else i=c,l++}}}function zb(t,e,r,n,s,i,o){let a=n%2?2:1;if(n%2==s%2)for(let l=e,c=0;l<r;){let u=!0,d=!1;if(c==i.length||l<i[c].from){let m=yt[l];m!=a&&(u=!1,d=m==16)}let h=!u&&a==1?[]:null,f=u?n:n+1,v=l;e:for(;;)if(c<i.length&&v==i[c].from){if(d)break e;let m=i[c];if(!u)for(let p=m.to,g=c+1;;){if(p==r)break e;if(g<i.length&&i[g].from==p)p=i[g++].to;else{if(yt[p]==a)break e;break}}if(c++,h)h.push(m);else{m.from>l&&o.push(new qi(l,m.from,f));let p=m.direction==xa!=!(f%2);Wb(t,p?n+1:n,s,m.inner,m.from,m.to,o),l=m.to}v=m.to}else{if(v==r||(u?yt[v]!=a:yt[v]==a))break;v++}h?zb(t,l,v,n+1,s,h,o):l<v&&o.push(new qi(l,v,f)),l=v}else for(let l=r,c=i.length;l>e;){let u=!0,d=!1;if(!c||l>i[c-1].to){let m=yt[l-1];m!=a&&(u=!1,d=m==16)}let h=!u&&a==1?[]:null,f=u?n:n+1,v=l;e:for(;;)if(c&&v==i[c-1].to){if(d)break e;let m=i[--c];if(!u)for(let p=m.from,g=c;;){if(p==e)break e;if(g&&i[g-1].to==p)p=i[--g].from;else{if(yt[p-1]==a)break e;break}}if(h)h.push(m);else{m.to<l&&o.push(new qi(m.to,l,f));let p=m.direction==xa!=!(f%2);Wb(t,p?n+1:n,s,m.inner,m.from,m.to,o),l=m.from}v=m.from}else{if(v==e||(u?yt[v-1]!=a:yt[v-1]==a))break;v--}h?zb(t,v,l,n+1,s,h,o):v<l&&o.push(new qi(v,l,f)),l=v}}function Wb(t,e,r,n,s,i,o){let a=e%2?2:1;Zpe(t,s,i,n,a),Xpe(t,s,i,n,a),Qpe(s,i,n,a),zb(t,s,i,e,r,n,o)}function eme(t,e,r){if(!t)return[new qi(0,0,e==KS?1:0)];if(e==xa&&!r.length&&!Ype.test(t))return e5(t.length);if(r.length)for(;t.length>yt.length;)yt[yt.length]=256;let n=[],s=e==xa?0:1;return Wb(t,s,s,r,0,t.length,n),n}function e5(t){return[new qi(0,t,0)]}let t5="";function tme(t,e,r,n,s){var i;let o=n.head-t.from,a=qi.find(e,o,(i=n.bidiLevel)!==null&&i!==void 0?i:-1,n.assoc),l=e[a],c=l.side(s,r);if(o==c){let h=a+=s?1:-1;if(h<0||h>=e.length)return null;l=e[a=h],o=l.side(!s,r),c=l.side(s,r)}let u=mr(t.text,o,l.forward(s,r));(u<l.from||u>l.to)&&(u=c),t5=t.text.slice(Math.min(o,u),Math.max(o,u));let d=a==(s?e.length-1:0)?null:e[a+(s?1:-1)];return d&&u==c&&d.level+(s?0:1)<l.level?xe.cursor(d.side(!s,r)+t.from,d.forward(s,r)?1:-1,d.level):xe.cursor(u+t.from,l.forward(s,r)?-1:1,l.level)}function rme(t,e,r){for(let n=e;n<r;n++){let s=X3(t.charCodeAt(n));if(s==1)return xa;if(s==2||s==4)return KS}return xa}const r5=je.define(),n5=je.define(),s5=je.define(),i5=je.define(),Kb=je.define(),o5=je.define(),a5=je.define(),qS=je.define(),JS=je.define(),l5=je.define({combine:t=>t.some(e=>e)}),c5=je.define({combine:t=>t.some(e=>e)}),u5=je.define();class wl{constructor(e,r="nearest",n="nearest",s=5,i=5,o=!1){this.range=e,this.y=r,this.x=n,this.yMargin=s,this.xMargin=i,this.isSnapshot=o}map(e){return e.empty?this:new wl(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new wl(xe.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const af=Qe.define({map:(t,e)=>t.map(e)}),d5=Qe.define();function hn(t,e,r){let n=t.facet(i5);n.length?n[0](e):window.onerror?window.onerror(String(e),r,void 0,void 0,e):r?console.error(r+":",e):console.error(e)}const ci=je.define({combine:t=>t.length?t[0]:!0});let nme=0;const zc=je.define();class nr{constructor(e,r,n,s,i){this.id=e,this.create=r,this.domEventHandlers=n,this.domEventObservers=s,this.extension=i(this)}static define(e,r){const{eventHandlers:n,eventObservers:s,provide:i,decorations:o}=r||{};return new nr(nme++,e,n,s,a=>{let l=[zc.of(a)];return o&&l.push(Rd.of(c=>{let u=c.plugin(a);return u?o(u):rt.none})),i&&l.push(i(a)),l})}static fromClass(e,r){return nr.define(n=>new e(n),r)}}class Vy{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(n){if(hn(r.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(r){hn(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(n){hn(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const h5=je.define(),zg=je.define(),Rd=je.define(),f5=je.define(),YS=je.define(),p5=je.define();function rR(t,e){let r=t.state.facet(p5);if(!r.length)return r;let n=r.map(i=>i instanceof Function?i(t):i),s=[];return ut.spans(n,e.from,e.to,{point(){},span(i,o,a,l){let c=i-e.from,u=o-e.from,d=s;for(let h=a.length-1;h>=0;h--,l--){let f=a[h].spec.bidiIsolate,v;if(f==null&&(f=rme(e.text,c,u)),l>0&&d.length&&(v=d[d.length-1]).to==c&&v.direction==f)v.to=u,d=v.inner;else{let m={from:c,to:u,direction:f,inner:[]};d.push(m),d=m.inner}}}}),s}const m5=je.define();function ZS(t){let e=0,r=0,n=0,s=0;for(let i of t.state.facet(m5)){let o=i(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(r=Math.max(r,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(s=Math.max(s,o.bottom)))}return{left:e,right:r,top:n,bottom:s}}const Wc=je.define();class Ln{constructor(e,r,n,s){this.fromA=e,this.toA=r,this.fromB=n,this.toB=s}join(e){return new Ln(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,n=this;for(;r>0;r--){let s=e[r-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),e.splice(r-1,1)}}return e.splice(r,0,n),e}static extendWithRanges(e,r){if(r.length==0)return e;let n=[];for(let s=0,i=0,o=0,a=0;;s++){let l=s==e.length?null:e[s],c=o-a,u=l?l.fromB:1e9;for(;i<r.length&&r[i]<u;){let d=r[i],h=r[i+1],f=Math.max(a,d),v=Math.min(u,h);if(f<=v&&new Ln(f+c,v+c,f,v).addToSet(n),h>u)break;i+=2}if(!l)return n;new Ln(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),o=l.toA,a=l.toB}}}class km{constructor(e,r,n){this.view=e,this.state=r,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=qt.empty(this.startState.doc.length);for(let i of n)this.changes=this.changes.compose(i.changes);let s=[];this.changes.iterChangedRanges((i,o,a,l)=>s.push(new Ln(i,o,a,l))),this.changedRanges=s}static create(e,r,n){return new km(e,r,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class nR extends _t{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=rt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Vt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ln(0,0,0,e.state.doc.length)],0,null)}update(e){var r;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((r=this.domChanged)===null||r===void 0)&&r.newSel?s=this.domChanged.newSel.head:!ume(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let i=s>-1?ime(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;n=new Ln(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(n.slice())}this.hasComposition=i?{from:i.range.fromB,to:i.range.toB}:null,(Le.ie||Le.chrome)&&!i&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=lme(o,a,e.changes);return n=Ln.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,i),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,r,n);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Le.chrome||Le.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||s.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof gi&&o.widget instanceof Vb&&i.push(o.dom);s.updateGaps(i)}updateChildren(e,r,n){let s=n?n.range.addToSet(e.slice()):e,i=this.childCursor(r);for(let o=s.length-1;;o--){let a=o>=0?s[o]:null;if(!a)break;let{fromA:l,toA:c,fromB:u,toB:d}=a,h,f,v,m;if(n&&n.range.fromB<d&&n.range.toB>u){let b=wu.build(this.view.state.doc,u,n.range.fromB,this.decorations,this.dynamicDecorationMap),w=wu.build(this.view.state.doc,n.range.toB,d,this.decorations,this.dynamicDecorationMap);f=b.breakAtStart,v=b.openStart,m=w.openEnd;let E=this.compositionView(n);w.breakAtStart?E.breakAfter=1:w.content.length&&E.merge(E.length,E.length,w.content[0],!1,w.openStart,0)&&(E.breakAfter=w.content[0].breakAfter,w.content.shift()),b.content.length&&E.merge(0,0,b.content[b.content.length-1],!0,0,b.openEnd)&&b.content.pop(),h=b.content.concat(E).concat(w.content)}else({content:h,breakAtStart:f,openStart:v,openEnd:m}=wu.build(this.view.state.doc,u,d,this.decorations,this.dynamicDecorationMap));let{i:p,off:g}=i.findPos(c,1),{i:y,off:_}=i.findPos(l,-1);V3(this,y,_,p,g,h,f,v,m)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let r of e.transactions)for(let n of r.effects)n.is(d5)&&(this.editContextFormatting=n.value)}compositionView(e){let r=new ts(e.text.nodeValue);r.flags|=8;for(let{deco:s}of e.marks)r=new ki(s,[r],r.length);let n=new Vt;return n.append(r,0),n}fixCompositionDOM(e){let r=(i,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=_t.get(i);a&&a!=o&&(a.dom=null),o.setDOM(i)},n=this.childPos(e.range.fromB,1),s=this.children[n.i];r(e.line,s);for(let i=e.marks.length-1;i>=-1;i--)n=s.childPos(n.off,1),s=s.children[n.i],r(i>=0?e.marks[i].node:e.text,s)}updateSelection(e=!1,r=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,s=n==this.dom,i=!s&&!(this.view.state.facet(ci)||this.dom.tabIndex>-1)&&Jf(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(s||r||i))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(Le.gecko&&a.empty&&!this.hasComposition&&sme(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=c=new Tr(d,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!bu(l.node,l.offset,u.anchorNode,u.anchorOffset)||!bu(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,a))&&(this.view.observer.ignore(()=>{Le.android&&Le.chrome&&this.dom.contains(u.focusNode)&&cme(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=Td(this.view.root);if(d)if(a.empty){if(Le.gecko){let h=ome(l.node,l.offset);if(h&&h!=3){let f=(h==1?$3:U3)(l.node,l.offset);f&&(l=new Tr(f.node,f.offset))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(c.node,c.offset)}catch{}}else{let h=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),h.setEnd(c.node,c.offset),h.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(h)}i&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new Tr(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new Tr(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,r){return this.hasComposition&&r.empty&&bu(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==r.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,r=e.state.selection.main,n=Td(e.root),{anchorNode:s,anchorOffset:i}=e.observer.selectionRange;if(!n||!r.empty||!r.assoc||!n.modify)return;let o=Vt.find(this,r.head);if(!o)return;let a=o.posAtStart;if(r.head==a||r.head==a+o.length)return;let l=this.coordsAt(r.head,-1),c=this.coordsAt(r.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(r.head+r.assoc);n.collapse(u.node,u.offset),n.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=r.from&&n.collapse(s,i)}moveToLine(e){let r=this.dom,n;if(e.node!=r)return e;for(let s=e.offset;!n&&s<r.childNodes.length;s++){let i=_t.get(r.childNodes[s]);i instanceof Vt&&(n=i.domAtPos(0))}for(let s=e.offset-1;!n&&s>=0;s--){let i=_t.get(r.childNodes[s]);i instanceof Vt&&(n=i.domAtPos(i.length))}return n?new Tr(n.node,n.offset,!0):e}nearest(e){for(let r=e;r;){let n=_t.get(r);if(n&&n.rootView==this)return n;r=r.parentNode}return null}posFromDOM(e,r){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,r)+n.posAtStart}domAtPos(e){let{i:r,off:n}=this.childCursor().findPos(e,-1);for(;r<this.children.length-1;){let s=this.children[r];if(n<s.length||s instanceof Vt)break;r++,n=0}return this.children[r].domAtPos(n)}coordsAt(e,r){let n=null,s=0;for(let i=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=i-a.breakAfter,c=l-a.length;if(l<e)break;if(c<=e&&(c<e||a.covers(-1))&&(l>e||a.covers(1))&&(!n||a instanceof Vt&&!(n instanceof Vt&&r>=0)))n=a,s=c;else if(n&&c==e&&l==e&&a instanceof gi&&Math.abs(r)<2){if(a.deco.startSide<0)break;o&&(n=null)}i=c}return n?n.coordsAt(e-s,r):null}coordsForChar(e){let{i:r,off:n}=this.childPos(e,1),s=this.children[r];if(!(s instanceof Vt))return null;for(;s.children.length;){let{i:a,off:l}=s.childPos(n,1);for(;;a++){if(a==s.children.length)return null;if((s=s.children[a]).length)break}n=l}if(!(s instanceof ts))return null;let i=mr(s.text,n);if(i==n)return null;let o=wa(s.dom,n,i).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let r=[],{from:n,to:s}=e,i=this.view.contentDOM.clientWidth,o=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==At.LTR;for(let c=0,u=0;u<this.children.length;u++){let d=this.children[u],h=c+d.length;if(h>s)break;if(c>=n){let f=d.dom.getBoundingClientRect();if(r.push(f.height),o){let v=d.dom.lastChild,m=v?Ad(v):[];if(m.length){let p=m[m.length-1],g=l?p.right-f.left:f.right-p.left;g>a&&(a=g,this.minWidth=i,this.minWidthFrom=c,this.minWidthTo=h)}}}c=h+d.breakAfter}return r}textDirectionAt(e){let{i:r}=this.childPos(e,1);return getComputedStyle(this.children[r].dom).direction=="rtl"?At.RTL:At.LTR}measureTextSize(){for(let i of this.children)if(i instanceof Vt){let o=i.measureTextSize();if(o)return o}let e=document.createElement("div"),r,n,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let i=Ad(e.firstChild)[0];r=e.getBoundingClientRect().height,n=i?i.width/27:7,s=i?i.height:r,e.remove()}),{lineHeight:r,charWidth:n,textHeight:s}}childCursor(e=this.length){let r=this.children.length;return r&&(e-=this.children[--r].length),new H3(this.children,e,r)}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let n=0,s=0;;s++){let i=s==r.viewports.length?null:r.viewports[s],o=i?i.from-1:this.length;if(o>n){let a=(r.lineBlockAt(o).bottom-r.lineBlockAt(n).top)/this.view.scaleY;e.push(rt.replace({widget:new Vb(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!i)break;n=i.to+1}return rt.set(e)}updateDeco(){let e=1,r=this.view.state.facet(Rd).map(i=>(this.dynamicDecorationMap[e++]=typeof i=="function")?i(this.view):i),n=!1,s=this.view.state.facet(f5).map((i,o)=>{let a=typeof i=="function";return a&&(n=!0),a?i(this.view):i});for(s.length&&(this.dynamicDecorationMap[e++]=n,r.push(ut.join(s))),this.decorations=[this.editContextFormatting,...r,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(u5))try{if(c(this.view,e.range,e))return!0}catch(u){hn(this.view.state,u,"scroll handler")}let{range:r}=e,n=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),s;if(!n)return;!r.empty&&(s=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let i=ZS(this.view),o={left:n.left-i.left,top:n.top-i.top,right:n.right+i.right,bottom:n.bottom+i.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;Npe(this.view.scrollDOM,o,r.head<r.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==At.LTR)}}function sme(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function g5(t,e){let r=t.observer.selectionRange;if(!r.focusNode)return null;let n=$3(r.focusNode,r.focusOffset),s=U3(r.focusNode,r.focusOffset),i=n||s;if(s&&n&&s.node!=n.node){let a=_t.get(s.node);if(!a||a instanceof ts&&a.text!=s.node.nodeValue)i=s;else if(t.docView.lastCompositionAfterCursor){let l=_t.get(n.node);!l||l instanceof ts&&l.text!=n.node.nodeValue||(i=s)}}if(t.docView.lastCompositionAfterCursor=i!=n,!i)return null;let o=e-i.offset;return{from:o,to:o+i.node.nodeValue.length,node:i.node}}function ime(t,e,r){let n=g5(t,r);if(!n)return null;let{node:s,from:i,to:o}=n,a=s.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(n.from,n.to)!=a)return null;let l=e.invertedDesc,c=new Ln(l.mapPos(i),l.mapPos(o),i,o),u=[];for(let d=s.parentNode;;d=d.parentNode){let h=_t.get(d);if(h instanceof ki)u.push({node:d,deco:h.mark});else{if(h instanceof Vt||d.nodeName=="DIV"&&d.parentNode==t.contentDOM)return{range:c,text:s,marks:u,line:d};if(d!=t.contentDOM)u.push({node:d,deco:new oh({inclusive:!0,attributes:Wpe(d),tagName:d.tagName.toLowerCase()})});else return null}}}function ome(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let ame=class{constructor(){this.changes=[]}compareRange(e,r){Yf(e,r,this.changes)}comparePoint(e,r){Yf(e,r,this.changes)}boundChange(e){Yf(e,e,this.changes)}};function lme(t,e,r){let n=new ame;return ut.compare(t,e,r,n),n.changes}function cme(t,e){for(let r=t;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function ume(t,e){let r=!1;return e&&t.iterChangedRanges((n,s)=>{n<e.to&&s>e.from&&(r=!0)}),r}function dme(t,e,r=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),i=e-s.from;if(s.length==0)return xe.cursor(e);i==0?r=1:i==s.length&&(r=-1);let o=i,a=i;r<0?o=mr(s.text,i,!1):a=mr(s.text,i);let l=n(s.text.slice(o,a));for(;o>0;){let c=mr(s.text,o,!1);if(n(s.text.slice(c,o))!=l)break;o=c}for(;a<s.length;){let c=mr(s.text,a);if(n(s.text.slice(a,c))!=l)break;a=c}return xe.range(o+s.from,a+s.from)}function hme(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function fme(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Gy(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function sR(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function iR(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function qb(t,e,r){let n,s,i,o,a=!1,l,c,u,d;for(let v=t.firstChild;v;v=v.nextSibling){let m=Ad(v);for(let p=0;p<m.length;p++){let g=m[p];s&&Gy(s,g)&&(g=sR(iR(g,s.bottom),s.top));let y=hme(e,g),_=fme(r,g);if(y==0&&_==0)return v.nodeType==3?oR(v,e,r):qb(v,e,r);if(!n||o>_||o==_&&i>y){n=v,s=g,i=y,o=_;let b=_?r<g.top?-1:1:y?e<g.left?-1:1:0;a=!b||(b>0?p<m.length-1:p>0)}y==0?r>g.bottom&&(!u||u.bottom<g.bottom)?(l=v,u=g):r<g.top&&(!d||d.top>g.top)&&(c=v,d=g):u&&Gy(u,g)?u=iR(u,g.bottom):d&&Gy(d,g)&&(d=sR(d,g.top))}}if(u&&u.bottom>=r?(n=l,s=u):d&&d.top<=r&&(n=c,s=d),!n)return{node:t,offset:0};let h=Math.max(s.left,Math.min(s.right,e));if(n.nodeType==3)return oR(n,h,r);if(a&&n.contentEditable!="false")return qb(n,h,r);let f=Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0);return{node:t,offset:f}}function oR(t,e,r){let n=t.nodeValue.length,s=-1,i=1e9,o=0;for(let a=0;a<n;a++){let l=wa(t,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let d=(u.top>r?u.top-r:r-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&d<i){let h=e>=(u.left+u.right)/2,f=h;if((Le.chrome||Le.gecko)&&wa(t,a).getBoundingClientRect().left==u.right&&(f=!h),d<=0)return{node:t,offset:a+(f?1:0)};s=a+(f?1:0),i=d}}}return{node:t,offset:s>-1?s:o>0?t.nodeValue.length:0}}function v5(t,e,r,n=-1){var s,i;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:c}=t.viewState,{x:u,y:d}=e,h=d-a;if(h<0)return 0;if(h>c)return t.state.doc.length;for(let b=t.viewState.heightOracle.textHeight/2,w=!1;l=t.elementAtHeight(h),l.type!=jr.Text;)for(;h=n>0?l.bottom+b:l.top-b,!(h>=0&&h<=c);){if(w)return r?null:0;w=!0,n=-n}d=a+h;let f=l.from;if(f<t.viewport.from)return t.viewport.from==0?0:r?null:aR(t,o,l,u,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:r?null:aR(t,o,l,u,d);let v=t.dom.ownerDocument,m=t.root.elementFromPoint?t.root:v,p=m.elementFromPoint(u,d);p&&!t.contentDOM.contains(p)&&(p=null),p||(u=Math.max(o.left+1,Math.min(o.right-1,u)),p=m.elementFromPoint(u,d),p&&!t.contentDOM.contains(p)&&(p=null));let g,y=-1;if(p&&((s=t.docView.nearest(p))===null||s===void 0?void 0:s.isEditable)!=!1){if(v.caretPositionFromPoint){let b=v.caretPositionFromPoint(u,d);b&&({offsetNode:g,offset:y}=b)}else if(v.caretRangeFromPoint){let b=v.caretRangeFromPoint(u,d);b&&({startContainer:g,startOffset:y}=b,(!t.contentDOM.contains(g)||Le.safari&&pme(g,y,u)||Le.chrome&&mme(g,y,u))&&(g=void 0))}g&&(y=Math.min($s(g),y))}if(!g||!t.docView.dom.contains(g)){let b=Vt.find(t.docView,f);if(!b)return h>l.top+l.height/2?l.to:l.from;({node:g,offset:y}=qb(b.dom,u,d))}let _=t.docView.nearest(g);if(!_)return null;if(_.isWidget&&((i=_.dom)===null||i===void 0?void 0:i.nodeType)==1){let b=_.dom.getBoundingClientRect();return e.y<b.top||e.y<=b.bottom&&e.x<=(b.left+b.right)/2?_.posAtStart:_.posAtEnd}else return _.localPosFromDOM(g,y)+_.posAtStart}function aR(t,e,r,n,s){let i=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&r.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((s-r.top-(t.defaultLineHeight-a)*.5)/a);i+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(r.from,r.to);return r.from+Ppe(o,i,t.state.tabSize)}function pme(t,e,r){let n;if(t.nodeType!=3||e!=(n=t.nodeValue.length))return!1;for(let s=t.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return wa(t,n-1,n).getBoundingClientRect().left>r}function mme(t,e,r){if(e!=0)return!1;for(let s=t;;){let i=s.parentNode;if(!i||i.nodeType!=1||i.firstChild!=s)return!1;if(i.classList.contains("cm-line"))break;s=i}let n=t.nodeType==1?t.getBoundingClientRect():wa(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return r-n.left>5}function Jb(t,e){let r=t.lineBlockAt(e);if(Array.isArray(r.type)){for(let n of r.type)if(n.to>e||n.to==e&&(n.to==r.to||n.type==jr.Text))return n}return r}function gme(t,e,r,n){let s=Jb(t,e.head),i=!n||s.type!=jr.Text||!(t.lineWrapping||s.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(i){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(s.from),l=t.posAtCoords({x:r==(a==At.LTR)?o.right-1:o.left+1,y:(i.top+i.bottom)/2});if(l!=null)return xe.cursor(l,r?-1:1)}return xe.cursor(r?s.to:s.from,r?-1:1)}function lR(t,e,r,n){let s=t.state.doc.lineAt(e.head),i=t.bidiSpans(s),o=t.textDirectionAt(s.from);for(let a=e,l=null;;){let c=tme(s,i,o,a,r),u=t5;if(!c){if(s.number==(r?t.state.doc.lines:1))return a;u=`
`,s=t.state.doc.line(s.number+(r?1:-1)),i=t.bidiSpans(s),c=t.visualLineSide(s,!r)}if(l){if(!l(u))return a}else{if(!n)return c;l=n(u)}a=c}}function vme(t,e,r){let n=t.state.charCategorizer(e),s=n(r);return i=>{let o=n(i);return s==zt.Space&&(s=o),s==o}}function yme(t,e,r,n){let s=e.head,i=r?1:-1;if(s==(r?t.state.doc.length:0))return xe.cursor(s,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(s,e.assoc||-1),u=t.documentTop;if(c)o==null&&(o=c.left-l.left),a=i<0?c.top:c.bottom;else{let f=t.viewState.lineBlockAt(s);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(s-f.from))),a=(i<0?f.top:f.bottom)+u}let d=l.left+o,h=n??t.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let v=a+(h+f)*i,m=v5(t,{x:d,y:v},!1,i);if(v<l.top||v>l.bottom||(i<0?m<s:m>s)){let p=t.docView.coordsForChar(m),g=!p||v<p.top?-1:1;return xe.cursor(m,g,void 0,o)}}}function Zf(t,e,r){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,(i,o,a)=>{if(e>i&&e<o){let l=n||r||(e-i<o-e?-1:1);e=l<0?i:o,n=l}});if(!n)return e}}function zy(t,e,r){let n=Zf(t.state.facet(YS).map(s=>s(t)),r.from,e.head>r.from?-1:1);return n==r.from?r:xe.cursor(n,n<r.from?1:-1)}const Kc="￿";class _me{constructor(e,r){this.points=e,this.text="",this.lineSeparator=r.facet(ot.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Kc}readRange(e,r){if(!e)return this;let n=e.parentNode;for(let s=e;;){this.findPointBefore(n,s);let i=this.text.length;this.readNode(s);let o=s.nextSibling;if(o==r)break;let a=_t.get(s),l=_t.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:Em(s))||Em(o)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>i)&&this.lineBreak(),s=o}return this.findPointBefore(n,r),this}readTextNode(e){let r=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,r.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let i=-1,o=1,a;if(this.lineSeparator?(i=r.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(a=s.exec(r))&&(i=a.index,o=a[0].length),this.append(r.slice(n,i<0?r.length:i)),i<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);n=i+o}}readNode(e){if(e.cmIgnore)return;let r=_t.get(e),n=r&&r.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==r&&(n.pos=this.text.length)}findPointInside(e,r){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(bme(e,n.node,n.offset)?r:0))}}function bme(t,e,r){for(;;){if(!e||r<$s(e))return!1;if(e==t)return!0;r=ba(e)+1,e=e.parentNode}}class cR{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}}class wme{constructor(e,r,n,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=r>-1;let{impreciseHead:i,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=e.docView.domBoundsAround(r,n,0))){let a=i||o?[]:Eme(e),l=new _me(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=Cme(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=i&&i.node==a.focusNode&&i.offset==a.focusOffset||!Bb(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),c=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Bb(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),u=e.viewport;if((Le.ios||Le.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let d=Math.min(l,c),h=Math.max(l,c),f=u.from-d,v=u.to-h;(f==0||f==1||d==0)&&(v==0||v==-1||h==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=xe.single(c,l)}}}function y5(t,e){let r,{newSel:n}=e,s=t.state.selection.main,i=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=s.from,c=null;(i===8||Le.android&&e.text.length<a-o)&&(l=s.to,c="end");let u=Sme(t.state.doc.sliceString(o,a,Kc),e.text,l-o,c);u&&(Le.chrome&&i==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==Kc+Kc&&u.toB--,r={from:o+u.from,to:o+u.toA,insert:ht.of(e.text.slice(u.from,u.toB).split(Kc))})}else n&&(!t.hasFocus&&t.state.facet(ci)||n.main.eq(s))&&(n=null);if(!r&&!n)return!1;if(!r&&e.typeOver&&!s.empty&&n&&n.main.empty?r={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(Le.mac||Le.android)&&r&&r.from==r.to&&r.from==s.head-1&&/^\. ?$/.test(r.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(n&&r.insert.length==2&&(n=xe.single(n.main.anchor-1,n.main.head-1)),r={from:r.from,to:r.to,insert:ht.of([r.insert.toString().replace("."," ")])}):r&&r.from>=s.from&&r.to<=s.to&&(r.from!=s.from||r.to!=s.to)&&s.to-s.from-(r.to-r.from)<=4?r={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,s.to))}:Le.chrome&&r&&r.from==r.to&&r.from==s.head&&r.insert.toString()==`
 `&&t.lineWrapping&&(n&&(n=xe.single(n.main.anchor-1,n.main.head-1)),r={from:s.from,to:s.to,insert:ht.of([" "])}),r)return XS(t,r,n,i);if(n&&!n.main.eq(s)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:o,userEvent:a}),!0}else return!1}function XS(t,e,r,n=-1){if(Le.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(Le.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&t.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&bl(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&bl(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&bl(t.contentDOM,"Delete",46)))return!0;let i=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=xme(t,e,r));return t.state.facet(o5).some(l=>l(t,e.from,e.to,i,a))||t.dispatch(a()),!0}function xme(t,e,r){let n,s=t.state,i=s.selection.main;if(e.from>=i.from&&e.to<=i.to&&e.to-e.from>=(i.to-i.from)/3&&(!r||r.main.empty&&r.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=i.from<e.from?s.sliceDoc(i.from,e.from):"",l=i.to>e.to?s.sliceDoc(e.to,i.to):"";n=s.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=s.changes(e),l=r&&r.main.to<=a.newLength?r.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=i.to&&e.to>=i.to-10){let c=t.state.sliceDoc(e.from,e.to),u,d=r&&g5(t,r.main.head);if(d){let v=e.insert.length-(e.to-e.from);u={from:d.from,to:d.to-v}}else u=t.state.doc.lineAt(i.head);let h=i.to-e.to,f=i.to-i.from;n=s.changeByRange(v=>{if(v.from==i.from&&v.to==i.to)return{changes:a,range:l||v.map(a)};let m=v.to-h,p=m-c.length;if(v.to-v.from!=f||t.state.sliceDoc(p,m)!=c||v.to>=u.from&&v.from<=u.to)return{range:v};let g=s.changes({from:p,to:m,insert:e.insert}),y=v.to-i.to;return{changes:g,range:l?xe.range(Math.max(0,l.anchor+y),Math.max(0,l.head+y)):v.map(g)}})}else n={changes:a,selection:l&&s.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:o,scrollIntoView:!0})}function Sme(t,e,r,n){let s=Math.min(t.length,e.length),i=0;for(;i<s&&t.charCodeAt(i)==e.charCodeAt(i);)i++;if(i==s&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(n=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&t.length<e.length){let l=r<=i&&r>=o?i-r:0;i-=l,a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,o=i+(o-a),a=i}return{from:i,toA:o,toB:a}}function Eme(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:i}=t.observer.selectionRange;return r&&(e.push(new cR(r,n)),(s!=r||i!=n)&&e.push(new cR(s,i))),e}function Cme(t,e){if(t.length==0)return null;let r=t[0].pos,n=t.length==2?t[1].pos:r;return r>-1&&n>-1?xe.single(r+e,n+e):null}class kme{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Le.safari&&e.contentDOM.addEventListener("input",()=>null),Le.gecko&&Hme(e.contentDOM.ownerDocument)}handleEvent(e){!Mme(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,r){let n=this.handlers[e];if(n){for(let s of n.observers)s(this.view,r);for(let s of n.handlers){if(r.defaultPrevented)break;if(s(this.view,r)){r.preventDefault();break}}}}ensureHandlers(e){let r=Tme(e),n=this.handlers,s=this.view.contentDOM;for(let i in r)if(i!="scroll"){let o=!r[i].handlers.length,a=n[i];a&&o!=!a.handlers.length&&(s.removeEventListener(i,this.handleEvent),a=null),a||s.addEventListener(i,this.handleEvent,{passive:o})}for(let i in n)i!="scroll"&&!r[i]&&s.removeEventListener(i,this.handleEvent);this.handlers=r}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&b5.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Le.android&&Le.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let r;return Le.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((r=_5.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||Ame.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=r||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let r=this.pendingIOSKey;return!r||r.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,bl(this.view.contentDOM,r.key,r.keyCode,r instanceof KeyboardEvent?r:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Le.safari&&!Le.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function uR(t,e){return(r,n)=>{try{return e.call(t,n,r)}catch(s){hn(r.state,s)}}}function Tme(t){let e=Object.create(null);function r(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of t){let s=n.spec;if(s&&s.domEventHandlers)for(let i in s.domEventHandlers){let o=s.domEventHandlers[i];o&&r(i).handlers.push(uR(n.value,o))}if(s&&s.domEventObservers)for(let i in s.domEventObservers){let o=s.domEventObservers[i];o&&r(i).observers.push(uR(n.value,o))}}for(let n in rs)r(n).handlers.push(rs[n]);for(let n in jn)r(n).observers.push(jn[n]);return e}const _5=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ame="dthko",b5=[16,17,18,20,91,92,224,225],lf=6;function cf(t){return Math.max(0,t)*.7+8}function Rme(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class Pme{constructor(e,r,n,s){this.view=e,this.startEvent=r,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParents=Bpe(e.contentDOM),this.atoms=e.state.facet(YS).map(o=>o(e));let i=e.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this)),i.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(ot.allowMultipleSelections)&&Ime(e,r),this.dragging=Dme(e,r)&&S5(r)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Rme(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,n=0,s=0,i=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:i,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=ZS(this.view);e.clientX-l.left<=s+lf?r=-cf(s-e.clientX):e.clientX+l.right>=o-lf&&(r=cf(e.clientX-o)),e.clientY-l.top<=i+lf?n=-cf(i-e.clientY):e.clientY+l.bottom>=a-lf&&(n=cf(e.clientY-a)),this.setScrollSpeed(r,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:r}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),r&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=r,r=0),(e||r)&&this.view.win.scrollBy(e,r),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let r=null;for(let n=0;n<e.ranges.length;n++){let s=e.ranges[n],i=null;if(s.empty){let o=Zf(this.atoms,s.from,0);o!=s.from&&(i=xe.cursor(o,-1))}else{let o=Zf(this.atoms,s.from,-1),a=Zf(this.atoms,s.to,1);(o!=s.from||a!=s.to)&&(i=xe.range(s.from==s.anchor?o:a,s.from==s.head?o:a))}i&&(r||(r=e.ranges.slice()),r[n]=i)}return r?xe.create(r,e.mainIndex):e}select(e){let{view:r}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(r.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(r=>r.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Ime(t,e){let r=t.state.facet(r5);return r.length?r[0](e):Le.mac?e.metaKey:e.ctrlKey}function Ome(t,e){let r=t.state.facet(n5);return r.length?r[0](e):Le.mac?!e.altKey:!e.ctrlKey}function Dme(t,e){let{main:r}=t.state.selection;if(r.empty)return!1;let n=Td(t.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let i=0;i<s.length;i++){let o=s[i];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Mme(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,n;r!=t.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(n=_t.get(r))&&n.ignoreEvent(e))return!1;return!0}const rs=Object.create(null),jn=Object.create(null),w5=Le.ie&&Le.ie_version<15||Le.ios&&Le.webkit_version<604;function Lme(t){let e=t.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.remove(),x5(t,r.value)},50)}function Wg(t,e,r){for(let n of t.facet(e))r=n(r,t);return r}function x5(t,e){e=Wg(t.state,qS,e);let{state:r}=t,n,s=1,i=r.toText(e),o=i.lines==r.selection.ranges.length;if(Yb!=null&&r.selection.ranges.every(l=>l.empty)&&Yb==i.toString()){let l=-1;n=r.changeByRange(c=>{let u=r.doc.lineAt(c.from);if(u.from==l)return{range:c};l=u.from;let d=r.toText((o?i.line(s++).text:e)+r.lineBreak);return{changes:{from:u.from,insert:d},range:xe.cursor(c.from+d.length)}})}else o?n=r.changeByRange(l=>{let c=i.line(s++);return{changes:{from:l.from,to:l.to,insert:c.text},range:xe.cursor(l.from+c.length)}}):n=r.replaceSelection(i);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}jn.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};rs.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);jn.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};jn.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};rs.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let r=null;for(let n of t.state.facet(s5))if(r=n(t,e),r)break;if(!r&&e.button==0&&(r=Fme(t,e)),r){let n=!t.hasFocus;t.inputState.startMouseSelection(new Pme(t,e,r,n)),n&&t.observer.ignore(()=>{B3(t.contentDOM);let i=t.root.activeElement;i&&!i.contains(t.contentDOM)&&i.blur()});let s=t.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function dR(t,e,r,n){if(n==1)return xe.cursor(e,r);if(n==2)return dme(t.state,e,r);{let s=Vt.find(t.docView,e),i=t.state.doc.lineAt(s?s.posAtEnd:e),o=s?s.posAtStart:i.from,a=s?s.posAtEnd:i.to;return a<t.state.doc.length&&a==i.to&&a++,xe.range(o,a)}}let hR=(t,e,r)=>e>=r.top&&e<=r.bottom&&t>=r.left&&t<=r.right;function Nme(t,e,r,n){let s=Vt.find(t.docView,e);if(!s)return 1;let i=e-s.posAtStart;if(i==0)return 1;if(i==s.length)return-1;let o=s.coordsAt(i,-1);if(o&&hR(r,n,o))return-1;let a=s.coordsAt(i,1);return a&&hR(r,n,a)?1:o&&o.bottom>=n?-1:1}function fR(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:r,bias:Nme(t,r,e.clientX,e.clientY)}}const Bme=Le.ie&&Le.ie_version<=11;let pR=null,mR=0,gR=0;function S5(t){if(!Bme)return t.detail;let e=pR,r=gR;return pR=t,gR=Date.now(),mR=!e||r>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(mR+1)%3:1}function Fme(t,e){let r=fR(t,e),n=S5(e),s=t.state.selection;return{update(i){i.docChanged&&(r.pos=i.changes.mapPos(r.pos),s=s.map(i.changes))},get(i,o,a){let l=fR(t,i),c,u=dR(t,l.pos,l.bias,n);if(r.pos!=l.pos&&!o){let d=dR(t,r.pos,r.bias,n),h=Math.min(d.from,u.from),f=Math.max(d.to,u.to);u=h<u.from?xe.range(h,f):xe.range(f,h)}return o?s.replaceRange(s.main.extend(u.from,u.to)):a&&n==1&&s.ranges.length>1&&(c=jme(s,l.pos))?c:a?s.addRange(u):xe.create([u])}}}function jme(t,e){for(let r=0;r<t.ranges.length;r++){let{from:n,to:s}=t.ranges[r];if(n<=e&&s>=e)return xe.create(t.ranges.slice(0,r).concat(t.ranges.slice(r+1)),t.mainIndex==r?0:t.mainIndex-(t.mainIndex>r?1:0))}return null}rs.dragstart=(t,e)=>{let{selection:{main:r}}=t.state;if(e.target.draggable){let s=t.docView.nearest(e.target);if(s&&s.isWidget){let i=s.posAtStart,o=i+s.length;(i>=r.to||o<=r.from)&&(r=xe.range(i,o))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,e.dataTransfer&&(e.dataTransfer.setData("Text",Wg(t.state,JS,t.state.sliceDoc(r.from,r.to))),e.dataTransfer.effectAllowed="copyMove"),!1};rs.dragend=t=>(t.inputState.draggedContent=null,!1);function vR(t,e,r,n){if(r=Wg(t.state,qS,r),!r)return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:i}=t.inputState,o=n&&i&&Ome(t,e)?{from:i.from,to:i.to}:null,a={from:s,insert:r},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}rs.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let r=e.dataTransfer.files;if(r&&r.length){let n=Array(r.length),s=0,i=()=>{++s==r.length&&vR(t,e,n.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<r.length;o++){let a=new FileReader;a.onerror=i,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(n[o]=a.result),i()},a.readAsText(r[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return vR(t,e,n,!0),!0}return!1};rs.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let r=w5?null:e.clipboardData;return r?(x5(t,r.getData("text/plain")||r.getData("text/uri-list")),!0):(Lme(t),!1)};function $me(t,e){let r=t.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),t.focus()},50)}function Ume(t){let e=[],r=[],n=!1;for(let s of t.selection.ranges)s.empty||(e.push(t.sliceDoc(s.from,s.to)),r.push(s));if(!e.length){let s=-1;for(let{from:i}of t.selection.ranges){let o=t.doc.lineAt(i);o.number>s&&(e.push(o.text),r.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:Wg(t,JS,e.join(t.lineBreak)),ranges:r,linewise:n}}let Yb=null;rs.copy=rs.cut=(t,e)=>{let{text:r,ranges:n,linewise:s}=Ume(t.state);if(!r&&!s)return!1;Yb=s?r:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let i=w5?null:e.clipboardData;return i?(i.clearData(),i.setData("text/plain",r),!0):($me(t,r),!1)};const E5=Ai.define();function C5(t,e){let r=[];for(let n of t.facet(a5)){let s=n(t,e);s&&r.push(s)}return r?t.update({effects:r,annotations:E5.of(!0)}):null}function k5(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let r=C5(t.state,e);r?t.dispatch(r):t.update([])}},10)}jn.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),k5(t)};jn.blur=t=>{t.observer.clearSelectionRange(),k5(t)};jn.compositionstart=jn.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};jn.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Le.chrome&&Le.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};jn.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};rs.beforeinput=(t,e)=>{var r,n;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let i=(r=e.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain"),o=e.getTargetRanges();if(i&&o.length){let a=o[0],l=t.posAtDOM(a.startContainer,a.startOffset),c=t.posAtDOM(a.endContainer,a.endOffset);return XS(t,{from:l,to:c,insert:t.state.toText(i)},null),!0}}let s;if(Le.chrome&&Le.android&&(s=_5.find(i=>i.inputType==e.inputType))&&(t.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let i=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>i+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return Le.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),Le.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>jn.compositionend(t,e),20),!1};const yR=new Set;function Hme(t){yR.has(t)||(yR.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const _R=["pre-wrap","normal","pre-line","break-spaces"];let ql=!1;function bR(){ql=!1}class Vme{constructor(e){this.lineWrapping=e,this.doc=ht.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,r){let n=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((r-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return _R.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let n=0;n<e.length;n++){let s=e[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(r=!0,this.heightSamples[Math.floor(s*10)]=!0)}return r}refresh(e,r,n,s,i,o){let a=_R.indexOf(e)>-1,l=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=r,this.charWidth=n,this.textHeight=s,this.lineLength=i,l){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class Gme{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}}class Cs{constructor(e,r,n,s,i){this.from=e,this.length=r,this.top=n,this.height=s,this._content=i}get type(){return typeof this._content=="number"?jr.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof vo?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let r=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Cs(this.from,this.length+e.length,this.top,this.height+e.height,r)}}var Ct=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Ct||(Ct={}));const Xf=.001;class $r{constructor(e,r,n=2){this.length=e,this.height=r,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Xf&&(ql=!0),this.height=e)}replace(e,r,n){return $r.of(n)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,n,s){let i=this,o=n.doc;for(let a=s.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:u,toB:d}=s[a],h=i.lineAt(l,Ct.ByPosNoHeight,n.setDoc(r),0,0),f=h.to>=c?h:i.lineAt(c,Ct.ByPosNoHeight,n,0,0);for(d+=f.to-c,c=f.to;a>0&&h.from<=s[a-1].toA;)l=s[a-1].fromA,u=s[a-1].fromB,a--,l<h.from&&(h=i.lineAt(l,Ct.ByPosNoHeight,n,0,0));u+=h.from-l,l=h.from;let v=QS.build(n.setDoc(o),e,u,d);i=Tm(i,i.replace(l,c,v))}return i.updateHeight(n,0)}static empty(){return new on(0,0)}static of(e){if(e.length==1)return e[0];let r=0,n=e.length,s=0,i=0;for(;;)if(r==n)if(s>i*2){let a=e[r-1];a.break?e.splice(--r,1,a.left,null,a.right):e.splice(--r,1,a.left,a.right),n+=1+a.break,s-=a.size}else if(i>s*2){let a=e[n];a.break?e.splice(n,1,a.left,null,a.right):e.splice(n,1,a.left,a.right),n+=2+a.break,i-=a.size}else break;else if(s<i){let a=e[r++];a&&(s+=a.size)}else{let a=e[--n];a&&(i+=a.size)}let o=0;return e[r-1]==null?(o=1,r--):e[r]==null&&(o=1,n++),new zme($r.of(e.slice(0,r)),o,$r.of(e.slice(n)))}}function Tm(t,e){return t==e?t:(t.constructor!=e.constructor&&(ql=!0),e)}$r.prototype.size=1;class T5 extends $r{constructor(e,r,n){super(e,r),this.deco=n}blockAt(e,r,n,s){return new Cs(s,this.length,n,this.height,this.deco||0)}lineAt(e,r,n,s,i){return this.blockAt(0,n,s,i)}forEachLine(e,r,n,s,i,o){e<=i+this.length&&r>=i&&o(this.blockAt(0,n,s,i))}updateHeight(e,r=0,n=!1,s){return s&&s.from<=r&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class on extends T5{constructor(e,r){super(e,r,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,r,n,s){return new Cs(s,this.length,n,this.height,this.breaks)}replace(e,r,n){let s=n[0];return n.length==1&&(s instanceof on||s instanceof dr&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof dr?s=new on(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):$r.of(n)}updateHeight(e,r=0,n=!1,s){return s&&s.from<=r&&s.more?this.setHeight(s.heights[s.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class dr extends $r{constructor(e){super(e,0)}heightMetrics(e,r){let n=e.doc.lineAt(r).number,s=e.doc.lineAt(r+this.length).number,i=s-n+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*i);o=l/i,this.length>i+1&&(a=(this.height-l)/(this.length-i-1))}else o=this.height/i;return{firstLine:n,lastLine:s,perLine:o,perChar:a}}blockAt(e,r,n,s){let{firstLine:i,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(r,s);if(r.lineWrapping){let c=s+(e<r.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),u=r.doc.lineAt(c),d=a+u.length*l,h=Math.max(n,e-d/2);return new Cs(u.from,u.length,h,d,0)}else{let c=Math.max(0,Math.min(o-i,Math.floor((e-n)/a))),{from:u,length:d}=r.doc.line(i+c);return new Cs(u,d,n+a*c,a,0)}}lineAt(e,r,n,s,i){if(r==Ct.ByHeight)return this.blockAt(e,n,s,i);if(r==Ct.ByPosNoHeight){let{from:f,to:v}=n.doc.lineAt(e);return new Cs(f,v-f,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,i),c=n.doc.lineAt(e),u=a+c.length*l,d=c.number-o,h=s+a*d+l*(c.from-i-d);return new Cs(c.from,c.length,Math.max(s,Math.min(h,s+this.height-u)),u,0)}forEachLine(e,r,n,s,i,o){e=Math.max(e,i),r=Math.min(r,i+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(n,i);for(let u=e,d=s;u<=r;){let h=n.doc.lineAt(u);if(u==e){let v=h.number-a;d+=l*v+c*(e-i-v)}let f=l+c*h.length;o(new Cs(h.from,h.length,d,f,0)),d+=f,u=h.to+1}}replace(e,r,n){let s=this.length-r;if(s>0){let i=n[n.length-1];i instanceof dr?n[n.length-1]=new dr(i.length+s):n.push(null,new dr(s-1))}if(e>0){let i=n[0];i instanceof dr?n[0]=new dr(e+i.length):n.unshift(new dr(e-1),null)}return $r.of(n)}decomposeLeft(e,r){r.push(new dr(e-1),null)}decomposeRight(e,r){r.push(null,new dr(this.length-e-1))}updateHeight(e,r=0,n=!1,s){let i=r+this.length;if(s&&s.from<=r+this.length&&s.more){let o=[],a=Math.max(r,s.from),l=-1;for(s.from>r&&o.push(new dr(s.from-r-1).updateHeight(e,r));a<=i&&s.more;){let u=e.doc.lineAt(a).length;o.length&&o.push(null);let d=s.heights[s.index++];l==-1?l=d:Math.abs(d-l)>=Xf&&(l=-2);let h=new on(u,d);h.outdated=!1,o.push(h),a+=u+1}a<=i&&o.push(null,new dr(i-a).updateHeight(e,a));let c=$r.of(o);return(l<0||Math.abs(c.height-this.height)>=Xf||Math.abs(l-this.heightMetrics(e,r).perLine)>=Xf)&&(ql=!0),Tm(this,c)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class zme extends $r{constructor(e,r,n){super(e.length+r+n.length,e.height+n.height,r|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,r,n,s){let i=n+this.left.height;return e<i?this.left.blockAt(e,r,n,s):this.right.blockAt(e,r,i,s+this.left.length+this.break)}lineAt(e,r,n,s,i){let o=s+this.left.height,a=i+this.left.length+this.break,l=r==Ct.ByHeight?e<o:e<a,c=l?this.left.lineAt(e,r,n,s,i):this.right.lineAt(e,r,n,o,a);if(this.break||(l?c.to<a:c.from>a))return c;let u=r==Ct.ByPosNoHeight?Ct.ByPosNoHeight:Ct.ByPos;return l?c.join(this.right.lineAt(a,u,n,o,a)):this.left.lineAt(a,u,n,s,i).join(c)}forEachLine(e,r,n,s,i,o){let a=s+this.left.height,l=i+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,r,n,s,i,o),r>=l&&this.right.forEachLine(e,r,n,a,l,o);else{let c=this.lineAt(l,Ct.ByPos,n,s,i);e<c.from&&this.left.forEachLine(e,c.from-1,n,s,i,o),c.to>=e&&c.from<=r&&o(c),r>c.to&&this.right.forEachLine(c.to+1,r,n,a,l,o)}}replace(e,r,n){let s=this.left.length+this.break;if(r<s)return this.balanced(this.left.replace(e,r,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,r-s,n));let i=[];e>0&&this.decomposeLeft(e,i);let o=i.length;for(let a of n)i.push(a);if(e>0&&wR(i,o-1),r<this.length){let a=i.length;this.decomposeRight(r,i),wR(i,a)}return $r.of(i)}decomposeLeft(e,r){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(n++,e>=n&&r.push(null)),e>n&&this.right.decomposeLeft(e-n,r)}decomposeRight(e,r){let n=this.left.length,s=n+this.break;if(e>=s)return this.right.decomposeRight(e-s,r);e<n&&this.left.decomposeRight(e,r),this.break&&e<s&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?$r.of(this.break?[e,null,r]:[e,r]):(this.left=Tm(this.left,e),this.right=Tm(this.right,r),this.setHeight(e.height+r.height),this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,n=!1,s){let{left:i,right:o}=this,a=r+i.length+this.break,l=null;return s&&s.from<=r+i.length&&s.more?l=i=i.updateHeight(e,r,n,s):i.updateHeight(e,r,n),s&&s.from<=a+o.length&&s.more?l=o=o.updateHeight(e,a,n,s):o.updateHeight(e,a,n),l?this.balanced(i,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function wR(t,e){let r,n;t[e]==null&&(r=t[e-1])instanceof dr&&(n=t[e+1])instanceof dr&&t.splice(e-1,3,new dr(r.length+1+n.length))}const Wme=5;class QS{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let n=Math.min(r,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof on?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new on(n-this.pos,-1)),this.writtenTo=n,r>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,n){if(e<r||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,i=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let o=r-e;n.block?this.addBlock(new T5(o,s,n)):(o||i||s>=Wme)&&this.addLineDeco(s,i,o)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new on(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,r){let n=new dr(r-e);return this.oracle.doc.lineAt(e).to==r&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof on)return e;let r=new on(0,-1);return this.nodes.push(r),r}addBlock(e){this.enterLine();let r=e.deco;r&&r.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r&&r.endSide>0&&(this.covering=e)}addLineDeco(e,r,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=r,this.writtenTo=this.pos=this.pos+n}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof on)&&!this.isCovered?this.nodes.push(new on(0,-1)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let s of this.nodes)s instanceof on&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(e,r,n,s){let i=new QS(n,e);return ut.spans(r,n,s,i,0),i.finish(n)}}function Kme(t,e,r){let n=new qme;return ut.compare(t,e,r,n,0),n.changes}class qme{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,n,s){(e<r||n&&n.heightRelevant||s&&s.heightRelevant)&&Yf(e,r,this.changes,5)}}function Jme(t,e){let r=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,i=Math.max(0,r.left),o=Math.min(s.innerWidth,r.right),a=Math.max(0,r.top),l=Math.min(s.innerHeight,r.bottom);for(let c=t.parentNode;c&&c!=n.body;)if(c.nodeType==1){let u=c,d=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&d.overflow!="visible"){let h=u.getBoundingClientRect();i=Math.max(i,h.left),o=Math.min(o,h.right),a=Math.max(a,h.top),l=Math.min(c==t.parentNode?s.innerHeight:l,h.bottom)}c=d.position=="absolute"||d.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:i-r.left,right:Math.max(i,o)-r.left,top:a-(r.top+e),bottom:Math.max(a,l)-(r.top+e)}}function Yme(t){let e=t.getBoundingClientRect(),r=t.ownerDocument.defaultView||window;return e.left<r.innerWidth&&e.right>0&&e.top<r.innerHeight&&e.bottom>0}function Zme(t,e){let r=t.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}class Wy{constructor(e,r,n,s){this.from=e,this.to=r,this.size=n,this.displaySize=s}static same(e,r){if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],i=r[n];if(s.from!=i.from||s.to!=i.to||s.size!=i.size)return!1}return!0}draw(e,r){return rt.replace({widget:new Xme(this.displaySize*(r?e.scaleY:e.scaleX),r)}).range(this.from,this.to)}}class Xme extends Pa{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class xR{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=SR,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=At.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(zg).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Vme(r),this.stateDeco=e.facet(Rd).filter(n=>typeof n!="function"),this.heightMap=$r.empty().applyChanges(this.stateDeco,ht.empty,this.heightOracle.setDoc(e.doc),[new Ln(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=rt.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let n=0;n<=1;n++){let s=n?r.head:r.anchor;if(!e.some(({from:i,to:o})=>s>=i&&s<=o)){let{from:i,to:o}=this.lineBlockAt(s);e.push(new uf(i,o))}}return this.viewports=e.sort((n,s)=>n.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?SR:new e1(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(qc(e,this.scaler))})}update(e,r=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Rd).filter(u=>typeof u!="function");let s=e.changedRanges,i=Ln.extendWithRanges(s,Kme(n,this.stateDeco,e?e.changes:qt.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);bR(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),i),(this.heightMap.height!=o||ql)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=i.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<l.from||r.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,r));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(c5)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,n=window.getComputedStyle(r),s=this.heightOracle,i=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?At.RTL:At.LTR;let o=this.heightOracle.mustRefreshForWrapping(i),a=r.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,u=0;if(a.width&&a.height){let{scaleX:b,scaleY:w}=N3(r,a);(b>.005&&Math.abs(this.scaleX-b)>.005||w>.005&&Math.abs(this.scaleY-w)>.005)&&(this.scaleX=b,this.scaleY=w,c|=16,o=l=!0)}let d=(parseInt(n.paddingTop)||0)*this.scaleY,h=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=h)&&(this.paddingTop=d,this.paddingBottom=h,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let f=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=j3(e.scrollDOM);let v=(this.printing?Zme:Jme)(r,this.paddingTop),m=v.top-this.pixelViewport.top,p=v.bottom-this.pixelViewport.bottom;this.pixelViewport=v;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(l=!0)),!this.inView&&!this.scrollTarget&&!Yme(e.dom))return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let b=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(b)&&(o=!0),o||s.lineWrapping&&Math.abs(y-this.contentDOMWidth)>s.charWidth){let{lineHeight:w,charWidth:E,textHeight:S}=e.docView.measureTextSize();o=w>0&&s.refresh(i,w,E,S,y/E,b),o&&(e.docView.minWidth=0,c|=16)}m>0&&p>0?u=Math.max(m,p):m<0&&p<0&&(u=Math.min(m,p)),bR();for(let w of this.viewports){let E=w.from==this.viewport.from?b:e.docView.measureVisibleLineHeights(w);this.heightMap=(o?$r.empty().applyChanges(this.stateDeco,ht.empty,this.heightOracle,[new Ln(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new Gme(w.from,E))}ql&&(c|=2)}let _=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return _&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||_)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,i=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new uf(s.lineAt(o-n*1e3,Ct.ByHeight,i,0,0).from,s.lineAt(a+(1-n)*1e3,Ct.ByHeight,i,0,0).to);if(r){let{head:c}=r.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=s.lineAt(c,Ct.ByPos,i,0,0),h;r.y=="center"?h=(d.top+d.bottom)/2-u/2:r.y=="start"||r.y=="nearest"&&c<l.from?h=d.top:h=d.bottom-u,l=new uf(s.lineAt(h-1e3/2,Ct.ByHeight,i,0,0).from,s.lineAt(h+u+1e3/2,Ct.ByHeight,i,0,0).to)}}return l}mapViewport(e,r){let n=r.mapPos(e.from,-1),s=r.mapPos(e.to,1);return new uf(this.heightMap.lineAt(n,Ct.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Ct.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,Ct.ByPos,this.heightOracle,0,0),{bottom:i}=this.heightMap.lineAt(r,Ct.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||s<=o-Math.max(10,Math.min(-n,250)))&&(r==this.state.doc.length||i>=a+Math.max(10,Math.min(n,250)))&&s>o-2*1e3&&i<a+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let n=[];for(let s of e)r.touchesRange(s.from,s.to)||n.push(new Wy(r.mapPos(s.from),r.mapPos(s.to),s.size,s.displaySize));return n}ensureLineGaps(e,r){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,i=s>>1,o=s<<1;if(this.defaultTextDirection!=At.LTR&&!n)return[];let a=[],l=(u,d,h,f)=>{if(d-u<i)return;let v=this.state.selection.main,m=[v.from];v.empty||m.push(v.to);for(let g of m)if(g>u&&g<d){l(u,g-10,h,f),l(g+10,d,h,f);return}let p=ege(e,g=>g.from>=h.from&&g.to<=h.to&&Math.abs(g.from-u)<i&&Math.abs(g.to-d)<i&&!m.some(y=>g.from<y&&g.to>y));if(!p){if(d<h.to&&r&&n&&r.visibleRanges.some(_=>_.from<=d&&_.to>=d)){let _=r.moveToLineBoundary(xe.cursor(d),!1,!0).head;_>u&&(d=_)}let g=this.gapSize(h,u,d,f),y=n||g<2e6?g:2e6;p=new Wy(u,d,g,y)}a.push(p)},c=u=>{if(u.length<o||u.type!=jr.Text)return;let d=Qme(u.from,u.to,this.stateDeco);if(d.total<o)return;let h=this.scrollTarget?this.scrollTarget.range.head:null,f,v;if(n){let m=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,p,g;if(h!=null){let y=hf(d,h),_=((this.visibleBottom-this.visibleTop)/2+m)/u.height;p=y-_,g=y+_}else p=(this.visibleTop-u.top-m)/u.height,g=(this.visibleBottom-u.top+m)/u.height;f=df(d,p),v=df(d,g)}else{let m=d.total*this.heightOracle.charWidth,p=s*this.heightOracle.charWidth,g=0;if(m>2e6)for(let E of e)E.from>=u.from&&E.from<u.to&&E.size!=E.displaySize&&E.from*this.heightOracle.charWidth+g<this.pixelViewport.left&&(g=E.size-E.displaySize);let y=this.pixelViewport.left+g,_=this.pixelViewport.right+g,b,w;if(h!=null){let E=hf(d,h),S=((_-y)/2+p)/m;b=E-S,w=E+S}else b=(y-p)/m,w=(_+p)/m;f=df(d,b),v=df(d,w)}f>u.from&&l(u.from,f,u,d),v<u.to&&l(v,u.to,u,d)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return a}gapSize(e,r,n,s){let i=hf(s,n)-hf(s,r);return this.heightOracle.lineWrapping?e.height*i:s.total*this.heightOracle.charWidth*i}updateLineGaps(e){Wy.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=rt.set(e.map(r=>r.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let r=this.stateDeco;this.lineGaps.length&&(r=r.concat(this.lineGapDeco));let n=[];ut.spans(r,this.viewport.from,this.viewport.to,{span(i,o){n.push({from:i,to:o})},point(){}},20);let s=0;if(n.length!=this.visibleRanges.length)s=12;else for(let i=0;i<n.length&&!(s&8);i++){let o=this.visibleRanges[i],a=n[i];(o.from!=a.from||o.to!=a.to)&&(s|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(s|=8))}return this.visibleRanges=n,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||qc(this.heightMap.lineAt(e,Ct.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(r=>r.top<=e&&r.bottom>=e)||qc(this.heightMap.lineAt(this.scaler.fromDOM(e),Ct.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let r=this.lineBlockAtHeight(e+8);return r.from>=this.viewport.from||this.viewportLines[0].top-e>200?r:this.viewportLines[0]}elementAtHeight(e){return qc(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class uf{constructor(e,r){this.from=e,this.to=r}}function Qme(t,e,r){let n=[],s=t,i=0;return ut.spans(r,t,e,{span(){},point(o,a){o>s&&(n.push({from:s,to:o}),i+=o-s),s=a}},20),s<e&&(n.push({from:s,to:e}),i+=e-s),{total:i,ranges:n}}function df({total:t,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let n=Math.floor(t*r);for(let s=0;;s++){let{from:i,to:o}=e[s],a=o-i;if(n<=a)return i+n;n-=a}}function hf(t,e){let r=0;for(let{from:n,to:s}of t.ranges){if(e<=s){r+=e-n;break}r+=s-n}return r/t.total}function ege(t,e){for(let r of t)if(e(r))return r}const SR={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class e1{constructor(e,r,n){let s=0,i=0,o=0;this.viewports=n.map(({from:a,to:l})=>{let c=r.lineAt(a,Ct.ByPos,e,0,0).top,u=r.lineAt(l,Ct.ByPos,e,0,0).bottom;return s+=u-c,{from:a,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(r.height-s);for(let a of this.viewports)a.domTop=o+(a.top-i)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),i=a.bottom}toDOM(e){for(let r=0,n=0,s=0;;r++){let i=r<this.viewports.length?this.viewports[r]:null;if(!i||e<i.top)return s+(e-n)*this.scale;if(e<=i.bottom)return i.domTop+(e-i.top);n=i.bottom,s=i.domBottom}}fromDOM(e){for(let r=0,n=0,s=0;;r++){let i=r<this.viewports.length?this.viewports[r]:null;if(!i||e<i.domTop)return n+(e-s)/this.scale;if(e<=i.domBottom)return i.top+(e-i.domTop);n=i.bottom,s=i.domBottom}}eq(e){return e instanceof e1?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((r,n)=>r.from==e.viewports[n].from&&r.to==e.viewports[n].to):!1}}function qc(t,e){if(e.scale==1)return t;let r=e.toDOM(t.top),n=e.toDOM(t.bottom);return new Cs(t.from,t.length,r,n-r,Array.isArray(t._content)?t._content.map(s=>qc(s,e)):t._content)}const ff=je.define({combine:t=>t.join(" ")}),Zb=je.define({combine:t=>t.indexOf(!0)>-1}),Xb=mo.newName(),A5=mo.newName(),R5=mo.newName(),P5={"&light":"."+A5,"&dark":"."+R5};function Qb(t,e,r){return new mo(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return t;if(!r||!r[s])throw new RangeError(`Unsupported selector: ${s}`);return r[s]}):t+" "+n}})}const tge=Qb("."+Xb,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},P5),rge={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ky=Le.ie&&Le.ie_version<=11;class nge{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Fpe,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let n of r)this.queue.push(n);(Le.ie&&Le.ie_version<=11||Le.ios&&e.composing)&&r.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Le.chrome&&Le.chrome_version<126)&&(this.editContext=new ige(e),e.state.facet(ci)&&(e.contentDOM.editContext=this.editContext.editContext)),Ky&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,n)=>r!=e[n]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(ci)?n.root.activeElement!=this.dom:!Jf(this.dom,s))return;let i=s.anchorNode&&n.docView.nearest(s.anchorNode);if(i&&i.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(Le.ie&&Le.ie_version<=11||Le.android&&Le.chrome)&&!n.state.selection.main.empty&&s.focusNode&&bu(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=Td(e.root);if(!r)return!1;let n=Le.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&sge(this.view,r)||r;if(!n||this.selectionRange.eq(n))return!1;let s=Jf(this.dom,n);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&$pe(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let n=this.dom;n;)if(n.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=r)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,rge),Ky&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ky&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var n;if(!this.delayedAndroidKey){let s=()=>{let i=this.delayedAndroidKey;i&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=i.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&i.force&&bl(this.dom,i.key,i.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,n=-1,s=!1;for(let i of e){let o=this.readMutation(i);o&&(o.typeOver&&(s=!0),r==-1?{from:r,to:n}=o:(r=Math.min(o.from,r),n=Math.max(o.to,n)))}return{from:r,to:n,typeOver:s}}readChange(){let{from:e,to:r,typeOver:n}=this.processRecords(),s=this.selectionChanged&&Jf(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let i=new wme(this.view,e,r,n);return this.view.docView.domChanged={newSel:i.newSel?i.newSel.main:null},i}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return this.view.requestMeasure(),!1;let n=this.view.state,s=y5(this.view,r);return this.view.state==n&&(r.domChanged||r.newSel&&!r.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let r=this.view.docView.nearest(e.target);if(!r||r.ignoreMutation(e))return null;if(r.markDirty(e.type=="attributes"),e.type=="attributes"&&(r.flags|=4),e.type=="childList"){let n=ER(r,e.previousSibling||e.target.previousSibling,-1),s=ER(r,e.nextSibling||e.target.nextSibling,1);return{from:n?r.posAfter(n):r.posAtStart,to:s?r.posBefore(s):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ci)!=e.state.facet(ci)&&(e.view.contentDOM.editContext=e.state.facet(ci)?this.editContext.editContext:null))}destroy(){var e,r,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function ER(t,e,r){for(;e;){let n=_t.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:r>0?e.nextSibling:e.previousSibling}return null}function CR(t,e){let r=e.startContainer,n=e.startOffset,s=e.endContainer,i=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return bu(o.node,o.offset,s,i)&&([r,n,s,i]=[s,i,r,n]),{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:i}}function sge(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return CR(t,s)}let r=null;function n(s){s.preventDefault(),s.stopImmediatePropagation(),r=s.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),r?CR(t,r):null}class ige{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let r=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let s=e.state.selection.main,{anchor:i,head:o}=s,a=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:a,drifted:!1});let c={from:a,to:l,insert:ht.of(n.text.split(`
`))};if(c.from==this.from&&i<this.from?c.from=i:c.to==this.to&&i>this.to&&(c.to=i),c.from==c.to&&!c.insert.length){let u=xe.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));u.main.eq(s)||e.dispatch({selection:u,userEvent:"select"});return}if((Le.mac||Le.android)&&c.from==o-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:a,to:l,insert:ht.of([n.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let u=this.to-this.from+(c.to-c.from+c.insert.length);XS(e,c,xe.single(this.toEditorPos(n.selectionStart,u),this.toEditorPos(n.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let s=[],i=null;for(let o=this.toEditorPos(n.rangeStart),a=this.toEditorPos(n.rangeEnd);o<a;o++){let l=e.coordsForChar(o);i=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||i||new DOMRect,s.push(i)}r.updateCharacterBounds(n.rangeStart,s)},this.handlers.textformatupdate=n=>{let s=[];for(let i of n.getTextFormats()){let o=i.underlineStyle,a=i.underlineThickness;if(o!="None"&&a!="None"){let l=this.toEditorPos(i.rangeStart),c=this.toEditorPos(i.rangeEnd);if(l<c){let u=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;s.push(rt.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:d5.of(rt.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)r.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let s=Td(n.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let r=0,n=!1,s=this.pendingContextChange;return e.changes.iterChanges((i,o,a,l,c)=>{if(n)return;let u=c.length-(o-i);if(s&&o>=s.to)if(s.from==i&&s.to==o&&s.insert.eq(c)){s=this.pendingContextChange=null,r+=u,this.to+=u;return}else s=null,this.revertPending(e.state);if(i+=r,o+=r,o<=this.from)this.from+=u,this.to+=u;else if(i<this.to){if(i<this.from||o>this.to||this.to-this.from+c.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(i),this.toContextPos(o),c.toString()),this.to+=u}r+=u}),s&&!n&&this.revertPending(e.state),!n}update(e){let r=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||r)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:r}=e.selection.main;this.from=Math.max(0,r-1e4),this.to=Math.min(e.doc.length,r+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let r=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(r.from),this.toContextPos(r.from+r.insert.length),e.doc.sliceString(r.from,r.to))}setSelection(e){let{main:r}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,r.anchor))),s=this.toContextPos(r.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(n,s)}rangeIsValid(e){let{head:r}=e.selection.main;return!(this.from>0&&r-this.from<500||this.to<e.doc.length&&this.to-r<500||this.to-this.from>1e4*3)}toEditorPos(e,r=this.to-this.from){e=Math.min(e,r);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let r=this.composing;return r&&r.drifted?r.contextBase+(e-r.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Fe{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var r;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(s=>s.forEach(i=>n(i,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||jpe(e.parent)||document,this.viewState=new xR(e.state||ot.create(e)),e.scrollTo&&e.scrollTo.is(af)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(zc).map(s=>new Vy(s));for(let s of this.plugins)s.update(this);this.observer=new nge(this),this.inputState=new kme(this),this.inputState.ensureHandlers(this.plugins),this.docView=new nR(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((r=document.fonts)===null||r===void 0)&&r.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let r=e.length==1&&e[0]instanceof Gt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(r,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,n=!1,s,i=this.state;for(let h of e){if(h.startState!=i)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");i=h.state}if(this.destroyed){this.viewState.state=i;return}let o=this.hasFocus,a=0,l=null;e.some(h=>h.annotation(E5))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=C5(i,o),l||(a=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(i.doc)||!this.state.selection.eq(i.selection))&&(u=null)):this.observer.clear(),i.facet(ot.phrases)!=this.state.facet(ot.phrases))return this.setState(i);s=km.create(this,i,e),s.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let h of e){if(d&&(d=d.map(h.changes)),h.scrollIntoView){let{main:f}=h.state.selection;d=new wl(f.empty?f:xe.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of h.effects)f.is(af)&&(d=f.value.clip(this.state))}this.viewState.update(s,d),this.bidiCache=Am.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),r=this.docView.update(s),this.state.facet(Wc)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(h=>h.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(ff)!=s.state.facet(ff)&&(this.viewState.mustMeasureContent=!0),(r||n||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),r&&this.docViewUpdate(),!s.empty)for(let h of this.state.facet(Kb))try{h(s)}catch(f){hn(this.state,f,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!y5(this,u)&&c.force&&bl(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new xR(e),this.plugins=e.facet(zc).map(n=>new Vy(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new nR(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(zc),n=e.state.facet(zc);if(r!=n){let s=[];for(let i of n){let o=r.indexOf(i);if(o<0)s.push(new Vy(i));else{let a=this.plugins[o];a.mustUpdate=e,s.push(a)}}for(let i of this.plugins)i.mustUpdate!=e&&i.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);r!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let r=e.value;if(r&&r.docViewUpdate)try{r.docViewUpdate(this)}catch(n){hn(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:i,scrollAnchorHeight:o}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(j3(n))i=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(s);i=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(f=>{try{return f.read(this)}catch(v){return hn(this.state,v),kR}}),d=km.create(this,this.state,[]),h=!1;d.flags|=l,r?r.flags|=l:r=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),h=this.docView.update(d),h&&this.docViewUpdate());for(let f=0;f<c.length;f++)if(u[f]!=kR)try{let v=c[f];v.write&&v.write(u[f],this)}catch(v){hn(this.state,v)}if(h&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let v=(i<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(i).top)-o;if(v>1||v<-1){s=s+v,n.scrollTop=s/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let a of this.state.facet(Kb))a(r)}get themeClasses(){return Xb+" "+(this.state.facet(Zb)?R5:A5)+" "+this.state.facet(ff)}updateAttrs(){let e=TR(this,h5,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ci)?"true":"false",class:"cm-content",style:`${Le.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),TR(this,zg,r);let n=this.observer.ignore(()=>{let s=Hb(this.contentDOM,this.contentAttrs,r),i=Hb(this.dom,this.editorAttrs,e);return s||i});return this.editorAttrs=e,this.contentAttrs=r,n}showAnnouncements(e){let r=!0;for(let n of e)for(let s of n.effects)if(s.is(Fe.announce)){r&&(this.announceDOM.textContent=""),r=!1;let i=this.announceDOM.appendChild(document.createElement("div"));i.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Wc);let e=this.state.facet(Fe.cspNonce);mo.mount(this.root,this.styleModules.concat(tge).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.spec!=e)&&this.pluginMap.set(e,r=this.plugins.find(n=>n.spec==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,n){return zy(this,e,lR(this,e,r,n))}moveByGroup(e,r){return zy(this,e,lR(this,e,r,n=>vme(this,e.head,n)))}visualLineSide(e,r){let n=this.bidiSpans(e),s=this.textDirectionAt(e.from),i=n[r?n.length-1:0];return xe.cursor(i.side(r,s)+e.from,i.forward(!r,s)?1:-1)}moveToLineBoundary(e,r,n=!0){return gme(this,e,r,n)}moveVertically(e,r,n){return zy(this,e,yme(this,e,r,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){return this.readMeasured(),v5(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let n=this.docView.coordsAt(e,r);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(e),i=this.bidiSpans(s),o=i[qi.find(i,e-s.from,-1,r)];return Vg(n,o.dir==At.LTR==r>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(l5)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>oge)return e5(e.length);let r=this.textDirectionAt(e.from),n;for(let i of this.bidiCache)if(i.from==e.from&&i.dir==r&&(i.fresh||Q3(i.isolates,n=rR(this,e))))return i.order;n||(n=rR(this,e));let s=eme(e.text,r,n);return this.bidiCache.push(new Am(e.from,e.to,r,n,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Le.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{B3(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return af.of(new wl(typeof e=="number"?xe.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:r}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return af.of(new wl(xe.cursor(n.from),"start","start",n.top-e,r,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return nr.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return nr.define(()=>({}),{eventObservers:e})}static theme(e,r){let n=mo.newName(),s=[ff.of(n),Wc.of(Qb(`.${n}`,e))];return r&&r.dark&&s.push(Zb.of(!0)),s}static baseTheme(e){return Eo.lowest(Wc.of(Qb("."+Xb,e,P5)))}static findFromDOM(e){var r;let n=e.querySelector(".cm-content"),s=n&&_t.get(n)||_t.get(e);return((r=s?.rootView)===null||r===void 0?void 0:r.view)||null}}Fe.styleModule=Wc;Fe.inputHandler=o5;Fe.clipboardInputFilter=qS;Fe.clipboardOutputFilter=JS;Fe.scrollHandler=u5;Fe.focusChangeEffect=a5;Fe.perLineTextDirection=l5;Fe.exceptionSink=i5;Fe.updateListener=Kb;Fe.editable=ci;Fe.mouseSelectionStyle=s5;Fe.dragMovesSelection=n5;Fe.clickAddsSelectionRange=r5;Fe.decorations=Rd;Fe.outerDecorations=f5;Fe.atomicRanges=YS;Fe.bidiIsolatedRanges=p5;Fe.scrollMargins=m5;Fe.darkTheme=Zb;Fe.cspNonce=je.define({combine:t=>t.length?t[0]:""});Fe.contentAttributes=zg;Fe.editorAttributes=h5;Fe.lineWrapping=Fe.contentAttributes.of({class:"cm-lineWrapping"});Fe.announce=Qe.define();const oge=4096,kR={};class Am{constructor(e,r,n,s,i,o){this.from=e,this.to=r,this.dir=n,this.isolates=s,this.fresh=i,this.order=o}static update(e,r){if(r.empty&&!e.some(i=>i.fresh))return e;let n=[],s=e.length?e[e.length-1].dir:At.LTR;for(let i=Math.max(0,e.length-10);i<e.length;i++){let o=e[i];o.dir==s&&!r.touchesRange(o.from,o.to)&&n.push(new Am(r.mapPos(o.from,1),r.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function TR(t,e,r){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let i=n[s],o=typeof i=="function"?i(t):i;o&&Ub(o,r)}return r}const age=Le.mac?"mac":Le.windows?"win":Le.linux?"linux":"key";function lge(t,e){const r=t.split(/-(?!$)/);let n=r[r.length-1];n=="Space"&&(n=" ");let s,i,o,a;for(let l=0;l<r.length-1;++l){const c=r[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))s=!0;else if(/^(c|ctrl|control)$/i.test(c))i=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?a=!0:i=!0;else throw new Error("Unrecognized modifier name: "+c)}return s&&(n="Alt-"+n),i&&(n="Ctrl-"+n),a&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function pf(t,e,r){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r!==!1&&e.shiftKey&&(t="Shift-"+t),t}const cge=Eo.default(Fe.domEventHandlers({keydown(t,e){return O5(I5(e.state),t,e,"editor")}})),Kg=je.define({enables:cge}),AR=new WeakMap;function I5(t){let e=t.facet(Kg),r=AR.get(e);return r||AR.set(e,r=hge(e.reduce((n,s)=>n.concat(s),[]))),r}function uge(t,e,r){return O5(I5(t.state),e,t,r)}let Hi=null;const dge=4e3;function hge(t,e=age){let r=Object.create(null),n=Object.create(null),s=(o,a)=>{let l=n[o];if(l==null)n[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},i=(o,a,l,c,u)=>{var d,h;let f=r[o]||(r[o]=Object.create(null)),v=a.split(/ (?!$)/).map(g=>lge(g,e));for(let g=1;g<v.length;g++){let y=v.slice(0,g).join(" ");s(y,!0),f[y]||(f[y]={preventDefault:!0,stopPropagation:!1,run:[_=>{let b=Hi={view:_,prefix:y,scope:o};return setTimeout(()=>{Hi==b&&(Hi=null)},dge),!0}]})}let m=v.join(" ");s(m,!1);let p=f[m]||(f[m]={preventDefault:!1,stopPropagation:!1,run:((h=(d=f._any)===null||d===void 0?void 0:d.run)===null||h===void 0?void 0:h.slice())||[]});l&&p.run.push(l),c&&(p.preventDefault=!0),u&&(p.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of a){let u=r[c]||(r[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=o;for(let h in u)u[h].run.push(f=>d(f,ew))}let l=o[e]||o.key;if(l)for(let c of a)i(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&i(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return r}let ew=null;function O5(t,e,r,n){ew=e;let s=Mpe(e),i=Wn(s,0),o=li(i)==s.length&&s!=" ",a="",l=!1,c=!1,u=!1;Hi&&Hi.view==r&&Hi.scope==n&&(a=Hi.prefix+" ",b5.indexOf(e.keyCode)<0&&(c=!0,Hi=null));let d=new Set,h=p=>{if(p){for(let g of p.run)if(!d.has(g)&&(d.add(g),g(r)))return p.stopPropagation&&(u=!0),!0;p.preventDefault&&(p.stopPropagation&&(u=!0),c=!0)}return!1},f=t[n],v,m;return f&&(h(f[a+pf(s,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Le.windows&&e.ctrlKey&&e.altKey)&&(v=go[e.keyCode])&&v!=s?(h(f[a+pf(v,e,!0)])||e.shiftKey&&(m=kd[e.keyCode])!=s&&m!=v&&h(f[a+pf(m,e,!1)]))&&(l=!0):o&&e.shiftKey&&h(f[a+pf(s,e,!0)])&&(l=!0),!l&&h(f._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),ew=null,l}class lh{constructor(e,r,n,s,i){this.className=e,this.left=r,this.top=n,this.width=s,this.height=i}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,n){if(n.empty){let s=e.coordsAtPos(n.head,n.assoc||1);if(!s)return[];let i=D5(e);return[new lh(r,s.left-i.left,s.top-i.top,null,s.bottom-s.top)]}else return fge(e,r,n)}}function D5(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==At.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function RR(t,e,r,n){let s=t.coordsAtPos(e,r*2);if(!s)return n;let i=t.dom.getBoundingClientRect(),o=(s.top+s.bottom)/2,a=t.posAtCoords({x:i.left+1,y:o}),l=t.posAtCoords({x:i.right-1,y:o});return a==null||l==null?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}function fge(t,e,r){if(r.to<=t.viewport.from||r.from>=t.viewport.to)return[];let n=Math.max(r.from,t.viewport.from),s=Math.min(r.to,t.viewport.to),i=t.textDirection==At.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=D5(t),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),d=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),h=a.right-(u?parseInt(u.paddingRight):0),f=Jb(t,n),v=Jb(t,s),m=f.type==jr.Text?f:null,p=v.type==jr.Text?v:null;if(m&&(t.lineWrapping||f.widgetLineBreaks)&&(m=RR(t,n,1,m)),p&&(t.lineWrapping||v.widgetLineBreaks)&&(p=RR(t,s,-1,p)),m&&p&&m.from==p.from&&m.to==p.to)return y(_(r.from,r.to,m));{let w=m?_(r.from,null,m):b(f,!1),E=p?_(null,r.to,p):b(v,!0),S=[];return(m||f).to<(p||v).from-(m&&p?1:0)||f.widgetLineBreaks>1&&w.bottom+t.defaultLineHeight/2<E.top?S.push(g(d,w.bottom,h,E.top)):w.bottom<E.top&&t.elementAtHeight((w.bottom+E.top)/2).type==jr.Text&&(w.bottom=E.top=(w.bottom+E.top)/2),y(w).concat(S).concat(y(E))}function g(w,E,S,x){return new lh(e,w-l.left,E-l.top,S-w,x-E)}function y({top:w,bottom:E,horizontal:S}){let x=[];for(let T=0;T<S.length;T+=2)x.push(g(S[T],w,S[T+1],E));return x}function _(w,E,S){let x=1e9,T=-1e9,D=[];function O(A,H,K,V,q){let I=t.coordsAtPos(A,A==S.to?-2:2),$=t.coordsAtPos(K,K==S.from?2:-2);!I||!$||(x=Math.min(I.top,$.top,x),T=Math.max(I.bottom,$.bottom,T),q==At.LTR?D.push(i&&H?d:I.left,i&&V?h:$.right):D.push(!i&&V?d:$.left,!i&&H?h:I.right))}let R=w??S.from,P=E??S.to;for(let A of t.visibleRanges)if(A.to>R&&A.from<P)for(let H=Math.max(A.from,R),K=Math.min(A.to,P);;){let V=t.state.doc.lineAt(H);for(let q of t.bidiSpans(V)){let I=q.from+V.from,$=q.to+V.from;if(I>=K)break;$>H&&O(Math.max(I,H),w==null&&I<=R,Math.min($,K),E==null&&$>=P,q.dir)}if(H=V.to+1,H>=K)break}return D.length==0&&O(R,w==null,P,E==null,t.textDirection),{top:x,bottom:T,horizontal:D}}function b(w,E){let S=a.top+(E?w.top:w.bottom);return{top:S,bottom:S,horizontal:[]}}}function pge(t,e){return t.constructor==e.constructor&&t.eq(e)}class mge{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(Qf)!=e.state.facet(Qf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let r=0,n=e.facet(Qf);for(;r<n.length&&n[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:r}=this.view;(e!=this.scaleX||r!=this.scaleY)&&(this.scaleX=e,this.scaleY=r,this.dom.style.transform=`scale(${1/e}, ${1/r})`)}draw(e){if(e.length!=this.drawn.length||e.some((r,n)=>!pge(r,this.drawn[n]))){let r=this.dom.firstChild,n=0;for(let s of e)s.update&&r&&s.constructor&&this.drawn[n].constructor&&s.update(r,this.drawn[n])?(r=r.nextSibling,n++):this.dom.insertBefore(s.draw(),r);for(;r;){let s=r.nextSibling;r.remove(),r=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Qf=je.define();function M5(t){return[nr.define(e=>new mge(e,t)),Qf.of(t)]}const Pd=je.define({combine(t){return Ra(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function gge(t={}){return[Pd.of(t),vge,yge,_ge,c5.of(!0)]}function L5(t){return t.startState.facet(Pd)!=t.state.facet(Pd)}const vge=M5({above:!0,markers(t){let{state:e}=t,r=e.facet(Pd),n=[];for(let s of e.selection.ranges){let i=s==e.selection.main;if(s.empty||r.drawRangeCursor){let o=i?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=s.empty?s:xe.cursor(s.head,s.head>s.anchor?-1:1);for(let l of lh.forRange(t,o,a))n.push(l)}}return n},update(t,e){t.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=L5(t);return r&&PR(t.state,e),t.docChanged||t.selectionSet||r},mount(t,e){PR(e.state,t)},class:"cm-cursorLayer"});function PR(t,e){e.style.animationDuration=t.facet(Pd).cursorBlinkRate+"ms"}const yge=M5({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:lh.forRange(t,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||L5(t)},class:"cm-selectionLayer"}),_ge=Eo.highest(Fe.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),N5=Qe.define({map(t,e){return t==null?null:e.mapPos(t)}}),Jc=sr.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((r,n)=>n.is(N5)?n.value:r,t)}}),bge=nr.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let r=t.state.field(Jc);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(Jc)!=r||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(Jc),r=e!=null&&t.coordsAtPos(e);if(!r)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:r.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:r.bottom-r.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:r}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/r+"px",this.cursor.style.height=t.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(Jc)!=t&&this.view.dispatch({effects:N5.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function wge(){return[Jc,bge]}const IR=nr.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(t){let{view:e}=t,r=e.viewState.editorHeight-e.defaultLineHeight-e.documentPadding.top-.5;r>=0&&r!=this.height&&(this.height=r,this.attrs={style:`padding-bottom: ${r}px`})}});function xge(){return[IR,zg.of(t=>{var e;return((e=t.plugin(IR))===null||e===void 0?void 0:e.attrs)||null})]}function Sge(){return Cge}const Ege=rt.line({class:"cm-activeLine"}),Cge=nr.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,r=[];for(let n of t.state.selection.ranges){let s=t.lineBlockAt(n.head);s.from>e&&(r.push(Ege.range(s.from)),e=s.from)}return rt.set(r)}},{decorations:t=>t.decorations}),Oc="-10000px";class kge{constructor(e,r,n,s){this.facet=r,this.createTooltipView=n,this.removeTooltipView=s,this.input=e.state.facet(r),this.tooltips=this.input.filter(o=>o);let i=null;this.tooltipViews=this.tooltips.map(o=>i=n(o,i))}update(e,r){var n;let s=e.state.facet(this.facet),i=s.filter(l=>l);if(s===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=r?[]:null;for(let l=0;l<i.length;l++){let c=i[l],u=-1;if(c){for(let d=0;d<this.tooltips.length;d++){let h=this.tooltips[d];h&&h.create==c.create&&(u=d)}if(u<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),a&&(a[l]=!!c.above);else{let d=o[l]=this.tooltipViews[u];a&&(a[l]=r[u]),d.update&&d.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return r&&(a.forEach((l,c)=>r[c]=l),r.length=a.length),this.input=s,this.tooltips=i,this.tooltipViews=o,!0}}function Tge(t={}){return ep.of(t)}function Age(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const ep=je.define({combine:t=>{var e,r,n;return{position:Le.ios?"absolute":((e=t.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=t.find(s=>s.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((n=t.find(s=>s.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Age}}}),OR=new WeakMap,B5=nr.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(ep);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new kge(t,t1,(r,n)=>this.createTooltip(r,n),r=>{this.resizeObserver&&this.resizeObserver.unobserve(r.dom),r.dom.remove()}),this.above=this.manager.tooltips.map(r=>!!r.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let r=e||t.geometryChanged,n=t.state.facet(ep);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(t,e){let r=t.create(this.view),n=e?e.dom:null;if(r.dom.classList.add("cm-tooltip"),t.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",r.dom.appendChild(s)}return r.dom.style.position=this.position,r.dom.style.top=Oc,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var t,e,r;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(t=n.destroy)===null||t===void 0||t.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(r=this.intersectionObserver)===null||r===void 0||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,r=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:i}=this.manager.tooltipViews[0];if(Le.gecko)r=i.offsetParent!=this.container.ownerDocument.body;else if(i.style.top==Oc&&i.style.left=="0px"){let o=i.getBoundingClientRect();r=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(r||this.position=="absolute")if(this.parent){let i=this.parent.getBoundingClientRect();i.width&&i.height&&(t=i.width/this.parent.offsetWidth,e=i.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=ZS(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((i,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(i.pos):this.view.coordsAtPos(i.pos)}),size:this.manager.tooltipViews.map(({dom:i})=>i.getBoundingClientRect()),space:this.view.state.facet(ep).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:r}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:r,space:n,scaleX:s,scaleY:i}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,d=t.pos[a],h=t.size[a];if(!d||l.clip!==!1&&(d.bottom<=Math.max(r.top,n.top)||d.top>=Math.min(r.bottom,n.bottom)||d.right<Math.max(r.left,n.left)-.1||d.left>Math.min(r.right,n.right)+.1)){u.style.top=Oc;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,v=f?7:0,m=h.right-h.left,p=(e=OR.get(c))!==null&&e!==void 0?e:h.bottom-h.top,g=c.offset||Pge,y=this.view.textDirection==At.LTR,_=h.width>n.right-n.left?y?n.left:n.right-h.width:y?Math.max(n.left,Math.min(d.left-(f?14:0)+g.x,n.right-m)):Math.min(Math.max(n.left,d.left-m+(f?14:0)-g.x),n.right-m),b=this.above[a];!l.strictSide&&(b?d.top-p-v-g.y<n.top:d.bottom+p+v+g.y>n.bottom)&&b==n.bottom-d.bottom>d.top-n.top&&(b=this.above[a]=!b);let w=(b?d.top-n.top:n.bottom-d.bottom)-v;if(w<p&&c.resize!==!1){if(w<this.view.defaultLineHeight){u.style.top=Oc;continue}OR.set(c,p),u.style.height=(p=w)/i+"px"}else u.style.height&&(u.style.height="");let E=b?d.top-p-v-g.y:d.bottom+v+g.y,S=_+m;if(c.overlap!==!0)for(let x of o)x.left<S&&x.right>_&&x.top<E+p&&x.bottom>E&&(E=b?x.top-p-2-v:x.bottom+v+2);if(this.position=="absolute"?(u.style.top=(E-t.parent.top)/i+"px",DR(u,(_-t.parent.left)/s)):(u.style.top=E/i+"px",DR(u,_/s)),f){let x=d.left+(y?g.x:-g.x)-(_+14-7);f.style.left=x/s+"px"}c.overlap!==!0&&o.push({left:_,top:E,right:S,bottom:E+p}),u.classList.toggle("cm-tooltip-above",b),u.classList.toggle("cm-tooltip-below",!b),c.positioned&&c.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Oc}},{eventObservers:{scroll(){this.maybeMeasure()}}});function DR(t,e){let r=parseInt(t.style.left,10);(isNaN(r)||Math.abs(e-r)>1)&&(t.style.left=e+"px")}const Rge=Fe.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Pge={x:0,y:0},t1=je.define({enables:[B5,Rge]});function F5(t,e){let r=t.plugin(B5);if(!r)return null;let n=r.manager.tooltips.indexOf(e);return n<0?null:r.manager.tooltipViews[n]}const MR=je.define({combine(t){let e,r;for(let n of t)e=e||n.topContainer,r=r||n.bottomContainer;return{topContainer:e,bottomContainer:r}}});function Rm(t,e){let r=t.plugin(j5),n=r?r.specs.indexOf(e):-1;return n>-1?r.panels[n]:null}const j5=nr.fromClass(class{constructor(t){this.input=t.state.facet(Pm),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(t));let e=t.state.facet(MR);this.top=new mf(t,!0,e.topContainer),this.bottom=new mf(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(t){let e=t.state.facet(MR);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new mf(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new mf(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=t.state.facet(Pm);if(r!=this.input){let n=r.filter(l=>l),s=[],i=[],o=[],a=[];for(let l of n){let c=this.specs.indexOf(l),u;c<0?(u=l(t.view),a.push(u)):(u=this.panels[c],u.update&&u.update(t)),s.push(u),(u.top?i:o).push(u)}this.specs=n,this.panels=s,this.top.sync(i),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Fe.scrollMargins.of(e=>{let r=e.plugin(t);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});let mf=class{constructor(e,r,n){this.view=e,this.top=r,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=LR(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=LR(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function LR(t){let e=t.nextSibling;return t.remove(),e}const Pm=je.define({enables:j5});class Ti extends ya{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ti.prototype.elementClass="";Ti.prototype.toDOM=void 0;Ti.prototype.mapMode=kr.TrackBefore;Ti.prototype.startSide=Ti.prototype.endSide=-1;Ti.prototype.point=!0;const tp=je.define(),Ige=je.define(),Oge={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>ut.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},xu=je.define();function Dge(t){return[$5(),xu.of(Object.assign(Object.assign({},Oge),t))]}const NR=je.define({combine:t=>t.some(e=>e)});function $5(t){return[Mge]}const Mge=nr.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(xu).map(e=>new FR(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(NR),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,r=t.view.viewport,n=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(NR)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let r=ut.iter(this.view.state.facet(tp),this.view.viewport.from),n=[],s=this.gutters.map(i=>new Lge(i,this.view.viewport,-this.view.documentPadding.top));for(let i of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(i.type)){let o=!0;for(let a of i.type)if(a.type==jr.Text&&o){tw(r,n,a.from);for(let l of s)l.line(this.view,a,n);o=!1}else if(a.widget)for(let l of s)l.widget(this.view,a)}else if(i.type==jr.Text){tw(r,n,i.from);for(let o of s)o.line(this.view,i,n)}else if(i.widget)for(let o of s)o.widget(this.view,i);for(let i of s)i.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(xu),r=t.state.facet(xu),n=t.docChanged||t.heightChanged||t.viewportChanged||!ut.eq(t.startState.facet(tp),t.state.facet(tp),t.view.viewport.from,t.view.viewport.to);if(e==r)for(let s of this.gutters)s.update(t)&&(n=!0);else{n=!0;let s=[];for(let i of r){let o=e.indexOf(i);o<0?s.push(new FR(this.view,i)):(this.gutters[o].update(t),s.push(this.gutters[o]))}for(let i of this.gutters)i.dom.remove(),s.indexOf(i)<0&&i.destroy();for(let i of s)this.dom.appendChild(i.dom);this.gutters=s}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Fe.scrollMargins.of(e=>{let r=e.plugin(t);return!r||r.gutters.length==0||!r.fixed?null:e.textDirection==At.LTR?{left:r.dom.offsetWidth*e.scaleX}:{right:r.dom.offsetWidth*e.scaleX}})});function BR(t){return Array.isArray(t)?t:[t]}function tw(t,e,r){for(;t.value&&t.from<=r;)t.from==r&&e.push(t.value),t.next()}class Lge{constructor(e,r,n){this.gutter=e,this.height=n,this.i=0,this.cursor=ut.iter(e.markers,r.from)}addElement(e,r,n){let{gutter:s}=this,i=(r.top-this.height)/e.scaleY,o=r.height/e.scaleY;if(this.i==s.elements.length){let a=new U5(e,o,i,n);s.elements.push(a),s.dom.appendChild(a.dom)}else s.elements[this.i].update(e,o,i,n);this.height=r.bottom,this.i++}line(e,r,n){let s=[];tw(this.cursor,s,r.from),n.length&&(s=s.concat(n));let i=this.gutter.config.lineMarker(e,r,s);i&&s.unshift(i);let o=this.gutter;s.length==0&&!o.config.renderEmptyElements||this.addElement(e,r,s)}widget(e,r){let n=this.gutter.config.widgetMarker(e,r.widget,r),s=n?[n]:null;for(let i of e.state.facet(Ige)){let o=i(e,r.widget,r);o&&(s||(s=[])).push(o)}s&&this.addElement(e,r,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}}class FR{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in r.domEventHandlers)this.dom.addEventListener(n,s=>{let i=s.target,o;if(i!=this.dom&&this.dom.contains(i)){for(;i.parentNode!=this.dom;)i=i.parentNode;let l=i.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=s.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);r.domEventHandlers[n](e,a,s)&&s.preventDefault()});this.markers=BR(r.markers(e)),r.initialSpacer&&(this.spacer=new U5(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=BR(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let n=e.view.viewport;return!ut.eq(this.markers,r,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class U5{constructor(e,r,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,n,s)}update(e,r,n,s){this.height!=r&&(this.height=r,this.dom.style.height=r+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Nge(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,r){let n="cm-gutterElement",s=this.dom.firstChild;for(let i=0,o=0;;){let a=o,l=i<r.length?r[i++]:null,c=!1;if(l){let u=l.elementClass;u&&(n+=" "+u);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,c=!0;break}}else a=this.markers.length;for(;o<a;){let u=this.markers[o++];if(u.toDOM){u.destroy(s);let d=s.nextSibling;s.remove(),s=d}}if(!l)break;l.toDOM&&(c?s=s.nextSibling:this.dom.insertBefore(l.toDOM(e),s)),c&&o++}this.dom.className=n,this.markers=r}destroy(){this.setMarkers(null,[])}}function Nge(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].compare(e[r]))return!1;return!0}const Bge=je.define(),Fge=je.define(),ol=je.define({combine(t){return Ra(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let n=Object.assign({},e);for(let s in r){let i=n[s],o=r[s];n[s]=i?(a,l,c)=>i(a,l,c)||o(a,l,c):o}return n}})}});class qy extends Ti{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Jy(t,e){return t.state.facet(ol).formatNumber(e,t.state)}const jge=xu.compute([ol],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Bge)},lineMarker(e,r,n){return n.some(s=>s.toDOM)?null:new qy(Jy(e,e.state.doc.lineAt(r.from).number))},widgetMarker:(e,r,n)=>{for(let s of e.state.facet(Fge)){let i=s(e,r,n);if(i)return i}return null},lineMarkerChange:e=>e.startState.facet(ol)!=e.state.facet(ol),initialSpacer(e){return new qy(Jy(e,jR(e.state.doc.lines)))},updateSpacer(e,r){let n=Jy(r.view,jR(r.view.state.doc.lines));return n==e.number?e:new qy(n)},domEventHandlers:t.facet(ol).domEventHandlers}));function $ge(t={}){return[ol.of(t),$5(),jge]}function jR(t){let e=9;for(;e<t;)e=e*10+9;return e}const Uge=new class extends Ti{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Hge=tp.compute(["selection"],t=>{let e=[],r=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.head).from;s>r&&(r=s,e.push(Uge.range(s)))}return ut.of(e)});function Vge(){return Hge}const Gge=1024;let zge=0;class On{constructor(e,r){this.from=e,this.to=r}}class nt{constructor(e={}){this.id=zge++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Qr.match(e)),r=>{let n=e(r);return n===void 0?null:[this,n]}}}nt.closedBy=new nt({deserialize:t=>t.split(" ")});nt.openedBy=new nt({deserialize:t=>t.split(" ")});nt.group=new nt({deserialize:t=>t.split(" ")});nt.isolate=new nt({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});nt.contextHash=new nt({perNode:!0});nt.lookAhead=new nt({perNode:!0});nt.mounted=new nt({perNode:!0});class Id{constructor(e,r,n){this.tree=e,this.overlay=r,this.parser=n}static get(e){return e&&e.props&&e.props[nt.mounted.id]}}const Wge=Object.create(null);class Qr{constructor(e,r,n,s=0){this.name=e,this.props=r,this.id=n,this.flags=s}static define(e){let r=e.props&&e.props.length?Object.create(null):Wge,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new Qr(e.name||"",r,e.id,n);if(e.props){for(let i of e.props)if(Array.isArray(i)||(i=i(s)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[i[0].id]=i[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(nt.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let n in e)for(let s of n.split(" "))r[s]=e[n];return n=>{for(let s=n.prop(nt.group),i=-1;i<(s?s.length:0);i++){let o=r[i<0?n.name:s[i]];if(o)return o}}}}Qr.none=new Qr("",Object.create(null),0,8);class H5{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let n of this.types){let s=null;for(let i of e){let o=i(n);o&&(s||(s=Object.assign({},n.props)),s[o[0].id]=o[1])}r.push(s?new Qr(n.name,s,n.id,n.flags):n)}return new H5(r)}}const gf=new WeakMap,$R=new WeakMap;var Ot;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(Ot||(Ot={}));class Jt{constructor(e,r,n,s,i){if(this.type=e,this.children=r,this.positions=n,this.length=s,this.props=null,i&&i.length){this.props=Object.create(null);for(let[o,a]of i)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Id.get(this);if(e&&!e.overlay)return e.tree.toString();let r="";for(let n of this.children){let s=n.toString();s&&(r&&(r+=","),r+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new Im(this.topNode,e)}cursorAt(e,r=0,n=0){let s=gf.get(this)||this.topNode,i=new Im(s);return i.moveTo(e,r),gf.set(this,i._tree),i}get topNode(){return new Rr(this,0,0,null)}resolve(e,r=0){let n=Od(gf.get(this)||this.topNode,e,r,!1);return gf.set(this,n),n}resolveInner(e,r=0){let n=Od($R.get(this)||this.topNode,e,r,!0);return $R.set(this,n),n}resolveStack(e,r=0){return Jge(this,e,r)}iterate(e){let{enter:r,leave:n,from:s=0,to:i=this.length}=e,o=e.mode||0,a=(o&Ot.IncludeAnonymous)>0;for(let l=this.cursor(o|Ot.IncludeAnonymous);;){let c=!1;if(l.from<=i&&l.to>=s&&(!a&&l.type.isAnonymous||r(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&n&&(a||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:s1(Qr.none,this.children,this.positions,0,this.children.length,0,this.length,(r,n,s)=>new Jt(this.type,r,n,s,this.propValues),e.makeTree||((r,n,s)=>new Jt(Qr.none,r,n,s)))}static build(e){return Yge(e)}}Jt.empty=new Jt(Qr.none,[],[],0);class r1{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new r1(this.buffer,this.index)}}class yo{constructor(e,r,n){this.buffer=e,this.length=r,this.set=n}get type(){return Qr.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],n=this.buffer[e+3],s=this.set.types[r],i=s.name;if(/\W/.test(i)&&!s.isError&&(i=JSON.stringify(i)),e+=4,n==e)return i;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return i+"("+o.join(",")+")"}findChild(e,r,n,s,i){let{buffer:o}=this,a=-1;for(let l=e;l!=r&&!(V5(i,s,o[l+1],o[l+2])&&(a=l,n>0));l=o[l+3]);return a}slice(e,r,n){let s=this.buffer,i=new Uint16Array(r-e),o=0;for(let a=e,l=0;a<r;){i[l++]=s[a++],i[l++]=s[a++]-n;let c=i[l++]=s[a++]-n;i[l++]=s[a++]-e,o=Math.max(o,c)}return new yo(i,o,this.set)}}function V5(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}function Od(t,e,r,n){for(var s;t.from==t.to||(r<1?t.from>=e:t.from>e)||(r>-1?t.to<=e:t.to<e);){let o=!n&&t instanceof Rr&&t.index<0?null:t.parent;if(!o)return t;t=o}let i=n?0:Ot.IgnoreOverlays;if(n)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof Rr&&o.index<0&&((s=a.enter(e,r,i))===null||s===void 0?void 0:s.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,r,i);if(!o)return t;t=o}}class G5{cursor(e=0){return new Im(this,e)}getChild(e,r=null,n=null){let s=UR(this,e,r,n);return s.length?s[0]:null}getChildren(e,r=null,n=null){return UR(this,e,r,n)}resolve(e,r=0){return Od(this,e,r,!1)}resolveInner(e,r=0){return Od(this,e,r,!0)}matchContext(e){return rw(this.parent,e)}enterUnfinishedNodesBefore(e){let r=this.childBefore(e),n=this;for(;r;){let s=r.lastChild;if(!s||s.to!=r.to)break;s.type.isError&&s.from==s.to?(n=r,r=s.prevSibling):r=s}return n}get node(){return this}get next(){return this.parent}}class Rr extends G5{constructor(e,r,n,s){super(),this._tree=e,this.from=r,this.index=n,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,n,s,i=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,c=r>0?a.length:-1;e!=c;e+=r){let u=a[e],d=l[e]+o.from;if(V5(s,n,d,d+u.length)){if(u instanceof yo){if(i&Ot.ExcludeBuffers)continue;let h=u.findChild(0,u.buffer.length,r,n-d,s);if(h>-1)return new ks(new Kge(o,u,e,d),null,h)}else if(i&Ot.IncludeAnonymous||!u.type.isAnonymous||n1(u)){let h;if(!(i&Ot.IgnoreMounts)&&(h=Id.get(u))&&!h.overlay)return new Rr(h.tree,d,e,o);let f=new Rr(u,d,e,o);return i&Ot.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(r<0?u.children.length-1:0,r,n,s)}}}if(i&Ot.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+r:e=r<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,r,n=0){let s;if(!(n&Ot.IgnoreOverlays)&&(s=Id.get(this._tree))&&s.overlay){let i=e-this.from;for(let{from:o,to:a}of s.overlay)if((r>0?o<=i:o<i)&&(r<0?a>=i:a>i))return new Rr(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function UR(t,e,r,n){let s=t.cursor(),i=[];if(!s.firstChild())return i;if(r!=null){for(let o=!1;!o;)if(o=s.type.is(r),!s.nextSibling())return i}for(;;){if(n!=null&&s.type.is(n))return i;if(s.type.is(e)&&i.push(s.node),!s.nextSibling())return n==null?i:[]}}function rw(t,e,r=e.length-1){for(let n=t;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[r]&&e[r]!=n.name)return!1;r--}}return!0}class Kge{constructor(e,r,n,s){this.parent=e,this.buffer=r,this.index=n,this.start=s}}class ks extends G5{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,n){super(),this.context=e,this._parent=r,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,r,n){let{buffer:s}=this.context,i=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.context.start,n);return i<0?null:new ks(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,r,n=0){if(n&Ot.ExcludeBuffers)return null;let{buffer:s}=this.context,i=s.findChild(this.index+4,s.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return i<0?null:new ks(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ks(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new ks(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],r=[],{buffer:n}=this.context,s=this.index+4,i=n.buffer[this.index+3];if(i>s){let o=n.buffer[this.index+1];e.push(n.slice(s,i,o)),r.push(0)}return new Jt(this.type,e,r,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function z5(t){if(!t.length)return null;let e=0,r=t[0];for(let i=1;i<t.length;i++){let o=t[i];(o.from>r.from||o.to<r.to)&&(r=o,e=i)}let n=r instanceof Rr&&r.index<0?null:r.parent,s=t.slice();return n?s[e]=n:s.splice(e,1),new qge(s,r)}class qge{constructor(e,r){this.heads=e,this.node=r}get next(){return z5(this.heads)}}function Jge(t,e,r){let n=t.resolveInner(e,r),s=null;for(let i=n instanceof Rr?n:n.context.parent;i;i=i.parent)if(i.index<0){let o=i.parent;(s||(s=[n])).push(o.resolve(e,r)),i=o}else{let o=Id.get(i.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Rr(o.tree,o.overlay[0].from+i.from,-1,i);(s||(s=[n])).push(Od(a,e,r,!1))}}return s?z5(s):n}class Im{get name(){return this.type.name}constructor(e,r=0){if(this.mode=r,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Rr)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:n,buffer:s}=this.buffer;return this.type=r||s.set.types[s.buffer[e]],this.from=n+s.buffer[e+1],this.to=n+s.buffer[e+2],!0}yield(e){return e?e instanceof Rr?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,n,this.mode));let{buffer:s}=this.buffer,i=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.buffer.start,n);return i<0?!1:(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,n=this.mode){return this.buffer?n&Ot.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ot.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ot.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,n=this.stack.length-1;if(e<0){let s=n<0?0:this.stack[n]+4;if(this.index!=s)return this.yieldBuf(r.findChild(s,this.index,-1,0,4))}else{let s=r.buffer[this.index+3];if(s<(n<0?r.buffer.length:r.buffer[this.stack[n]+3]))return this.yieldBuf(s)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,n,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let i=0;i<this.index;i++)if(s.buffer.buffer[i+3]<this.index)return!1;({index:r,parent:n}=s)}else({index:r,_parent:n}=this._tree);for(;n;{index:r,_parent:n}=n)if(r>-1)for(let i=r+e,o=e<0?-1:n._tree.children.length;i!=o;i+=e){let a=n._tree.children[i];if(this.mode&Ot.IncludeAnonymous||a instanceof yo||!a.type.isAnonymous||n1(a))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,n=0;if(e&&e.context==this.buffer)e:for(let s=this.index,i=this.stack.length;i>=0;){for(let o=e;o;o=o._parent)if(o.index==s){if(s==this.index)return o;r=o,n=i+1;break e}s=this.stack[--i]}for(let s=n;s<this.stack.length;s++)r=new ks(this.buffer,r,this.stack[s]);return this.bufferNode=new ks(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let n=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&r&&r(this),s=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,s=!0}}}matchContext(e){if(!this.buffer)return rw(this.node.parent,e);let{buffer:r}=this.buffer,{types:n}=r.set;for(let s=e.length-1,i=this.stack.length-1;s>=0;i--){if(i<0)return rw(this._tree,e,s);let o=n[r.buffer[this.stack[i]]];if(!o.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}}function n1(t){return t.children.some(e=>e instanceof yo||!e.type.isAnonymous||n1(e))}function Yge(t){var e;let{buffer:r,nodeSet:n,maxBufferLength:s=Gge,reused:i=[],minRepeatType:o=n.types.length}=t,a=Array.isArray(r)?new r1(r,r.length):r,l=n.types,c=0,u=0;function d(w,E,S,x,T,D){let{id:O,start:R,end:P,size:A}=a,H=u,K=c;for(;A<0;)if(a.next(),A==-1){let j=i[O];S.push(j),x.push(R-w);return}else if(A==-3){c=O;return}else if(A==-4){u=O;return}else throw new RangeError(`Unrecognized record size: ${A}`);let V=l[O],q,I,$=R-w;if(P-R<=s&&(I=p(a.pos-E,T))){let j=new Uint16Array(I.size-I.skip),U=a.pos-I.size,J=j.length;for(;a.pos>U;)J=g(I.start,j,J);q=new yo(j,P-I.start,n),$=I.start-w}else{let j=a.pos-A;a.next();let U=[],J=[],ne=O>=o?O:-1,te=0,me=P;for(;a.pos>j;)ne>=0&&a.id==ne&&a.size>=0?(a.end<=me-s&&(v(U,J,R,te,a.end,me,ne,H,K),te=U.length,me=a.end),a.next()):D>2500?h(R,j,U,J):d(R,j,U,J,ne,D+1);if(ne>=0&&te>0&&te<U.length&&v(U,J,R,te,R,me,ne,H,K),U.reverse(),J.reverse(),ne>-1&&te>0){let re=f(V,K);q=s1(V,U,J,0,U.length,0,P-R,re,re)}else q=m(V,U,J,P-R,H-P,K)}S.push(q),x.push($)}function h(w,E,S,x){let T=[],D=0,O=-1;for(;a.pos>E;){let{id:R,start:P,end:A,size:H}=a;if(H>4)a.next();else{if(O>-1&&P<O)break;O<0&&(O=A-s),T.push(R,P,A),D++,a.next()}}if(D){let R=new Uint16Array(D*4),P=T[T.length-2];for(let A=T.length-3,H=0;A>=0;A-=3)R[H++]=T[A],R[H++]=T[A+1]-P,R[H++]=T[A+2]-P,R[H++]=H;S.push(new yo(R,T[2]-P,n)),x.push(P-w)}}function f(w,E){return(S,x,T)=>{let D=0,O=S.length-1,R,P;if(O>=0&&(R=S[O])instanceof Jt){if(!O&&R.type==w&&R.length==T)return R;(P=R.prop(nt.lookAhead))&&(D=x[O]+R.length+P)}return m(w,S,x,T,D,E)}}function v(w,E,S,x,T,D,O,R,P){let A=[],H=[];for(;w.length>x;)A.push(w.pop()),H.push(E.pop()+S-T);w.push(m(n.types[O],A,H,D-T,R-D,P)),E.push(T-S)}function m(w,E,S,x,T,D,O){if(D){let R=[nt.contextHash,D];O=O?[R].concat(O):[R]}if(T>25){let R=[nt.lookAhead,T];O=O?[R].concat(O):[R]}return new Jt(w,E,S,x,O)}function p(w,E){let S=a.fork(),x=0,T=0,D=0,O=S.end-s,R={size:0,start:0,skip:0};e:for(let P=S.pos-w;S.pos>P;){let A=S.size;if(S.id==E&&A>=0){R.size=x,R.start=T,R.skip=D,D+=4,x+=4,S.next();continue}let H=S.pos-A;if(A<0||H<P||S.start<O)break;let K=S.id>=o?4:0,V=S.start;for(S.next();S.pos>H;){if(S.size<0)if(S.size==-3)K+=4;else break e;else S.id>=o&&(K+=4);S.next()}T=V,x+=A,D+=K}return(E<0||x==w)&&(R.size=x,R.start=T,R.skip=D),R.size>4?R:void 0}function g(w,E,S){let{id:x,start:T,end:D,size:O}=a;if(a.next(),O>=0&&x<o){let R=S;if(O>4){let P=a.pos-(O-4);for(;a.pos>P;)S=g(w,E,S)}E[--S]=R,E[--S]=D-w,E[--S]=T-w,E[--S]=x}else O==-3?c=x:O==-4&&(u=x);return S}let y=[],_=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,y,_,-1,0);let b=(e=t.length)!==null&&e!==void 0?e:y.length?_[0]+y[0].length:0;return new Jt(l[t.topID],y.reverse(),_.reverse(),b)}const HR=new WeakMap;function rp(t,e){if(!t.isAnonymous||e instanceof yo||e.type!=t)return 1;let r=HR.get(e);if(r==null){r=1;for(let n of e.children){if(n.type!=t||!(n instanceof Jt)){r=1;break}r+=rp(t,n)}HR.set(e,r)}return r}function s1(t,e,r,n,s,i,o,a,l){let c=0;for(let v=n;v<s;v++)c+=rp(t,e[v]);let u=Math.ceil(c*1.5/8),d=[],h=[];function f(v,m,p,g,y){for(let _=p;_<g;){let b=_,w=m[_],E=rp(t,v[_]);for(_++;_<g;_++){let S=rp(t,v[_]);if(E+S>=u)break;E+=S}if(_==b+1){if(E>u){let S=v[b];f(S.children,S.positions,0,S.children.length,m[b]+y);continue}d.push(v[b])}else{let S=m[_-1]+v[_-1].length-w;d.push(s1(t,v,m,b,_,w,S,null,l))}h.push(w+y-i)}}return f(e,r,n,s,0),(a||l)(d,h,o)}class KCe{constructor(){this.map=new WeakMap}setBuffer(e,r,n){let s=this.map.get(e);s||this.map.set(e,s=new Map),s.set(r,n)}getBuffer(e,r){let n=this.map.get(e);return n&&n.get(r)}set(e,r){e instanceof ks?this.setBuffer(e.context.buffer,e.index,r):e instanceof Rr&&this.map.set(e.tree,r)}get(e){return e instanceof ks?this.getBuffer(e.context.buffer,e.index):e instanceof Rr?this.map.get(e.tree):void 0}cursorSet(e,r){e.buffer?this.setBuffer(e.buffer.buffer,e.index,r):this.map.set(e.tree,r)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class vi{constructor(e,r,n,s,i=!1,o=!1){this.from=e,this.to=r,this.tree=n,this.offset=s,this.open=(i?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],n=!1){let s=[new vi(0,e.length,e,0,!1,n)];for(let i of r)i.to>e.length&&s.push(i);return s}static applyChanges(e,r,n=128){if(!r.length)return e;let s=[],i=1,o=e.length?e[0]:null;for(let a=0,l=0,c=0;;a++){let u=a<r.length?r[a]:null,d=u?u.fromA:1e9;if(d-l>=n)for(;o&&o.from<d;){let h=o;if(l>=h.from||d<=h.to||c){let f=Math.max(h.from,l)-c,v=Math.min(h.to,d)-c;h=f>=v?null:new vi(f,v,h.tree,h.offset+c,a>0,!!u)}if(h&&s.push(h),o.to>d)break;o=i<e.length?e[i++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return s}}class Zge{startParse(e,r,n){return typeof e=="string"&&(e=new Xge(e)),n=n?n.length?n.map(s=>new On(s.from,s.to)):[new On(0,0)]:[new On(0,e.length)],this.createParse(e,r||[],n)}parse(e,r,n){let s=this.startParse(e,r,n);for(;;){let i=s.advance();if(i)return i}}}class Xge{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}}function qCe(t){return(e,r,n,s)=>new eve(e,t,r,n,s)}class VR{constructor(e,r,n,s,i){this.parser=e,this.parse=r,this.overlay=n,this.target=s,this.from=i}}function GR(t){if(!t.length||t.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(t))}class Qge{constructor(e,r,n,s,i,o,a){this.parser=e,this.predicate=r,this.mounts=n,this.index=s,this.start=i,this.target=o,this.prev=a,this.depth=0,this.ranges=[]}}const nw=new nt({perNode:!0});class eve{constructor(e,r,n,s,i){this.nest=r,this.input=n,this.fragments=s,this.ranges=i,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let s of this.inner)s.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new Jt(n.type,n.children,n.positions,n.length,n.propValues.concat([[nw,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],r=e.parse.advance();if(r){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[nt.mounted.id]=new Id(r,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let r=this.innerDone;r<this.inner.length;r++)this.inner[r].from<e&&(e=Math.min(e,this.inner[r].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let r=this.innerDone;r<this.inner.length;r++)this.inner[r].parse.stopAt(e)}startInner(){let e=new nve(this.fragments),r=null,n=null,s=new Im(new Rr(this.baseTree,this.ranges[0].from,0,null),Ot.IncludeAnonymous|Ot.IgnoreMounts);e:for(let i,o;;){let a=!0,l;if(this.stoppedAt!=null&&s.from>=this.stoppedAt)a=!1;else if(e.hasNode(s)){if(r){let c=r.mounts.find(u=>u.frag.from<=s.from&&u.frag.to>=s.to&&u.mount.overlay);if(c)for(let u of c.mount.overlay){let d=u.from+c.pos,h=u.to+c.pos;d>=s.from&&h<=s.to&&!r.ranges.some(f=>f.from<h&&f.to>d)&&r.ranges.push({from:d,to:h})}}a=!1}else if(n&&(o=tve(n.ranges,s.from,s.to)))a=o!=2;else if(!s.type.isAnonymous&&(i=this.nest(s,this.input))&&(s.from<s.to||!i.overlay)){s.tree||rve(s);let c=e.findMounts(s.from,i.parser);if(typeof i.overlay=="function")r=new Qge(i.parser,i.overlay,c,this.inner.length,s.from,s.tree,r);else{let u=KR(this.ranges,i.overlay||(s.from<s.to?[new On(s.from,s.to)]:[]));u.length&&GR(u),(u.length||!i.overlay)&&this.inner.push(new VR(i.parser,u.length?i.parser.startParse(this.input,qR(c,u),u):i.parser.startParse(""),i.overlay?i.overlay.map(d=>new On(d.from-s.from,d.to-s.from)):null,s.tree,u.length?u[0].from:s.from)),i.overlay?u.length&&(n={ranges:u,depth:0,prev:n}):a=!1}}else if(r&&(l=r.predicate(s))&&(l===!0&&(l=new On(s.from,s.to)),l.from<l.to)){let c=r.ranges.length-1;c>=0&&r.ranges[c].to==l.from?r.ranges[c]={from:r.ranges[c].from,to:l.to}:r.ranges.push(l)}if(a&&s.firstChild())r&&r.depth++,n&&n.depth++;else for(;!s.nextSibling();){if(!s.parent())break e;if(r&&!--r.depth){let c=KR(this.ranges,r.ranges);c.length&&(GR(c),this.inner.splice(r.index,0,new VR(r.parser,r.parser.startParse(this.input,qR(r.mounts,c),c),r.ranges.map(u=>new On(u.from-r.start,u.to-r.start)),r.target,c[0].from))),r=r.prev}n&&!--n.depth&&(n=n.prev)}}}}function tve(t,e,r){for(let n of t){if(n.from>=r)break;if(n.to>e)return n.from<=e&&n.to>=r?2:1}return 0}function zR(t,e,r,n,s,i){if(e<r){let o=t.buffer[e+1];n.push(t.slice(e,r,o)),s.push(o-i)}}function rve(t){let{node:e}=t,r=[],n=e.context.buffer;do r.push(t.index),t.parent();while(!t.tree);let s=t.tree,i=s.children.indexOf(n),o=s.children[i],a=o.buffer,l=[i];function c(u,d,h,f,v,m){let p=r[m],g=[],y=[];zR(o,u,p,g,y,f);let _=a[p+1],b=a[p+2];l.push(g.length);let w=m?c(p+4,a[p+3],o.set.types[a[p]],_,b-_,m-1):e.toTree();return g.push(w),y.push(_-f),zR(o,a[p+3],d,g,y,f),new Jt(h,g,y,v)}s.children[i]=c(0,a.length,Qr.none,0,o.length,r.length-1);for(let u of l){let d=t.tree.children[u],h=t.tree.positions[u];t.yield(new Rr(d,h+t.from,u,t._tree))}}class WR{constructor(e,r){this.offset=r,this.done=!1,this.cursor=e.cursor(Ot.IncludeAnonymous|Ot.IgnoreMounts)}moveTo(e){let{cursor:r}=this,n=e-this.offset;for(;!this.done&&r.from<n;)r.to>=e&&r.enter(n,1,Ot.IgnoreOverlays|Ot.ExcludeBuffers)||r.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let r=this.cursor.tree;;){if(r==e.tree)return!0;if(r.children.length&&r.positions[0]==0&&r.children[0]instanceof Jt)r=r.children[0];else break}return!1}}class nve{constructor(e){var r;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(r=n.tree.prop(nw))!==null&&r!==void 0?r:n.to,this.inner=new WR(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let r=this.curFrag=this.fragments[this.fragI];this.curTo=(e=r.tree.prop(nw))!==null&&e!==void 0?e:r.to,this.inner=new WR(r.tree,-r.offset)}}findMounts(e,r){var n;let s=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let i=this.inner.cursor.node;i;i=i.parent){let o=(n=i.tree)===null||n===void 0?void 0:n.prop(nt.mounted);if(o&&o.parser==r)for(let a=this.fragI;a<this.fragments.length;a++){let l=this.fragments[a];if(l.from>=i.to)break;l.tree==this.curFrag.tree&&s.push({frag:l,pos:i.from-l.offset,mount:o})}}}return s}}function KR(t,e){let r=null,n=e;for(let s=1,i=0;s<t.length;s++){let o=t[s-1].to,a=t[s].from;for(;i<n.length;i++){let l=n[i];if(l.from>=a)break;l.to<=o||(r||(n=r=e.slice()),l.from<o?(r[i]=new On(l.from,o),l.to>a&&r.splice(i+1,0,new On(a,l.to))):l.to>a?r[i--]=new On(a,l.to):r.splice(i--,1))}}return n}function sve(t,e,r,n){let s=0,i=0,o=!1,a=!1,l=-1e9,c=[];for(;;){let u=s==t.length?1e9:o?t[s].to:t[s].from,d=i==e.length?1e9:a?e[i].to:e[i].from;if(o!=a){let h=Math.max(l,r),f=Math.min(u,d,n);h<f&&c.push(new On(h,f))}if(l=Math.min(u,d),l==1e9)break;u==l&&(o?(o=!1,s++):o=!0),d==l&&(a?(a=!1,i++):a=!0)}return c}function qR(t,e){let r=[];for(let{pos:n,mount:s,frag:i}of t){let o=n+(s.overlay?s.overlay[0].from:0),a=o+s.tree.length,l=Math.max(i.from,o),c=Math.min(i.to,a);if(s.overlay){let u=s.overlay.map(h=>new On(h.from+n,h.to+n)),d=sve(e,u,l,c);for(let h=0,f=l;;h++){let v=h==d.length,m=v?c:d[h].from;if(m>f&&r.push(new vi(f,m,s.tree,-o,i.from>=f||i.openStart,i.to<=m||i.openEnd)),v)break;f=d[h].to}}else r.push(new vi(l,c,s.tree,-o,i.from>=o||i.openStart,i.to<=a||i.openEnd))}return r}let ive=0;class In{constructor(e,r,n,s){this.name=e,this.set=r,this.base=n,this.modified=s,this.id=ive++}toString(){let{name:e}=this;for(let r of this.modified)r.name&&(e=`${r.name}(${e})`);return e}static define(e,r){let n=typeof e=="string"?e:"?";if(e instanceof In&&(r=e),r?.base)throw new Error("Can not derive from a modified tag");let s=new In(n,[],null,[]);if(s.set.push(s),r)for(let i of r.set)s.set.push(i);return s}static defineModifier(e){let r=new Om(e);return n=>n.modified.indexOf(r)>-1?n:Om.get(n.base||n,n.modified.concat(r).sort((s,i)=>s.id-i.id))}}let ove=0;class Om{constructor(e){this.name=e,this.instances=[],this.id=ove++}static get(e,r){if(!r.length)return e;let n=r[0].instances.find(a=>a.base==e&&ave(r,a.modified));if(n)return n;let s=[],i=new In(e.name,s,e,r);for(let a of r)a.instances.push(i);let o=lve(r);for(let a of e.set)if(!a.modified.length)for(let l of o)s.push(Om.get(a,l));return i}}function ave(t,e){return t.length==e.length&&t.every((r,n)=>r==e[n])}function lve(t){let e=[[]];for(let r=0;r<t.length;r++)for(let n=0,s=e.length;n<s;n++)e.push(e[n].concat(t[r]));return e.sort((r,n)=>n.length-r.length)}function cve(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let s of r.split(" "))if(s){let i=[],o=2,a=s;for(let d=0;;){if(a=="..."&&d>0&&d+3==s.length){o=1;break}let h=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!h)throw new RangeError("Invalid path: "+s);if(i.push(h[0]=="*"?"":h[0][0]=='"'?JSON.parse(h[0]):h[0]),d+=h[0].length,d==s.length)break;let f=s[d++];if(d==s.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+s);a=s.slice(d)}let l=i.length-1,c=i[l];if(!c)throw new RangeError("Invalid path: "+s);let u=new Dm(n,o,l>0?i.slice(0,l):null);e[c]=u.sort(e[c])}}return W5.add(e)}const W5=new nt;class Dm{constructor(e,r,n,s){this.tags=e,this.mode=r,this.context=n,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Dm.empty=new Dm([],2,null);function K5(t,e){let r=Object.create(null);for(let i of t)if(!Array.isArray(i.tag))r[i.tag.id]=i.class;else for(let o of i.tag)r[o.id]=i.class;let{scope:n,all:s=null}=e||{};return{style:i=>{let o=s;for(let a of i)for(let l of a.set){let c=r[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:n}}function uve(t,e){let r=null;for(let n of t){let s=n.style(e);s&&(r=r?r+" "+s:s)}return r}function dve(t,e,r,n=0,s=t.length){let i=new hve(n,Array.isArray(e)?e:[e],r);i.highlightRange(t.cursor(),n,s,"",i.highlighters),i.flush(s)}class hve{constructor(e,r,n){this.at=e,this.highlighters=r,this.span=n,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,n,s,i){let{type:o,from:a,to:l}=e;if(a>=n||l<=r)return;o.isTop&&(i=this.highlighters.filter(f=>!f.scope||f.scope(o)));let c=s,u=fve(e)||Dm.empty,d=uve(i,u.tags);if(d&&(c&&(c+=" "),c+=d,u.mode==1&&(s+=(s?" ":"")+d)),this.startSpan(Math.max(r,a),c),u.opaque)return;let h=e.tree&&e.tree.prop(nt.mounted);if(h&&h.overlay){let f=e.node.enter(h.overlay[0].from+a,1),v=this.highlighters.filter(p=>!p.scope||p.scope(h.tree.type)),m=e.firstChild();for(let p=0,g=a;;p++){let y=p<h.overlay.length?h.overlay[p]:null,_=y?y.from+a:l,b=Math.max(r,g),w=Math.min(n,_);if(b<w&&m)for(;e.from<w&&(this.highlightRange(e,b,w,s,i),this.startSpan(Math.min(w,e.to),c),!(e.to>=_||!e.nextSibling())););if(!y||_>n)break;g=y.to+a,g>r&&(this.highlightRange(f.cursor(),Math.max(r,y.from+a),Math.min(n,g),"",v),this.startSpan(Math.min(n,g),c))}m&&e.parent()}else if(e.firstChild()){h&&(s="");do if(!(e.to<=r)){if(e.from>=n)break;this.highlightRange(e,r,n,s,i),this.startSpan(Math.min(n,e.to),c)}while(e.nextSibling());e.parent()}}}function fve(t){let e=t.type.prop(W5);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const Pe=In.define,vf=Pe(),ji=Pe(),JR=Pe(ji),YR=Pe(ji),$i=Pe(),yf=Pe($i),Yy=Pe($i),gs=Pe(),Do=Pe(gs),hs=Pe(),fs=Pe(),sw=Pe(),Dc=Pe(sw),_f=Pe(),ve={comment:vf,lineComment:Pe(vf),blockComment:Pe(vf),docComment:Pe(vf),name:ji,variableName:Pe(ji),typeName:JR,tagName:Pe(JR),propertyName:YR,attributeName:Pe(YR),className:Pe(ji),labelName:Pe(ji),namespace:Pe(ji),macroName:Pe(ji),literal:$i,string:yf,docString:Pe(yf),character:Pe(yf),attributeValue:Pe(yf),number:Yy,integer:Pe(Yy),float:Pe(Yy),bool:Pe($i),regexp:Pe($i),escape:Pe($i),color:Pe($i),url:Pe($i),keyword:hs,self:Pe(hs),null:Pe(hs),atom:Pe(hs),unit:Pe(hs),modifier:Pe(hs),operatorKeyword:Pe(hs),controlKeyword:Pe(hs),definitionKeyword:Pe(hs),moduleKeyword:Pe(hs),operator:fs,derefOperator:Pe(fs),arithmeticOperator:Pe(fs),logicOperator:Pe(fs),bitwiseOperator:Pe(fs),compareOperator:Pe(fs),updateOperator:Pe(fs),definitionOperator:Pe(fs),typeOperator:Pe(fs),controlOperator:Pe(fs),punctuation:sw,separator:Pe(sw),bracket:Dc,angleBracket:Pe(Dc),squareBracket:Pe(Dc),paren:Pe(Dc),brace:Pe(Dc),content:gs,heading:Do,heading1:Pe(Do),heading2:Pe(Do),heading3:Pe(Do),heading4:Pe(Do),heading5:Pe(Do),heading6:Pe(Do),contentSeparator:Pe(gs),list:Pe(gs),quote:Pe(gs),emphasis:Pe(gs),strong:Pe(gs),link:Pe(gs),monospace:Pe(gs),strikethrough:Pe(gs),inserted:Pe(),deleted:Pe(),changed:Pe(),invalid:Pe(),meta:_f,documentMeta:Pe(_f),annotation:Pe(_f),processingInstruction:Pe(_f),definition:In.defineModifier("definition"),constant:In.defineModifier("constant"),function:In.defineModifier("function"),standard:In.defineModifier("standard"),local:In.defineModifier("local"),special:In.defineModifier("special")};for(let t in ve){let e=ve[t];e instanceof In&&(e.name=t)}K5([{tag:ve.link,class:"tok-link"},{tag:ve.heading,class:"tok-heading"},{tag:ve.emphasis,class:"tok-emphasis"},{tag:ve.strong,class:"tok-strong"},{tag:ve.keyword,class:"tok-keyword"},{tag:ve.atom,class:"tok-atom"},{tag:ve.bool,class:"tok-bool"},{tag:ve.url,class:"tok-url"},{tag:ve.labelName,class:"tok-labelName"},{tag:ve.inserted,class:"tok-inserted"},{tag:ve.deleted,class:"tok-deleted"},{tag:ve.literal,class:"tok-literal"},{tag:ve.string,class:"tok-string"},{tag:ve.number,class:"tok-number"},{tag:[ve.regexp,ve.escape,ve.special(ve.string)],class:"tok-string2"},{tag:ve.variableName,class:"tok-variableName"},{tag:ve.local(ve.variableName),class:"tok-variableName tok-local"},{tag:ve.definition(ve.variableName),class:"tok-variableName tok-definition"},{tag:ve.special(ve.variableName),class:"tok-variableName2"},{tag:ve.definition(ve.propertyName),class:"tok-propertyName tok-definition"},{tag:ve.typeName,class:"tok-typeName"},{tag:ve.namespace,class:"tok-namespace"},{tag:ve.className,class:"tok-className"},{tag:ve.macroName,class:"tok-macroName"},{tag:ve.propertyName,class:"tok-propertyName"},{tag:ve.operator,class:"tok-operator"},{tag:ve.comment,class:"tok-comment"},{tag:ve.meta,class:"tok-meta"},{tag:ve.invalid,class:"tok-invalid"},{tag:ve.punctuation,class:"tok-punctuation"}]);var Zy;const al=new nt;function pve(t){return je.define({combine:t?e=>e.concat(t):void 0})}const mve=new nt;class qn{constructor(e,r,n=[],s=""){this.data=e,this.name=s,ot.prototype.hasOwnProperty("tree")||Object.defineProperty(ot.prototype,"tree",{get(){return gr(this)}}),this.parser=r,this.extension=[_o.of(this),ot.languageData.of((i,o,a)=>{let l=ZR(i,o,a),c=l.type.prop(al);if(!c)return[];let u=i.facet(c),d=l.type.prop(mve);if(d){let h=l.resolve(o-l.from,a);for(let f of d)if(f.test(h,i)){let v=i.facet(f.facet);return f.type=="replace"?v:v.concat(u)}}return u})].concat(n)}isActiveAt(e,r,n=-1){return ZR(e,r,n).type.prop(al)==this.data}findRegions(e){let r=e.facet(_o);if(r?.data==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let n=[],s=(i,o)=>{if(i.prop(al)==this.data){n.push({from:o,to:o+i.length});return}let a=i.prop(nt.mounted);if(a){if(a.tree.prop(al)==this.data){if(a.overlay)for(let l of a.overlay)n.push({from:l.from+o,to:l.to+o});else n.push({from:o,to:o+i.length});return}else if(a.overlay){let l=n.length;if(s(a.tree,a.overlay[0].from+o),n.length>l)return}}for(let l=0;l<i.children.length;l++){let c=i.children[l];c instanceof Jt&&s(c,i.positions[l]+o)}};return s(gr(e),0),n}get allowsNesting(){return!0}}qn.setState=Qe.define();function ZR(t,e,r){let n=t.facet(_o),s=gr(t).topNode;if(!n||n.allowsNesting)for(let i=s;i;i=i.enter(e,r,Ot.ExcludeBuffers))i.type.isTop&&(s=i);return s}class iw extends qn{constructor(e,r,n){super(e,r,[],n),this.parser=r}static define(e){let r=pve(e.languageData);return new iw(r,e.parser.configure({props:[al.add(n=>n.isTop?r:void 0)]}),e.name)}configure(e,r){return new iw(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function gr(t){let e=t.field(qn.state,!1);return e?e.tree:Jt.empty}class gve{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let n=this.cursorPos-this.string.length;return e<n||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-n,r-n)}}let Mc=null;class Mm{constructor(e,r,n=[],s,i,o,a,l){this.parser=e,this.state=r,this.fragments=n,this.tree=s,this.treeLen=i,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,r,n){return new Mm(e,r,[],Jt.empty,0,n,[],null)}startParse(){return this.parser.startParse(new gve(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=Jt.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(vi.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(vi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=Mc;Mc=this;try{return e()}finally{Mc=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=XR(e,r.from,r.to);return e}changes(e,r){let{fragments:n,tree:s,treeLen:i,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,d,h)=>l.push({fromA:c,toA:u,fromB:d,toB:h})),n=vi.applyChanges(n,l),s=Jt.empty,i=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),d=e.mapPos(c.to,-1);u<d&&a.push({from:u,to:d})}}}return new Mm(this.parser,r,n,s,i,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:s,to:i}=this.skipped[n];s<e.to&&i>e.from&&(this.fragments=XR(this.fragments,s,i),this.skipped.splice(n--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends Zge{createParse(r,n,s){let i=s[0].from,o=s[s.length-1].to;return{parsedPos:i,advance(){let l=Mc;if(l){for(let c of s)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Jt(Qr.none,[],[],o-i)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return Mc}}function XR(t,e,r){return vi.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}class Jl{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,n)||r.takeTree(),new Jl(r)}static init(e){let r=Math.min(3e3,e.doc.length),n=Mm.create(e.facet(_o).parser,e,{from:0,to:r});return n.work(20,r)||n.takeTree(),new Jl(n)}}qn.state=sr.define({create:Jl.init,update(t,e){for(let r of e.effects)if(r.is(qn.setState))return r.value;return e.startState.facet(_o)!=e.state.facet(_o)?Jl.init(e.state):t.apply(e)}});let q5=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(q5=t=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const Xy=typeof navigator<"u"&&(!((Zy=navigator.scheduling)===null||Zy===void 0)&&Zy.isInputPending)?()=>navigator.scheduling.isInputPending():null,vve=nr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(qn.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(qn.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=q5(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:s}}=this.view,i=n.field(qn.state);if(i.tree==i.context.tree&&i.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Xy?Math.max(25,e.timeRemaining()-5):1e9),a=i.context.treeLen<s&&n.doc.length>s+1e3,l=i.context.work(()=>Xy&&Xy()||Date.now()>o,s+(a?0:1e5));this.chunkBudget-=Date.now()-r,(l||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:qn.setState.of(new Jl(i.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>hn(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),_o=je.define({combine(t){return t.length?t[0]:null},enables:t=>[qn.state,vve,Fe.contentAttributes.compute([t],e=>{let r=e.facet(t);return r&&r.name?{"data-language":r.name}:{}})]});class YCe{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}}class lr{constructor(e,r,n,s,i,o=void 0){this.name=e,this.alias=r,this.extensions=n,this.filename=s,this.loadFunc=i,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:r,support:n}=e;if(!r){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");r=()=>Promise.resolve(n)}return new lr(e.name,(e.alias||[]).concat(e.name).map(s=>s.toLowerCase()),e.extensions||[],e.filename,r,n)}static matchFilename(e,r){for(let s of e)if(s.filename&&s.filename.test(r))return s;let n=/\.([^.]+)$/.exec(r);if(n){for(let s of e)if(s.extensions.indexOf(n[1])>-1)return s}return null}static matchLanguageName(e,r,n=!0){r=r.toLowerCase();for(let s of e)if(s.alias.some(i=>i==r))return s;if(n)for(let s of e)for(let i of s.alias){let o=r.indexOf(i);if(o>-1&&(i.length>2||!/\w/.test(r[o-1])&&!/\w/.test(r[o+i.length])))return s}return null}}const yve=je.define(),pc=je.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function Lm(t){let e=t.facet(pc);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Dd(t,e){let r="",n=t.tabSize,s=t.facet(pc)[0];if(s=="	"){for(;e>=n;)r+="	",e-=n;s=" "}for(let i=0;i<e;i++)r+=s;return r}function i1(t,e){t instanceof ot&&(t=new qg(t));for(let n of t.state.facet(yve)){let s=n(t,e);if(s!==void 0)return s}let r=gr(t.state);return r.length>=e?bve(t,r,e):null}class qg{constructor(e,r={}){this.state=e,this.options=r,this.unit=Lm(e)}lineAt(e,r=1){let n=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:i}=this.options;return s!=null&&s>=n.from&&s<=n.to?i&&s==e?{text:"",from:e}:(r<0?s<e:s<=e)?{text:n.text.slice(s-n.from),from:s}:{text:n.text.slice(0,s-n.from),from:n.from}:n}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:s}=this.lineAt(e,r);return n.slice(e-s,Math.min(n.length,e+100-s))}column(e,r=1){let{text:n,from:s}=this.lineAt(e,r),i=this.countColumn(n,e-s),o=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return o>-1&&(i+=o-this.countColumn(n,n.search(/\S|$/))),i}countColumn(e,r=e.length){return Hg(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:n,from:s}=this.lineAt(e,r),i=this.options.overrideIndentation;if(i){let o=i(s);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const _ve=new nt;function bve(t,e,r){let n=e.resolveStack(r),s=e.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(s!=n.node){let i=[];for(let o=s;o&&!(o.from==n.node.from&&o.type==n.node.type);o=o.parent)i.push(o);for(let o=i.length-1;o>=0;o--)n={node:i[o],next:n}}return J5(n,t,r)}function J5(t,e,r){for(let n=t;n;n=n.next){let s=xve(n.node);if(s)return s(o1.create(e,r,n))}return 0}function wve(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function xve(t){let e=t.type.prop(_ve);if(e)return e;let r=t.firstChild,n;if(r&&(n=r.type.prop(nt.closedBy))){let s=t.lastChild,i=s&&n.indexOf(s.name)>-1;return o=>Y5(o,!0,1,void 0,i&&!wve(o)?s.from:void 0)}return t.parent==null?Sve:null}function Sve(){return 0}class o1 extends qg{constructor(e,r,n){super(e.state,e.options),this.base=e,this.pos=r,this.context=n}get node(){return this.context.node}static create(e,r,n){return new o1(e,r,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let r=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(r.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(Eve(n,e))break;r=this.state.doc.lineAt(n.from)}return this.lineIndent(r.from)}continue(){return J5(this.context.next,this.base,this.pos)}}function Eve(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function Cve(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let s=t.options.simulateBreak,i=t.state.doc.lineAt(r.from),o=s==null||s<=i.from?i.to:Math.min(i.to,s);for(let a=r.to;;){let l=e.childAfter(a);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(i.text.slice(r.to-i.from))[0].length;return{from:r.from,to:r.to+c}}a=l.to}}function ZCe({closing:t,align:e=!0,units:r=1}){return n=>Y5(n,e,r,t)}function Y5(t,e,r,n,s){let i=t.textAfter,o=i.match(/^\s*/)[0].length,a=n&&i.slice(o,o+n.length)==n||s==t.pos+o,l=e?Cve(t):null;return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*r)}const XCe=t=>t.baseIndent;function QCe({except:t,units:e=1}={}){return r=>{let n=t&&t.test(r.textAfter);return r.baseIndent+(n?0:e*r.unit)}}const kve=200;function Tve(){return ot.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let r=t.newDoc,{head:n}=t.newSelection.main,s=r.lineAt(n);if(n>s.from+kve)return t;let i=r.sliceString(s.from,n);if(!e.some(c=>c.test(i)))return t;let{state:o}=t,a=-1,l=[];for(let{head:c}of o.selection.ranges){let u=o.doc.lineAt(c);if(u.from==a)continue;a=u.from;let d=i1(o,u.from);if(d==null)continue;let h=/^\s*/.exec(u.text)[0],f=Dd(o,d);h!=f&&l.push({from:u.from,to:u.from+h.length,insert:f})}return l.length?[t,{changes:l,sequential:!0}]:t})}const Ave=je.define(),Rve=new nt;function eke(t){let e=t.firstChild,r=t.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?t.to:r.from}:null}function Pve(t,e,r){let n=gr(t);if(n.length<r)return null;let s=n.resolveStack(r,1),i=null;for(let o=s;o;o=o.next){let a=o.node;if(a.to<=r||a.from>r)continue;if(i&&a.from<e)break;let l=a.type.prop(Rve);if(l&&(a.to<n.length-50||n.length==t.doc.length||!Ive(a))){let c=l(a,t);c&&c.from<=r&&c.from>=e&&c.to>r&&(i=c)}}return i}function Ive(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function QR(t,e,r){for(let n of t.facet(Ave)){let s=n(t,e,r);if(s)return s}return Pve(t,e,r)}function Z5(t,e){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return r>=n?void 0:{from:r,to:n}}const X5=Qe.define({map:Z5}),a1=Qe.define({map:Z5}),Nm=sr.define({create(){return rt.none},update(t,e){t=t.map(e.changes);for(let r of e.effects)if(r.is(X5)&&!Ove(t,r.value.from,r.value.to)){let{preparePlaceholder:n}=e.state.facet(Q5),s=n?rt.replace({widget:new Lve(n(e.state,r.value))}):eP;t=t.update({add:[s.range(r.value.from,r.value.to)]})}else r.is(a1)&&(t=t.update({filter:(n,s)=>r.value.from!=n||r.value.to!=s,filterFrom:r.value.from,filterTo:r.value.to}));if(e.selection){let r=!1,{head:n}=e.selection.main;t.between(n,n,(s,i)=>{s<n&&i>n&&(r=!0)}),r&&(t=t.update({filterFrom:n,filterTo:n,filter:(s,i)=>i<=n||s>=n}))}return t},provide:t=>Fe.decorations.from(t),toJSON(t,e){let r=[];return t.between(0,e.doc.length,(n,s)=>{r.push(n,s)}),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<t.length;){let n=t[r++],s=t[r++];if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(eP.range(n,s))}return rt.set(e,!0)}});function ow(t,e,r){var n;let s=null;return(n=t.field(Nm,!1))===null||n===void 0||n.between(e,r,(i,o)=>{(!s||s.from>i)&&(s={from:i,to:o})}),s}function Ove(t,e,r){let n=!1;return t.between(e,e,(s,i)=>{s==e&&i==r&&(n=!0)}),n}const Dve={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},Q5=je.define({combine(t){return Ra(t,Dve)}});function Mve(t){return[Nm,Fve]}function ej(t,e){let{state:r}=t,n=r.facet(Q5),s=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=ow(t.state,a.from,a.to);l&&t.dispatch({effects:a1.of(l)}),o.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,s,e);let i=document.createElement("span");return i.textContent=n.placeholderText,i.setAttribute("aria-label",r.phrase("folded code")),i.title=r.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=s,i}const eP=rt.replace({widget:new class extends Pa{toDOM(t){return ej(t,null)}}});class Lve extends Pa{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return ej(e,this.value)}}const Nve={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Qy extends Ti{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}}function Bve(t={}){let e=Object.assign(Object.assign({},Nve),t),r=new Qy(e,!0),n=new Qy(e,!1),s=nr.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(_o)!=o.state.facet(_o)||o.startState.field(Nm,!1)!=o.state.field(Nm,!1)||gr(o.startState)!=gr(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new _a;for(let l of o.viewportLineBlocks){let c=ow(o.state,l.from,l.to)?n:QR(o.state,l.from,l.to)?r:null;c&&a.add(l.from,l.from,c)}return a.finish()}}),{domEventHandlers:i}=e;return[s,Dge({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(s))===null||a===void 0?void 0:a.markers)||ut.empty},initialSpacer(){return new Qy(e,!1)},domEventHandlers:Object.assign(Object.assign({},i),{click:(o,a,l)=>{if(i.click&&i.click(o,a,l))return!0;let c=ow(o.state,a.from,a.to);if(c)return o.dispatch({effects:a1.of(c)}),!0;let u=QR(o.state,a.from,a.to);return u?(o.dispatch({effects:X5.of(u)}),!0):!1}})}),Mve()]}const Fve=Fe.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Jg{constructor(e,r){this.specs=e;let n;function s(a){let l=mo.newName();return(n||(n=Object.create(null)))["."+l]=a,l}const i=typeof r.all=="string"?r.all:r.all?s(r.all):void 0,o=r.scope;this.scope=o instanceof qn?a=>a.prop(al)==o.data:o?a=>a==o:void 0,this.style=K5(e.map(a=>({tag:a.tag,class:a.class||s(Object.assign({},a,{tag:null}))})),{all:i}).style,this.module=n?new mo(n):null,this.themeType=r.themeType}static define(e,r){return new Jg(e,r||{})}}const aw=je.define(),jve=je.define({combine(t){return t.length?[t[0]]:null}});function e0(t){let e=t.facet(aw);return e.length?e:t.facet(jve)}function $ve(t,e){let r=[Hve],n;return t instanceof Jg&&(t.module&&r.push(Fe.styleModule.of(t.module)),n=t.themeType),n?r.push(aw.computeN([Fe.darkTheme],s=>s.facet(Fe.darkTheme)==(n=="dark")?[t]:[])):r.push(aw.of(t)),r}class Uve{constructor(e){this.markCache=Object.create(null),this.tree=gr(e.state),this.decorations=this.buildDeco(e,e0(e.state)),this.decoratedTo=e.viewport.to}update(e){let r=gr(e.state),n=e0(e.state),s=n!=e0(e.startState),{viewport:i}=e.view,o=e.changes.mapPos(this.decoratedTo,1);r.length<i.to&&!s&&r.type==this.tree.type&&o>=i.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(r!=this.tree||e.viewportChanged||s)&&(this.tree=r,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=i.to)}buildDeco(e,r){if(!r||!this.tree.length)return rt.none;let n=new _a;for(let{from:s,to:i}of e.visibleRanges)dve(this.tree,r,(o,a,l)=>{n.add(o,a,this.markCache[l]||(this.markCache[l]=rt.mark({class:l})))},s,i);return n.finish()}}const Hve=Eo.high(nr.fromClass(Uve,{decorations:t=>t.decorations})),Vve=Fe.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),tj=1e4,rj="()[]{}",nj=je.define({combine(t){return Ra(t,{afterCursor:!0,brackets:rj,maxScanDistance:tj,renderMatch:Wve})}}),Gve=rt.mark({class:"cm-matchingBracket"}),zve=rt.mark({class:"cm-nonmatchingBracket"});function Wve(t){let e=[],r=t.matched?Gve:zve;return e.push(r.range(t.start.from,t.start.to)),t.end&&e.push(r.range(t.end.from,t.end.to)),e}const Kve=sr.define({create(){return rt.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let r=[],n=e.state.facet(nj);for(let s of e.state.selection.ranges){if(!s.empty)continue;let i=Ts(e.state,s.head,-1,n)||s.head>0&&Ts(e.state,s.head-1,1,n)||n.afterCursor&&(Ts(e.state,s.head,1,n)||s.head<e.state.doc.length&&Ts(e.state,s.head+1,-1,n));i&&(r=r.concat(n.renderMatch(i,e.state)))}return rt.set(r,!0)},provide:t=>Fe.decorations.from(t)}),qve=[Kve,Vve];function Jve(t={}){return[nj.of(t),qve]}const Yve=new nt;function lw(t,e,r){let n=t.prop(e<0?nt.openedBy:nt.closedBy);if(n)return n;if(t.name.length==1){let s=r.indexOf(t.name);if(s>-1&&s%2==(e<0?1:0))return[r[s+e]]}return null}function cw(t){let e=t.type.prop(Yve);return e?e(t.node):t}function Ts(t,e,r,n={}){let s=n.maxScanDistance||tj,i=n.brackets||rj,o=gr(t),a=o.resolveInner(e,r);for(let l=a;l;l=l.parent){let c=lw(l.type,r,i);if(c&&l.from<l.to){let u=cw(l);if(u&&(r>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return Zve(t,e,r,l,u,c,i)}}return Xve(t,e,r,o,a.type,s,i)}function Zve(t,e,r,n,s,i,o){let a=n.parent,l={from:s.from,to:s.to},c=0,u=a?.cursor();if(u&&(r<0?u.childBefore(n.from):u.childAfter(n.to)))do if(r<0?u.to<=n.from:u.from>=n.to){if(c==0&&i.indexOf(u.type.name)>-1&&u.from<u.to){let d=cw(u);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(lw(u.type,r,o))c++;else if(lw(u.type,-r,o)){if(c==0){let d=cw(u);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}c--}}while(r<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function Xve(t,e,r,n,s,i,o){let a=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=r>0)return null;let c={from:r<0?e-1:e,to:r>0?e+1:e},u=t.doc.iterRange(e,r>0?t.doc.length:0),d=0;for(let h=0;!u.next().done&&h<=i;){let f=u.value;r<0&&(h+=f.length);let v=e+h*r;for(let m=r>0?0:f.length-1,p=r>0?f.length:-1;m!=p;m+=r){let g=o.indexOf(f[m]);if(!(g<0||n.resolveInner(v+m,1).type!=s))if(g%2==0==r>0)d++;else{if(d==1)return{start:c,end:{from:v+m,to:v+m+1},matched:g>>1==l>>1};d--}}r>0&&(h+=f.length)}return u.done?{start:c,matched:!1}:null}const Qve=Object.create(null),tP=[Qr.none],rP=[],nP=Object.create(null),eye=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])eye[t]=tye(Qve,e);function t0(t,e){rP.indexOf(t)>-1||(rP.push(t),console.warn(e))}function tye(t,e){let r=[];for(let a of e.split(" ")){let l=[];for(let c of a.split(".")){let u=t[c]||ve[c];u?typeof u=="function"?l.length?l=l.map(u):t0(c,`Modifier ${c} used at start of tag`):l.length?t0(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:t0(c,`Unknown highlighting tag ${c}`)}for(let c of l)r.push(c)}if(!r.length)return 0;let n=e.replace(/ /g,"_"),s=n+" "+r.map(a=>a.id),i=nP[s];if(i)return i.id;let o=nP[s]=Qr.define({id:tP.length,name:n,props:[cve({[n]:r})]});return tP.push(o),o.id}At.RTL,At.LTR;class sj{constructor(e,r,n,s){this.state=e,this.pos=r,this.explicit=n,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let r=gr(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),n=Math.max(r.from,this.pos-250),s=r.text.slice(n-r.from,this.pos-r.from),i=s.search(ij(e,!1));return i<0?null:{from:n+i,to:this.pos,text:s.slice(i)}}get aborted(){return this.abortListeners==null}addEventListener(e,r,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(r),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function sP(t){let e=Object.keys(t).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function rye(t){let e=Object.create(null),r=Object.create(null);for(let{label:s}of t){e[s[0]]=!0;for(let i=1;i<s.length;i++)r[s[i]]=!0}let n=sP(e)+sP(r)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function nye(t){let e=t.map(s=>typeof s=="string"?{label:s}:s),[r,n]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:rye(e);return s=>{let i=s.matchBefore(n);return i||s.explicit?{from:i?i.from:s.pos,options:e,validFor:r}:null}}function tke(t,e){return r=>{for(let n=gr(r.state).resolveInner(r.pos,-1);n;n=n.parent){if(t.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(r)}}class iP{constructor(e,r,n,s){this.completion=e,this.source=r,this.match=n,this.score=s}}function aa(t){return t.selection.main.from}function ij(t,e){var r;let{source:n}=t,s=e&&n[0]!="^",i=n[n.length-1]!="$";return!s&&!i?t:new RegExp(`${s?"^":""}(?:${n})${i?"$":""}`,(r=t.flags)!==null&&r!==void 0?r:t.ignoreCase?"i":"")}const l1=Ai.define();function sye(t,e,r,n){let{main:s}=t.selection,i=r-s.from,o=n-s.from;return Object.assign(Object.assign({},t.changeByRange(a=>{if(a!=s&&r!=n&&t.sliceDoc(a.from+i,a.from+o)!=t.sliceDoc(r,n))return{range:a};let l=t.toText(e);return{changes:{from:a.from+i,to:n==s.from?a.to:a.from+o,insert:l},range:xe.cursor(a.from+i+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const oP=new WeakMap;function iye(t){if(!Array.isArray(t))return t;let e=oP.get(t);return e||oP.set(t,e=nye(t)),e}const Bm=Qe.define(),Md=Qe.define();class oye{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let r=0;r<e.length;){let n=Wn(e,r),s=li(n);this.chars.push(n);let i=e.slice(r,r+s),o=i.toUpperCase();this.folded.push(Wn(o==i?i.toLowerCase():o,0)),r+=s}this.astral=e.length!=this.chars.length}ret(e,r){return this.score=e,this.matched=r,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:r,folded:n,any:s,precise:i,byWord:o}=this;if(r.length==1){let y=Wn(e,0),_=li(y),b=_==e.length?0:-100;if(y!=r[0])if(y==n[0])b+=-200;else return null;return this.ret(b,[0,_])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=r.length,c=0;if(a<0){for(let y=0,_=Math.min(e.length,200);y<_&&c<l;){let b=Wn(e,y);(b==r[c]||b==n[c])&&(s[c++]=y),y+=li(b)}if(c<l)return null}let u=0,d=0,h=!1,f=0,v=-1,m=-1,p=/[a-z]/.test(e),g=!0;for(let y=0,_=Math.min(e.length,200),b=0;y<_&&d<l;){let w=Wn(e,y);a<0&&(u<l&&w==r[u]&&(i[u++]=y),f<l&&(w==r[f]||w==n[f]?(f==0&&(v=y),m=y+1,f++):f=0));let E,S=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(E=HS(w))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!y||S==1&&p||b==0&&S!=0)&&(r[d]==w||n[d]==w&&(h=!0)?o[d++]=y:o.length&&(g=!1)),b=S,y+=li(w)}return d==l&&o[0]==0&&g?this.result(-100+(h?-200:0),o,e):f==l&&v==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):f==l?this.ret(-900-e.length,[v,m]):d==l?this.result(-100+(h?-200:0)+-700+(g?0:-1100),o,e):r.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,r,n){let s=[],i=0;for(let o of r){let a=o+(this.astral?li(Wn(n,o)):1);i&&s[i-1]==o?s[i-1]=a:(s[i++]=o,s[i++]=a)}return this.ret(e-n.length,s)}}class aye{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let r=e.slice(0,this.pattern.length),n=r==this.pattern?0:r.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,r.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const er=je.define({combine(t){return Ra(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:lye,filterStrict:!1,compareCompletions:(e,r)=>e.label.localeCompare(r.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>n=>aP(e(n),r(n)),optionClass:(e,r)=>n=>aP(e(n),r(n)),addToOptions:(e,r)=>e.concat(r),filterStrict:(e,r)=>e||r})}});function aP(t,e){return t?e?t+" "+e:t:e}function lye(t,e,r,n,s,i){let o=t.textDirection==At.RTL,a=o,l=!1,c="top",u,d,h=e.left-s.left,f=s.right-e.right,v=n.right-n.left,m=n.bottom-n.top;if(a&&h<Math.min(v,f)?a=!1:!a&&f<Math.min(v,h)&&(a=!0),v<=(a?h:f))u=Math.max(s.top,Math.min(r.top,s.bottom-m))-e.top,d=Math.min(400,a?h:f);else{l=!0,d=Math.min(400,(o?e.right:s.right-e.left)-30);let y=s.bottom-e.bottom;y>=m||y>e.top?u=r.bottom-e.top:(c="bottom",u=e.bottom-r.top)}let p=(e.bottom-e.top)/i.offsetHeight,g=(e.right-e.left)/i.offsetWidth;return{style:`${c}: ${u/p}px; max-width: ${d/g}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function cye(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(r){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),r.type&&n.classList.add(...r.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(r,n,s,i){let o=document.createElement("span");o.className="cm-completionLabel";let a=r.displayLabel||r.label,l=0;for(let c=0;c<i.length;){let u=i[c++],d=i[c++];u>l&&o.appendChild(document.createTextNode(a.slice(l,u)));let h=o.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(a.slice(u,d))),h.className="cm-completionMatchedText",l=d}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(r){if(!r.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=r.detail,n},position:80}),e.sort((r,n)=>r.position-n.position).map(r=>r.render)}function r0(t,e,r){if(t<=r)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let s=Math.floor(e/r);return{from:s*r,to:(s+1)*r}}let n=Math.floor((t-e)/r);return{from:t-(n+1)*r,to:t-n*r}}class uye{constructor(e,r,n){this.view=e,this.stateField=r,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let s=e.state.field(r),{options:i,selected:o}=s.open,a=e.state.facet(er);this.optionContent=cye(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=r0(i.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(r).open;for(let u=l.target,d;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(d=/-(\d+)$/.exec(u.id))&&+d[1]<c.length){this.applyCompletion(e,c[+d[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(er).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Md.of(null)})}),this.showOptions(i,s.id)}mount(){this.updateSel()}showOptions(e,r){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,r,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var r;let n=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=s){let{options:i,selected:o,disabled:a}=n.open;(!s.open||s.open.options!=i)&&(this.range=r0(i.length,o,e.state.facet(er).maxRenderedOptions),this.showOptions(i,n.id)),this.updateSel(),a!=((r=s.open)===null||r===void 0?void 0:r.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of r.split(" "))n&&this.dom.classList.add(n);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;if((r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=r0(r.options.length,r.selected,this.view.state.facet(er).maxRenderedOptions),this.showOptions(r.options,e.id)),this.updateSelectedOption(r.selected)){this.destroyInfo();let{completion:n}=r.options[r.selected],{info:s}=n;if(!s)return;let i=typeof s=="string"?document.createTextNode(s):s(n);if(!i)return;"then"in i?i.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>hn(this.view.state,o,"completion info")):this.addInfoPane(i,n)}}addInfoPane(e,r){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:i}=e;n.appendChild(s),this.infoDestroy=i||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let n=this.list.firstChild,s=this.range.from;n;n=n.nextSibling,s++)n.nodeName!="LI"||!n.id?s--:s==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),r=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return r&&hye(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),i=this.space;if(!i){let o=this.dom.ownerDocument.documentElement;i={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return s.top>Math.min(i.bottom,r.bottom)-10||s.bottom<Math.max(i.top,r.top)+10?null:this.view.state.facet(er).positionInfo(this.view,r,s,n,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,n){const s=document.createElement("ul");s.id=r,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions")),s.addEventListener("mousedown",o=>{o.target==s&&o.preventDefault()});let i=null;for(let o=n.from;o<n.to;o++){let{completion:a,match:l}=e[o],{section:c}=a;if(c){let h=typeof c=="string"?c:c.name;if(h!=i&&(o>n.from||n.from==0))if(i=h,typeof c!="string"&&c.header)s.appendChild(c.header(c));else{let f=s.appendChild(document.createElement("completion-section"));f.textContent=h}}const u=s.appendChild(document.createElement("li"));u.id=r+"-"+o,u.setAttribute("role","option");let d=this.optionClass(a);d&&(u.className=d);for(let h of this.optionContent){let f=h(a,this.view.state,this.view,l);f&&u.appendChild(f)}}return n.from&&s.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function dye(t,e){return r=>new uye(r,t,e)}function hye(t,e){let r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=r.height/t.offsetHeight;n.top<r.top?t.scrollTop-=(r.top-n.top)/s:n.bottom>r.bottom&&(t.scrollTop+=(n.bottom-r.bottom)/s)}function lP(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function fye(t,e){let r=[],n=null,s=c=>{r.push(c);let{section:u}=c.completion;if(u){n||(n=[]);let d=typeof u=="string"?u:u.name;n.some(h=>h.name==d)||n.push(typeof u=="string"?{name:d}:u)}},i=e.facet(er);for(let c of t)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let d of c.result.options)s(new iP(d,c.source,u?u(d):[],1e9-r.length));else{let d=e.sliceDoc(c.from,c.to),h,f=i.filterStrict?new aye(d):new oye(d);for(let v of c.result.options)if(h=f.match(v.label)){let m=v.displayLabel?u?u(v,h.matched):[]:h.matched;s(new iP(v,c.source,m,h.score+(v.boost||0)))}}}if(n){let c=Object.create(null),u=0,d=(h,f)=>{var v,m;return((v=h.rank)!==null&&v!==void 0?v:1e9)-((m=f.rank)!==null&&m!==void 0?m:1e9)||(h.name<f.name?-1:1)};for(let h of n.sort(d))u-=1e5,c[h.name]=u;for(let h of r){let{section:f}=h.completion;f&&(h.score+=c[typeof f=="string"?f:f.name])}}let o=[],a=null,l=i.compareCompletions;for(let c of r.sort((u,d)=>d.score-u.score||l(u.completion,d.completion))){let u=c.completion;!a||a.label!=u.label||a.detail!=u.detail||a.type!=null&&u.type!=null&&a.type!=u.type||a.apply!=u.apply||a.boost!=u.boost?o.push(c):lP(c.completion)>lP(a)&&(o[o.length-1]=c),a=c.completion}return o}class ll{constructor(e,r,n,s,i,o){this.options=e,this.attrs=r,this.tooltip=n,this.timestamp=s,this.selected=i,this.disabled=o}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new ll(this.options,cP(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,n,s,i,o){if(s&&!o&&e.some(c=>c.isPending))return s.setDisabled();let a=fye(e,r);if(!a.length)return s&&e.some(c=>c.isPending)?s.setDisabled():null;let l=r.facet(er).selectOnOpen?0:-1;if(s&&s.selected!=l&&s.selected!=-1){let c=s.options[s.selected].completion;for(let u=0;u<a.length;u++)if(a[u].completion==c){l=u;break}}return new ll(a,cP(n,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:_ye,above:i.aboveCursor},s?s.timestamp:Date.now(),l,!1)}map(e){return new ll(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ll(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Fm{constructor(e,r,n){this.active=e,this.id=r,this.open=n}static start(){return new Fm(vye,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,n=r.facet(er),i=(n.override||r.languageDataAt("autocomplete",aa(r)).map(iye)).map(l=>(this.active.find(u=>u.source==l)||new Dn(l,this.active.some(u=>u.state!=0)?1:0)).update(e,n));i.length==this.active.length&&i.every((l,c)=>l==this.active[c])&&(i=this.active);let o=this.open,a=e.effects.some(l=>l.is(c1));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||i.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!pye(i,this.active)||a?o=ll.build(i,r,this.id,o,n,a):o&&o.disabled&&!i.some(l=>l.isPending)&&(o=null),!o&&i.every(l=>!l.isPending)&&i.some(l=>l.hasResult())&&(i=i.map(l=>l.hasResult()?new Dn(l.source,0):l));for(let l of e.effects)l.is(aj)&&(o=o&&o.setSelected(l.value,this.id));return i==this.active&&o==this.open?this:new Fm(i,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?mye:gye}}function pye(t,e){if(t==e)return!0;for(let r=0,n=0;;){for(;r<t.length&&!t[r].hasResult();)r++;for(;n<e.length&&!e[n].hasResult();)n++;let s=r==t.length,i=n==e.length;if(s||i)return s==i;if(t[r++].result!=e[n++].result)return!1}}const mye={"aria-autocomplete":"list"},gye={};function cP(t,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(r["aria-activedescendant"]=t+"-"+e),r}const vye=[];function oj(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(l1);if(n&&e.activateOnCompletion(n))return 12}let r=t.isUserEvent("input.type");return r&&e.activateOnTyping?5:r?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class Dn{constructor(e,r,n=!1){this.source=e,this.state=r,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,r){let n=oj(e,r),s=this;(n&8||n&16&&this.touches(e))&&(s=new Dn(s.source,0)),n&4&&s.state==0&&(s=new Dn(this.source,1)),s=s.updateFor(e,n);for(let i of e.effects)if(i.is(Bm))s=new Dn(s.source,1,i.value);else if(i.is(Md))s=new Dn(s.source,0);else if(i.is(c1))for(let o of i.value)o.source==s.source&&(s=o);return s}updateFor(e,r){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(aa(e.state))}}class xl extends Dn{constructor(e,r,n,s,i,o){super(e,3,r),this.limit=n,this.result=s,this.from=i,this.to=o}hasResult(){return!0}updateFor(e,r){var n;if(!(r&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let i=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=aa(e.state);if(a>o||!s||r&2&&(aa(e.startState)==this.from||a<this.limit))return new Dn(this.source,r&4?1:0);let l=e.changes.mapPos(this.limit);return yye(s.validFor,e.state,i,o)?new xl(this.source,this.explicit,l,s,i,o):s.update&&(s=s.update(s,i,o,new sj(e.state,a,!1)))?new xl(this.source,this.explicit,l,s,s.from,(n=s.to)!==null&&n!==void 0?n:aa(e.state)):new Dn(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new xl(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Dn(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function yye(t,e,r,n){if(!t)return!1;let s=e.sliceDoc(r,n);return typeof t=="function"?t(s,r,n,e):ij(t,!0).test(s)}const c1=Qe.define({map(t,e){return t.map(r=>r.map(e))}}),aj=Qe.define(),Jr=sr.define({create(){return Fm.start()},update(t,e){return t.update(e)},provide:t=>[t1.from(t,e=>e.tooltip),Fe.contentAttributes.from(t,e=>e.attrs)]});function u1(t,e){const r=e.completion.apply||e.completion.label;let n=t.state.field(Jr).active.find(s=>s.source==e.source);return n instanceof xl?(typeof r=="string"?t.dispatch(Object.assign(Object.assign({},sye(t.state,r,n.from,n.to)),{annotations:l1.of(e.completion)})):r(t,e.completion,n.from,n.to),!0):!1}const _ye=dye(Jr,u1);function bf(t,e="option"){return r=>{let n=r.state.field(Jr,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(er).interactionDelay)return!1;let s=1,i;e=="page"&&(i=F5(r,n.open.tooltip))&&(s=Math.max(2,Math.floor(i.dom.offsetHeight/i.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,a=n.open.selected>-1?n.open.selected+s*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),r.dispatch({effects:aj.of(a)}),!0}}const lj=t=>{let e=t.state.field(Jr,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(er).interactionDelay?!1:u1(t,e.open.options[e.open.selected])},uP=t=>t.state.field(Jr,!1)?(t.dispatch({effects:Bm.of(!0)}),!0):!1,bye=t=>{let e=t.state.field(Jr,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(t.dispatch({effects:Md.of(null)}),!0)};class wye{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}}const xye=50,Sye=1e3,Eye=nr.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(Jr).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(Jr),r=t.state.facet(er);if(!t.selectionSet&&!t.docChanged&&t.startState.field(Jr)==e)return;let n=t.transactions.some(i=>{let o=oj(i,r);return o&8||(i.selection||i.docChanged)&&!(o&3)});for(let i=0;i<this.running.length;i++){let o=this.running[i];if(n||o.context.abortOnDocChange&&t.docChanged||o.updates.length+t.transactions.length>xye&&Date.now()-o.time>Sye){for(let a of o.context.abortListeners)try{a()}catch(l){hn(this.view.state,l)}o.context.abortListeners=null,this.running.splice(i--,1)}else o.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(i=>i.effects.some(o=>o.is(Bm)))&&(this.pendingStart=!0);let s=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(i=>i.isPending&&!this.running.some(o=>o.active.source==i.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let i of t.transactions)i.isUserEvent("input.type")?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(Jr);for(let r of e.active)r.isPending&&!this.running.some(n=>n.active.source==r.source)&&this.startQuery(r);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(er).updateSyncTime))}startQuery(t){let{state:e}=this.view,r=aa(e),n=new sj(e,r,t.explicit,this.view),s=new wye(t,n);this.running.push(s),Promise.resolve(t.source(n)).then(i=>{s.context.aborted||(s.done=i||null,this.scheduleAccept())},i=>{this.view.dispatch({effects:Md.of(null)}),hn(this.view.state,i)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(er).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(er),n=this.view.state.field(Jr);for(let s=0;s<this.running.length;s++){let i=this.running[s];if(i.done===void 0)continue;if(this.running.splice(s--,1),i.done){let a=aa(i.updates.length?i.updates[0].startState:this.view.state),l=Math.min(a,i.done.from+(i.active.explicit?0:1)),c=new xl(i.active.source,i.active.explicit,l,i.done,i.done.from,(t=i.done.to)!==null&&t!==void 0?t:a);for(let u of i.updates)c=c.update(u,r);if(c.hasResult()){e.push(c);continue}}let o=n.active.find(a=>a.source==i.active.source);if(o&&o.isPending)if(i.done==null){let a=new Dn(i.active.source,0);for(let l of i.updates)a=a.update(l,r);a.isPending||e.push(a)}else this.startQuery(o)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:c1.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(Jr,!1);if(e&&e.tooltip&&this.view.state.facet(er).closeOnBlur){let r=e.open&&F5(this.view,e.open.tooltip);(!r||!r.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Md.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Bm.of(!1)}),20),this.composing=0}}}),Cye=typeof navigator=="object"&&/Win/.test(navigator.platform),kye=Eo.highest(Fe.domEventHandlers({keydown(t,e){let r=e.state.field(Jr,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||t.key.length>1||t.ctrlKey&&!(Cye&&t.altKey)||t.metaKey)return!1;let n=r.open.options[r.open.selected],s=r.active.find(o=>o.source==n.source),i=n.completion.commitCharacters||s.result.commitCharacters;return i&&i.indexOf(t.key)>-1&&u1(e,n),!1}})),cj=Fe.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Tye{constructor(e,r,n,s){this.field=e,this.line=r,this.from=n,this.to=s}}class d1{constructor(e,r,n){this.field=e,this.from=r,this.to=n}map(e){let r=e.mapPos(this.from,-1,kr.TrackDel),n=e.mapPos(this.to,1,kr.TrackDel);return r==null||n==null?null:new d1(this.field,r,n)}}class h1{constructor(e,r){this.lines=e,this.fieldPositions=r}instantiate(e,r){let n=[],s=[r],i=e.doc.lineAt(r),o=/^\s*/.exec(i.text)[0];for(let l of this.lines){if(n.length){let c=o,u=/^\t*/.exec(l)[0].length;for(let d=0;d<u;d++)c+=e.facet(pc);s.push(r+c.length-u),l=c+l.slice(u)}n.push(l),r+=l.length+1}let a=this.fieldPositions.map(l=>new d1(l.field,s[l.line]+l.from,s[l.line]+l.to));return{text:n,ranges:a}}static parse(e){let r=[],n=[],s=[],i;for(let o of e.split(/\r\n?|\n/)){for(;i=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let a=i[1]?+i[1]:null,l=i[2]||i[3]||"",c=-1,u=l.replace(/\\[{}]/g,d=>d[1]);for(let d=0;d<r.length;d++)(a!=null?r[d].seq==a:u&&r[d].name==u)&&(c=d);if(c<0){let d=0;for(;d<r.length&&(a==null||r[d].seq!=null&&r[d].seq<a);)d++;r.splice(d,0,{seq:a,name:u}),c=d;for(let h of s)h.field>=c&&h.field++}s.push(new Tye(c,n.length,i.index,i.index+u.length)),o=o.slice(0,i.index)+l+o.slice(i.index+i[0].length)}o=o.replace(/\\([{}])/g,(a,l,c)=>{for(let u of s)u.line==n.length&&u.from>c&&(u.from--,u.to--);return l}),n.push(o)}return new h1(n,s)}}let Aye=rt.widget({widget:new class extends Pa{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),Rye=rt.mark({class:"cm-snippetField"});class mc{constructor(e,r){this.ranges=e,this.active=r,this.deco=rt.set(e.map(n=>(n.from==n.to?Aye:Rye).range(n.from,n.to)))}map(e){let r=[];for(let n of this.ranges){let s=n.map(e);if(!s)return null;r.push(s)}return new mc(r,this.active)}selectionInsideField(e){return e.ranges.every(r=>this.ranges.some(n=>n.field==this.active&&n.from<=r.from&&n.to>=r.to))}}const ch=Qe.define({map(t,e){return t&&t.map(e)}}),Pye=Qe.define(),Ld=sr.define({create(){return null},update(t,e){for(let r of e.effects){if(r.is(ch))return r.value;if(r.is(Pye)&&t)return new mc(t.ranges,r.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Fe.decorations.from(t,e=>e?e.deco:rt.none)});function f1(t,e){return xe.create(t.filter(r=>r.field==e).map(r=>xe.range(r.from,r.to)))}function Iye(t){let e=h1.parse(t);return(r,n,s,i)=>{let{text:o,ranges:a}=e.instantiate(r.state,s),{main:l}=r.state.selection,c={changes:{from:s,to:i==l.from?l.to:i,insert:ht.of(o)},scrollIntoView:!0,annotations:n?[l1.of(n),Gt.userEvent.of("input.complete")]:void 0};if(a.length&&(c.selection=f1(a,0)),a.some(u=>u.field>0)){let u=new mc(a,0),d=c.effects=[ch.of(u)];r.state.field(Ld,!1)===void 0&&d.push(Qe.appendConfig.of([Ld,Nye,Bye,cj]))}r.dispatch(r.state.update(c))}}function uj(t){return({state:e,dispatch:r})=>{let n=e.field(Ld,!1);if(!n||t<0&&n.active==0)return!1;let s=n.active+t,i=t>0&&!n.ranges.some(o=>o.field==s+t);return r(e.update({selection:f1(n.ranges,s),effects:ch.of(i?null:new mc(n.ranges,s)),scrollIntoView:!0})),!0}}const Oye=({state:t,dispatch:e})=>t.field(Ld,!1)?(e(t.update({effects:ch.of(null)})),!0):!1,Dye=uj(1),Mye=uj(-1),Lye=[{key:"Tab",run:Dye,shift:Mye},{key:"Escape",run:Oye}],dP=je.define({combine(t){return t.length?t[0]:Lye}}),Nye=Eo.highest(Kg.compute([dP],t=>t.facet(dP)));function rke(t,e){return Object.assign(Object.assign({},e),{apply:Iye(t)})}const Bye=Fe.domEventHandlers({mousedown(t,e){let r=e.state.field(Ld,!1),n;if(!r||(n=e.posAtCoords({x:t.clientX,y:t.clientY}))==null)return!1;let s=r.ranges.find(i=>i.from<=n&&i.to>=n);return!s||s.field==r.active?!1:(e.dispatch({selection:f1(r.ranges,s.field),effects:ch.of(r.ranges.some(i=>i.field>s.field)?new mc(r.ranges,s.field):null),scrollIntoView:!0}),!0)}}),jm={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Xo=Qe.define({map(t,e){let r=e.mapPos(t,-1,kr.TrackAfter);return r??void 0}}),p1=new class extends ya{};p1.startSide=1;p1.endSide=-1;const dj=sr.define({create(){return ut.empty},update(t,e){if(t=t.map(e.changes),e.selection){let r=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:n=>n>=r.from&&n<=r.to})}for(let r of e.effects)r.is(Xo)&&(t=t.update({add:[p1.range(r.value,r.value+1)]}));return t}});function Fye(){return[Hye,dj]}const n0="()[]{}<>«»»«［］｛｝";function jye(t){for(let e=0;e<n0.length;e+=2)if(n0.charCodeAt(e)==t)return n0.charAt(e+1);return HS(t<128?t:t+1)}function $ye(t,e){return t.languageDataAt("closeBrackets",e)[0]||jm}const Uye=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Hye=Fe.inputHandler.of((t,e,r,n)=>{if((Uye?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let s=t.state.selection.main;if(n.length>2||n.length==2&&li(Wn(n,0))==1||e!=s.from||r!=s.to)return!1;let i=Vye(t.state,n);return i?(t.dispatch(i),!0):!1});function Vye(t,e){let r=$ye(t,t.selection.main.head),n=r.brackets||jm.brackets;for(let s of n){let i=jye(Wn(s,0));if(e==s)return i==s?Wye(t,s,n.indexOf(s+s+s)>-1,r):Gye(t,s,i,r.before||jm.before);if(e==i&&hj(t,t.selection.main.from))return zye(t,s,i)}return null}function hj(t,e){let r=!1;return t.field(dj).between(0,t.doc.length,n=>{n==e&&(r=!0)}),r}function m1(t,e){let r=t.sliceString(e,e+2);return r.slice(0,li(Wn(r,0)))}function Gye(t,e,r,n){let s=null,i=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:r,from:o.to}],effects:Xo.of(o.to+e.length),range:xe.range(o.anchor+e.length,o.head+e.length)};let a=m1(t.doc,o.head);return!a||/\s/.test(a)||n.indexOf(a)>-1?{changes:{insert:e+r,from:o.head},effects:Xo.of(o.head+e.length),range:xe.cursor(o.head+e.length)}:{range:s=o}});return s?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function zye(t,e,r){let n=null,s=t.changeByRange(i=>i.empty&&m1(t.doc,i.head)==r?{changes:{from:i.head,to:i.head+r.length,insert:r},range:xe.cursor(i.head+r.length)}:n={range:i});return n?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Wye(t,e,r,n){let s=n.stringPrefixes||jm.stringPrefixes,i=null,o=t.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:e,from:a.to}],effects:Xo.of(a.to+e.length),range:xe.range(a.anchor+e.length,a.head+e.length)};let l=a.head,c=m1(t.doc,l),u;if(c==e){if(hP(t,l))return{changes:{insert:e+e,from:l},effects:Xo.of(l+e.length),range:xe.cursor(l+e.length)};if(hj(t,l)){let h=r&&t.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+h.length,insert:h},range:xe.cursor(l+h.length)}}}else{if(r&&t.sliceDoc(l-2*e.length,l)==e+e&&(u=fP(t,l-2*e.length,s))>-1&&hP(t,u))return{changes:{insert:e+e+e+e,from:l},effects:Xo.of(l+e.length),range:xe.cursor(l+e.length)};if(t.charCategorizer(l)(c)!=zt.Word&&fP(t,l,s)>-1&&!Kye(t,l,e,s))return{changes:{insert:e+e,from:l},effects:Xo.of(l+e.length),range:xe.cursor(l+e.length)}}return{range:i=a}});return i?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function hP(t,e){let r=gr(t).resolveInner(e+1);return r.parent&&r.from==e}function Kye(t,e,r,n){let s=gr(t).resolveInner(e,-1),i=n.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=t.sliceDoc(s.from,Math.min(s.to,s.from+r.length+i)),l=a.indexOf(r);if(!l||l>-1&&n.indexOf(a.slice(0,l))>-1){let u=s.firstChild;for(;u&&u.from==s.from&&u.to-u.from>r.length+l;){if(t.sliceDoc(u.to-r.length,u.to)==r)return!1;u=u.firstChild}return!0}let c=s.to==e&&s.parent;if(!c)break;s=c}return!1}function fP(t,e,r){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=zt.Word)return e;for(let s of r){let i=e-s.length;if(t.sliceDoc(i,e)==s&&n(t.sliceDoc(i-1,i))!=zt.Word)return i}return-1}function qye(t={}){return[kye,Jr,er.of(t),Eye,Yye,cj]}const Jye=[{key:"Ctrl-Space",run:uP},{mac:"Alt-`",run:uP},{key:"Escape",run:bye},{key:"ArrowDown",run:bf(!0)},{key:"ArrowUp",run:bf(!1)},{key:"PageDown",run:bf(!0,"page")},{key:"PageUp",run:bf(!1,"page")},{key:"Enter",run:lj}],Yye=Eo.highest(Kg.computeN([er],t=>t.facet(er).defaultKeymap?[Jye]:[])),Zye=t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=v1(t.state,r.from);return n.line?Xye(t):n.block?e0e(t):!1};function g1(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let s=t(e,r);return s?(n(r.update(s)),!0):!1}}const Xye=g1(n0e,0),Qye=g1(fj,0),e0e=g1((t,e)=>fj(t,e,r0e(e)),0);function v1(t,e){let r=t.languageDataAt("commentTokens",e);return r.length?r[0]:{}}const Lc=50;function t0e(t,{open:e,close:r},n,s){let i=t.sliceDoc(n-Lc,n),o=t.sliceDoc(s,s+Lc),a=/\s*$/.exec(i)[0].length,l=/^\s*/.exec(o)[0].length,c=i.length-a;if(i.slice(c-e.length,c)==e&&o.slice(l,l+r.length)==r)return{open:{pos:n-a,margin:a&&1},close:{pos:s+l,margin:l&&1}};let u,d;s-n<=2*Lc?u=d=t.sliceDoc(n,s):(u=t.sliceDoc(n,n+Lc),d=t.sliceDoc(s-Lc,s));let h=/^\s*/.exec(u)[0].length,f=/\s*$/.exec(d)[0].length,v=d.length-f-r.length;return u.slice(h,h+e.length)==e&&d.slice(v,v+r.length)==r?{open:{pos:n+h+e.length,margin:/\s/.test(u.charAt(h+e.length))?1:0},close:{pos:s-f-r.length,margin:/\s/.test(d.charAt(v-1))?1:0}}:null}function r0e(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),s=r.to<=n.to?n:t.doc.lineAt(r.to);s.from>n.from&&s.from==r.to&&(s=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let i=e.length-1;i>=0&&e[i].to>n.from?e[i].to=s.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return e}function fj(t,e,r=e.selection.ranges){let n=r.map(i=>v1(e,i.from).block);if(!n.every(i=>i))return null;let s=r.map((i,o)=>t0e(e,n[o],i.from,i.to));if(t!=2&&!s.every(i=>i))return{changes:e.changes(r.map((i,o)=>s[o]?[]:[{from:i.from,insert:n[o].open+" "},{from:i.to,insert:" "+n[o].close}]))};if(t!=1&&s.some(i=>i)){let i=[];for(let o=0,a;o<s.length;o++)if(a=s[o]){let l=n[o],{open:c,close:u}=a;i.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:i}}return null}function n0e(t,e,r=e.selection.ranges){let n=[],s=-1;for(let{from:i,to:o}of r){let a=n.length,l=1e9,c=v1(e,i).line;if(c){for(let u=i;u<=o;){let d=e.doc.lineAt(u);if(d.from>s&&(i==o||o>d.from)){s=d.from;let h=/^\s*/.exec(d.text)[0].length,f=h==d.length,v=d.text.slice(h,h+c.length)==c?h:-1;h<d.text.length&&h<l&&(l=h),n.push({line:d,comment:v,token:c,indent:h,empty:f,single:!1})}u=d.to+1}if(l<1e9)for(let u=a;u<n.length;u++)n[u].indent<n[u].line.text.length&&(n[u].indent=l);n.length==a+1&&(n[a].single=!0)}}if(t!=2&&n.some(i=>i.comment<0&&(!i.empty||i.single))){let i=[];for(let{line:a,token:l,indent:c,empty:u,single:d}of n)(d||!u)&&i.push({from:a.from+c,insert:l+" "});let o=e.changes(i);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&n.some(i=>i.comment>=0)){let i=[];for(let{line:o,comment:a,token:l}of n)if(a>=0){let c=o.from+a,u=c+l.length;o.text[u-o.from]==" "&&u++,i.push({from:c,to:u})}return{changes:i}}return null}const uw=Ai.define(),s0e=Ai.define(),i0e=je.define(),pj=je.define({combine(t){return Ra(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(n,s)=>e(n,s)||r(n,s)})}}),mj=sr.define({create(){return As.empty},update(t,e){let r=e.state.facet(pj),n=e.annotation(uw);if(n){let l=Yr.fromTransaction(e,n.selection),c=n.side,u=c==0?t.undone:t.done;return l?u=$m(u,u.length,r.minDepth,l):u=yj(u,e.startState.selection),new As(c==0?n.rest:u,c==0?u:n.rest)}let s=e.annotation(s0e);if((s=="full"||s=="before")&&(t=t.isolate()),e.annotation(Gt.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let i=Yr.fromTransaction(e),o=e.annotation(Gt.time),a=e.annotation(Gt.userEvent);return i?t=t.addChanges(i,o,a,r,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,r.newGroupDelay)),(s=="full"||s=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new As(t.done.map(Yr.fromJSON),t.undone.map(Yr.fromJSON))}});function o0e(t={}){return[mj,pj.of(t),Fe.domEventHandlers({beforeinput(e,r){let n=e.inputType=="historyUndo"?gj:e.inputType=="historyRedo"?dw:null;return n?(e.preventDefault(),n(r)):!1}})]}function Yg(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let s=r.field(mj,!1);if(!s)return!1;let i=s.pop(t,r,e);return i?(n(i),!0):!1}}const gj=Yg(0,!1),dw=Yg(1,!1),a0e=Yg(0,!0),l0e=Yg(1,!0);class Yr{constructor(e,r,n,s,i){this.changes=e,this.effects=r,this.mapped=n,this.startSelection=s,this.selectionsAfter=i}setSelAfter(e){return new Yr(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new Yr(e.changes&&qt.fromJSON(e.changes),[],e.mapped&&Ls.fromJSON(e.mapped),e.startSelection&&xe.fromJSON(e.startSelection),e.selectionsAfter.map(xe.fromJSON))}static fromTransaction(e,r){let n=Mn;for(let s of e.startState.facet(i0e)){let i=s(e);i.length&&(n=n.concat(i))}return!n.length&&e.changes.empty?null:new Yr(e.changes.invert(e.startState.doc),n,void 0,r||e.startState.selection,Mn)}static selection(e){return new Yr(void 0,Mn,void 0,void 0,e)}}function $m(t,e,r,n){let s=e+1>r+20?e-r-1:0,i=t.slice(s,e);return i.push(n),i}function c0e(t,e){let r=[],n=!1;return t.iterChangedRanges((s,i)=>r.push(s,i)),e.iterChangedRanges((s,i,o,a)=>{for(let l=0;l<r.length;){let c=r[l++],u=r[l++];a>=c&&o<=u&&(n=!0)}}),n}function u0e(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((r,n)=>r.empty!=e.ranges[n].empty).length===0}function vj(t,e){return t.length?e.length?t.concat(e):t:e}const Mn=[],d0e=200;function yj(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-d0e));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),$m(t,t.length-1,1e9,r.setSelAfter(n)))}else return[Yr.selection([e])]}function h0e(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function s0(t,e){if(!t.length)return t;let r=t.length,n=Mn;for(;r;){let s=f0e(t[r-1],e,n);if(s.changes&&!s.changes.empty||s.effects.length){let i=t.slice(0,r);return i[r-1]=s,i}else e=s.mapped,r--,n=s.selectionsAfter}return n.length?[Yr.selection(n)]:Mn}function f0e(t,e,r){let n=vj(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):Mn,r);if(!t.changes)return Yr.selection(n);let s=t.changes.map(e),i=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(i):i;return new Yr(s,Qe.mapEffects(t.effects,e),o,t.startSelection.map(i),n)}const p0e=/^(input\.type|delete)($|\.)/;class As{constructor(e,r,n=0,s=void 0){this.done=e,this.undone=r,this.prevTime=n,this.prevUserEvent=s}isolate(){return this.prevTime?new As(this.done,this.undone):this}addChanges(e,r,n,s,i){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!n||p0e.test(n))&&(!a.selectionsAfter.length&&r-this.prevTime<s.newGroupDelay&&s.joinToEvent(i,c0e(a.changes,e.changes))||n=="input.type.compose")?o=$m(o,o.length-1,s.minDepth,new Yr(e.changes.compose(a.changes),vj(Qe.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,Mn)):o=$m(o,o.length,s.minDepth,e),new As(o,Mn,r,n)}addSelection(e,r,n,s){let i=this.done.length?this.done[this.done.length-1].selectionsAfter:Mn;return i.length>0&&r-this.prevTime<s&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&u0e(i[i.length-1],e)?this:new As(yj(this.done,e),this.undone,r,n)}addMapping(e){return new As(s0(this.done,e),s0(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,n){let s=e==0?this.done:this.undone;if(s.length==0)return null;let i=s[s.length-1],o=i.selectionsAfter[0]||r.selection;if(n&&i.selectionsAfter.length)return r.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:uw.of({side:e,rest:h0e(s),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){let a=s.length==1?Mn:s.slice(0,s.length-1);return i.mapped&&(a=s0(a,i.mapped)),r.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:uw.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}As.empty=new As(Mn,Mn);const m0e=[{key:"Mod-z",run:gj,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:dw,preventDefault:!0},{linux:"Ctrl-Shift-z",run:dw,preventDefault:!0},{key:"Mod-u",run:a0e,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:l0e,preventDefault:!0}];function gc(t,e){return xe.create(t.ranges.map(e),t.mainIndex)}function Vs(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ss({state:t,dispatch:e},r){let n=gc(t.selection,r);return n.eq(t.selection,!0)?!1:(e(Vs(t,n)),!0)}function Zg(t,e){return xe.cursor(e?t.to:t.from)}function _j(t,e){return ss(t,r=>r.empty?t.moveByChar(r,e):Zg(r,e))}function Or(t){return t.textDirectionAt(t.state.selection.main.head)==At.LTR}const bj=t=>_j(t,!Or(t)),wj=t=>_j(t,Or(t));function xj(t,e){return ss(t,r=>r.empty?t.moveByGroup(r,e):Zg(r,e))}const g0e=t=>xj(t,!Or(t)),v0e=t=>xj(t,Or(t));function y0e(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Xg(t,e,r){let n=gr(t).resolveInner(e.head),s=r?nt.closedBy:nt.openedBy;for(let l=e.head;;){let c=r?n.childAfter(l):n.childBefore(l);if(!c)break;y0e(t,c,s)?n=c:l=r?c.to:c.from}let i=n.type.prop(s),o,a;return i&&(o=r?Ts(t,n.from,1):Ts(t,n.to,-1))&&o.matched?a=r?o.end.to:o.end.from:a=r?n.to:n.from,xe.cursor(a,r?-1:1)}const _0e=t=>ss(t,e=>Xg(t.state,e,!Or(t))),b0e=t=>ss(t,e=>Xg(t.state,e,Or(t)));function Sj(t,e){return ss(t,r=>{if(!r.empty)return Zg(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}const Ej=t=>Sj(t,!1),Cj=t=>Sj(t,!0);function kj(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,r=0,n=0,s;if(e){for(let i of t.state.facet(Fe.scrollMargins)){let o=i(t);o?.top&&(r=Math.max(o?.top,r)),o?.bottom&&(n=Math.max(o?.bottom,n))}s=t.scrollDOM.clientHeight-r-n}else s=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,s-5)}}function Tj(t,e){let r=kj(t),{state:n}=t,s=gc(n.selection,o=>o.empty?t.moveVertically(o,e,r.height):Zg(o,e));if(s.eq(n.selection))return!1;let i;if(r.selfScroll){let o=t.coordsAtPos(n.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+r.marginTop,c=a.bottom-r.marginBottom;o&&o.top>l&&o.bottom<c&&(i=Fe.scrollIntoView(s.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(Vs(n,s),{effects:i}),!0}const pP=t=>Tj(t,!1),hw=t=>Tj(t,!0);function Co(t,e,r){let n=t.lineBlockAt(e.head),s=t.moveToLineBoundary(e,r);if(s.head==e.head&&s.head!=(r?n.to:n.from)&&(s=t.moveToLineBoundary(e,r,!1)),!r&&s.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(s=xe.cursor(n.from+i))}return s}const w0e=t=>ss(t,e=>Co(t,e,!0)),x0e=t=>ss(t,e=>Co(t,e,!1)),S0e=t=>ss(t,e=>Co(t,e,!Or(t))),E0e=t=>ss(t,e=>Co(t,e,Or(t))),C0e=t=>ss(t,e=>xe.cursor(t.lineBlockAt(e.head).from,1)),k0e=t=>ss(t,e=>xe.cursor(t.lineBlockAt(e.head).to,-1));function T0e(t,e,r){let n=!1,s=gc(t.selection,i=>{let o=Ts(t,i.head,-1)||Ts(t,i.head,1)||i.head>0&&Ts(t,i.head-1,1)||i.head<t.doc.length&&Ts(t,i.head+1,-1);if(!o||!o.end)return i;n=!0;let a=o.start.from==i.head?o.end.to:o.end.from;return xe.cursor(a)});return n?(e(Vs(t,s)),!0):!1}const A0e=({state:t,dispatch:e})=>T0e(t,e);function Hn(t,e){let r=gc(t.state.selection,n=>{let s=e(n);return xe.range(n.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return r.eq(t.state.selection)?!1:(t.dispatch(Vs(t.state,r)),!0)}function Aj(t,e){return Hn(t,r=>t.moveByChar(r,e))}const Rj=t=>Aj(t,!Or(t)),Pj=t=>Aj(t,Or(t));function Ij(t,e){return Hn(t,r=>t.moveByGroup(r,e))}const R0e=t=>Ij(t,!Or(t)),P0e=t=>Ij(t,Or(t)),I0e=t=>Hn(t,e=>Xg(t.state,e,!Or(t))),O0e=t=>Hn(t,e=>Xg(t.state,e,Or(t)));function Oj(t,e){return Hn(t,r=>t.moveVertically(r,e))}const Dj=t=>Oj(t,!1),Mj=t=>Oj(t,!0);function Lj(t,e){return Hn(t,r=>t.moveVertically(r,e,kj(t).height))}const mP=t=>Lj(t,!1),gP=t=>Lj(t,!0),D0e=t=>Hn(t,e=>Co(t,e,!0)),M0e=t=>Hn(t,e=>Co(t,e,!1)),L0e=t=>Hn(t,e=>Co(t,e,!Or(t))),N0e=t=>Hn(t,e=>Co(t,e,Or(t))),B0e=t=>Hn(t,e=>xe.cursor(t.lineBlockAt(e.head).from)),F0e=t=>Hn(t,e=>xe.cursor(t.lineBlockAt(e.head).to)),vP=({state:t,dispatch:e})=>(e(Vs(t,{anchor:0})),!0),yP=({state:t,dispatch:e})=>(e(Vs(t,{anchor:t.doc.length})),!0),_P=({state:t,dispatch:e})=>(e(Vs(t,{anchor:t.selection.main.anchor,head:0})),!0),bP=({state:t,dispatch:e})=>(e(Vs(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),j0e=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),$0e=({state:t,dispatch:e})=>{let r=Qg(t).map(({from:n,to:s})=>xe.range(n,Math.min(s+1,t.doc.length)));return e(t.update({selection:xe.create(r),userEvent:"select"})),!0},U0e=({state:t,dispatch:e})=>{let r=gc(t.selection,n=>{let s=gr(t),i=s.resolveStack(n.from,1);if(n.empty){let o=s.resolveStack(n.from,-1);o.node.from>=i.node.from&&o.node.to<=i.node.to&&(i=o)}for(let o=i;o;o=o.next){let{node:a}=o;if((a.from<n.from&&a.to>=n.to||a.to>n.to&&a.from<=n.from)&&o.next)return xe.range(a.to,a.from)}return n});return r.eq(t.selection)?!1:(e(Vs(t,r)),!0)},H0e=({state:t,dispatch:e})=>{let r=t.selection,n=null;return r.ranges.length>1?n=xe.create([r.main]):r.main.empty||(n=xe.create([xe.cursor(r.main.head)])),n?(e(Vs(t,n)),!0):!1};function uh(t,e){if(t.state.readOnly)return!1;let r="delete.selection",{state:n}=t,s=n.changeByRange(i=>{let{from:o,to:a}=i;if(o==a){let l=e(i);l<o?(r="delete.backward",l=wf(t,l,!1)):l>o&&(r="delete.forward",l=wf(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=wf(t,o,!1),a=wf(t,a,!0);return o==a?{range:i}:{changes:{from:o,to:a},range:xe.cursor(o,o<i.head?-1:1)}});return s.changes.empty?!1:(t.dispatch(n.update(s,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?Fe.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function wf(t,e,r){if(t instanceof Fe)for(let n of t.state.facet(Fe.atomicRanges).map(s=>s(t)))n.between(e,e,(s,i)=>{s<e&&i>e&&(e=r?i:s)});return e}const Nj=(t,e,r)=>uh(t,n=>{let s=n.from,{state:i}=t,o=i.doc.lineAt(s),a,l;if(r&&!e&&s>o.from&&s<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,s-o.from))){if(a[a.length-1]=="	")return s-1;let c=Hg(a,i.tabSize),u=c%Lm(i)||Lm(i);for(let d=0;d<u&&a[a.length-1-d]==" ";d++)s--;l=s}else l=mr(o.text,s-o.from,e,e)+o.from,l==s&&o.number!=(e?i.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,s-o.from))&&(l=mr(o.text,l-o.from,!1,!1)+o.from);return l}),fw=t=>Nj(t,!1,!0),Bj=t=>Nj(t,!0,!1),Fj=(t,e)=>uh(t,r=>{let n=r.head,{state:s}=t,i=s.doc.lineAt(n),o=s.charCategorizer(n);for(let a=null;;){if(n==(e?i.to:i.from)){n==r.head&&i.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let l=mr(i.text,n-i.from,e)+i.from,c=i.text.slice(Math.min(n,l)-i.from,Math.max(n,l)-i.from),u=o(c);if(a!=null&&u!=a)break;(c!=" "||n!=r.head)&&(a=u),n=l}return n}),jj=t=>Fj(t,!1),V0e=t=>Fj(t,!0),G0e=t=>uh(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),z0e=t=>uh(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)}),W0e=t=>uh(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),K0e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:ht.of(["",""])},range:xe.cursor(n.from)}));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},q0e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{if(!n.empty||n.from==0||n.from==t.doc.length)return{range:n};let s=n.from,i=t.doc.lineAt(s),o=s==i.from?s-1:mr(i.text,s-i.from,!1)+i.from,a=s==i.to?s+1:mr(i.text,s-i.from,!0)+i.from;return{changes:{from:o,to:a,insert:t.doc.slice(s,a).append(t.doc.slice(o,s))},range:xe.cursor(a)}});return r.changes.empty?!1:(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Qg(t){let e=[],r=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.from),i=t.doc.lineAt(n.to);if(!n.empty&&n.to==i.from&&(i=t.doc.lineAt(n.to-1)),r>=s.number){let o=e[e.length-1];o.to=i.to,o.ranges.push(n)}else e.push({from:s.from,to:i.to,ranges:[n]});r=i.number+1}return e}function $j(t,e,r){if(t.readOnly)return!1;let n=[],s=[];for(let i of Qg(t)){if(r?i.to==t.doc.length:i.from==0)continue;let o=t.doc.lineAt(r?i.to+1:i.from-1),a=o.length+1;if(r){n.push({from:i.to,to:o.to},{from:i.from,insert:o.text+t.lineBreak});for(let l of i.ranges)s.push(xe.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{n.push({from:o.from,to:i.from},{from:i.to,insert:t.lineBreak+o.text});for(let l of i.ranges)s.push(xe.range(l.anchor-a,l.head-a))}}return n.length?(e(t.update({changes:n,scrollIntoView:!0,selection:xe.create(s,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const J0e=({state:t,dispatch:e})=>$j(t,e,!1),Y0e=({state:t,dispatch:e})=>$j(t,e,!0);function Uj(t,e,r){if(t.readOnly)return!1;let n=[];for(let s of Qg(t))r?n.push({from:s.from,insert:t.doc.slice(s.from,s.to)+t.lineBreak}):n.push({from:s.to,insert:t.lineBreak+t.doc.slice(s.from,s.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Z0e=({state:t,dispatch:e})=>Uj(t,e,!1),X0e=({state:t,dispatch:e})=>Uj(t,e,!0),Q0e=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(Qg(e).map(({from:s,to:i})=>(s>0?s--:i<e.doc.length&&i++,{from:s,to:i}))),n=gc(e.selection,s=>{let i;if(t.lineWrapping){let o=t.lineBlockAt(s.head),a=t.coordsAtPos(s.head,s.assoc||1);a&&(i=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(s,!0,i)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function e_e(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=gr(t).resolveInner(e),n=r.childBefore(e),s=r.childAfter(e),i;return n&&s&&n.to<=e&&s.from>=e&&(i=n.type.prop(nt.closedBy))&&i.indexOf(s.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(s.from).from&&!/\S/.test(t.sliceDoc(n.to,s.from))?{from:n.to,to:s.from}:null}const wP=Hj(!1),t_e=Hj(!0);function Hj(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(s=>{let{from:i,to:o}=s,a=e.doc.lineAt(i),l=!t&&i==o&&e_e(e,i);t&&(i=o=(o<=a.to?a:e.doc.lineAt(o)).to);let c=new qg(e,{simulateBreak:i,simulateDoubleBreak:!!l}),u=i1(c,i);for(u==null&&(u=Hg(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:i,to:o}=l:i>a.from&&i<a.from+100&&!/\S/.test(a.text.slice(0,i))&&(i=a.from);let d=["",Dd(e,u)];return l&&d.push(Dd(e,c.lineIndent(a.from,-1))),{changes:{from:i,to:o,insert:ht.of(d)},range:xe.cursor(i+1+d[1].length)}});return r(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function y1(t,e){let r=-1;return t.changeByRange(n=>{let s=[];for(let o=n.from;o<=n.to;){let a=t.doc.lineAt(o);a.number>r&&(n.empty||n.to>a.from)&&(e(a,s,n),r=a.number),o=a.to+1}let i=t.changes(s);return{changes:s,range:xe.range(i.mapPos(n.anchor,1),i.mapPos(n.head,1))}})}const r_e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new qg(t,{overrideIndentation:i=>{let o=r[i];return o??-1}}),s=y1(t,(i,o,a)=>{let l=i1(n,i.from);if(l==null)return;/\S/.test(i.text)||(l=0);let c=/^\s*/.exec(i.text)[0],u=Dd(t,l);(c!=u||a.from<i.from+c.length)&&(r[i.from]=l,o.push({from:i.from,to:i.from+c.length,insert:u}))});return s.changes.empty||e(t.update(s,{userEvent:"indent"})),!0},n_e=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(y1(t,(r,n)=>{n.push({from:r.from,insert:t.facet(pc)})}),{userEvent:"input.indent"})),!0),Vj=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(y1(t,(r,n)=>{let s=/^\s*/.exec(r.text)[0];if(!s)return;let i=Hg(s,t.tabSize),o=0,a=Dd(t,Math.max(0,i-Lm(t)));for(;o<s.length&&o<a.length&&s.charCodeAt(o)==a.charCodeAt(o);)o++;n.push({from:r.from+o,to:r.from+s.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),s_e=t=>(t.setTabFocusMode(),!0),i_e=[{key:"Ctrl-b",run:bj,shift:Rj,preventDefault:!0},{key:"Ctrl-f",run:wj,shift:Pj},{key:"Ctrl-p",run:Ej,shift:Dj},{key:"Ctrl-n",run:Cj,shift:Mj},{key:"Ctrl-a",run:C0e,shift:B0e},{key:"Ctrl-e",run:k0e,shift:F0e},{key:"Ctrl-d",run:Bj},{key:"Ctrl-h",run:fw},{key:"Ctrl-k",run:G0e},{key:"Ctrl-Alt-h",run:jj},{key:"Ctrl-o",run:K0e},{key:"Ctrl-t",run:q0e},{key:"Ctrl-v",run:hw}],o_e=[{key:"ArrowLeft",run:bj,shift:Rj,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:g0e,shift:R0e,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:S0e,shift:L0e,preventDefault:!0},{key:"ArrowRight",run:wj,shift:Pj,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:v0e,shift:P0e,preventDefault:!0},{mac:"Cmd-ArrowRight",run:E0e,shift:N0e,preventDefault:!0},{key:"ArrowUp",run:Ej,shift:Dj,preventDefault:!0},{mac:"Cmd-ArrowUp",run:vP,shift:_P},{mac:"Ctrl-ArrowUp",run:pP,shift:mP},{key:"ArrowDown",run:Cj,shift:Mj,preventDefault:!0},{mac:"Cmd-ArrowDown",run:yP,shift:bP},{mac:"Ctrl-ArrowDown",run:hw,shift:gP},{key:"PageUp",run:pP,shift:mP},{key:"PageDown",run:hw,shift:gP},{key:"Home",run:x0e,shift:M0e,preventDefault:!0},{key:"Mod-Home",run:vP,shift:_P},{key:"End",run:w0e,shift:D0e,preventDefault:!0},{key:"Mod-End",run:yP,shift:bP},{key:"Enter",run:wP,shift:wP},{key:"Mod-a",run:j0e},{key:"Backspace",run:fw,shift:fw},{key:"Delete",run:Bj},{key:"Mod-Backspace",mac:"Alt-Backspace",run:jj},{key:"Mod-Delete",mac:"Alt-Delete",run:V0e},{mac:"Mod-Backspace",run:z0e},{mac:"Mod-Delete",run:W0e}].concat(i_e.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),a_e=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:_0e,shift:I0e},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:b0e,shift:O0e},{key:"Alt-ArrowUp",run:J0e},{key:"Shift-Alt-ArrowUp",run:Z0e},{key:"Alt-ArrowDown",run:Y0e},{key:"Shift-Alt-ArrowDown",run:X0e},{key:"Escape",run:H0e},{key:"Mod-Enter",run:t_e},{key:"Alt-l",mac:"Ctrl-l",run:$0e},{key:"Mod-i",run:U0e,preventDefault:!0},{key:"Mod-[",run:Vj},{key:"Mod-]",run:n_e},{key:"Mod-Alt-\\",run:r_e},{key:"Shift-Mod-k",run:Q0e},{key:"Shift-Mod-\\",run:A0e},{key:"Mod-/",run:Zye},{key:"Alt-A",run:Qye},{key:"Ctrl-m",mac:"Shift-Alt-m",run:s_e}].concat(o_e);function cr(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var s=r[n];typeof s=="string"?t.setAttribute(n,s):s!=null&&(t[n]=s)}e++}for(;e<arguments.length;e++)Gj(t,arguments[e]);return t}function Gj(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)Gj(t,e[r]);else throw new RangeError("Unsupported child node: "+e)}const xP=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class Nd{constructor(e,r,n=0,s=e.length,i,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,s),this.bufferStart=n,this.normalize=i?a=>i(xP(a)):xP,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Wn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=HS(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=li(e);let s=this.normalize(r);if(s.length)for(let i=0,o=n;;i++){let a=s.charCodeAt(i),l=this.match(a,o,this.bufferPos+this.bufferStart);if(i==s.length-1){if(l)return this.value=l,this;break}o==n&&i<r.length&&r.charCodeAt(i)==a&&o++}}}match(e,r,n){let s=null;for(let i=0;i<this.matches.length;i+=2){let o=this.matches[i],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?s={from:this.matches[i+1],to:n}:(this.matches[i]++,a=!0)),a||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:r,to:n}:this.matches.push(1,r)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(Nd.prototype[Symbol.iterator]=function(){return this});const zj={from:-1,to:-1,match:/.*/.exec("")},_1="gm"+(/x/.unicode==null?"":"u");class Wj{constructor(e,r,n,s=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=zj,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new Kj(e,r,n,s,i);this.re=new RegExp(r,_1+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let o=e.lineAt(s);this.curLineStart=o.from,this.matchPos=Um(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,s=n+r[0].length;if(this.matchPos=Um(this.text,s+(n==s?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<s||n>this.value.to)&&(!this.test||this.test(n,s,r)))return this.value={from:n,to:s,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const i0=new WeakMap;class Sl{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let s=i0.get(e);if(!s||s.from>=n||s.to<=r){let a=new Sl(r,e.sliceString(r,n));return i0.set(e,a),a}if(s.from==r&&s.to==n)return s;let{text:i,from:o}=s;return o>r&&(i=e.sliceString(r,o)+i,o=r),s.to<n&&(i+=e.sliceString(s.to,n)),i0.set(e,new Sl(o,i)),new Sl(r,i.slice(r-o,n-o))}}class Kj{constructor(e,r,n,s,i){this.text=e,this.to=i,this.done=!1,this.value=zj,this.matchPos=Um(e,s),this.re=new RegExp(r,_1+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=Sl.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,s=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,s,r)))return this.value={from:n,to:s,match:r},this.matchPos=Um(this.text,s+(n==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Sl.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Wj.prototype[Symbol.iterator]=Kj.prototype[Symbol.iterator]=function(){return this});function l_e(t){try{return new RegExp(t,_1),!0}catch{return!1}}function Um(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}function pw(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),r=cr("input",{class:"cm-textfield",name:"line",value:e}),n=cr("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:Su.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),s())},onsubmit:i=>{i.preventDefault(),s()}},cr("label",t.state.phrase("Go to line"),": ",r)," ",cr("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),cr("button",{name:"close",onclick:()=>{t.dispatch({effects:Su.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["×"]));function s(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(r.value);if(!i)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,c,u,d]=i,h=u?+u.slice(1):0,f=c?+c:a.number;if(c&&d){let p=f/100;l&&(p=p*(l=="-"?-1:1)+a.number/o.doc.lines),f=Math.round(o.doc.lines*p)}else c&&l&&(f=f*(l=="-"?-1:1)+a.number);let v=o.doc.line(Math.max(1,Math.min(o.doc.lines,f))),m=xe.cursor(v.from+Math.max(0,Math.min(h,v.length)));t.dispatch({effects:[Su.of(!1),Fe.scrollIntoView(m.from,{y:"center"})],selection:m}),t.focus()}return{dom:n}}const Su=Qe.define(),SP=sr.define({create(){return!0},update(t,e){for(let r of e.effects)r.is(Su)&&(t=r.value);return t},provide:t=>Pm.from(t,e=>e?pw:null)}),c_e=t=>{let e=Rm(t,pw);if(!e){let r=[Su.of(!0)];t.state.field(SP,!1)==null&&r.push(Qe.appendConfig.of([SP,u_e])),t.dispatch({effects:r}),e=Rm(t,pw)}return e&&e.dom.querySelector("input").select(),!0},u_e=Fe.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),d_e=({state:t,dispatch:e})=>{let{selection:r}=t,n=xe.create(r.ranges.map(s=>t.wordAt(s.head)||xe.cursor(s.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function h_e(t,e){let{main:r,ranges:n}=t.selection,s=t.wordAt(r.head),i=s&&s.from==r.from&&s.to==r.to;for(let o=!1,a=new Nd(t.doc,e,n[n.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new Nd(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(l=>l.from==a.value.from))continue;if(i){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const f_e=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(i=>i.from===i.to))return d_e({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(i=>t.sliceDoc(i.from,i.to)!=n))return!1;let s=h_e(t,n);return s?(e(t.update({selection:t.selection.addRange(xe.range(s.from,s.to),!1),effects:Fe.scrollIntoView(s.to)})),!0):!1},vc=je.define({combine(t){return Ra(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new C_e(e),scrollToMatch:e=>Fe.scrollIntoView(e)})}});class qj{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||l_e(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new v_e(this):new m_e(this)}getCursor(e,r=0,n){let s=e.doc?e:ot.create({doc:e});return n==null&&(n=s.doc.length),this.regexp?Ja(this,s,r,n):qa(this,s,r,n)}}class Jj{constructor(e){this.spec=e}}function qa(t,e,r,n){return new Nd(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:s=>s.toLowerCase(),t.wholeWord?p_e(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function p_e(t,e){return(r,n,s,i)=>((i>r||i+s.length<n)&&(i=Math.max(0,r-2),s=t.sliceString(i,Math.min(t.length,n+2))),(e(Hm(s,r-i))!=zt.Word||e(Vm(s,r-i))!=zt.Word)&&(e(Vm(s,n-i))!=zt.Word||e(Hm(s,n-i))!=zt.Word))}class m_e extends Jj{constructor(e){super(e)}nextMatch(e,r,n){let s=qa(this.spec,e,n,e.doc.length).nextOverlapping();if(s.done){let i=Math.min(e.doc.length,r+this.spec.unquoted.length);s=qa(this.spec,e,0,i).nextOverlapping()}return s.done||s.value.from==r&&s.value.to==n?null:s.value}prevMatchInRange(e,r,n){for(let s=n;;){let i=Math.max(r,s-1e4-this.spec.unquoted.length),o=qa(this.spec,e,i,s),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(i==r)return null;s-=1e4}}prevMatch(e,r,n){let s=this.prevMatchInRange(e,0,r);return s||(s=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=r||s.to!=n)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=qa(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=r)return null;s.push(n.value)}return s}highlight(e,r,n,s){let i=qa(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)s(i.value.from,i.value.to)}}function Ja(t,e,r,n){return new Wj(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?g_e(e.charCategorizer(e.selection.main.head)):void 0},r,n)}function Hm(t,e){return t.slice(mr(t,e,!1),e)}function Vm(t,e){return t.slice(e,mr(t,e))}function g_e(t){return(e,r,n)=>!n[0].length||(t(Hm(n.input,n.index))!=zt.Word||t(Vm(n.input,n.index))!=zt.Word)&&(t(Vm(n.input,n.index+n[0].length))!=zt.Word||t(Hm(n.input,n.index+n[0].length))!=zt.Word)}class v_e extends Jj{nextMatch(e,r,n){let s=Ja(this.spec,e,n,e.doc.length).next();return s.done&&(s=Ja(this.spec,e,0,r).next()),s.done?null:s.value}prevMatchInRange(e,r,n){for(let s=1;;s++){let i=Math.max(r,n-s*1e4),o=Ja(this.spec,e,i,n),a=null;for(;!o.next().done;)a=o.value;if(a&&(i==r||a.from>i+10))return a;if(i==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(r,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let s=n.length;s>0;s--){let i=+n.slice(0,s);if(i>0&&i<e.match.length)return e.match[i]+n.slice(s)}return r})}matchAll(e,r){let n=Ja(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=r)return null;s.push(n.value)}return s}highlight(e,r,n,s){let i=Ja(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!i.next().done;)s(i.value.from,i.value.to)}}const Bd=Qe.define(),b1=Qe.define(),Yi=sr.define({create(t){return new o0(mw(t).create(),null)},update(t,e){for(let r of e.effects)r.is(Bd)?t=new o0(r.value.create(),t.panel):r.is(b1)&&(t=new o0(t.query,r.value?w1:null));return t},provide:t=>Pm.from(t,e=>e.panel)});class o0{constructor(e,r){this.query=e,this.panel=r}}const y_e=rt.mark({class:"cm-searchMatch"}),__e=rt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),b_e=nr.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Yi))}update(t){let e=t.state.field(Yi);(e!=t.startState.field(Yi)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return rt.none;let{view:r}=this,n=new _a;for(let s=0,i=r.visibleRanges,o=i.length;s<o;s++){let{from:a,to:l}=i[s];for(;s<o-1&&l>i[s+1].from-2*250;)l=i[++s].to;t.highlight(r.state,a,l,(c,u)=>{let d=r.state.selection.ranges.some(h=>h.from==c&&h.to==u);n.add(c,u,d?__e:y_e)})}return n.finish()}},{decorations:t=>t.decorations});function dh(t){return e=>{let r=e.state.field(Yi,!1);return r&&r.query.spec.valid?t(e,r):Xj(e)}}const Gm=dh((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let s=xe.single(n.from,n.to),i=t.state.facet(vc);return t.dispatch({selection:s,effects:[x1(t,n),i.scrollToMatch(s.main,t)],userEvent:"select.search"}),Zj(t),!0}),zm=dh((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,s=e.prevMatch(r,n,n);if(!s)return!1;let i=xe.single(s.from,s.to),o=t.state.facet(vc);return t.dispatch({selection:i,effects:[x1(t,s),o.scrollToMatch(i.main,t)],userEvent:"select.search"}),Zj(t),!0}),w_e=dh((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:xe.create(r.map(n=>xe.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),x_e=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:s}=r.main,i=[],o=0;for(let a=new Nd(t.doc,t.sliceDoc(n,s));!a.next().done;){if(i.length>1e3)return!1;a.value.from==n&&(o=i.length),i.push(xe.range(a.value.from,a.value.to))}return e(t.update({selection:xe.create(i,o),userEvent:"select.search.matches"})),!0},EP=dh((t,{query:e})=>{let{state:r}=t,{from:n,to:s}=r.selection.main;if(r.readOnly)return!1;let i=e.nextMatch(r,n,n);if(!i)return!1;let o=i,a=[],l,c,u=[];if(o.from==n&&o.to==s&&(c=r.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(r,o.from,o.to),u.push(Fe.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+"."))),o){let d=a.length==0||a[0].from>=i.to?0:i.to-i.from-c.length;l=xe.single(o.from-d,o.to-d),u.push(x1(t,o)),u.push(r.facet(vc).scrollToMatch(l.main,t))}return t.dispatch({changes:a,selection:l,effects:u,userEvent:"input.replace"}),!0}),S_e=dh((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(s=>{let{from:i,to:o}=s;return{from:i,to:o,insert:e.getReplacement(s)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:Fe.announce.of(n),userEvent:"input.replace.all"}),!0});function w1(t){return t.state.facet(vc).createPanel(t)}function mw(t,e){var r,n,s,i,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let c=t.facet(vc);return new qj({search:((r=e?.literal)!==null&&r!==void 0?r:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:c.caseSensitive,literal:(s=e?.literal)!==null&&s!==void 0?s:c.literal,regexp:(i=e?.regexp)!==null&&i!==void 0?i:c.regexp,wholeWord:(o=e?.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function Yj(t){let e=Rm(t,w1);return e&&e.dom.querySelector("[main-field]")}function Zj(t){let e=Yj(t);e&&e==t.root.activeElement&&e.select()}const Xj=t=>{let e=t.state.field(Yi,!1);if(e&&e.panel){let r=Yj(t);if(r&&r!=t.root.activeElement){let n=mw(t.state,e.query.spec);n.valid&&t.dispatch({effects:Bd.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[b1.of(!0),e?Bd.of(mw(t.state,e.query.spec)):Qe.appendConfig.of(T_e)]});return!0},Qj=t=>{let e=t.state.field(Yi,!1);if(!e||!e.panel)return!1;let r=Rm(t,w1);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:b1.of(!1)}),!0},E_e=[{key:"Mod-f",run:Xj,scope:"editor search-panel"},{key:"F3",run:Gm,shift:zm,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Gm,shift:zm,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Qj,scope:"editor search-panel"},{key:"Mod-Shift-l",run:x_e},{key:"Mod-Alt-g",run:c_e},{key:"Mod-d",run:f_e,preventDefault:!0}];class C_e{constructor(e){this.view=e;let r=this.query=e.state.field(Yi).query.spec;this.commit=this.commit.bind(this),this.searchField=cr("input",{value:r.search,placeholder:nn(e,"Find"),"aria-label":nn(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=cr("input",{value:r.replace,placeholder:nn(e,"Replace"),"aria-label":nn(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=cr("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=cr("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=cr("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(s,i,o){return cr("button",{class:"cm-button",name:s,onclick:i,type:"button"},o)}this.dom=cr("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,n("next",()=>Gm(e),[nn(e,"next")]),n("prev",()=>zm(e),[nn(e,"previous")]),n("select",()=>w_e(e),[nn(e,"all")]),cr("label",null,[this.caseField,nn(e,"match case")]),cr("label",null,[this.reField,nn(e,"regexp")]),cr("label",null,[this.wordField,nn(e,"by word")]),...e.state.readOnly?[]:[cr("br"),this.replaceField,n("replace",()=>EP(e),[nn(e,"replace")]),n("replaceAll",()=>S_e(e),[nn(e,"replace all")])],cr("button",{name:"close",onclick:()=>Qj(e),"aria-label":nn(e,"close"),type:"button"},["×"])])}commit(){let e=new qj({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Bd.of(e)}))}keydown(e){uge(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?zm:Gm)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),EP(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(Bd)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(vc).top}}function nn(t,e){return t.state.phrase(e)}const xf=30,Sf=/[\s\.,:;?!]/;function x1(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),s=t.state.doc.lineAt(r).to,i=Math.max(n.from,e-xf),o=Math.min(s,r+xf),a=t.state.sliceDoc(i,o);if(i!=n.from){for(let l=0;l<xf;l++)if(!Sf.test(a[l+1])&&Sf.test(a[l])){a=a.slice(l);break}}if(o!=s){for(let l=a.length-1;l>a.length-xf;l--)if(!Sf.test(a[l-1])&&Sf.test(a[l])){a=a.slice(0,l);break}}return Fe.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${n.number}.`)}const k_e=Fe.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),T_e=[Yi,Eo.low(b_e),k_e];function A_e(){return C.jsx("div",{className:"flex items-center justify-center absolute inset-0 z-10 text-sm bg-tk-elements-app-backgroundColor text-tk-elements-app-textColor",children:"File format cannot be displayed."})}function Wm(){return Wm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wm.apply(null,arguments)}var e4=t=>{var{theme:e,settings:r={},styles:n=[]}=t,s={".cm-gutters":{}},i={};r.background&&(i.backgroundColor=r.background),r.backgroundImage&&(i.backgroundImage=r.backgroundImage),r.foreground&&(i.color=r.foreground),r.fontSize&&(i.fontSize=r.fontSize),(r.background||r.foreground)&&(s["&"]=i),r.fontFamily&&(s["&.cm-editor .cm-scroller"]={fontFamily:r.fontFamily}),r.gutterBackground&&(s[".cm-gutters"].backgroundColor=r.gutterBackground),r.gutterForeground&&(s[".cm-gutters"].color=r.gutterForeground),r.gutterBorder&&(s[".cm-gutters"].borderRightColor=r.gutterBorder),r.caret&&(s[".cm-content"]={caretColor:r.caret},s[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r.caret});var o={};r.gutterActiveForeground&&(o.color=r.gutterActiveForeground),r.lineHighlight&&(s[".cm-activeLine"]={backgroundColor:r.lineHighlight},o.backgroundColor=r.lineHighlight),s[".cm-activeLineGutter"]=o,r.selection&&(s["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:r.selection+" !important"}),r.selectionMatch&&(s["& .cm-selectionMatch"]={backgroundColor:r.selectionMatch});var a=Fe.theme(s,{dark:e==="dark"}),l=Jg.define(n),c=[a,$ve(l)];return c},R_e={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},P_e=[{tag:[ve.keyword,ve.operatorKeyword,ve.modifier,ve.color,ve.constant(ve.name),ve.standard(ve.name),ve.standard(ve.tagName),ve.special(ve.brace),ve.atom,ve.bool,ve.special(ve.variableName)],color:"#0000ff"},{tag:[ve.moduleKeyword,ve.controlKeyword],color:"#af00db"},{tag:[ve.name,ve.deleted,ve.character,ve.macroName,ve.propertyName,ve.variableName,ve.labelName,ve.definition(ve.name)],color:"#0070c1"},{tag:ve.heading,fontWeight:"bold",color:"#0070c1"},{tag:[ve.typeName,ve.className,ve.tagName,ve.number,ve.changed,ve.annotation,ve.self,ve.namespace],color:"#267f99"},{tag:[ve.function(ve.variableName),ve.function(ve.propertyName)],color:"#795e26"},{tag:[ve.number],color:"#098658"},{tag:[ve.operator,ve.punctuation,ve.separator,ve.url,ve.escape,ve.regexp],color:"#383a42"},{tag:[ve.regexp],color:"#af00db"},{tag:[ve.special(ve.string),ve.processingInstruction,ve.string,ve.inserted],color:"#a31515"},{tag:[ve.angleBracket],color:"#383a42"},{tag:ve.strong,fontWeight:"bold"},{tag:ve.emphasis,fontStyle:"italic"},{tag:ve.strikethrough,textDecoration:"line-through"},{tag:[ve.meta,ve.comment],color:"#008000"},{tag:ve.link,color:"#4078f2",textDecoration:"underline"},{tag:ve.invalid,color:"#e45649"}];function I_e(t){var{theme:e="light",settings:r={},styles:n=[]}={};return e4({theme:e,settings:Wm({},R_e,r),styles:[...P_e,...n]})}var O_e=I_e(),D_e={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},M_e=[{tag:[ve.keyword,ve.operatorKeyword,ve.modifier,ve.color,ve.constant(ve.name),ve.standard(ve.name),ve.standard(ve.tagName),ve.special(ve.brace),ve.atom,ve.bool,ve.special(ve.variableName)],color:"#569cd6"},{tag:[ve.controlKeyword,ve.moduleKeyword],color:"#c586c0"},{tag:[ve.name,ve.deleted,ve.character,ve.macroName,ve.propertyName,ve.variableName,ve.labelName,ve.definition(ve.name)],color:"#9cdcfe"},{tag:ve.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[ve.typeName,ve.className,ve.tagName,ve.number,ve.changed,ve.annotation,ve.self,ve.namespace],color:"#4ec9b0"},{tag:[ve.function(ve.variableName),ve.function(ve.propertyName)],color:"#dcdcaa"},{tag:[ve.number],color:"#b5cea8"},{tag:[ve.operator,ve.punctuation,ve.separator,ve.url,ve.escape,ve.regexp],color:"#d4d4d4"},{tag:[ve.regexp],color:"#d16969"},{tag:[ve.special(ve.string),ve.processingInstruction,ve.string,ve.inserted],color:"#ce9178"},{tag:[ve.angleBracket],color:"#808080"},{tag:ve.strong,fontWeight:"bold"},{tag:ve.emphasis,fontStyle:"italic"},{tag:ve.strikethrough,textDecoration:"line-through"},{tag:[ve.meta,ve.comment],color:"#6a9955"},{tag:ve.link,color:"#6a9955",textDecoration:"underline"},{tag:ve.invalid,color:"#ff0000"}];function L_e(t){var{theme:e="dark",settings:r={},styles:n=[]}={};return e4({theme:e,settings:Wm({},D_e,r),styles:[...M_e,...n]})}var N_e=L_e();Fe.theme({},{dark:!0});const gw=new va;function B_e(t,e={}){return[F_e(e),t==="dark"?gw.of([n4()]):gw.of([r4()])]}function t4(t){return gw.reconfigure(t==="dark"?n4():r4())}function F_e(t){return Fe.theme({"&":{fontSize:t.fontSize??"12px"},"&.cm-editor":{height:"100%",background:"var(--cm-backgroundColor)",color:"var(--cm-textColor)"},".cm-cursor":{borderLeft:"var(--cm-cursor-width) solid var(--cm-cursor-backgroundColor)"},".cm-scroller":{lineHeight:"1.5","&:focus-visible":{outline:"none"}},".cm-line":{padding:"0 0 0 4px"},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{backgroundColor:"var(--cm-selection-backgroundColorFocused) !important",opacity:"var(--cm-selection-backgroundOpacityFocused, 0.3)"},"&:not(.cm-focused) > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{backgroundColor:"var(--cm-selection-backgroundColorBlured)",opacity:"var(--cm-selection-backgroundOpacityBlured, 0.3)"},"&.cm-focused > .cm-scroller .cm-matchingBracket":{backgroundColor:"var(--cm-matching-bracket)"},".cm-activeLine":{background:"var(--cm-activeLineBackgroundColor)"},".cm-gutters":{background:"var(--cm-gutter-backgroundColor)",borderRight:0,color:"var(--cm-gutter-textColor)"},".cm-gutter":{"&.cm-lineNumbers":{fontFamily:"Roboto Mono, monospace",fontSize:t.gutterFontSize??t.fontSize??"12px",minWidth:"40px"},"& .cm-activeLineGutter":{background:"transparent",color:"var(--cm-gutter-activeLineTextColor)"},"&.cm-foldGutter .cm-gutterElement > .fold-icon":{cursor:"pointer",color:"var(--cm-foldGutter-textColor)",transform:"translateY(2px)","&:hover":{color:"var(--cm-foldGutter-textColorHover)"}}},".cm-foldGutter .cm-gutterElement":{padding:"0 4px"},".cm-tooltip-autocomplete > ul > li":{minHeight:"18px"},".cm-panel.cm-search label":{marginLeft:"2px",fontSize:"12px"},".cm-panel.cm-search .cm-button":{fontSize:"12px"},".cm-panel.cm-search .cm-textfield":{fontSize:"12px"},".cm-panel.cm-search input[type=checkbox]":{position:"relative",transform:"translateY(2px)",marginRight:"4px"},".cm-panels":{borderColor:"var(--cm-panels-borderColor)"},".cm-panels-bottom":{borderTop:"1px solid var(--cm-panels-borderColor)",backgroundColor:"transparent"},".cm-panel.cm-search":{background:"var(--cm-search-backgroundColor)",color:"var(--cm-search-textColor)",padding:"8px"},".cm-search .cm-button":{background:"var(--cm-search-button-backgroundColor)",borderColor:"var(--cm-search-button-borderColor)",color:"var(--cm-search-button-textColor)",borderRadius:"4px","&:hover":{color:"var(--cm-search-button-textColorHover)"},"&:focus-visible":{outline:"none",borderColor:"var(--cm-search-button-borderColorFocused)"},"&:hover:not(:focus-visible)":{background:"var(--cm-search-button-backgroundColorHover)",borderColor:"var(--cm-search-button-borderColorHover)"},"&:hover:focus-visible":{background:"var(--cm-search-button-backgroundColorHover)",borderColor:"var(--cm-search-button-borderColorFocused)"}},".cm-panel.cm-search [name=close]":{top:"6px",right:"6px",padding:"0 6px",fontSize:"1rem",backgroundColor:"var(--cm-search-closeButton-backgroundColor)",color:"var(--cm-search-closeButton-textColor)","&:hover":{"border-radius":"6px",color:"var(--cm-search-closeButton-textColorHover)",backgroundColor:"var(--cm-search-closeButton-backgroundColorHover)"}},".cm-search input":{background:"var(--cm-search-input-backgroundColor)",borderColor:"var(--cm-search-input-borderColor)",color:"var(--cm-search-input-textColor)",outline:"none",borderRadius:"4px","&:focus-visible":{borderColor:"var(--cm-search-input-borderColorFocused)"}},".cm-tooltip":{background:"var(--cm-tooltip-backgroundColor)",border:"1px solid transparent",borderColor:"var(--cm-tooltip-borderColor)",color:"var(--cm-tooltip-textColor)"},".cm-tooltip.cm-tooltip-autocomplete ul li[aria-selected]":{background:"var(--cm-tooltip-backgroundColorSelected)",color:"var(--cm-tooltip-textColorSelected)"},".cm-searchMatch":{backgroundColor:"var(--cm-searchMatch-backgroundColor)"},".cm-tooltip.cm-readonly-tooltip":{padding:"4px",whiteSpace:"nowrap",backgroundColor:"var(--codeia-elements-bg-depth-2)",borderColor:"var(--codeia-elements-borderColorActive)","& .cm-tooltip-arrow:before":{borderTopColor:"var(--codeia-elements-borderColorActive)"},"& .cm-tooltip-arrow:after":{borderTopColor:"transparent"}}})}function r4(){return O_e}function n4(){return N_e}const j_e={key:"Tab",run:$_e,shift:Vj};function $_e({state:t,dispatch:e}){return t.readOnly?!1:(e(t.update(U_e(t,(r,n,s)=>{s.push({from:r,to:n,insert:t.facet(pc)})}),{userEvent:"input.indent"})),!0)}function U_e(t,e){return t.changeByRange(r=>{const n=[],s=t.doc.lineAt(r.from);if(r.from===r.to)e(r.from,void 0,n,s);else if(r.from<r.to&&r.to<=s.to)e(r.from,r.to,n,s);else{let o=-1;for(let a=r.from;a<=r.to;){const l=t.doc.lineAt(a);l.number>o&&(r.empty||r.to>l.from)&&(e(l.from,void 0,n,l),o=l.number),a=l.to+1}}const i=t.changes(n);return{changes:n,range:xe.range(i.mapPos(r.anchor,1),i.mapPos(r.head,1))}})}const H_e=[lr.of({name:"VUE",extensions:["vue"],async load(){return ee(()=>import("./index-SqehUPdz.js"),__vite__mapDeps([96,97,98,29,28,99,100])).then(t=>t.vue())}}),lr.of({name:"TS",extensions:["ts"],async load(){return ee(()=>import("./index-T6vtev0h.js"),__vite__mapDeps([100,98,29,28])).then(t=>t.javascript({typescript:!0}))}}),lr.of({name:"JS",extensions:["js","mjs","cjs"],async load(){return ee(()=>import("./index-T6vtev0h.js"),__vite__mapDeps([100,98,29,28])).then(t=>t.javascript())}}),lr.of({name:"TSX",extensions:["tsx"],async load(){return ee(()=>import("./index-T6vtev0h.js"),__vite__mapDeps([100,98,29,28])).then(t=>t.javascript({jsx:!0,typescript:!0}))}}),lr.of({name:"JSX",extensions:["jsx"],async load(){return ee(()=>import("./index-T6vtev0h.js"),__vite__mapDeps([100,98,29,28])).then(t=>t.javascript({jsx:!0}))}}),lr.of({name:"HTML",extensions:["html"],async load(){return ee(()=>import("./index-BIdaEGAo.js"),__vite__mapDeps([97,98,29,28,99,100])).then(t=>t.html())}}),lr.of({name:"CSS",extensions:["css"],async load(){return ee(()=>import("./index-C2ln8tH6.js"),__vite__mapDeps([99,98,29,28])).then(t=>t.css())}}),lr.of({name:"SASS",extensions:["sass"],async load(){return ee(()=>import("./index-CTjSYwf9.js"),__vite__mapDeps([101,98,29,28,99])).then(t=>t.sass({indented:!0}))}}),lr.of({name:"SCSS",extensions:["scss"],async load(){return ee(()=>import("./index-CTjSYwf9.js"),__vite__mapDeps([101,98,29,28,99])).then(t=>t.sass({indented:!1}))}}),lr.of({name:"JSON",extensions:["json"],async load(){return ee(()=>import("./index-DyLHor89.js"),__vite__mapDeps([102,98,29,28])).then(t=>t.json())}}),lr.of({name:"Markdown",extensions:["md"],async load(){return ee(()=>import("./index-r-rZF91s.js"),__vite__mapDeps([103,97,98,29,28,99,100])).then(t=>t.markdown())}}),lr.of({name:"Wasm",extensions:["wat"],async load(){return ee(()=>import("./index-D72bIYZz.js"),__vite__mapDeps([104,98,29,28])).then(t=>t.wast())}}),lr.of({name:"Python",extensions:["py"],async load(){return ee(()=>import("./index-GzxnQwyo.js"),__vite__mapDeps([105,98,29,28])).then(t=>t.python())}}),lr.of({name:"C++",extensions:["cpp"],async load(){return ee(()=>import("./index-DUVexiE2.js"),__vite__mapDeps([106,98,29,28])).then(t=>t.cpp())}})];async function V_e(t){const e=lr.matchFilename(H_e,t);if(e)return await e.load()}class G_e extends Pa{constructor(e){super(),this._value=e}eq(e){return e._value===this._value}toDOM(){const e=document.createElement("span");return e.textContent="*".repeat(this._value.length),e.className="cm-masked-text",e}ignoreEvent(){return!1}}function z_e(t){return nr.fromClass(class{decorations;constructor(e){this.decorations=this.buildDecorations(e)}update(e){(e.docChanged||e.viewportChanged)&&(this.decorations=this.buildDecorations(e.view))}buildDecorations(e){const r=t();if(!(r?.endsWith(".env")||r?.includes(".env.")||r?.includes("/.env")))return rt.none;const s=[],i=e.state.doc;for(let o=1;o<=i.lines;o++){const a=i.line(o),l=a.text,c=l.match(/^([^=]+)=(.+)$/);if(c&&!l.trim().startsWith("#")){const[,u,d]=c,h=a.from+u.length+1;s.push(rt.replace({inclusive:!0,widget:new G_e(d)}).range(h,a.to))}}return rt.set(s)}},{decorations:e=>e.decorations})}const Eu=en("CodeMirrorEditor");let s4;const i4=Qe.define(),W_e=sr.define({create:()=>[],update(t,e){if(!e.state.readOnly)return[];for(const r of e.effects)if(r.is(i4)&&r.value)return J_e(e.state);return[]},provide:t=>t1.computeN([t],e=>e.field(t))}),S1=Qe.define(),CP=sr.define({create(){return!0},update(t,e){for(const r of e.effects)if(r.is(S1))return r.value;return t}}),o4=k.memo(({id:t,doc:e,debounceScroll:r=100,debounceChange:n=150,autoFocusOnDocumentChange:s=!1,editable:i=!0,onScroll:o,onChange:a,onSave:l,theme:c,settings:u,className:d=""})=>{ec.trace("CodeMirrorEditor");const[h]=k.useState(new va),[f]=k.useState(new va),v=k.useRef(null),m=k.useRef(),p=k.useRef(),g=k.useRef(),y=k.useRef(),_=k.useRef(o),b=k.useRef(a),w=k.useRef(l);return k.useEffect(()=>{_.current=o,b.current=a,w.current=l,g.current=e,s4=e,p.current=c}),k.useEffect(()=>{if(!(!m.current||!e||e.isBinary))if(typeof e.scroll?.line=="number"){const E=e.scroll.line,S=e.scroll.column??0;try{const x=m.current.state.doc.lines;if(E<x){const T=m.current.state.doc.line(E+1).from+S;m.current.dispatch({selection:{anchor:T},scrollIntoView:!0}),m.current.focus()}else Eu.warn(`Invalid line number ${E+1} in ${x}-line document`)}catch(x){Eu.error("Error scrolling to line:",x)}}else(typeof e.scroll?.top=="number"||typeof e.scroll?.left=="number")&&m.current.scrollDOM.scrollTo(e.scroll.left??0,e.scroll.top??0)},[e?.scroll?.line,e?.scroll?.column,e?.scroll?.top,e?.scroll?.left]),k.useEffect(()=>{const E=Cg(x=>{b.current?.(x)},n),S=new Fe({parent:v.current,dispatchTransactions(x){const T=S.state.selection;S.update(x);const D=S.state.selection,O=D!==T&&(D===void 0||T===void 0||!D.eq(T));g.current&&(x.some(R=>R.docChanged)||O)&&(E({selection:S.state.selection,content:S.state.doc.toString()}),y.current.set(g.current.filePath,S.state))}});return m.current=S,()=>{m.current?.destroy(),m.current=void 0}},[]),k.useEffect(()=>{m.current&&m.current.dispatch({effects:[t4(c)]})},[c]),k.useEffect(()=>{y.current=new Map},[t]),k.useEffect(()=>{const E=y.current,S=m.current,x=p.current;if(!e){const R=kP("",x,u,_,r,w,[h.of([]),f.of([])]);S.setState(R),K_e(S);return}if(e.isBinary)return;e.filePath===""&&Eu.warn("File path should not be empty");let T=E.get(e.filePath);T||(T=kP(e.value,x,u,_,r,w,[h.of([]),f.of([z_e(()=>g.current?.filePath)])]),E.set(e.filePath,T)),S.setState(T),q_e(S,x,i,h,s,e);const D=wr(),{locked:O}=uS(e.filePath,D);O&&S.dispatch({effects:[S1.of(!1)]})},[e?.value,i,e?.filePath,s]),C.jsxs("div",{className:Te("relative h-full",d),children:[e?.isBinary&&C.jsx(A_e,{}),C.jsx("div",{className:"h-full overflow-hidden",ref:v})]})});o4.displayName="CodeMirrorEditor";function kP(t,e,r,n,s,i,o){return ot.create({doc:t,extensions:[Fe.domEventHandlers({scroll:Cg((a,l)=>{a.target===l.scrollDOM&&n.current?.({left:l.scrollDOM.scrollLeft,top:l.scrollDOM.scrollTop})},s),keydown:(a,l)=>l.state.readOnly?(l.dispatch({effects:[i4.of(a.key!=="Escape")]}),!0):!1}),B_e(e,r),o0e(),Kg.of([...a_e,...m0e,...E_e,{key:"Tab",run:lj},{key:"Mod-s",preventDefault:!0,run:()=>(i.current?.(),!0)},j_e]),pc.of("	"),qye({closeOnBlur:!1}),Tge({position:"absolute",parent:document.body,tooltipSpace:a=>{const l=a.dom.getBoundingClientRect();return{top:l.top-50,left:l.left,bottom:l.bottom,right:l.right+10}}}),Fye(),$ge(),xge(),wge(),gge(),Jve(),ot.tabSize.of(r?.tabSize??2),Tve(),W_e,CP,ot.readOnly.from(CP,a=>!a),Vge(),Sge(),Bve({markerDOM:a=>{const l=document.createElement("div");return l.className=`fold-icon ${a?"i-ph-caret-down-bold":"i-ph-caret-right-bold"}`,l}}),...o]})}function K_e(t){t.dispatch({selection:{anchor:0},changes:{from:0,to:t.state.doc.length,insert:""}}),t.scrollDOM.scrollTo(0,0)}function q_e(t,e,r,n,s,i){i.value!==t.state.doc.toString()&&t.dispatch({selection:{anchor:0},changes:{from:0,to:t.state.doc.length,insert:i.value}});const o=wr(),{locked:a}=uS(i.filePath,o);t.dispatch({effects:[S1.of(r&&!i.isBinary&&!a)]}),V_e(i.filePath).then(l=>{l&&(t.dispatch({effects:[n.reconfigure([l]),t4(e)]}),requestAnimationFrame(()=>{const c=t.scrollDOM.scrollLeft,u=t.scrollDOM.scrollTop,d=i.scroll?.left??0,h=i.scroll?.top??0;if(typeof i.scroll?.line=="number"){const v=i.scroll.line,m=i.scroll.column??0;try{const p=t.state.doc.lines;if(v<p){const g=t.state.doc.line(v+1).from+m;t.dispatch({selection:{anchor:g},scrollIntoView:!0}),t.focus()}else Eu.warn(`Invalid line number ${v+1} in ${p}-line document`)}catch(p){Eu.error("Error scrolling to line:",p)}return}s&&r&&(c!==d||u!==h?t.scrollDOM.addEventListener("scroll",()=>{t.focus()},{once:!0}):t.focus()),t.scrollDOM.scrollTo(d,h)}))})}function J_e(t){if(!t.readOnly)return[];const e=s4;let r="Cannot edit file while AI response is being generated";if(e?.filePath){const n=wr(),{locked:s}=uS(e.filePath,n);s&&(r="This file is locked and cannot be edited")}return t.selection.ranges.filter(n=>n.empty).map(n=>({pos:n.head,above:!0,strictSide:!0,arrow:!0,create:()=>{const s=document.createElement("div");return s.className="cm-readonly-tooltip",s.textContent=r,{dom:s}}}))}const vw=k.memo(({className:t,disabledClassName:e,disabled:r=!1,children:n,onClick:s})=>C.jsx("button",{className:Te("flex items-center shrink-0 gap-1.5 px-1.5 rounded-md py-0.5 text-codeia-elements-item-contentDefault bg-transparent enabled:hover:text-codeia-elements-item-contentActive enabled:hover:bg-codeia-elements-item-backgroundActive disabled:cursor-not-allowed",{[Te("opacity-30",e)]:r},t),disabled:r,onClick:i=>{r||s?.(i)},children:n})),Y_e=k.memo,Z_e=Y_e(({selected:t,options:e,setSelected:r})=>{const n=!!e.middle,s=t===e.left.value,i=n&&e.middle?t===e.middle.value:!1;return C.jsxs("div",{className:"flex items-center flex-wrap shrink-0 gap-1 bg-codeia-elements-background-depth-1 overflow-hidden rounded-full p-1",children:[C.jsx(a0,{selected:s,setSelected:()=>r?.(e.left.value),children:e.left.text}),e.middle&&C.jsx(a0,{selected:i,setSelected:()=>r?.(e.middle.value),children:e.middle.text}),C.jsx(a0,{selected:!s&&!i,setSelected:()=>r?.(e.right.value),children:e.right.text})]})}),a0=k.memo(({selected:t,children:e,setSelected:r})=>C.jsxs("button",{onClick:r,className:Te("bg-transparent text-sm px-2.5 py-0.5 rounded-full relative",t?"text-codeia-elements-item-contentAccent":"text-codeia-elements-item-contentDefault hover:text-codeia-elements-item-contentActive"),children:[C.jsx("span",{className:"relative z-10",children:e}),t&&C.jsx(mt.span,{layoutId:"pill-tab",transition:{duration:.2,ease:ho},className:"absolute inset-0 z-0 bg-codeia-elements-item-backgroundAccent rounded-full"})]})),{createElement:Yl,createContext:X_e,forwardRef:a4,useCallback:Wr,useContext:l4,useEffect:la,useImperativeHandle:c4,useLayoutEffect:Q_e,useMemo:ebe,useRef:Kr,useState:El}=Al,TP=Al[`useId${Math.random()}`.slice(0,5)],tbe=Q_e,ev=X_e(null);ev.displayName="PanelGroupContext";const ca=tbe,rbe=typeof TP=="function"?TP:()=>null;let nbe=0;function E1(t=null){const e=rbe(),r=Kr(t||e||null);return r.current===null&&(r.current=""+nbe++),t??r.current}function u4({children:t,className:e="",collapsedSize:r,collapsible:n,defaultSize:s,forwardedRef:i,id:o,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:h,style:f,tagName:v="div",...m}){const p=l4(ev);if(p===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:g,expandPanel:y,getPanelSize:_,getPanelStyle:b,groupId:w,isPanelCollapsed:E,reevaluatePanelConstraints:S,registerPanel:x,resizePanel:T,unregisterPanel:D}=p,O=E1(o),R=Kr({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:r,collapsible:n,defaultSize:s,maxSize:a,minSize:l},id:O,idIsFromProps:o!==void 0,order:h});Kr({didLogMissingDefaultSizeWarning:!1}),ca(()=>{const{callbacks:A,constraints:H}=R.current,K={...H};R.current.id=O,R.current.idIsFromProps=o!==void 0,R.current.order=h,A.onCollapse=c,A.onExpand=u,A.onResize=d,H.collapsedSize=r,H.collapsible=n,H.defaultSize=s,H.maxSize=a,H.minSize=l,(K.collapsedSize!==H.collapsedSize||K.collapsible!==H.collapsible||K.maxSize!==H.maxSize||K.minSize!==H.minSize)&&S(R.current,K)}),ca(()=>{const A=R.current;return x(A),()=>{D(A)}},[h,O,x,D]),c4(i,()=>({collapse:()=>{g(R.current)},expand:A=>{y(R.current,A)},getId(){return O},getSize(){return _(R.current)},isCollapsed(){return E(R.current)},isExpanded(){return!E(R.current)},resize:A=>{T(R.current,A)}}),[g,y,_,E,O,T]);const P=b(R.current,s);return Yl(v,{...m,children:t,className:e,id:o,style:{...P,...f},"data-panel":"","data-panel-collapsible":n||void 0,"data-panel-group-id":w,"data-panel-id":O,"data-panel-size":parseFloat(""+P.flexGrow).toFixed(1)})}const Cu=a4((t,e)=>Yl(u4,{...t,forwardedRef:e}));u4.displayName="Panel";Cu.displayName="forwardRef(Panel)";let yw=null,Qo=null;function sbe(t,e){if(e){const r=(e&m4)!==0,n=(e&g4)!==0,s=(e&v4)!==0,i=(e&y4)!==0;if(r)return s?"se-resize":i?"ne-resize":"e-resize";if(n)return s?"sw-resize":i?"nw-resize":"w-resize";if(s)return"s-resize";if(i)return"n-resize"}switch(t){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function ibe(){Qo!==null&&(document.head.removeChild(Qo),yw=null,Qo=null)}function l0(t,e){const r=sbe(t,e);yw!==r&&(yw=r,Qo===null&&(Qo=document.createElement("style"),document.head.appendChild(Qo)),Qo.innerHTML=`*{cursor: ${r}!important;}`)}function d4(t){return t.type==="keydown"}function h4(t){return t.type.startsWith("pointer")}function f4(t){return t.type.startsWith("mouse")}function tv(t){if(h4(t)){if(t.isPrimary)return{x:t.clientX,y:t.clientY}}else if(f4(t))return{x:t.clientX,y:t.clientY};return{x:1/0,y:1/0}}function obe(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function abe(t,e,r){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function lbe(t,e){if(t===e)throw new Error("Cannot compare node with itself");const r={a:PP(t),b:PP(e)};let n;for(;r.a.at(-1)===r.b.at(-1);)t=r.a.pop(),e=r.b.pop(),n=t;Ze(n,"Stacking order can only be calculated for elements with a common ancestor");const s={a:RP(AP(r.a)),b:RP(AP(r.b))};if(s.a===s.b){const i=n.childNodes,o={a:r.a.at(-1),b:r.b.at(-1)};let a=i.length;for(;a--;){const l=i[a];if(l===o.a)return 1;if(l===o.b)return-1}}return Math.sign(s.a-s.b)}const cbe=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ube(t){var e;const r=getComputedStyle((e=p4(t))!==null&&e!==void 0?e:t).display;return r==="flex"||r==="inline-flex"}function dbe(t){const e=getComputedStyle(t);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||ube(t))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||cbe.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function AP(t){let e=t.length;for(;e--;){const r=t[e];if(Ze(r,"Missing node"),dbe(r))return r}return null}function RP(t){return t&&Number(getComputedStyle(t).zIndex)||0}function PP(t){const e=[];for(;t;)e.push(t),t=p4(t);return e}function p4(t){const{parentNode:e}=t;return e&&e instanceof ShadowRoot?e.host:e}const m4=1,g4=2,v4=4,y4=8,hbe=obe()==="coarse";let Yn=[],Cl=!1,Vi=new Map,rv=new Map;const Fd=new Set;function fbe(t,e,r,n,s){var i;const{ownerDocument:o}=e,a={direction:r,element:e,hitAreaMargins:n,setResizeHandlerState:s},l=(i=Vi.get(o))!==null&&i!==void 0?i:0;return Vi.set(o,l+1),Fd.add(a),Km(),function(){var u;rv.delete(t),Fd.delete(a);const d=(u=Vi.get(o))!==null&&u!==void 0?u:1;if(Vi.set(o,d-1),Km(),d===1&&Vi.delete(o),Yn.includes(a)){const h=Yn.indexOf(a);h>=0&&Yn.splice(h,1),k1(),s("up",!0,null)}}}function IP(t){const{target:e}=t,{x:r,y:n}=tv(t);Cl=!0,C1({target:e,x:r,y:n}),Km(),Yn.length>0&&(qm("down",t),t.preventDefault(),t.stopPropagation())}function Nc(t){const{x:e,y:r}=tv(t);if(Cl&&t.buttons===0&&(Cl=!1,qm("up",t)),!Cl){const{target:n}=t;C1({target:n,x:e,y:r})}qm("move",t),k1(),Yn.length>0&&t.preventDefault()}function Ua(t){const{target:e}=t,{x:r,y:n}=tv(t);rv.clear(),Cl=!1,Yn.length>0&&t.preventDefault(),qm("up",t),C1({target:e,x:r,y:n}),k1(),Km()}function C1({target:t,x:e,y:r}){Yn.splice(0);let n=null;(t instanceof HTMLElement||t instanceof SVGElement)&&(n=t),Fd.forEach(s=>{const{element:i,hitAreaMargins:o}=s,a=i.getBoundingClientRect(),{bottom:l,left:c,right:u,top:d}=a,h=hbe?o.coarse:o.fine;if(e>=c-h&&e<=u+h&&r>=d-h&&r<=l+h){if(n!==null&&document.contains(n)&&i!==n&&!i.contains(n)&&!n.contains(i)&&lbe(n,i)>0){let v=n,m=!1;for(;v&&!v.contains(i);){if(abe(v.getBoundingClientRect(),a)){m=!0;break}v=v.parentElement}if(m)return}Yn.push(s)}})}function c0(t,e){rv.set(t,e)}function k1(){let t=!1,e=!1;Yn.forEach(n=>{const{direction:s}=n;s==="horizontal"?t=!0:e=!0});let r=0;rv.forEach(n=>{r|=n}),t&&e?l0("intersection",r):t?l0("horizontal",r):e?l0("vertical",r):ibe()}function Km(){Vi.forEach((t,e)=>{const{body:r}=e;r.removeEventListener("contextmenu",Ua),r.removeEventListener("pointerdown",IP),r.removeEventListener("pointerleave",Nc),r.removeEventListener("pointermove",Nc)}),window.removeEventListener("pointerup",Ua),window.removeEventListener("pointercancel",Ua),Fd.size>0&&(Cl?(Yn.length>0&&Vi.forEach((t,e)=>{const{body:r}=e;t>0&&(r.addEventListener("contextmenu",Ua),r.addEventListener("pointerleave",Nc),r.addEventListener("pointermove",Nc))}),window.addEventListener("pointerup",Ua),window.addEventListener("pointercancel",Ua)):Vi.forEach((t,e)=>{const{body:r}=e;t>0&&(r.addEventListener("pointerdown",IP,{capture:!0}),r.addEventListener("pointermove",Nc))}))}function qm(t,e){Fd.forEach(r=>{const{setResizeHandlerState:n}=r,s=Yn.includes(r);n(t,s,e)})}function pbe(){const[t,e]=El(0);return Wr(()=>e(r=>r+1),[])}function Ze(t,e){if(!t)throw console.error(e),Error(e)}const T1=10;function Sa(t,e,r=T1){return t.toFixed(r)===e.toFixed(r)?0:t>e?1:-1}function ui(t,e,r=T1){return Sa(t,e,r)===0}function an(t,e,r){return Sa(t,e,r)===0}function mbe(t,e,r){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++){const s=t[n],i=e[n];if(!an(s,i,r))return!1}return!0}function cl({panelConstraints:t,panelIndex:e,size:r}){const n=t[e];Ze(n!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:s=0,collapsible:i,maxSize:o=100,minSize:a=0}=n;if(Sa(r,a)<0)if(i){const l=(s+a)/2;Sa(r,l)<0?r=s:r=a}else r=a;return r=Math.min(o,r),r=parseFloat(r.toFixed(T1)),r}function Yc({delta:t,initialLayout:e,panelConstraints:r,pivotIndices:n,prevLayout:s,trigger:i}){if(an(t,0))return e;const o=[...e],[a,l]=n;Ze(a!=null,"Invalid first pivot index"),Ze(l!=null,"Invalid second pivot index");let c=0;if(i==="keyboard"){{const d=t<0?l:a,h=r[d];Ze(h,`Panel constraints not found for index ${d}`);const{collapsedSize:f=0,collapsible:v,minSize:m=0}=h;if(v){const p=e[d];if(Ze(p!=null,`Previous layout not found for panel index ${d}`),an(p,f)){const g=m-p;Sa(g,Math.abs(t))>0&&(t=t<0?0-g:g)}}}{const d=t<0?a:l,h=r[d];Ze(h,`No panel constraints found for index ${d}`);const{collapsedSize:f=0,collapsible:v,minSize:m=0}=h;if(v){const p=e[d];if(Ze(p!=null,`Previous layout not found for panel index ${d}`),an(p,m)){const g=p-f;Sa(g,Math.abs(t))>0&&(t=t<0?0-g:g)}}}}{const d=t<0?1:-1;let h=t<0?l:a,f=0;for(;;){const m=e[h];Ze(m!=null,`Previous layout not found for panel index ${h}`);const g=cl({panelConstraints:r,panelIndex:h,size:100})-m;if(f+=g,h+=d,h<0||h>=r.length)break}const v=Math.min(Math.abs(t),Math.abs(f));t=t<0?0-v:v}{let h=t<0?a:l;for(;h>=0&&h<r.length;){const f=Math.abs(t)-Math.abs(c),v=e[h];Ze(v!=null,`Previous layout not found for panel index ${h}`);const m=v-f,p=cl({panelConstraints:r,panelIndex:h,size:m});if(!an(v,p)&&(c+=v-p,o[h]=p,c.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?h--:h++}}if(mbe(s,o))return s;{const d=t<0?l:a,h=e[d];Ze(h!=null,`Previous layout not found for panel index ${d}`);const f=h+c,v=cl({panelConstraints:r,panelIndex:d,size:f});if(o[d]=v,!an(v,f)){let m=f-v,g=t<0?l:a;for(;g>=0&&g<r.length;){const y=o[g];Ze(y!=null,`Previous layout not found for panel index ${g}`);const _=y+m,b=cl({panelConstraints:r,panelIndex:g,size:_});if(an(y,b)||(m-=b-y,o[g]=b),an(m,0))break;t>0?g--:g++}}}const u=o.reduce((d,h)=>h+d,0);return an(u,100)?o:s}function gbe({layout:t,panelsArray:e,pivotIndices:r}){let n=0,s=100,i=0,o=0;const a=r[0];Ze(a!=null,"No pivot index found"),e.forEach((d,h)=>{const{constraints:f}=d,{maxSize:v=100,minSize:m=0}=f;h===a?(n=m,s=v):(i+=m,o+=v)});const l=Math.min(s,100-i),c=Math.max(n,100-o),u=t[a];return{valueMax:l,valueMin:c,valueNow:u}}function jd(t,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function _4(t,e,r=document){const s=jd(t,r).findIndex(i=>i.getAttribute("data-panel-resize-handle-id")===e);return s??null}function b4(t,e,r){const n=_4(t,e,r);return n!=null?[n,n+1]:[-1,-1]}function w4(t,e=document){var r;if(e instanceof HTMLElement&&(e==null||(r=e.dataset)===null||r===void 0?void 0:r.panelGroupId)==t)return e;const n=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return n||null}function nv(t,e=document){const r=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return r||null}function vbe(t,e,r,n=document){var s,i,o,a;const l=nv(e,n),c=jd(t,n),u=l?c.indexOf(l):-1,d=(s=(i=r[u])===null||i===void 0?void 0:i.id)!==null&&s!==void 0?s:null,h=(o=(a=r[u+1])===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:null;return[d,h]}function ybe({committedValuesRef:t,eagerValuesRef:e,groupId:r,layout:n,panelDataArray:s,panelGroupElement:i,setLayout:o}){Kr({didWarnAboutMissingResizeHandle:!1}),ca(()=>{if(!i)return;const a=jd(r,i);for(let l=0;l<s.length-1;l++){const{valueMax:c,valueMin:u,valueNow:d}=gbe({layout:n,panelsArray:s,pivotIndices:[l,l+1]}),h=a[l];if(h!=null){const f=s[l];Ze(f,`No panel data found for index "${l}"`),h.setAttribute("aria-controls",f.id),h.setAttribute("aria-valuemax",""+Math.round(c)),h.setAttribute("aria-valuemin",""+Math.round(u)),h.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[r,n,s,i]),la(()=>{if(!i)return;const a=e.current;Ze(a,"Eager values not found");const{panelDataArray:l}=a,c=w4(r,i);Ze(c!=null,`No group found for id "${r}"`);const u=jd(r,i);Ze(u,`No resize handles found for group id "${r}"`);const d=u.map(h=>{const f=h.getAttribute("data-panel-resize-handle-id");Ze(f,"Resize handle element has no handle id attribute");const[v,m]=vbe(r,f,l,i);if(v==null||m==null)return()=>{};const p=g=>{if(!g.defaultPrevented)switch(g.key){case"Enter":{g.preventDefault();const y=l.findIndex(_=>_.id===v);if(y>=0){const _=l[y];Ze(_,`No panel data found for index ${y}`);const b=n[y],{collapsedSize:w=0,collapsible:E,minSize:S=0}=_.constraints;if(b!=null&&E){const x=Yc({delta:an(b,w)?S-w:w-b,initialLayout:n,panelConstraints:l.map(T=>T.constraints),pivotIndices:b4(r,f,i),prevLayout:n,trigger:"keyboard"});n!==x&&o(x)}}break}}};return h.addEventListener("keydown",p),()=>{h.removeEventListener("keydown",p)}});return()=>{d.forEach(h=>h())}},[i,t,e,r,n,s,o])}function OP(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function x4(t,e){const r=t==="horizontal",{x:n,y:s}=tv(e);return r?n:s}function _be(t,e,r,n,s){const i=r==="horizontal",o=nv(e,s);Ze(o,`No resize handle element found for id "${e}"`);const a=o.getAttribute("data-panel-group-id");Ze(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=n;const c=x4(r,t),u=w4(a,s);Ze(u,`No group element found for id "${a}"`);const d=u.getBoundingClientRect(),h=i?d.width:d.height;return(c-l)/h*100}function bbe(t,e,r,n,s,i){if(d4(t)){const o=r==="horizontal";let a=0;t.shiftKey?a=100:s!=null?a=s:a=10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return n==null?0:_be(t,e,r,n,i)}function wbe({panelDataArray:t}){const e=Array(t.length),r=t.map(i=>i.constraints);let n=0,s=100;for(let i=0;i<t.length;i++){const o=r[i];Ze(o,`Panel constraints not found for index ${i}`);const{defaultSize:a}=o;a!=null&&(n++,e[i]=a,s-=a)}for(let i=0;i<t.length;i++){const o=r[i];Ze(o,`Panel constraints not found for index ${i}`);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-n,c=s/l;n++,e[i]=c,s-=c}return e}function Ha(t,e,r){e.forEach((n,s)=>{const i=t[s];Ze(i,`Panel data not found for index ${s}`);const{callbacks:o,constraints:a,id:l}=i,{collapsedSize:c=0,collapsible:u}=a,d=r[l];if(d==null||n!==d){r[l]=n;const{onCollapse:h,onExpand:f,onResize:v}=o;v&&v(n,d),u&&(h||f)&&(f&&(d==null||ui(d,c))&&!ui(n,c)&&f(),h&&(d==null||!ui(d,c))&&ui(n,c)&&h())}})}function Ef(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r])return!1;return!0}function xbe({defaultSize:t,dragState:e,layout:r,panelData:n,panelIndex:s,precision:i=3}){const o=r[s];let a;return o==null?a=t!=null?t.toPrecision(i):"1":n.length===1?a="1":a=o.toPrecision(i),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function Sbe(t,e=10){let r=null;return(...s)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{t(...s)},e)}}function DP(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,r)=>{localStorage.setItem(e,r)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function S4(t){return`react-resizable-panels:${t}`}function E4(t){return t.map(e=>{const{constraints:r,id:n,idIsFromProps:s,order:i}=e;return s?n:i?`${i}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((e,r)=>e.localeCompare(r)).join(",")}function C4(t,e){try{const r=S4(t),n=e.getItem(r);if(n){const s=JSON.parse(n);if(typeof s=="object"&&s!=null)return s}}catch{}return null}function Ebe(t,e,r){var n,s;const i=(n=C4(t,r))!==null&&n!==void 0?n:{},o=E4(e);return(s=i[o])!==null&&s!==void 0?s:null}function Cbe(t,e,r,n,s){var i;const o=S4(t),a=E4(e),l=(i=C4(t,s))!==null&&i!==void 0?i:{};l[a]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{s.setItem(o,JSON.stringify(l))}catch(c){console.error(c)}}function MP({layout:t,panelConstraints:e}){const r=[...t],n=r.reduce((i,o)=>i+o,0);if(r.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${r.map(i=>`${i}%`).join(", ")}`);if(!an(n,100)&&r.length>0)for(let i=0;i<e.length;i++){const o=r[i];Ze(o!=null,`No layout data found for index ${i}`);const a=100/n*o;r[i]=a}let s=0;for(let i=0;i<e.length;i++){const o=r[i];Ze(o!=null,`No layout data found for index ${i}`);const a=cl({panelConstraints:e,panelIndex:i,size:o});o!=a&&(s+=o-a,r[i]=a)}if(!an(s,0))for(let i=0;i<e.length;i++){const o=r[i];Ze(o!=null,`No layout data found for index ${i}`);const a=o+s,l=cl({panelConstraints:e,panelIndex:i,size:a});if(o!==l&&(s-=l-o,r[i]=l,an(s,0)))break}return r}const kbe=100,Zc={getItem:t=>(DP(Zc),Zc.getItem(t)),setItem:(t,e)=>{DP(Zc),Zc.setItem(t,e)}},LP={};function k4({autoSaveId:t=null,children:e,className:r="",direction:n,forwardedRef:s,id:i=null,onLayout:o=null,keyboardResizeBy:a=null,storage:l=Zc,style:c,tagName:u="div",...d}){const h=E1(i),f=Kr(null),[v,m]=El(null),[p,g]=El([]),y=pbe(),_=Kr({}),b=Kr(new Map),w=Kr(0),E=Kr({autoSaveId:t,direction:n,dragState:v,id:h,keyboardResizeBy:a,onLayout:o,storage:l}),S=Kr({layout:p,panelDataArray:[],panelDataArrayChanged:!1});Kr({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),c4(s,()=>({getId:()=>E.current.id,getLayout:()=>{const{layout:J}=S.current;return J},setLayout:J=>{const{onLayout:ne}=E.current,{layout:te,panelDataArray:me}=S.current,re=MP({layout:J,panelConstraints:me.map(F=>F.constraints)});OP(te,re)||(g(re),S.current.layout=re,ne&&ne(re),Ha(me,re,_.current))}}),[]),ca(()=>{E.current.autoSaveId=t,E.current.direction=n,E.current.dragState=v,E.current.id=h,E.current.onLayout=o,E.current.storage=l}),ybe({committedValuesRef:E,eagerValuesRef:S,groupId:h,layout:p,panelDataArray:S.current.panelDataArray,setLayout:g,panelGroupElement:f.current}),la(()=>{const{panelDataArray:J}=S.current;if(t){if(p.length===0||p.length!==J.length)return;let ne=LP[t];ne==null&&(ne=Sbe(Cbe,kbe),LP[t]=ne);const te=[...J],me=new Map(b.current);ne(t,te,me,p,l)}},[t,p,l]),la(()=>{});const x=Wr(J=>{const{onLayout:ne}=E.current,{layout:te,panelDataArray:me}=S.current;if(J.constraints.collapsible){const re=me.map(oe=>oe.constraints),{collapsedSize:F=0,panelSize:X,pivotIndices:Y}=Mo(me,J,te);if(Ze(X!=null,`Panel size not found for panel "${J.id}"`),!ui(X,F)){b.current.set(J.id,X);const le=Ya(me,J)===me.length-1?X-F:F-X,ue=Yc({delta:le,initialLayout:te,panelConstraints:re,pivotIndices:Y,prevLayout:te,trigger:"imperative-api"});Ef(te,ue)||(g(ue),S.current.layout=ue,ne&&ne(ue),Ha(me,ue,_.current))}}},[]),T=Wr((J,ne)=>{const{onLayout:te}=E.current,{layout:me,panelDataArray:re}=S.current;if(J.constraints.collapsible){const F=re.map(N=>N.constraints),{collapsedSize:X=0,panelSize:Y=0,minSize:oe=0,pivotIndices:le}=Mo(re,J,me),ue=ne??oe;if(ui(Y,X)){const N=b.current.get(J.id),Z=N!=null&&N>=ue?N:ue,W=Ya(re,J)===re.length-1?Y-Z:Z-Y,z=Yc({delta:W,initialLayout:me,panelConstraints:F,pivotIndices:le,prevLayout:me,trigger:"imperative-api"});Ef(me,z)||(g(z),S.current.layout=z,te&&te(z),Ha(re,z,_.current))}}},[]),D=Wr(J=>{const{layout:ne,panelDataArray:te}=S.current,{panelSize:me}=Mo(te,J,ne);return Ze(me!=null,`Panel size not found for panel "${J.id}"`),me},[]),O=Wr((J,ne)=>{const{panelDataArray:te}=S.current,me=Ya(te,J);return xbe({defaultSize:ne,dragState:v,layout:p,panelData:te,panelIndex:me})},[v,p]),R=Wr(J=>{const{layout:ne,panelDataArray:te}=S.current,{collapsedSize:me=0,collapsible:re,panelSize:F}=Mo(te,J,ne);return Ze(F!=null,`Panel size not found for panel "${J.id}"`),re===!0&&ui(F,me)},[]),P=Wr(J=>{const{layout:ne,panelDataArray:te}=S.current,{collapsedSize:me=0,collapsible:re,panelSize:F}=Mo(te,J,ne);return Ze(F!=null,`Panel size not found for panel "${J.id}"`),!re||Sa(F,me)>0},[]),A=Wr(J=>{const{panelDataArray:ne}=S.current;ne.push(J),ne.sort((te,me)=>{const re=te.order,F=me.order;return re==null&&F==null?0:re==null?-1:F==null?1:re-F}),S.current.panelDataArrayChanged=!0,y()},[y]);ca(()=>{if(S.current.panelDataArrayChanged){S.current.panelDataArrayChanged=!1;const{autoSaveId:J,onLayout:ne,storage:te}=E.current,{layout:me,panelDataArray:re}=S.current;let F=null;if(J){const Y=Ebe(J,re,te);Y&&(b.current=new Map(Object.entries(Y.expandToSizes)),F=Y.layout)}F==null&&(F=wbe({panelDataArray:re}));const X=MP({layout:F,panelConstraints:re.map(Y=>Y.constraints)});OP(me,X)||(g(X),S.current.layout=X,ne&&ne(X),Ha(re,X,_.current))}}),ca(()=>{const J=S.current;return()=>{J.layout=[]}},[]);const H=Wr(J=>{let ne=!1;const te=f.current;return te&&window.getComputedStyle(te,null).getPropertyValue("direction")==="rtl"&&(ne=!0),function(re){re.preventDefault();const F=f.current;if(!F)return()=>null;const{direction:X,dragState:Y,id:oe,keyboardResizeBy:le,onLayout:ue}=E.current,{layout:N,panelDataArray:Z}=S.current,{initialLayout:ie}=Y??{},W=b4(oe,J,F);let z=bbe(re,J,X,Y,le,F);const ae=X==="horizontal";ae&&ne&&(z=-z);const ce=Z.map(fe=>fe.constraints),ge=Yc({delta:z,initialLayout:ie??N,panelConstraints:ce,pivotIndices:W,prevLayout:N,trigger:d4(re)?"keyboard":"mouse-or-touch"}),de=!Ef(N,ge);(h4(re)||f4(re))&&w.current!=z&&(w.current=z,!de&&z!==0?ae?c0(J,z<0?m4:g4):c0(J,z<0?v4:y4):c0(J,0)),de&&(g(ge),S.current.layout=ge,ue&&ue(ge),Ha(Z,ge,_.current))}},[]),K=Wr((J,ne)=>{const{onLayout:te}=E.current,{layout:me,panelDataArray:re}=S.current,F=re.map(N=>N.constraints),{panelSize:X,pivotIndices:Y}=Mo(re,J,me);Ze(X!=null,`Panel size not found for panel "${J.id}"`);const le=Ya(re,J)===re.length-1?X-ne:ne-X,ue=Yc({delta:le,initialLayout:me,panelConstraints:F,pivotIndices:Y,prevLayout:me,trigger:"imperative-api"});Ef(me,ue)||(g(ue),S.current.layout=ue,te&&te(ue),Ha(re,ue,_.current))},[]),V=Wr((J,ne)=>{const{layout:te,panelDataArray:me}=S.current,{collapsedSize:re=0,collapsible:F}=ne,{collapsedSize:X=0,collapsible:Y,maxSize:oe=100,minSize:le=0}=J.constraints,{panelSize:ue}=Mo(me,J,te);ue!=null&&(F&&Y&&ui(ue,re)?ui(re,X)||K(J,X):ue<le?K(J,le):ue>oe&&K(J,oe))},[K]),q=Wr((J,ne)=>{const{direction:te}=E.current,{layout:me}=S.current;if(!f.current)return;const re=nv(J,f.current);Ze(re,`Drag handle element not found for id "${J}"`);const F=x4(te,ne);m({dragHandleId:J,dragHandleRect:re.getBoundingClientRect(),initialCursorPosition:F,initialLayout:me})},[]),I=Wr(()=>{m(null)},[]),$=Wr(J=>{const{panelDataArray:ne}=S.current,te=Ya(ne,J);te>=0&&(ne.splice(te,1),delete _.current[J.id],S.current.panelDataArrayChanged=!0,y())},[y]),j=ebe(()=>({collapsePanel:x,direction:n,dragState:v,expandPanel:T,getPanelSize:D,getPanelStyle:O,groupId:h,isPanelCollapsed:R,isPanelExpanded:P,reevaluatePanelConstraints:V,registerPanel:A,registerResizeHandle:H,resizePanel:K,startDragging:q,stopDragging:I,unregisterPanel:$,panelGroupElement:f.current}),[x,v,n,T,D,O,h,R,P,V,A,H,K,q,I,$]),U={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Yl(ev.Provider,{value:j},Yl(u,{...d,children:e,className:r,id:i,ref:f,style:{...U,...c},"data-panel-group":"","data-panel-group-direction":n,"data-panel-group-id":h}))}const _w=a4((t,e)=>Yl(k4,{...t,forwardedRef:e}));k4.displayName="PanelGroup";_w.displayName="forwardRef(PanelGroup)";function Ya(t,e){return t.findIndex(r=>r===e||r.id===e.id)}function Mo(t,e,r){const n=Ya(t,e),i=n===t.length-1?[n-1,n]:[n,n+1],o=r[n];return{...e.constraints,panelSize:o,pivotIndices:i}}function Tbe({disabled:t,handleId:e,resizeHandler:r,panelGroupElement:n}){la(()=>{if(t||r==null||n==null)return;const s=nv(e,n);if(s==null)return;const i=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),r(o);break}case"F6":{o.preventDefault();const a=s.getAttribute("data-panel-group-id");Ze(a,`No group element found for id "${a}"`);const l=jd(a,n),c=_4(a,e,n);Ze(c!==null,`No resize element found for id "${e}"`);const u=o.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return s.addEventListener("keydown",i),()=>{s.removeEventListener("keydown",i)}},[n,t,e,r])}function bw({children:t=null,className:e="",disabled:r=!1,hitAreaMargins:n,id:s,onBlur:i,onDragging:o,onFocus:a,style:l={},tabIndex:c=0,tagName:u="div",...d}){var h,f;const v=Kr(null),m=Kr({onDragging:o});la(()=>{m.current.onDragging=o});const p=l4(ev);if(p===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:g,groupId:y,registerResizeHandle:_,startDragging:b,stopDragging:w,panelGroupElement:E}=p,S=E1(s),[x,T]=El("inactive"),[D,O]=El(!1),[R,P]=El(null),A=Kr({state:x});ca(()=>{A.current.state=x}),la(()=>{if(r)P(null);else{const q=_(S);P(()=>q)}},[r,S,_]);const H=(h=n?.coarse)!==null&&h!==void 0?h:15,K=(f=n?.fine)!==null&&f!==void 0?f:5;return la(()=>{if(r||R==null)return;const q=v.current;return Ze(q,"Element ref not attached"),fbe(S,q,g,{coarse:H,fine:K},($,j,U)=>{if(j)switch($){case"down":{T("drag"),Ze(U,'Expected event to be defined for "down" action'),b(S,U);const{onDragging:J}=m.current;J&&J(!0);break}case"move":{const{state:J}=A.current;J!=="drag"&&T("hover"),Ze(U,'Expected event to be defined for "move" action'),R(U);break}case"up":{T("hover"),w();const{onDragging:J}=m.current;J&&J(!1);break}}else T("inactive")})},[H,g,r,K,_,S,R,b,w]),Tbe({disabled:r,handleId:S,resizeHandler:R,panelGroupElement:E}),Yl(u,{...d,children:t,className:e,id:s,onBlur:()=>{O(!1),i?.()},onFocus:()=>{O(!0),a?.()},ref:v,role:"separator",style:{...{touchAction:"none",userSelect:"none"},...l},tabIndex:c,"data-panel-group-direction":g,"data-panel-group-id":y,"data-resize-handle":"","data-resize-handle-active":x==="drag"?"pointer":D?"keyboard":void 0,"data-resize-handle-state":x,"data-panel-resize-handle-enabled":!r,"data-panel-resize-handle-id":S})}bw.displayName="PanelResizeHandle";function Ue(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t?.(s),r===!1||!s.defaultPrevented)return e?.(s)}}function Abe(t,e){const r=k.createContext(e),n=i=>{const{children:o,...a}=i,l=k.useMemo(()=>a,Object.values(a));return C.jsx(r.Provider,{value:l,children:o})};n.displayName=t+"Provider";function s(i){const o=k.useContext(r);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[n,s]}function Gs(t,e=[]){let r=[];function n(i,o){const a=k.createContext(o),l=r.length;r=[...r,o];const c=d=>{const{scope:h,children:f,...v}=d,m=h?.[t]?.[l]||a,p=k.useMemo(()=>v,Object.values(v));return C.jsx(m.Provider,{value:p,children:f})};c.displayName=i+"Provider";function u(d,h){const f=h?.[t]?.[l]||a,v=k.useContext(f);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=r.map(o=>k.createContext(o));return function(a){const l=a?.[t]||i;return k.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[n,Rbe(s,...e)]}function Rbe(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return k.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function NP(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function sv(...t){return e=>{let r=!1;const n=t.map(s=>{const i=NP(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():NP(t[s],null)}}}}function Wt(...t){return k.useCallback(sv(...t),t)}var Zl=k.forwardRef((t,e)=>{const{children:r,...n}=t,s=k.Children.toArray(r),i=s.find(Pbe);if(i){const o=i.props.children,a=s.map(l=>l===i?k.Children.count(o)>1?k.Children.only(null):k.isValidElement(o)?o.props.children:null:l);return C.jsx(ww,{...n,ref:e,children:k.isValidElement(o)?k.cloneElement(o,void 0,a):null})}return C.jsx(ww,{...n,ref:e,children:r})});Zl.displayName="Slot";var ww=k.forwardRef((t,e)=>{const{children:r,...n}=t;if(k.isValidElement(r)){const s=Obe(r),i=Ibe(n,r.props);return r.type!==k.Fragment&&(i.ref=e?sv(e,s):s),k.cloneElement(r,i)}return k.Children.count(r)>1?k.Children.only(null):null});ww.displayName="SlotClone";var T4=({children:t})=>C.jsx(C.Fragment,{children:t});function Pbe(t){return k.isValidElement(t)&&t.type===T4}function Ibe(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...a)=>{i(...a),s(...a)}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function Obe(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function A4(t){const e=t+"CollectionProvider",[r,n]=Gs(e),[s,i]=r(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:v,children:m}=f,p=Re.useRef(null),g=Re.useRef(new Map).current;return C.jsx(s,{scope:v,itemMap:g,collectionRef:p,children:m})};o.displayName=e;const a=t+"CollectionSlot",l=Re.forwardRef((f,v)=>{const{scope:m,children:p}=f,g=i(a,m),y=Wt(v,g.collectionRef);return C.jsx(Zl,{ref:y,children:p})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",d=Re.forwardRef((f,v)=>{const{scope:m,children:p,...g}=f,y=Re.useRef(null),_=Wt(v,y),b=i(c,m);return Re.useEffect(()=>(b.itemMap.set(y,{ref:y,...g}),()=>void b.itemMap.delete(y))),C.jsx(Zl,{[u]:"",ref:_,children:p})});d.displayName=c;function h(f){const v=i(t+"CollectionConsumer",f);return Re.useCallback(()=>{const p=v.collectionRef.current;if(!p)return[];const g=Array.from(p.querySelectorAll(`[${u}]`));return Array.from(v.itemMap.values()).sort((b,w)=>g.indexOf(b.ref.current)-g.indexOf(w.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,n]}var Ea=globalThis?.document?k.useLayoutEffect:()=>{},Dbe=Al.useId||(()=>{}),Mbe=0;function ua(t){const[e,r]=k.useState(Dbe());return Ea(()=>{r(n=>n??String(Mbe++))},[t]),t||(e?`radix-${e}`:"")}var Lbe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],pt=Lbe.reduce((t,e)=>{const r=k.forwardRef((n,s)=>{const{asChild:i,...o}=n,a=i?Zl:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),C.jsx(a,{...o,ref:s})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function R4(t,e){t&&Tl.flushSync(()=>t.dispatchEvent(e))}function $n(t){const e=k.useRef(t);return k.useEffect(()=>{e.current=t}),k.useMemo(()=>(...r)=>e.current?.(...r),[])}function hh({prop:t,defaultProp:e,onChange:r=()=>{}}){const[n,s]=Nbe({defaultProp:e,onChange:r}),i=t!==void 0,o=i?t:n,a=$n(r),l=k.useCallback(c=>{if(i){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else s(c)},[i,t,s,a]);return[o,l]}function Nbe({defaultProp:t,onChange:e}){const r=k.useState(t),[n]=r,s=k.useRef(n),i=$n(e);return k.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}var Bbe=k.createContext(void 0);function A1(t){const e=k.useContext(Bbe);return t||e||"ltr"}var u0="rovingFocusGroup.onEntryFocus",Fbe={bubbles:!1,cancelable:!0},iv="RovingFocusGroup",[xw,P4,jbe]=A4(iv),[$be,ov]=Gs(iv,[jbe]),[Ube,Hbe]=$be(iv),I4=k.forwardRef((t,e)=>C.jsx(xw.Provider,{scope:t.__scopeRovingFocusGroup,children:C.jsx(xw.Slot,{scope:t.__scopeRovingFocusGroup,children:C.jsx(Vbe,{...t,ref:e})})}));I4.displayName=iv;var Vbe=k.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,h=k.useRef(null),f=Wt(e,h),v=A1(i),[m=null,p]=hh({prop:o,defaultProp:a,onChange:l}),[g,y]=k.useState(!1),_=$n(c),b=P4(r),w=k.useRef(!1),[E,S]=k.useState(0);return k.useEffect(()=>{const x=h.current;if(x)return x.addEventListener(u0,_),()=>x.removeEventListener(u0,_)},[_]),C.jsx(Ube,{scope:r,orientation:n,dir:v,loop:s,currentTabStopId:m,onItemFocus:k.useCallback(x=>p(x),[p]),onItemShiftTab:k.useCallback(()=>y(!0),[]),onFocusableItemAdd:k.useCallback(()=>S(x=>x+1),[]),onFocusableItemRemove:k.useCallback(()=>S(x=>x-1),[]),children:C.jsx(pt.div,{tabIndex:g||E===0?-1:0,"data-orientation":n,...d,ref:f,style:{outline:"none",...t.style},onMouseDown:Ue(t.onMouseDown,()=>{w.current=!0}),onFocus:Ue(t.onFocus,x=>{const T=!w.current;if(x.target===x.currentTarget&&T&&!g){const D=new CustomEvent(u0,Fbe);if(x.currentTarget.dispatchEvent(D),!D.defaultPrevented){const O=b().filter(K=>K.focusable),R=O.find(K=>K.active),P=O.find(K=>K.id===m),H=[R,P,...O].filter(Boolean).map(K=>K.ref.current);M4(H,u)}}w.current=!1}),onBlur:Ue(t.onBlur,()=>y(!1))})})}),O4="RovingFocusGroupItem",D4=k.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,...o}=t,a=ua(),l=i||a,c=Hbe(O4,r),u=c.currentTabStopId===l,d=P4(r),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return k.useEffect(()=>{if(n)return h(),()=>f()},[n,h,f]),C.jsx(xw.ItemSlot,{scope:r,id:l,focusable:n,active:s,children:C.jsx(pt.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:Ue(t.onMouseDown,v=>{n?c.onItemFocus(l):v.preventDefault()}),onFocus:Ue(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:Ue(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){c.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const m=Wbe(v,c.orientation,c.dir);if(m!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let g=d().filter(y=>y.focusable).map(y=>y.ref.current);if(m==="last")g.reverse();else if(m==="prev"||m==="next"){m==="prev"&&g.reverse();const y=g.indexOf(v.currentTarget);g=c.loop?Kbe(g,y+1):g.slice(y+1)}setTimeout(()=>M4(g))}})})})});D4.displayName=O4;var Gbe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function zbe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Wbe(t,e,r){const n=zbe(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Gbe[n]}function M4(t,e=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:e}),document.activeElement!==r))return}function Kbe(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var L4=I4,N4=D4;function qbe(t,e){return k.useReducer((r,n)=>e[r][n]??r,t)}var is=t=>{const{present:e,children:r}=t,n=Jbe(e),s=typeof r=="function"?r({present:n.isPresent}):k.Children.only(r),i=Wt(n.ref,Ybe(s));return typeof r=="function"||n.isPresent?k.cloneElement(s,{ref:i}):null};is.displayName="Presence";function Jbe(t){const[e,r]=k.useState(),n=k.useRef({}),s=k.useRef(t),i=k.useRef("none"),o=t?"mounted":"unmounted",[a,l]=qbe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return k.useEffect(()=>{const c=Cf(n.current);i.current=a==="mounted"?c:"none"},[a]),Ea(()=>{const c=n.current,u=s.current;if(u!==t){const h=i.current,f=Cf(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Ea(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=f=>{const m=Cf(n.current).includes(f.animationName);if(f.target===e&&m&&(l("ANIMATION_END"),!s.current)){const p=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=p)})}},h=f=>{f.target===e&&(i.current=Cf(n.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:k.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function Cf(t){return t?.animationName||"none"}function Ybe(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var R1="Tabs",[Zbe,nke]=Gs(R1,[ov]),B4=ov(),[Xbe,P1]=Zbe(R1),F4=k.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=A1(a),[d,h]=hh({prop:n,onChange:s,defaultProp:i});return C.jsx(Xbe,{scope:r,baseId:ua(),value:d,onValueChange:h,orientation:o,dir:u,activationMode:l,children:C.jsx(pt.div,{dir:u,"data-orientation":o,...c,ref:e})})});F4.displayName=R1;var j4="TabsList",$4=k.forwardRef((t,e)=>{const{__scopeTabs:r,loop:n=!0,...s}=t,i=P1(j4,r),o=B4(r);return C.jsx(L4,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:C.jsx(pt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});$4.displayName=j4;var U4="TabsTrigger",H4=k.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...i}=t,o=P1(U4,r),a=B4(r),l=z4(o.baseId,n),c=W4(o.baseId,n),u=n===o.value;return C.jsx(N4,{asChild:!0,...a,focusable:!s,active:u,children:C.jsx(pt.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:e,onMouseDown:Ue(t.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?o.onValueChange(n):d.preventDefault()}),onKeyDown:Ue(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(n)}),onFocus:Ue(t.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!s&&d&&o.onValueChange(n)})})})});H4.displayName=U4;var V4="TabsContent",G4=k.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,forceMount:s,children:i,...o}=t,a=P1(V4,r),l=z4(a.baseId,n),c=W4(a.baseId,n),u=n===a.value,d=k.useRef(u);return k.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),C.jsx(is,{present:s||u,children:({present:h})=>C.jsx(pt.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});G4.displayName=V4;function z4(t,e){return`${t}-trigger-${e}`}function W4(t,e){return`${t}-content-${e}`}var Qbe=F4,ewe=$4,d0=H4,h0=G4;const BP=k.memo(({className:t,children:e})=>C.jsx("div",{className:Te("flex items-center gap-2 bg-codeia-elements-background-depth-2 text-codeia-elements-textSecondary border-b border-codeia-elements-borderColor px-4 py-1 min-h-[34px] text-sm",t),children:e}));function twe(){return globalThis.innerWidth<640}function rwe(t,e=globalThis?.document){const r=$n(t);k.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var nwe="DismissableLayer",Sw="dismissableLayer.update",swe="dismissableLayer.pointerDownOutside",iwe="dismissableLayer.focusOutside",FP,K4=k.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),av=k.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=k.useContext(K4),[u,d]=k.useState(null),h=u?.ownerDocument??globalThis?.document,[,f]=k.useState({}),v=Wt(e,S=>d(S)),m=Array.from(c.layers),[p]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),g=m.indexOf(p),y=u?m.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,b=y>=g,w=lwe(S=>{const x=S.target,T=[...c.branches].some(D=>D.contains(x));!b||T||(s?.(S),o?.(S),S.defaultPrevented||a?.())},h),E=cwe(S=>{const x=S.target;[...c.branches].some(D=>D.contains(x))||(i?.(S),o?.(S),S.defaultPrevented||a?.())},h);return rwe(S=>{y===c.layers.size-1&&(n?.(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},h),k.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(FP=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),jP(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=FP)}},[u,h,r,c]),k.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),jP())},[u,c]),k.useEffect(()=>{const S=()=>f({});return document.addEventListener(Sw,S),()=>document.removeEventListener(Sw,S)},[]),C.jsx(pt.div,{...l,ref:v,style:{pointerEvents:_?b?"auto":"none":void 0,...t.style},onFocusCapture:Ue(t.onFocusCapture,E.onFocusCapture),onBlurCapture:Ue(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Ue(t.onPointerDownCapture,w.onPointerDownCapture)})});av.displayName=nwe;var owe="DismissableLayerBranch",awe=k.forwardRef((t,e)=>{const r=k.useContext(K4),n=k.useRef(null),s=Wt(e,n);return k.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),C.jsx(pt.div,{...t,ref:s})});awe.displayName=owe;function lwe(t,e=globalThis?.document){const r=$n(t),n=k.useRef(!1),s=k.useRef(()=>{});return k.useEffect(()=>{const i=a=>{if(a.target&&!n.current){let l=function(){q4(swe,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function cwe(t,e=globalThis?.document){const r=$n(t),n=k.useRef(!1);return k.useEffect(()=>{const s=i=>{i.target&&!n.current&&q4(iwe,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function jP(){const t=new CustomEvent(Sw);document.dispatchEvent(t)}function q4(t,e,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?R4(s,i):s.dispatchEvent(i)}var f0=0;function J4(){k.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??$P()),document.body.insertAdjacentElement("beforeend",t[1]??$P()),f0++,()=>{f0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),f0--}},[])}function $P(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var p0="focusScope.autoFocusOnMount",m0="focusScope.autoFocusOnUnmount",UP={bubbles:!1,cancelable:!0},uwe="FocusScope",I1=k.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=k.useState(null),c=$n(s),u=$n(i),d=k.useRef(null),h=Wt(e,m=>l(m)),f=k.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;k.useEffect(()=>{if(n){let m=function(_){if(f.paused||!a)return;const b=_.target;a.contains(b)?d.current=b:Bi(d.current,{select:!0})},p=function(_){if(f.paused||!a)return;const b=_.relatedTarget;b!==null&&(a.contains(b)||Bi(d.current,{select:!0}))},g=function(_){if(document.activeElement===document.body)for(const w of _)w.removedNodes.length>0&&Bi(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",p);const y=new MutationObserver(g);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",p),y.disconnect()}}},[n,a,f.paused]),k.useEffect(()=>{if(a){VP.add(f);const m=document.activeElement;if(!a.contains(m)){const g=new CustomEvent(p0,UP);a.addEventListener(p0,c),a.dispatchEvent(g),g.defaultPrevented||(dwe(gwe(Y4(a)),{select:!0}),document.activeElement===m&&Bi(a))}return()=>{a.removeEventListener(p0,c),setTimeout(()=>{const g=new CustomEvent(m0,UP);a.addEventListener(m0,u),a.dispatchEvent(g),g.defaultPrevented||Bi(m??document.body,{select:!0}),a.removeEventListener(m0,u),VP.remove(f)},0)}}},[a,c,u,f]);const v=k.useCallback(m=>{if(!r&&!n||f.paused)return;const p=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,g=document.activeElement;if(p&&g){const y=m.currentTarget,[_,b]=hwe(y);_&&b?!m.shiftKey&&g===b?(m.preventDefault(),r&&Bi(_,{select:!0})):m.shiftKey&&g===_&&(m.preventDefault(),r&&Bi(b,{select:!0})):g===y&&m.preventDefault()}},[r,n,f.paused]);return C.jsx(pt.div,{tabIndex:-1,...o,ref:h,onKeyDown:v})});I1.displayName=uwe;function dwe(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(Bi(n,{select:e}),document.activeElement!==r)return}function hwe(t){const e=Y4(t),r=HP(e,t),n=HP(e.reverse(),t);return[r,n]}function Y4(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function HP(t,e){for(const r of t)if(!fwe(r,{upTo:e}))return r}function fwe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function pwe(t){return t instanceof HTMLInputElement&&"select"in t}function Bi(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&pwe(t)&&e&&t.select()}}var VP=mwe();function mwe(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=GP(t,e),t.unshift(e)},remove(e){t=GP(t,e),t[0]?.resume()}}}function GP(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function gwe(t){return t.filter(e=>e.tagName!=="A")}var vwe="Arrow",Z4=k.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...i}=t;return C.jsx(pt.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:C.jsx("polygon",{points:"0,0 30,0 15,10"})})});Z4.displayName=vwe;var ywe=Z4;function X4(t){const[e,r]=k.useState(void 0);return Ea(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var O1="Popper",[Q4,lv]=Gs(O1),[_we,e$]=Q4(O1),t$=t=>{const{__scopePopper:e,children:r}=t,[n,s]=k.useState(null);return C.jsx(_we,{scope:e,anchor:n,onAnchorChange:s,children:r})};t$.displayName=O1;var r$="PopperAnchor",n$=k.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,i=e$(r$,r),o=k.useRef(null),a=Wt(e,o);return k.useEffect(()=>{i.onAnchorChange(n?.current||o.current)}),n?null:C.jsx(pt.div,{...s,ref:a})});n$.displayName=r$;var D1="PopperContent",[bwe,wwe]=Q4(D1),s$=k.forwardRef((t,e)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:v,...m}=t,p=e$(D1,r),[g,y]=k.useState(null),_=Wt(e,re=>y(re)),[b,w]=k.useState(null),E=X4(b),S=E?.width??0,x=E?.height??0,T=n+(i!=="center"?"-"+i:""),D=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},O=Array.isArray(c)?c:[c],R=O.length>0,P={padding:D,boundary:O.filter(Swe),altBoundary:R},{refs:A,floatingStyles:H,placement:K,isPositioned:V,middlewareData:q}=iF({strategy:"fixed",placement:T,whileElementsMounted:(...re)=>nF(...re,{animationFrame:f==="always"}),elements:{reference:p.anchor},middleware:[TS({mainAxis:s+x,alignmentAxis:o}),l&&oF({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Ece():void 0,...P}),l&&aF({...P}),lF({...P,apply:({elements:re,rects:F,availableWidth:X,availableHeight:Y})=>{const{width:oe,height:le}=F.reference,ue=re.floating.style;ue.setProperty("--radix-popper-available-width",`${X}px`),ue.setProperty("--radix-popper-available-height",`${Y}px`),ue.setProperty("--radix-popper-anchor-width",`${oe}px`),ue.setProperty("--radix-popper-anchor-height",`${le}px`)}}),b&&kce({element:b,padding:a}),Ewe({arrowWidth:S,arrowHeight:x}),h&&Cce({strategy:"referenceHidden",...P})]}),[I,$]=a$(K),j=$n(v);Ea(()=>{V&&j?.()},[V,j]);const U=q.arrow?.x,J=q.arrow?.y,ne=q.arrow?.centerOffset!==0,[te,me]=k.useState();return Ea(()=>{g&&me(window.getComputedStyle(g).zIndex)},[g]),C.jsx("div",{ref:A.setFloating,"data-radix-popper-content-wrapper":"",style:{...H,transform:V?H.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:te,"--radix-popper-transform-origin":[q.transformOrigin?.x,q.transformOrigin?.y].join(" "),...q.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:C.jsx(bwe,{scope:r,placedSide:I,onArrowChange:w,arrowX:U,arrowY:J,shouldHideArrow:ne,children:C.jsx(pt.div,{"data-side":I,"data-align":$,...m,ref:_,style:{...m.style,animation:V?void 0:"none"}})})})});s$.displayName=D1;var i$="PopperArrow",xwe={top:"bottom",right:"left",bottom:"top",left:"right"},o$=k.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,i=wwe(i$,n),o=xwe[i.placedSide];return C.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:C.jsx(ywe,{...s,ref:r,style:{...s.style,display:"block"}})})});o$.displayName=i$;function Swe(t){return t!==null}var Ewe=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:n,middlewareData:s}=e,o=s.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=a$(r),d={start:"0%",center:"50%",end:"100%"}[u],h=(s.arrow?.x??0)+a/2,f=(s.arrow?.y??0)+l/2;let v="",m="";return c==="bottom"?(v=o?d:`${h}px`,m=`${-l}px`):c==="top"?(v=o?d:`${h}px`,m=`${n.floating.height+l}px`):c==="right"?(v=`${-l}px`,m=o?d:`${f}px`):c==="left"&&(v=`${n.floating.width+l}px`,m=o?d:`${f}px`),{data:{x:v,y:m}}}});function a$(t){const[e,r="center"]=t.split("-");return[e,r]}var Cwe=t$,l$=n$,c$=s$,u$=o$,kwe="Portal",M1=k.forwardRef((t,e)=>{const{container:r,...n}=t,[s,i]=k.useState(!1);Ea(()=>i(!0),[]);const o=r||s&&globalThis?.document?.body;return o?hU.createPortal(C.jsx(pt.div,{...n,ref:e}),o):null});M1.displayName=kwe;var Twe=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Va=new WeakMap,kf=new WeakMap,Tf={},g0=0,d$=function(t){return t&&(t.host||d$(t.parentNode))},Awe=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=d$(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},Rwe=function(t,e,r,n){var s=Awe(e,Array.isArray(t)?t:[t]);Tf[r]||(Tf[r]=new WeakMap);var i=Tf[r],o=[],a=new Set,l=new Set(s),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var f=h.getAttribute(n),v=f!==null&&f!=="false",m=(Va.get(h)||0)+1,p=(i.get(h)||0)+1;Va.set(h,m),i.set(h,p),o.push(h),m===1&&v&&kf.set(h,!0),p===1&&h.setAttribute(r,"true"),v||h.setAttribute(n,"true")}catch(g){console.error("aria-hidden: cannot operate on ",h,g)}})};return u(e),a.clear(),g0++,function(){o.forEach(function(d){var h=Va.get(d)-1,f=i.get(d)-1;Va.set(d,h),i.set(d,f),h||(kf.has(d)||d.removeAttribute(n),kf.delete(d)),f||d.removeAttribute(r)}),g0--,g0||(Va=new WeakMap,Va=new WeakMap,kf=new WeakMap,Tf={})}},h$=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),s=Twe(t);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),Rwe(n,s,r,"aria-hidden")):function(){return null}},np="right-scroll-bar-position",sp="width-before-scroll-bar",Pwe="with-scroll-bars-hidden",Iwe="--removed-body-scroll-bar-size";function v0(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Owe(t,e){var r=k.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=e,r.facade}var Dwe=typeof window<"u"?k.useLayoutEffect:k.useEffect,zP=new WeakMap;function Mwe(t,e){var r=Owe(null,function(n){return t.forEach(function(s){return v0(s,n)})});return Dwe(function(){var n=zP.get(r);if(n){var s=new Set(n),i=new Set(t),o=r.current;s.forEach(function(a){i.has(a)||v0(a,null)}),i.forEach(function(a){s.has(a)||v0(a,o)})}zP.set(r,t)},[t]),r}function Lwe(t){return t}function Nwe(t,e){e===void 0&&(e=Lwe);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var o=e(i,n);return r.push(o),function(){r=r.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(a){return i(a)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var a=r;r=[],a.forEach(i),o=r}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),r}}}};return s}function Bwe(t){t===void 0&&(t={});var e=Nwe(null);return e.options=ws({async:!0,ssr:!1},t),e}var f$=function(t){var e=t.sideCar,r=tN(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return k.createElement(n,ws({},r))};f$.isSideCarExport=!0;function Fwe(t,e){return t.useMedium(e),f$}var p$=Bwe(),y0=function(){},cv=k.forwardRef(function(t,e){var r=k.useRef(null),n=k.useState({onScrollCapture:y0,onWheelCapture:y0,onTouchMoveCapture:y0}),s=n[0],i=n[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,v=t.inert,m=t.allowPinchZoom,p=t.as,g=p===void 0?"div":p,y=t.gapMode,_=tN(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=h,w=Mwe([r,e]),E=ws(ws({},_),s);return k.createElement(k.Fragment,null,u&&k.createElement(b,{sideCar:p$,removeScrollBar:c,shards:d,noIsolation:f,inert:v,setCallbacks:i,allowPinchZoom:!!m,lockRef:r,gapMode:y}),o?k.cloneElement(k.Children.only(a),ws(ws({},E),{ref:w})):k.createElement(g,ws({},E,{className:l,ref:w}),a))});cv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};cv.classNames={fullWidth:sp,zeroRight:np};var jwe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $we(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=jwe();return e&&t.setAttribute("nonce",e),t}function Uwe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Hwe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Vwe=function(){var t=0,e=null;return{add:function(r){t==0&&(e=$we())&&(Uwe(e,r),Hwe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Gwe=function(){var t=Vwe();return function(e,r){k.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},m$=function(){var t=Gwe(),e=function(r){var n=r.styles,s=r.dynamic;return t(n,s),null};return e},zwe={left:0,top:0,right:0,gap:0},_0=function(t){return parseInt(t||"",10)||0},Wwe=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[_0(r),_0(n),_0(s)]},Kwe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return zwe;var e=Wwe(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},qwe=m$(),kl="data-scroll-locked",Jwe=function(t,e,r,n){var s=t.left,i=t.top,o=t.right,a=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(Pwe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(kl,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(np,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(sp,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(np," .").concat(np,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(sp," .").concat(sp,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(kl,`] {
    `).concat(Iwe,": ").concat(a,`px;
  }
`)},WP=function(){var t=parseInt(document.body.getAttribute(kl)||"0",10);return isFinite(t)?t:0},Ywe=function(){k.useEffect(function(){return document.body.setAttribute(kl,(WP()+1).toString()),function(){var t=WP()-1;t<=0?document.body.removeAttribute(kl):document.body.setAttribute(kl,t.toString())}},[])},Zwe=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,s=n===void 0?"margin":n;Ywe();var i=k.useMemo(function(){return Kwe(s)},[s]);return k.createElement(qwe,{styles:Jwe(i,!e,s,r?"":"!important")})},Ew=!1;if(typeof window<"u")try{var Af=Object.defineProperty({},"passive",{get:function(){return Ew=!0,!0}});window.addEventListener("test",Af,Af),window.removeEventListener("test",Af,Af)}catch{Ew=!1}var Ga=Ew?{passive:!1}:!1,Xwe=function(t){return t.tagName==="TEXTAREA"},g$=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!Xwe(t)&&r[e]==="visible")},Qwe=function(t){return g$(t,"overflowY")},exe=function(t){return g$(t,"overflowX")},KP=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=v$(t,n);if(s){var i=y$(t,n),o=i[1],a=i[2];if(o>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},txe=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},rxe=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},v$=function(t,e){return t==="v"?Qwe(e):exe(e)},y$=function(t,e){return t==="v"?txe(e):rxe(e)},nxe=function(t,e){return t==="h"&&e==="rtl"?-1:1},sxe=function(t,e,r,n,s){var i=nxe(t,window.getComputedStyle(e).direction),o=i*n,a=r.target,l=e.contains(a),c=!1,u=o>0,d=0,h=0;do{var f=y$(t,a),v=f[0],m=f[1],p=f[2],g=m-p-i*v;(v||g)&&v$(t,a)&&(d+=g,h+=v),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},Rf=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},qP=function(t){return[t.deltaX,t.deltaY]},JP=function(t){return t&&"current"in t?t.current:t},ixe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},oxe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},axe=0,za=[];function lxe(t){var e=k.useRef([]),r=k.useRef([0,0]),n=k.useRef(),s=k.useState(axe++)[0],i=k.useState(m$)[0],o=k.useRef(t);k.useEffect(function(){o.current=t},[t]),k.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var m=Ate([t.lockRef.current],(t.shards||[]).map(JP),!0).filter(Boolean);return m.forEach(function(p){return p.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(p){return p.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=k.useCallback(function(m,p){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!o.current.allowPinchZoom;var g=Rf(m),y=r.current,_="deltaX"in m?m.deltaX:y[0]-g[0],b="deltaY"in m?m.deltaY:y[1]-g[1],w,E=m.target,S=Math.abs(_)>Math.abs(b)?"h":"v";if("touches"in m&&S==="h"&&E.type==="range")return!1;var x=KP(S,E);if(!x)return!0;if(x?w=S:(w=S==="v"?"h":"v",x=KP(S,E)),!x)return!1;if(!n.current&&"changedTouches"in m&&(_||b)&&(n.current=w),!w)return!0;var T=n.current||w;return sxe(T,p,m,T==="h"?_:b)},[]),l=k.useCallback(function(m){var p=m;if(!(!za.length||za[za.length-1]!==i)){var g="deltaY"in p?qP(p):Rf(p),y=e.current.filter(function(w){return w.name===p.type&&(w.target===p.target||p.target===w.shadowParent)&&ixe(w.delta,g)})[0];if(y&&y.should){p.cancelable&&p.preventDefault();return}if(!y){var _=(o.current.shards||[]).map(JP).filter(Boolean).filter(function(w){return w.contains(p.target)}),b=_.length>0?a(p,_[0]):!o.current.noIsolation;b&&p.cancelable&&p.preventDefault()}}},[]),c=k.useCallback(function(m,p,g,y){var _={name:m,delta:p,target:g,should:y,shadowParent:cxe(g)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(b){return b!==_})},1)},[]),u=k.useCallback(function(m){r.current=Rf(m),n.current=void 0},[]),d=k.useCallback(function(m){c(m.type,qP(m),m.target,a(m,t.lockRef.current))},[]),h=k.useCallback(function(m){c(m.type,Rf(m),m.target,a(m,t.lockRef.current))},[]);k.useEffect(function(){return za.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Ga),document.addEventListener("touchmove",l,Ga),document.addEventListener("touchstart",u,Ga),function(){za=za.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,Ga),document.removeEventListener("touchmove",l,Ga),document.removeEventListener("touchstart",u,Ga)}},[]);var f=t.removeScrollBar,v=t.inert;return k.createElement(k.Fragment,null,v?k.createElement(i,{styles:oxe(s)}):null,f?k.createElement(Zwe,{gapMode:t.gapMode}):null)}function cxe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const uxe=Fwe(p$,lxe);var L1=k.forwardRef(function(t,e){return k.createElement(cv,ws({},t,{ref:e,sideCar:uxe}))});L1.classNames=cv.classNames;var Cw=["Enter"," "],dxe=["ArrowDown","PageUp","Home"],_$=["ArrowUp","PageDown","End"],hxe=[...dxe,..._$],fxe={ltr:[...Cw,"ArrowRight"],rtl:[...Cw,"ArrowLeft"]},pxe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},fh="Menu",[$d,mxe,gxe]=A4(fh),[Ia,uv]=Gs(fh,[gxe,lv,ov]),dv=lv(),b$=ov(),[vxe,Oa]=Ia(fh),[yxe,ph]=Ia(fh),w$=t=>{const{__scopeMenu:e,open:r=!1,children:n,dir:s,onOpenChange:i,modal:o=!0}=t,a=dv(e),[l,c]=k.useState(null),u=k.useRef(!1),d=$n(i),h=A1(s);return k.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),C.jsx(Cwe,{...a,children:C.jsx(vxe,{scope:e,open:r,onOpenChange:d,content:l,onContentChange:c,children:C.jsx(yxe,{scope:e,onClose:k.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:o,children:n})})})};w$.displayName=fh;var _xe="MenuAnchor",N1=k.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=dv(r);return C.jsx(l$,{...s,...n,ref:e})});N1.displayName=_xe;var B1="MenuPortal",[bxe,x$]=Ia(B1,{forceMount:void 0}),S$=t=>{const{__scopeMenu:e,forceMount:r,children:n,container:s}=t,i=Oa(B1,e);return C.jsx(bxe,{scope:e,forceMount:r,children:C.jsx(is,{present:r||i.open,children:C.jsx(M1,{asChild:!0,container:s,children:n})})})};S$.displayName=B1;var Nn="MenuContent",[wxe,F1]=Ia(Nn),E$=k.forwardRef((t,e)=>{const r=x$(Nn,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,i=Oa(Nn,t.__scopeMenu),o=ph(Nn,t.__scopeMenu);return C.jsx($d.Provider,{scope:t.__scopeMenu,children:C.jsx(is,{present:n||i.open,children:C.jsx($d.Slot,{scope:t.__scopeMenu,children:o.modal?C.jsx(xxe,{...s,ref:e}):C.jsx(Sxe,{...s,ref:e})})})})}),xxe=k.forwardRef((t,e)=>{const r=Oa(Nn,t.__scopeMenu),n=k.useRef(null),s=Wt(e,n);return k.useEffect(()=>{const i=n.current;if(i)return h$(i)},[]),C.jsx(j1,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Ue(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Sxe=k.forwardRef((t,e)=>{const r=Oa(Nn,t.__scopeMenu);return C.jsx(j1,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),j1=k.forwardRef((t,e)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:v,...m}=t,p=Oa(Nn,r),g=ph(Nn,r),y=dv(r),_=b$(r),b=mxe(r),[w,E]=k.useState(null),S=k.useRef(null),x=Wt(e,S,p.onContentChange),T=k.useRef(0),D=k.useRef(""),O=k.useRef(0),R=k.useRef(null),P=k.useRef("right"),A=k.useRef(0),H=v?L1:k.Fragment,K=v?{as:Zl,allowPinchZoom:!0}:void 0,V=I=>{const $=D.current+I,j=b().filter(re=>!re.disabled),U=document.activeElement,J=j.find(re=>re.ref.current===U)?.textValue,ne=j.map(re=>re.textValue),te=Lxe(ne,$,J),me=j.find(re=>re.textValue===te)?.ref.current;(function re(F){D.current=F,window.clearTimeout(T.current),F!==""&&(T.current=window.setTimeout(()=>re(""),1e3))})($),me&&setTimeout(()=>me.focus())};k.useEffect(()=>()=>window.clearTimeout(T.current),[]),J4();const q=k.useCallback(I=>P.current===R.current?.side&&Bxe(I,R.current?.area),[]);return C.jsx(wxe,{scope:r,searchRef:D,onItemEnter:k.useCallback(I=>{q(I)&&I.preventDefault()},[q]),onItemLeave:k.useCallback(I=>{q(I)||(S.current?.focus(),E(null))},[q]),onTriggerLeave:k.useCallback(I=>{q(I)&&I.preventDefault()},[q]),pointerGraceTimerRef:O,onPointerGraceIntentChange:k.useCallback(I=>{R.current=I},[]),children:C.jsx(H,{...K,children:C.jsx(I1,{asChild:!0,trapped:s,onMountAutoFocus:Ue(i,I=>{I.preventDefault(),S.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:C.jsx(av,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:C.jsx(L4,{asChild:!0,..._,dir:g.dir,orientation:"vertical",loop:n,currentTabStopId:w,onCurrentTabStopIdChange:E,onEntryFocus:Ue(l,I=>{g.isUsingKeyboardRef.current||I.preventDefault()}),preventScrollOnEntryFocus:!0,children:C.jsx(c$,{role:"menu","aria-orientation":"vertical","data-state":$$(p.open),"data-radix-menu-content":"",dir:g.dir,...y,...m,ref:x,style:{outline:"none",...m.style},onKeyDown:Ue(m.onKeyDown,I=>{const j=I.target.closest("[data-radix-menu-content]")===I.currentTarget,U=I.ctrlKey||I.altKey||I.metaKey,J=I.key.length===1;j&&(I.key==="Tab"&&I.preventDefault(),!U&&J&&V(I.key));const ne=S.current;if(I.target!==ne||!hxe.includes(I.key))return;I.preventDefault();const me=b().filter(re=>!re.disabled).map(re=>re.ref.current);_$.includes(I.key)&&me.reverse(),Dxe(me)}),onBlur:Ue(t.onBlur,I=>{I.currentTarget.contains(I.target)||(window.clearTimeout(T.current),D.current="")}),onPointerMove:Ue(t.onPointerMove,Ud(I=>{const $=I.target,j=A.current!==I.clientX;if(I.currentTarget.contains($)&&j){const U=I.clientX>A.current?"right":"left";P.current=U,A.current=I.clientX}}))})})})})})})});E$.displayName=Nn;var Exe="MenuGroup",$1=k.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return C.jsx(pt.div,{role:"group",...n,ref:e})});$1.displayName=Exe;var Cxe="MenuLabel",C$=k.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return C.jsx(pt.div,{...n,ref:e})});C$.displayName=Cxe;var Jm="MenuItem",YP="menu.itemSelect",hv=k.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:n,...s}=t,i=k.useRef(null),o=ph(Jm,t.__scopeMenu),a=F1(Jm,t.__scopeMenu),l=Wt(e,i),c=k.useRef(!1),u=()=>{const d=i.current;if(!r&&d){const h=new CustomEvent(YP,{bubbles:!0,cancelable:!0});d.addEventListener(YP,f=>n?.(f),{once:!0}),R4(d,h),h.defaultPrevented?c.current=!1:o.onClose()}};return C.jsx(k$,{...s,ref:l,disabled:r,onClick:Ue(t.onClick,u),onPointerDown:d=>{t.onPointerDown?.(d),c.current=!0},onPointerUp:Ue(t.onPointerUp,d=>{c.current||d.currentTarget?.click()}),onKeyDown:Ue(t.onKeyDown,d=>{const h=a.searchRef.current!=="";r||h&&d.key===" "||Cw.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});hv.displayName=Jm;var k$=k.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...i}=t,o=F1(Jm,r),a=b$(r),l=k.useRef(null),c=Wt(e,l),[u,d]=k.useState(!1),[h,f]=k.useState("");return k.useEffect(()=>{const v=l.current;v&&f((v.textContent??"").trim())},[i.children]),C.jsx($d.ItemSlot,{scope:r,disabled:n,textValue:s??h,children:C.jsx(N4,{asChild:!0,...a,focusable:!n,children:C.jsx(pt.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:c,onPointerMove:Ue(t.onPointerMove,Ud(v=>{n?o.onItemLeave(v):(o.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ue(t.onPointerLeave,Ud(v=>o.onItemLeave(v))),onFocus:Ue(t.onFocus,()=>d(!0)),onBlur:Ue(t.onBlur,()=>d(!1))})})})}),kxe="MenuCheckboxItem",T$=k.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:n,...s}=t;return C.jsx(O$,{scope:t.__scopeMenu,checked:r,children:C.jsx(hv,{role:"menuitemcheckbox","aria-checked":Ym(r)?"mixed":r,...s,ref:e,"data-state":H1(r),onSelect:Ue(s.onSelect,()=>n?.(Ym(r)?!0:!r),{checkForDefaultPrevented:!1})})})});T$.displayName=kxe;var A$="MenuRadioGroup",[Txe,Axe]=Ia(A$,{value:void 0,onValueChange:()=>{}}),R$=k.forwardRef((t,e)=>{const{value:r,onValueChange:n,...s}=t,i=$n(n);return C.jsx(Txe,{scope:t.__scopeMenu,value:r,onValueChange:i,children:C.jsx($1,{...s,ref:e})})});R$.displayName=A$;var P$="MenuRadioItem",I$=k.forwardRef((t,e)=>{const{value:r,...n}=t,s=Axe(P$,t.__scopeMenu),i=r===s.value;return C.jsx(O$,{scope:t.__scopeMenu,checked:i,children:C.jsx(hv,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":H1(i),onSelect:Ue(n.onSelect,()=>s.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});I$.displayName=P$;var U1="MenuItemIndicator",[O$,Rxe]=Ia(U1,{checked:!1}),D$=k.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:n,...s}=t,i=Rxe(U1,r);return C.jsx(is,{present:n||Ym(i.checked)||i.checked===!0,children:C.jsx(pt.span,{...s,ref:e,"data-state":H1(i.checked)})})});D$.displayName=U1;var Pxe="MenuSeparator",M$=k.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return C.jsx(pt.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});M$.displayName=Pxe;var Ixe="MenuArrow",L$=k.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=dv(r);return C.jsx(u$,{...s,...n,ref:e})});L$.displayName=Ixe;var Oxe="MenuSub",[ske,N$]=Ia(Oxe),Xc="MenuSubTrigger",B$=k.forwardRef((t,e)=>{const r=Oa(Xc,t.__scopeMenu),n=ph(Xc,t.__scopeMenu),s=N$(Xc,t.__scopeMenu),i=F1(Xc,t.__scopeMenu),o=k.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,c={__scopeMenu:t.__scopeMenu},u=k.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return k.useEffect(()=>u,[u]),k.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),C.jsx(N1,{asChild:!0,...c,children:C.jsx(k$,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":$$(r.open),...t,ref:sv(e,s.onTriggerChange),onClick:d=>{t.onClick?.(d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Ue(t.onPointerMove,Ud(d=>{i.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Ue(t.onPointerLeave,Ud(d=>{u();const h=r.content?.getBoundingClientRect();if(h){const f=r.content?.dataset.side,v=f==="right",m=v?-5:5,p=h[v?"left":"right"],g=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+m,y:d.clientY},{x:p,y:h.top},{x:g,y:h.top},{x:g,y:h.bottom},{x:p,y:h.bottom}],side:f}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Ue(t.onKeyDown,d=>{const h=i.searchRef.current!=="";t.disabled||h&&d.key===" "||fxe[n.dir].includes(d.key)&&(r.onOpenChange(!0),r.content?.focus(),d.preventDefault())})})})});B$.displayName=Xc;var F$="MenuSubContent",j$=k.forwardRef((t,e)=>{const r=x$(Nn,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,i=Oa(Nn,t.__scopeMenu),o=ph(Nn,t.__scopeMenu),a=N$(F$,t.__scopeMenu),l=k.useRef(null),c=Wt(e,l);return C.jsx($d.Provider,{scope:t.__scopeMenu,children:C.jsx(is,{present:n||i.open,children:C.jsx($d.Slot,{scope:t.__scopeMenu,children:C.jsx(j1,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{o.isUsingKeyboardRef.current&&l.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Ue(t.onFocusOutside,u=>{u.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Ue(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:Ue(t.onKeyDown,u=>{const d=u.currentTarget.contains(u.target),h=pxe[o.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),a.trigger?.focus(),u.preventDefault())})})})})})});j$.displayName=F$;function $$(t){return t?"open":"closed"}function Ym(t){return t==="indeterminate"}function H1(t){return Ym(t)?"indeterminate":t?"checked":"unchecked"}function Dxe(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function Mxe(t,e){return t.map((r,n)=>t[(e+n)%t.length])}function Lxe(t,e,r){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=r?t.indexOf(r):-1;let o=Mxe(t,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==r));const l=o.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==r?l:void 0}function Nxe(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>n!=u>n&&r<(c-a)*(n-l)/(u-l)+a&&(s=!s)}return s}function Bxe(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return Nxe(r,e)}function Ud(t){return e=>e.pointerType==="mouse"?t(e):void 0}var U$=w$,H$=N1,V$=S$,G$=E$,z$=$1,W$=C$,K$=hv,q$=T$,J$=R$,Y$=I$,Z$=D$,X$=M$,Q$=L$,e6=B$,t6=j$,V1="DropdownMenu",[Fxe,ike]=Gs(V1,[uv]),Gr=uv(),[jxe,r6]=Fxe(V1),n6=t=>{const{__scopeDropdownMenu:e,children:r,dir:n,open:s,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=Gr(e),c=k.useRef(null),[u=!1,d]=hh({prop:s,defaultProp:i,onChange:o});return C.jsx(jxe,{scope:e,triggerId:ua(),triggerRef:c,contentId:ua(),open:u,onOpenChange:d,onOpenToggle:k.useCallback(()=>d(h=>!h),[d]),modal:a,children:C.jsx(U$,{...l,open:u,onOpenChange:d,dir:n,modal:a,children:r})})};n6.displayName=V1;var s6="DropdownMenuTrigger",i6=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=t,i=r6(s6,r),o=Gr(r);return C.jsx(H$,{asChild:!0,...o,children:C.jsx(pt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:sv(e,i.triggerRef),onPointerDown:Ue(t.onPointerDown,a=>{!n&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:Ue(t.onKeyDown,a=>{n||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});i6.displayName=s6;var $xe="DropdownMenuPortal",o6=t=>{const{__scopeDropdownMenu:e,...r}=t,n=Gr(e);return C.jsx(V$,{...n,...r})};o6.displayName=$xe;var a6="DropdownMenuContent",l6=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=r6(a6,r),i=Gr(r),o=k.useRef(!1);return C.jsx(G$,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:Ue(t.onCloseAutoFocus,a=>{o.current||s.triggerRef.current?.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:Ue(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});l6.displayName=a6;var Uxe="DropdownMenuGroup",Hxe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(z$,{...s,...n,ref:e})});Hxe.displayName=Uxe;var Vxe="DropdownMenuLabel",Gxe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(W$,{...s,...n,ref:e})});Gxe.displayName=Vxe;var zxe="DropdownMenuItem",c6=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(K$,{...s,...n,ref:e})});c6.displayName=zxe;var Wxe="DropdownMenuCheckboxItem",Kxe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(q$,{...s,...n,ref:e})});Kxe.displayName=Wxe;var qxe="DropdownMenuRadioGroup",Jxe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(J$,{...s,...n,ref:e})});Jxe.displayName=qxe;var Yxe="DropdownMenuRadioItem",Zxe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(Y$,{...s,...n,ref:e})});Zxe.displayName=Yxe;var Xxe="DropdownMenuItemIndicator",Qxe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(Z$,{...s,...n,ref:e})});Qxe.displayName=Xxe;var eSe="DropdownMenuSeparator",tSe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(X$,{...s,...n,ref:e})});tSe.displayName=eSe;var rSe="DropdownMenuArrow",u6=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(Q$,{...s,...n,ref:e})});u6.displayName=rSe;var nSe="DropdownMenuSubTrigger",sSe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(e6,{...s,...n,ref:e})});sSe.displayName=nSe;var iSe="DropdownMenuSubContent",oSe=k.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Gr(r);return C.jsx(t6,{...s,...n,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});oSe.displayName=iSe;var d6=n6,h6=i6,aSe=o6,f6=l6,b0=c6,lSe=u6,G1="ContextMenu",[cSe,oke]=Gs(G1,[uv]),zr=uv(),[uSe,p6]=cSe(G1),m6=t=>{const{__scopeContextMenu:e,children:r,onOpenChange:n,dir:s,modal:i=!0}=t,[o,a]=k.useState(!1),l=zr(e),c=$n(n),u=k.useCallback(d=>{a(d),c(d)},[c]);return C.jsx(uSe,{scope:e,open:o,onOpenChange:u,modal:i,children:C.jsx(U$,{...l,dir:s,open:o,onOpenChange:u,modal:i,children:r})})};m6.displayName=G1;var g6="ContextMenuTrigger",v6=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,disabled:n=!1,...s}=t,i=p6(g6,r),o=zr(r),a=k.useRef({x:0,y:0}),l=k.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=k.useRef(0),u=k.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{a.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return k.useEffect(()=>u,[u]),k.useEffect(()=>void(n&&u()),[n,u]),C.jsxs(C.Fragment,{children:[C.jsx(H$,{...o,virtualRef:l}),C.jsx(pt.span,{"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,...s,ref:e,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:n?t.onContextMenu:Ue(t.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:n?t.onPointerDown:Ue(t.onPointerDown,Pf(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:n?t.onPointerMove:Ue(t.onPointerMove,Pf(u)),onPointerCancel:n?t.onPointerCancel:Ue(t.onPointerCancel,Pf(u)),onPointerUp:n?t.onPointerUp:Ue(t.onPointerUp,Pf(u))})]})});v6.displayName=g6;var dSe="ContextMenuPortal",y6=t=>{const{__scopeContextMenu:e,...r}=t,n=zr(e);return C.jsx(V$,{...n,...r})};y6.displayName=dSe;var _6="ContextMenuContent",b6=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=p6(_6,r),i=zr(r),o=k.useRef(!1);return C.jsx(G$,{...i,...n,ref:e,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{t.onCloseAutoFocus?.(a),!a.defaultPrevented&&o.current&&a.preventDefault(),o.current=!1},onInteractOutside:a=>{t.onInteractOutside?.(a),!a.defaultPrevented&&!s.modal&&(o.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});b6.displayName=_6;var hSe="ContextMenuGroup",w6=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(z$,{...s,...n,ref:e})});w6.displayName=hSe;var fSe="ContextMenuLabel",pSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(W$,{...s,...n,ref:e})});pSe.displayName=fSe;var mSe="ContextMenuItem",x6=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(K$,{...s,...n,ref:e})});x6.displayName=mSe;var gSe="ContextMenuCheckboxItem",vSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(q$,{...s,...n,ref:e})});vSe.displayName=gSe;var ySe="ContextMenuRadioGroup",_Se=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(J$,{...s,...n,ref:e})});_Se.displayName=ySe;var bSe="ContextMenuRadioItem",wSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(Y$,{...s,...n,ref:e})});wSe.displayName=bSe;var xSe="ContextMenuItemIndicator",SSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(Z$,{...s,...n,ref:e})});SSe.displayName=xSe;var ESe="ContextMenuSeparator",CSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(X$,{...s,...n,ref:e})});CSe.displayName=ESe;var kSe="ContextMenuArrow",TSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(Q$,{...s,...n,ref:e})});TSe.displayName=kSe;var ASe="ContextMenuSubTrigger",RSe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(e6,{...s,...n,ref:e})});RSe.displayName=ASe;var PSe="ContextMenuSubContent",ISe=k.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=zr(r);return C.jsx(t6,{...s,...n,ref:e,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ISe.displayName=PSe;function Pf(t){return e=>e.pointerType!=="mouse"?t(e):void 0}var OSe=m6,DSe=v6,MSe=y6,LSe=b6,If=w6,NSe=x6;const Qs=en("FileTree"),S6=8,BSe=[/\/node_modules\//,/\/\.next/,/\/\.astro/],E6=k.memo(({files:t={},onFileSelect:e,selectedFile:r,rootFolder:n,hideRoot:s=!1,collapsed:i=!1,allowFolderSelection:o=!1,hiddenFiles:a,className:l,unsavedFiles:c,fileHistory:u={}})=>{ec.trace("FileTree");const d=k.useMemo(()=>[...BSe,...a??[]],[a]),h=k.useMemo(()=>$Se(t,n,s,d),[t,n,s,d]),[f,v]=k.useState(()=>i?new Set(h.filter(_=>_.kind==="folder").map(_=>_.fullPath)):new Set);k.useEffect(()=>{if(i){v(new Set(h.filter(_=>_.kind==="folder").map(_=>_.fullPath)));return}v(_=>{const b=new Set;for(const w of h)w.kind==="folder"&&_.has(w.fullPath)&&b.add(w.fullPath);return b})},[h,i]);const m=k.useMemo(()=>{const _=[];let b=Number.MAX_SAFE_INTEGER;for(const w of h){const E=w.depth;b===E&&(b=Number.MAX_SAFE_INTEGER),f.has(w.fullPath)&&(b=Math.min(b,E)),!(b<E)&&_.push(w)}return _},[h,f]),p=_=>{v(b=>{const w=new Set(b);return w.has(_)?w.delete(_):w.add(_),w})},g=_=>{try{navigator.clipboard.writeText(_.fullPath)}catch(b){Qs.error(b)}},y=_=>{try{navigator.clipboard.writeText(_.fullPath.substring((n||"").length))}catch(b){Qs.error(b)}};return C.jsx("div",{className:Te("text-sm",l,"overflow-y-auto modern-scrollbar"),children:m.map(_=>{switch(_.kind){case"file":return C.jsx(jSe,{selected:r===_.fullPath,file:_,unsavedChanges:c instanceof Set&&c.has(_.fullPath),fileHistory:u,onCopyPath:()=>{g(_)},onCopyRelativePath:()=>{y(_)},onClick:()=>{e?.(_.fullPath)}},_.id);case"folder":return C.jsx(FSe,{folder:_,selected:o&&r===_.fullPath,collapsed:f.has(_.fullPath),onCopyPath:()=>{g(_)},onCopyRelativePath:()=>{y(_)},onClick:()=>{p(_.fullPath)}},_.id);default:return}})})});function qs({onSelect:t,children:e}){return C.jsxs(NSe,{onSelect:t,className:"flex items-center gap-2 px-2 py-1.5 outline-0 text-sm text-codeia-elements-textPrimary cursor-pointer ws-nowrap text-codeia-elements-item-contentDefault hover:text-codeia-elements-item-contentActive hover:bg-codeia-elements-item-backgroundActive rounded-md",children:[C.jsx("span",{className:"size-4 shrink-0"}),C.jsx("span",{children:e})]})}function ZP({depth:t,placeholder:e,initialValue:r="",onSubmit:n,onCancel:s}){const i=k.useRef(null);k.useEffect(()=>{const a=setTimeout(()=>{i.current&&(i.current.focus(),r&&(i.current.value=r,i.current.select()))},50);return()=>clearTimeout(a)},[r]);const o=a=>{if(a.key==="Enter"){const l=i.current?.value.trim();l&&n(l)}else a.key==="Escape"&&s()};return C.jsxs("div",{className:"flex items-center w-full px-2 bg-codeia-elements-background-depth-4 border border-codeia-elements-item-contentAccent py-0.5 text-codeia-elements-textPrimary",style:{paddingLeft:`${6+t*S6}px`},children:[C.jsx("div",{className:"scale-120 shrink-0 i-ph:file-plus text-codeia-elements-textTertiary"}),C.jsx("input",{ref:i,type:"text",className:"ml-2 flex-1 bg-transparent border-none outline-none py-0.5 text-sm text-codeia-elements-textPrimary placeholder:text-codeia-elements-textTertiary min-w-0",placeholder:e,onKeyDown:o,onBlur:()=>{setTimeout(()=>{document.activeElement!==i.current&&s()},100)}})]})}function C6({onCopyPath:t,onCopyRelativePath:e,fullPath:r,children:n}){const[s,i]=k.useState(!1),[o,a]=k.useState(!1),[l,c]=k.useState(!1),u=k.useMemo(()=>r.split("/").length,[r]),d=k.useMemo(()=>fr.basename(r),[r]),h=k.useMemo(()=>{const T=Ie.files.get()[r];return!T||T.type==="folder"},[r]),f=k.useMemo(()=>h?r:fr.dirname(r),[r,h]),v=k.useCallback(x=>{x.preventDefault(),x.stopPropagation(),c(!0)},[]),m=k.useCallback(x=>{x.preventDefault(),x.stopPropagation(),c(!1)},[]),p=k.useCallback(async x=>{x.preventDefault(),x.stopPropagation();const D=Array.from(x.dataTransfer.items).filter(O=>O.kind==="file");for(const O of D){const R=O.getAsFile();if(R)try{const P=fr.join(r,R.name),A=await R.arrayBuffer(),H=new Uint8Array(A);await Ie.createFile(P,H)?De.success(`File ${R.name} uploaded successfully`):De.error(`Failed to upload file ${R.name}`)}catch(P){De.error(`Error uploading ${R.name}`),Qs.error(P)}}c(!1)},[r]),g=async x=>{const T=fr.join(f,x);await Ie.createFile(T,"")?De.success("File created successfully"):De.error("Failed to create file"),i(!1)},y=async x=>{const T=fr.join(f,x);await Ie.createFolder(T)?De.success("Folder created successfully"):De.error("Failed to create folder"),a(!1)},_=async()=>{try{if(!confirm(`Are you sure you want to delete ${h?"folder":"file"}: ${d}?`))return;let x;h?x=await Ie.deleteFolder(r):x=await Ie.deleteFile(r),x?De.success(`${h?"Folder":"File"} deleted successfully`):De.error(`Failed to delete ${h?"folder":"file"}`)}catch(x){De.error(`Error deleting ${h?"folder":"file"}`),Qs.error(x)}},b=()=>{try{if(h)return;Ie.lockFile(r)?De.success("File locked successfully"):De.error("Failed to lock file")}catch(x){De.error("Error locking file"),Qs.error(x)}},w=()=>{try{if(h)return;Ie.unlockFile(r)?De.success("File unlocked successfully"):De.error("Failed to unlock file")}catch(x){De.error("Error unlocking file"),Qs.error(x)}},E=()=>{try{if(!h)return;Ie.lockFolder(r)?De.success("Folder locked successfully"):De.error("Failed to lock folder")}catch(x){De.error("Error locking folder"),Qs.error(x)}},S=()=>{try{if(!h)return;Ie.unlockFolder(r)?De.success("Folder unlocked successfully"):De.error("Failed to unlock folder")}catch(x){De.error("Error unlocking folder"),Qs.error(x)}};return C.jsxs(C.Fragment,{children:[C.jsxs(OSe,{children:[C.jsx(DSe,{children:C.jsx("div",{onDragOver:v,onDragLeave:m,onDrop:p,className:Te("relative",{"bg-codeia-elements-background-depth-2 border border-dashed border-codeia-elements-item-contentAccent rounded-md":l}),children:n})}),C.jsx(MSe,{children:C.jsxs(LSe,{style:{zIndex:998},className:"border border-codeia-elements-borderColor rounded-md z-context-menu bg-codeia-elements-background-depth-1 dark:bg-codeia-elements-background-depth-2 data-[state=open]:animate-in animate-duration-100 data-[state=open]:fade-in-0 data-[state=open]:zoom-in-98 w-56",children:[C.jsxs(If,{className:"p-1 border-b-px border-solid border-codeia-elements-borderColor",children:[C.jsx(qs,{onSelect:()=>i(!0),children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:file-plus"}),"New File"]})}),C.jsx(qs,{onSelect:()=>a(!0),children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:folder-plus"}),"New Folder"]})})]}),C.jsxs(If,{className:"p-1",children:[C.jsx(qs,{onSelect:t,children:"Copy path"}),C.jsx(qs,{onSelect:e,children:"Copy relative path"})]}),C.jsx(If,{className:"p-1 border-t-px border-solid border-codeia-elements-borderColor",children:h?C.jsxs(C.Fragment,{children:[C.jsx(qs,{onSelect:E,children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:lock-simple"}),"Lock Folder"]})}),C.jsx(qs,{onSelect:S,children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:lock-key-open"}),"Unlock Folder"]})})]}):C.jsxs(C.Fragment,{children:[C.jsx(qs,{onSelect:b,children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:lock-simple"}),"Lock File"]})}),C.jsx(qs,{onSelect:w,children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:lock-key-open"}),"Unlock File"]})})]})}),C.jsx(If,{className:"p-1 border-t-px border-solid border-codeia-elements-borderColor",children:C.jsx(qs,{onSelect:_,children:C.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[C.jsx("div",{className:"i-ph:trash"}),"Delete ",h?"Folder":"File"]})})})]})})]}),s&&C.jsx(ZP,{depth:u,placeholder:"Enter file name...",onSubmit:g,onCancel:()=>i(!1)}),o&&C.jsx(ZP,{depth:u,placeholder:"Enter folder name...",onSubmit:y,onCancel:()=>a(!1)})]})}function FSe({folder:t,collapsed:e,selected:r=!1,onCopyPath:n,onCopyRelativePath:s,onClick:i}){const{isLocked:o}=Ie.isFolderLocked(t.fullPath);return C.jsx(C6,{onCopyPath:n,onCopyRelativePath:s,fullPath:t.fullPath,children:C.jsx(k6,{className:Te("group",{"bg-transparent text-codeia-elements-item-contentDefault hover:text-codeia-elements-item-contentActive hover:bg-codeia-elements-item-backgroundActive":!r,"bg-codeia-elements-item-backgroundAccent text-codeia-elements-item-contentAccent":r}),depth:t.depth,iconClasses:Te({"i-ph:caret-right scale-98":e,"i-ph:caret-down scale-98":!e}),onClick:i,children:C.jsxs("div",{className:"flex items-center w-full",children:[C.jsx("div",{className:"flex-1 truncate pr-2",children:t.name}),o&&C.jsx("span",{className:Te("shrink-0","i-ph:lock-simple scale-80 text-red-500"),title:"Folder is locked"})]})})})}function jSe({file:t,onClick:e,onCopyPath:r,onCopyRelativePath:n,selected:s,unsavedChanges:i=!1,fileHistory:o={}}){const{depth:a,name:l,fullPath:c}=t,{locked:u}=Ie.isFileLocked(c),d=o[c],{additions:h,deletions:f}=k.useMemo(()=>{if(!d?.originalContent)return{additions:0,deletions:0};const m=d.originalContent.replace(/\r\n/g,`
`),p=d.versions[d.versions.length-1]?.content.replace(/\r\n/g,`
`)||"";return m===p?{additions:0,deletions:0}:$l(m,p,{newlineIsToken:!1,ignoreWhitespace:!0,ignoreCase:!1}).reduce((y,_)=>(_.added&&(y.additions+=_.value.split(`
`).length),_.removed&&(y.deletions+=_.value.split(`
`).length),y),{additions:0,deletions:0})},[d]),v=h>0||f>0;return C.jsx(C6,{onCopyPath:r,onCopyRelativePath:n,fullPath:c,children:C.jsx(k6,{className:Te("group",{"bg-transparent hover:bg-codeia-elements-item-backgroundActive text-codeia-elements-item-contentDefault":!s,"bg-codeia-elements-item-backgroundAccent text-codeia-elements-item-contentAccent":s}),depth:a,iconClasses:Te("i-ph:file-duotone scale-98",{"group-hover:text-codeia-elements-item-contentActive":!s}),onClick:e,children:C.jsxs("div",{className:Te("flex items-center",{"group-hover:text-codeia-elements-item-contentActive":!s}),children:[C.jsx("div",{className:"flex-1 truncate pr-2",children:l}),C.jsxs("div",{className:"flex items-center gap-1",children:[v&&C.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[h>0&&C.jsxs("span",{className:"text-green-500",children:["+",h]}),f>0&&C.jsxs("span",{className:"text-red-500",children:["-",f]})]}),u&&C.jsx("span",{className:Te("shrink-0","i-ph:lock-simple scale-80 text-red-500"),title:"File is locked"}),i&&C.jsx("span",{className:"i-ph:circle-fill scale-68 shrink-0 text-orange-500"})]})]})})})}function k6({depth:t,iconClasses:e,onClick:r,className:n,children:s}){return C.jsxs("button",{className:Te("flex items-center gap-1.5 w-full pr-2 border-2 border-transparent text-faded py-0.5",n),style:{paddingLeft:`${6+t*S6}px`},onClick:()=>r?.(),children:[C.jsx("div",{className:Te("scale-120 shrink-0",e)}),C.jsx("div",{className:"truncate w-full text-left",children:s})]})}function $Se(t,e="/",r,n){const s=new Set,i=[];let o=0;e==="/"&&!r&&(o=1,i.push({kind:"folder",name:"/",depth:0,id:0,fullPath:"/"}));for(const[a,l]of Object.entries(t)){const c=a.split("/").filter(v=>v),u=c.at(-1);if(!u||USe(a,u,n))continue;let d="",h=0,f=0;for(;h<c.length;){const v=c[h],m=d+=`/${v}`;if(!m.startsWith(e)||r&&m===e){h++;continue}h===c.length-1&&l?.type==="file"?i.push({kind:"file",id:i.length,name:v,fullPath:m,depth:f+o}):s.has(m)||(s.add(m),i.push({kind:"folder",id:i.length,name:v,fullPath:m,depth:f+o})),h++,f++}}return HSe(e,i,r)}function USe(t,e,r){return r.some(n=>typeof n=="string"?e===n:n.test(t))}function HSe(t,e,r){Qs.trace("sortFileList");const n=new Map,s=new Map;e.sort((a,l)=>VSe(a,l));for(const a of e){n.set(a.fullPath,a);const l=a.fullPath.slice(0,a.fullPath.lastIndexOf("/"));l!==t.slice(0,t.lastIndexOf("/"))&&(s.has(l)||s.set(l,[]),s.get(l)?.push(a))}const i=[],o=a=>{const l=n.get(a);l&&i.push(l);const c=s.get(a);if(c)for(const u of c)u.kind==="folder"?o(u.fullPath):i.push(u)};if(r){const a=s.get(t)||[];for(const l of a)o(l.fullPath)}else o(t);return i}function VSe(t,e){return t.kind!==e.kind?t.kind==="folder"?-1:1:t.name.localeCompare(e.name,void 0,{numeric:!0,sensitivity:"base"})}const GSe=new RegExp(`^${lc.split("/").slice(0,-1).join("/").replaceAll("/","\\/")}/`),zSe={open:{y:0,opacity:1,transition:{duration:.15,ease:ho}},close:{y:6,opacity:0,transition:{duration:.15,ease:ho}}},WSe=k.memo(({files:t,pathSegments:e=[],onFileSelect:r})=>{ec.trace("FileBreadcrumb");const[n,s]=k.useState(null),i=k.useRef(null),o=k.useRef([]),a=l=>{s(c=>c===l?null:l)};return k.useEffect(()=>{const l=c=>{n!==null&&!i.current?.contains(c.target)&&!o.current.some(u=>u?.contains(c.target))&&s(null)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[n]),t===void 0||e.length===0?null:C.jsx("div",{className:"flex",children:e.map((l,c)=>{const u=c===e.length-1,d=e.slice(0,c).join("/");if(!GSe.test(d))return null;const h=n===c;return C.jsx("div",{className:"relative flex items-center",children:C.jsxs(d6,{open:h,modal:!1,children:[C.jsx(h6,{asChild:!0,children:C.jsxs("span",{ref:f=>{o.current[c]=f},className:Te("flex items-center gap-1.5 cursor-pointer shrink-0",{"text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary":!h,"text-codeia-elements-textPrimary underline":h,"pr-4":u}),onClick:()=>a(c),children:[u&&C.jsx("div",{className:"i-ph:file-duotone"}),l]})}),c>0&&!u&&C.jsx("span",{className:"i-ph:caret-right inline-block mx-1"}),C.jsx(Hw,{children:h&&C.jsx(aSe,{children:C.jsx(f6,{className:"z-file-tree-breadcrumb",asChild:!0,align:"start",side:"bottom",avoidCollisions:!1,children:C.jsxs(mt.div,{ref:i,initial:"close",animate:"open",exit:"close",variants:zSe,children:[C.jsx("div",{className:"rounded-lg overflow-hidden",children:C.jsx("div",{className:"max-h-[50vh] min-w-[300px] overflow-scroll bg-codeia-elements-background-depth-1 border border-codeia-elements-borderColor shadow-sm rounded-lg",children:C.jsx(E6,{files:t,hideRoot:!0,rootFolder:d,collapsed:!0,allowFolderSelection:!0,selectedFile:`${d}/${l}`,onFileSelect:f=>{s(null),r?.(f)}})})}),C.jsx(lSe,{className:"fill-codeia-elements-borderColor"})]})})})})]})},c)})})});var T6={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(self,()=>(()=>{var r={};return(()=>{var n=r;Object.defineProperty(n,"__esModule",{value:!0}),n.FitAddon=void 0,n.FitAddon=class{activate(s){this._terminal=s}dispose(){}fit(){const s=this.proposeDimensions();if(!s||!this._terminal||isNaN(s.cols)||isNaN(s.rows))return;const i=this._terminal._core;this._terminal.rows===s.rows&&this._terminal.cols===s.cols||(i._renderService.clear(),this._terminal.resize(s.cols,s.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const s=this._terminal._core,i=s._renderService.dimensions;if(i.css.cell.width===0||i.css.cell.height===0)return;const o=this._terminal.options.scrollback===0?0:s.viewport.scrollBarWidth,a=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(a.getPropertyValue("height")),c=Math.max(0,parseInt(a.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),d=l-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),h=c-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-o;return{cols:Math.max(2,Math.floor(h/i.css.cell.width)),rows:Math.max(1,Math.floor(d/i.css.cell.height))}}}})(),r})())})(T6);var KSe=T6.exports,A6={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(self,()=>(()=>{var r={6:(o,a)=>{function l(u){try{const d=new URL(u),h=d.password&&d.username?`${d.protocol}//${d.username}:${d.password}@${d.host}`:d.username?`${d.protocol}//${d.username}@${d.host}`:`${d.protocol}//${d.host}`;return u.toLocaleLowerCase().startsWith(h.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.LinkComputer=a.WebLinkProvider=void 0,a.WebLinkProvider=class{constructor(u,d,h,f={}){this._terminal=u,this._regex=d,this._handler=h,this._options=f}provideLinks(u,d){const h=c.computeLink(u,this._regex,this._terminal,this._handler);d(this._addCallbacks(h))}_addCallbacks(u){return u.map(d=>(d.leave=this._options.leave,d.hover=(h,f)=>{if(this._options.hover){const{range:v}=d;this._options.hover(h,f,v)}},d))}};class c{static computeLink(d,h,f,v){const m=new RegExp(h.source,(h.flags||"")+"g"),[p,g]=c._getWindowedLineStrings(d-1,f),y=p.join("");let _;const b=[];for(;_=m.exec(y);){const w=_[0];if(!l(w))continue;const[E,S]=c._mapStrIdx(f,g,0,_.index),[x,T]=c._mapStrIdx(f,E,S,w.length);if(E===-1||S===-1||x===-1||T===-1)continue;const D={start:{x:S+1,y:E+1},end:{x:T,y:x+1}};b.push({range:D,text:w,activate:v})}return b}static _getWindowedLineStrings(d,h){let f,v=d,m=d,p=0,g="";const y=[];if(f=h.buffer.active.getLine(d)){const _=f.translateToString(!0);if(f.isWrapped&&_[0]!==" "){for(p=0;(f=h.buffer.active.getLine(--v))&&p<2048&&(g=f.translateToString(!0),p+=g.length,y.push(g),f.isWrapped&&g.indexOf(" ")===-1););y.reverse()}for(y.push(_),p=0;(f=h.buffer.active.getLine(++m))&&f.isWrapped&&p<2048&&(g=f.translateToString(!0),p+=g.length,y.push(g),g.indexOf(" ")===-1););}return[y,v]}static _mapStrIdx(d,h,f,v){const m=d.buffer.active,p=m.getNullCell();let g=f;for(;v;){const y=m.getLine(h);if(!y)return[-1,-1];for(let _=g;_<y.length;++_){y.getCell(_,p);const b=p.getChars();if(p.getWidth()&&(v-=b.length||1,_===y.length-1&&b==="")){const w=m.getLine(h+1);w&&w.isWrapped&&(w.getCell(0,p),p.getWidth()===2&&(v+=1))}if(v<0)return[h,_]}h++,g=0}return[h,g]}}a.LinkComputer=c}},n={};function s(o){var a=n[o];if(a!==void 0)return a.exports;var l=n[o]={exports:{}};return r[o](l,l.exports,s),l.exports}var i={};return(()=>{var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.WebLinksAddon=void 0;const a=s(6),l=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function c(u,d){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=d}else console.warn("Opening link blocked as opener could not be cleared")}o.WebLinksAddon=class{constructor(u=c,d={}){this._handler=u,this._options=d}activate(u){this._terminal=u;const d=this._options,h=d.urlRegex||l;this._linkProvider=this._terminal.registerLinkProvider(new a.WebLinkProvider(this._terminal,h,this._handler,d))}dispose(){this._linkProvider?.dispose()}}})(),i})())})(A6);var qSe=A6.exports,R6={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(globalThis,()=>(()=>{var r={4567:function(o,a,l){var c=this&&this.__decorate||function(y,_,b,w){var E,S=arguments.length,x=S<3?_:w===null?w=Object.getOwnPropertyDescriptor(_,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,_,b,w);else for(var T=y.length-1;T>=0;T--)(E=y[T])&&(x=(S<3?E(x):S>3?E(_,b,x):E(_,b))||x);return S>3&&x&&Object.defineProperty(_,b,x),x},u=this&&this.__param||function(y,_){return function(b,w){_(b,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.AccessibilityManager=void 0;const d=l(9042),h=l(9924),f=l(844),v=l(4725),m=l(2585),p=l(3656);let g=a.AccessibilityManager=class extends f.Disposable{constructor(y,_,b,w){super(),this._terminal=y,this._coreBrowserService=b,this._renderService=w,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let E=0;E<this._terminal.rows;E++)this._rowElements[E]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[E]);if(this._topBoundaryFocusListener=E=>this._handleBoundaryFocus(E,0),this._bottomBoundaryFocusListener=E=>this._handleBoundaryFocus(E,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new h.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(E=>this._handleResize(E.rows))),this.register(this._terminal.onRender(E=>this._refreshRows(E.start,E.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(E=>this._handleChar(E))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(E=>this._handleTab(E))),this.register(this._terminal.onKey(E=>this._handleKey(E.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,p.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,f.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(y){for(let _=0;_<y;_++)this._handleChar(" ")}_handleChar(y){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==y&&(this._charsToAnnounce+=y):this._charsToAnnounce+=y,y===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=d.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(y){this._clearLiveRegion(),/\p{Control}/u.test(y)||this._charsToConsume.push(y)}_refreshRows(y,_){this._liveRegionDebouncer.refresh(y,_,this._terminal.rows)}_renderRows(y,_){const b=this._terminal.buffer,w=b.lines.length.toString();for(let E=y;E<=_;E++){const S=b.lines.get(b.ydisp+E),x=[],T=S?.translateToString(!0,void 0,void 0,x)||"",D=(b.ydisp+E+1).toString(),O=this._rowElements[E];O&&(T.length===0?(O.innerText=" ",this._rowColumns.set(O,[0,1])):(O.textContent=T,this._rowColumns.set(O,x)),O.setAttribute("aria-posinset",D),O.setAttribute("aria-setsize",w))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(y,_){const b=y.target,w=this._rowElements[_===0?1:this._rowElements.length-2];if(b.getAttribute("aria-posinset")===(_===0?"1":`${this._terminal.buffer.lines.length}`)||y.relatedTarget!==w)return;let E,S;if(_===0?(E=b,S=this._rowElements.pop(),this._rowContainer.removeChild(S)):(E=this._rowElements.shift(),S=b,this._rowContainer.removeChild(E)),E.removeEventListener("focus",this._topBoundaryFocusListener),S.removeEventListener("focus",this._bottomBoundaryFocusListener),_===0){const x=this._createAccessibilityTreeNode();this._rowElements.unshift(x),this._rowContainer.insertAdjacentElement("afterbegin",x)}else{const x=this._createAccessibilityTreeNode();this._rowElements.push(x),this._rowContainer.appendChild(x)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(_===0?-1:1),this._rowElements[_===0?1:this._rowElements.length-2].focus(),y.preventDefault(),y.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;const y=document.getSelection();if(!y)return;if(y.isCollapsed)return void(this._rowContainer.contains(y.anchorNode)&&this._terminal.clearSelection());if(!y.anchorNode||!y.focusNode)return void console.error("anchorNode and/or focusNode are null");let _={node:y.anchorNode,offset:y.anchorOffset},b={node:y.focusNode,offset:y.focusOffset};if((_.node.compareDocumentPosition(b.node)&Node.DOCUMENT_POSITION_PRECEDING||_.node===b.node&&_.offset>b.offset)&&([_,b]=[b,_]),_.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(_={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(_.node))return;const w=this._rowElements.slice(-1)[0];if(b.node.compareDocumentPosition(w)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(b={node:w,offset:w.textContent?.length??0}),!this._rowContainer.contains(b.node))return;const E=({node:T,offset:D})=>{const O=T instanceof Text?T.parentNode:T;let R=parseInt(O?.getAttribute("aria-posinset"),10)-1;if(isNaN(R))return console.warn("row is invalid. Race condition?"),null;const P=this._rowColumns.get(O);if(!P)return console.warn("columns is null. Race condition?"),null;let A=D<P.length?P[D]:P.slice(-1)[0]+1;return A>=this._terminal.cols&&(++R,A=0),{row:R,column:A}},S=E(_),x=E(b);if(S&&x){if(S.row>x.row||S.row===x.row&&S.column>=x.column)throw new Error("invalid range");this._terminal.select(S.column,S.row,(x.row-S.row)*this._terminal.cols-S.column+x.column)}}_handleResize(y){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let _=this._rowContainer.children.length;_<this._terminal.rows;_++)this._rowElements[_]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[_]);for(;this._rowElements.length>y;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const y=this._coreBrowserService.mainDocument.createElement("div");return y.setAttribute("role","listitem"),y.tabIndex=-1,this._refreshRowDimensions(y),y}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let y=0;y<this._terminal.rows;y++)this._refreshRowDimensions(this._rowElements[y])}}_refreshRowDimensions(y){y.style.height=`${this._renderService.dimensions.css.cell.height}px`}};a.AccessibilityManager=g=c([u(1,m.IInstantiationService),u(2,v.ICoreBrowserService),u(3,v.IRenderService)],g)},3614:(o,a)=>{function l(h){return h.replace(/\r?\n/g,"\r")}function c(h,f){return f?"\x1B[200~"+h+"\x1B[201~":h}function u(h,f,v,m){h=c(h=l(h),v.decPrivateModes.bracketedPasteMode&&m.rawOptions.ignoreBracketedPasteMode!==!0),v.triggerDataEvent(h,!0),f.value=""}function d(h,f,v){const m=v.getBoundingClientRect(),p=h.clientX-m.left-10,g=h.clientY-m.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${p}px`,f.style.top=`${g}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(a,"__esModule",{value:!0}),a.rightClickHandler=a.moveTextAreaUnderMouseCursor=a.paste=a.handlePasteEvent=a.copyHandler=a.bracketTextForPaste=a.prepareTextForTerminal=void 0,a.prepareTextForTerminal=l,a.bracketTextForPaste=c,a.copyHandler=function(h,f){h.clipboardData&&h.clipboardData.setData("text/plain",f.selectionText),h.preventDefault()},a.handlePasteEvent=function(h,f,v,m){h.stopPropagation(),h.clipboardData&&u(h.clipboardData.getData("text/plain"),f,v,m)},a.paste=u,a.moveTextAreaUnderMouseCursor=d,a.rightClickHandler=function(h,f,v,m,p){d(h,f,v),p&&m.rightClickSelect(h),f.value=m.selectionText,f.select()}},7239:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorContrastCache=void 0;const c=l(1505);a.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(u,d,h){this._css.set(u,d,h)}getCss(u,d){return this._css.get(u,d)}setColor(u,d,h){this._color.set(u,d,h)}getColor(u,d){return this._color.get(u,d)}clear(){this._color.clear(),this._css.clear()}}},3656:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.addDisposableDomListener=void 0,a.addDisposableDomListener=function(l,c,u,d){l.addEventListener(c,u,d);let h=!1;return{dispose:()=>{h||(h=!0,l.removeEventListener(c,u,d))}}}},3551:function(o,a,l){var c=this&&this.__decorate||function(g,y,_,b){var w,E=arguments.length,S=E<3?y:b===null?b=Object.getOwnPropertyDescriptor(y,_):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(g,y,_,b);else for(var x=g.length-1;x>=0;x--)(w=g[x])&&(S=(E<3?w(S):E>3?w(y,_,S):w(y,_))||S);return E>3&&S&&Object.defineProperty(y,_,S),S},u=this&&this.__param||function(g,y){return function(_,b){y(_,b,g)}};Object.defineProperty(a,"__esModule",{value:!0}),a.Linkifier=void 0;const d=l(3656),h=l(8460),f=l(844),v=l(2585),m=l(4725);let p=a.Linkifier=class extends f.Disposable{get currentLink(){return this._currentLink}constructor(g,y,_,b,w){super(),this._element=g,this._mouseService=y,this._renderService=_,this._bufferService=b,this._linkProviderService=w,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,d.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,d.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,d.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,d.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(g){this._lastMouseEvent=g;const y=this._positionFromMouseEvent(g,this._element,this._mouseService);if(!y)return;this._isMouseOut=!1;const _=g.composedPath();for(let b=0;b<_.length;b++){const w=_[b];if(w.classList.contains("xterm"))break;if(w.classList.contains("xterm-hover"))return}this._lastBufferCell&&y.x===this._lastBufferCell.x&&y.y===this._lastBufferCell.y||(this._handleHover(y),this._lastBufferCell=y)}_handleHover(g){if(this._activeLine!==g.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(g,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,g)||(this._clearCurrentLink(),this._askForLink(g,!0))}_askForLink(g,y){this._activeProviderReplies&&y||(this._activeProviderReplies?.forEach(b=>{b?.forEach(w=>{w.link.dispose&&w.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=g.y);let _=!1;for(const[b,w]of this._linkProviderService.linkProviders.entries())y?this._activeProviderReplies?.get(b)&&(_=this._checkLinkProviderResult(b,g,_)):w.provideLinks(g.y,E=>{if(this._isMouseOut)return;const S=E?.map(x=>({link:x}));this._activeProviderReplies?.set(b,S),_=this._checkLinkProviderResult(b,g,_),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(g.y,this._activeProviderReplies)})}_removeIntersectingLinks(g,y){const _=new Set;for(let b=0;b<y.size;b++){const w=y.get(b);if(w)for(let E=0;E<w.length;E++){const S=w[E],x=S.link.range.start.y<g?0:S.link.range.start.x,T=S.link.range.end.y>g?this._bufferService.cols:S.link.range.end.x;for(let D=x;D<=T;D++){if(_.has(D)){w.splice(E--,1);break}_.add(D)}}}}_checkLinkProviderResult(g,y,_){if(!this._activeProviderReplies)return _;const b=this._activeProviderReplies.get(g);let w=!1;for(let E=0;E<g;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(w=!0);if(!w&&b){const E=b.find(S=>this._linkAtPosition(S.link,y));E&&(_=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!_)for(let E=0;E<this._activeProviderReplies.size;E++){const S=this._activeProviderReplies.get(E)?.find(x=>this._linkAtPosition(x.link,y));if(S){_=!0,this._handleNewLink(S);break}}return _}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(g){if(!this._currentLink)return;const y=this._positionFromMouseEvent(g,this._element,this._mouseService);y&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,y)&&this._currentLink.link.activate(g,this._currentLink.link.text)}_clearCurrentLink(g,y){this._currentLink&&this._lastMouseEvent&&(!g||!y||this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=y)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(g){if(!this._lastMouseEvent)return;const y=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);y&&this._linkAtPosition(g.link,y)&&(this._currentLink=g,this._currentLink.state={decorations:{underline:g.link.decorations===void 0||g.link.decorations.underline,pointerCursor:g.link.decorations===void 0||g.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,g.link,this._lastMouseEvent),g.link.decorations={},Object.defineProperties(g.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:_=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==_&&(this._currentLink.state.decorations.pointerCursor=_,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",_))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:_=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==_&&(this._currentLink.state.decorations.underline=_,this._currentLink.state.isHovered&&this._fireUnderlineEvent(g.link,_))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(_=>{if(!this._currentLink)return;const b=_.start===0?0:_.start+1+this._bufferService.buffer.ydisp,w=this._bufferService.buffer.ydisp+1+_.end;if(this._currentLink.link.range.start.y>=b&&this._currentLink.link.range.end.y<=w&&(this._clearCurrentLink(b,w),this._lastMouseEvent)){const E=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);E&&this._askForLink(E,!1)}})))}_linkHover(g,y,_){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(y,!0),this._currentLink.state.decorations.pointerCursor&&g.classList.add("xterm-cursor-pointer")),y.hover&&y.hover(_,y.text)}_fireUnderlineEvent(g,y){const _=g.range,b=this._bufferService.buffer.ydisp,w=this._createLinkUnderlineEvent(_.start.x-1,_.start.y-b-1,_.end.x,_.end.y-b-1,void 0);(y?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(w)}_linkLeave(g,y,_){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(y,!1),this._currentLink.state.decorations.pointerCursor&&g.classList.remove("xterm-cursor-pointer")),y.leave&&y.leave(_,y.text)}_linkAtPosition(g,y){const _=g.range.start.y*this._bufferService.cols+g.range.start.x,b=g.range.end.y*this._bufferService.cols+g.range.end.x,w=y.y*this._bufferService.cols+y.x;return _<=w&&w<=b}_positionFromMouseEvent(g,y,_){const b=_.getCoords(g,y,this._bufferService.cols,this._bufferService.rows);if(b)return{x:b[0],y:b[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(g,y,_,b,w){return{x1:g,y1:y,x2:_,y2:b,cols:this._bufferService.cols,fg:w}}};a.Linkifier=p=c([u(1,m.IMouseService),u(2,m.IRenderService),u(3,v.IBufferService),u(4,m.ILinkProviderService)],p)},9042:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.tooMuchOutput=a.promptLabel=void 0,a.promptLabel="Terminal input",a.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(o,a,l){var c=this&&this.__decorate||function(m,p,g,y){var _,b=arguments.length,w=b<3?p:y===null?y=Object.getOwnPropertyDescriptor(p,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,p,g,y);else for(var E=m.length-1;E>=0;E--)(_=m[E])&&(w=(b<3?_(w):b>3?_(p,g,w):_(p,g))||w);return b>3&&w&&Object.defineProperty(p,g,w),w},u=this&&this.__param||function(m,p){return function(g,y){p(g,y,m)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OscLinkProvider=void 0;const d=l(511),h=l(2585);let f=a.OscLinkProvider=class{constructor(m,p,g){this._bufferService=m,this._optionsService=p,this._oscLinkService=g}provideLinks(m,p){const g=this._bufferService.buffer.lines.get(m-1);if(!g)return void p(void 0);const y=[],_=this._optionsService.rawOptions.linkHandler,b=new d.CellData,w=g.getTrimmedLength();let E=-1,S=-1,x=!1;for(let T=0;T<w;T++)if(S!==-1||g.hasContent(T)){if(g.loadCell(T,b),b.hasExtendedAttrs()&&b.extended.urlId){if(S===-1){S=T,E=b.extended.urlId;continue}x=b.extended.urlId!==E}else S!==-1&&(x=!0);if(x||S!==-1&&T===w-1){const D=this._oscLinkService.getLinkData(E)?.uri;if(D){const O={start:{x:S+1,y:m},end:{x:T+(x||T!==w-1?0:1),y:m}};let R=!1;if(!_?.allowNonHttpProtocols)try{const P=new URL(D);["http:","https:"].includes(P.protocol)||(R=!0)}catch{R=!0}R||y.push({text:D,range:O,activate:(P,A)=>_?_.activate(P,A,O):v(0,A),hover:(P,A)=>_?.hover?.(P,A,O),leave:(P,A)=>_?.leave?.(P,A,O)})}x=!1,b.hasExtendedAttrs()&&b.extended.urlId?(S=T,E=b.extended.urlId):(S=-1,E=-1)}}p(y)}};function v(m,p){if(confirm(`Do you want to navigate to ${p}?

WARNING: This link could potentially be dangerous`)){const g=window.open();if(g){try{g.opener=null}catch{}g.location.href=p}else console.warn("Opening link blocked as opener could not be cleared")}}a.OscLinkProvider=f=c([u(0,h.IBufferService),u(1,h.IOptionsService),u(2,h.IOscLinkService)],f)},6193:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.RenderDebouncer=void 0,a.RenderDebouncer=class{constructor(l,c){this._renderCallback=l,this._coreBrowserService=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,c,u){this._rowCount=u,l=l!==void 0?l:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},3236:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Terminal=void 0;const c=l(3614),u=l(3656),d=l(3551),h=l(9042),f=l(3730),v=l(1680),m=l(3107),p=l(5744),g=l(2950),y=l(1296),_=l(428),b=l(4269),w=l(5114),E=l(8934),S=l(3230),x=l(9312),T=l(4725),D=l(6731),O=l(8055),R=l(8969),P=l(8460),A=l(844),H=l(6114),K=l(8437),V=l(2584),q=l(7399),I=l(5941),$=l(9074),j=l(2585),U=l(5435),J=l(4567),ne=l(779);class te extends R.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(re={}){super(re),this.browser=H,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new A.MutableDisposable),this._onCursorMove=this.register(new P.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new P.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new P.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new P.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new P.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new P.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new P.EventEmitter),this._onBlur=this.register(new P.EventEmitter),this._onA11yCharEmitter=this.register(new P.EventEmitter),this._onA11yTabEmitter=this.register(new P.EventEmitter),this._onWillOpen=this.register(new P.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance($.DecorationService),this._instantiationService.setService(j.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(ne.LinkProviderService),this._instantiationService.setService(T.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(f.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((F,X)=>this.refresh(F,X))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(F=>this._reportWindowsOptions(F))),this.register(this._inputHandler.onColor(F=>this._handleColorEvent(F))),this.register((0,P.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,P.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(F=>this._afterResize(F.cols,F.rows))),this.register((0,A.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(re){if(this._themeService)for(const F of re){let X,Y="";switch(F.index){case 256:X="foreground",Y="10";break;case 257:X="background",Y="11";break;case 258:X="cursor",Y="12";break;default:X="ansi",Y="4;"+F.index}switch(F.type){case 0:const oe=O.color.toColorRGB(X==="ansi"?this._themeService.colors.ansi[F.index]:this._themeService.colors[X]);this.coreService.triggerDataEvent(`${V.C0.ESC}]${Y};${(0,I.toRgbString)(oe)}${V.C1_ESCAPED.ST}`);break;case 1:if(X==="ansi")this._themeService.modifyColors(le=>le.ansi[F.index]=O.channels.toColor(...F.color));else{const le=X;this._themeService.modifyColors(ue=>ue[le]=O.channels.toColor(...F.color))}break;case 2:this._themeService.restoreColor(F.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(re){re?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(J.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(re){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(V.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(V.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const re=this.buffer.ybase+this.buffer.y,F=this.buffer.lines.get(re);if(!F)return;const X=Math.min(this.buffer.x,this.cols-1),Y=this._renderService.dimensions.css.cell.height,oe=F.getWidth(X),le=this._renderService.dimensions.css.cell.width*oe,ue=this.buffer.y*this._renderService.dimensions.css.cell.height,N=X*this._renderService.dimensions.css.cell.width;this.textarea.style.left=N+"px",this.textarea.style.top=ue+"px",this.textarea.style.width=le+"px",this.textarea.style.height=Y+"px",this.textarea.style.lineHeight=Y+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,u.addDisposableDomListener)(this.element,"copy",F=>{this.hasSelection()&&(0,c.copyHandler)(F,this._selectionService)}));const re=F=>(0,c.handlePasteEvent)(F,this.textarea,this.coreService,this.optionsService);this.register((0,u.addDisposableDomListener)(this.textarea,"paste",re)),this.register((0,u.addDisposableDomListener)(this.element,"paste",re)),H.isFirefox?this.register((0,u.addDisposableDomListener)(this.element,"mousedown",F=>{F.button===2&&(0,c.rightClickHandler)(F,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,u.addDisposableDomListener)(this.element,"contextmenu",F=>{(0,c.rightClickHandler)(F,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),H.isLinux&&this.register((0,u.addDisposableDomListener)(this.element,"auxclick",F=>{F.button===1&&(0,c.moveTextAreaUnderMouseCursor)(F,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,u.addDisposableDomListener)(this.textarea,"keyup",re=>this._keyUp(re),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keydown",re=>this._keyDown(re),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keypress",re=>this._keyPress(re),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionupdate",re=>this._compositionHelper.compositionupdate(re))),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,u.addDisposableDomListener)(this.textarea,"input",re=>this._inputEvent(re),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(re){if(!re)throw new Error("Terminal requires a parent element.");if(re.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=re.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),re.appendChild(this.element);const F=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),F.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,u.addDisposableDomListener)(this.screenElement,"mousemove",X=>this.updateCursorStyle(X))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),F.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),H.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(w.CoreBrowserService,this.textarea,re.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(T.ICoreBrowserService,this._coreBrowserService),this.register((0,u.addDisposableDomListener)(this.textarea,"focus",X=>this._handleTextAreaFocus(X))),this.register((0,u.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(_.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(T.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(D.ThemeService),this._instantiationService.setService(T.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(b.CharacterJoinerService),this._instantiationService.setService(T.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(T.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(X=>this._onRender.fire(X))),this.onResize(X=>this._renderService.resize(X.cols,X.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(g.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(T.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(d.Linkifier,this.screenElement)),this.element.appendChild(F);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(v.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(x.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(T.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(X=>this._renderService.handleSelectionChanged(X.start,X.end,X.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(X=>{this.textarea.value=X,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(X=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(m.BufferDecorationRenderer,this.screenElement)),this.register((0,u.addDisposableDomListener)(this.element,"mousedown",X=>this._selectionService.handleMouseDown(X))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(J.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",X=>this._handleScreenReaderModeOptionChange(X))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(p.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",X=>{!this._overviewRulerRenderer&&X&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(p.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(y.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const re=this,F=this.element;function X(le){const ue=re._mouseService.getMouseReportCoords(le,re.screenElement);if(!ue)return!1;let N,Z;switch(le.overrideType||le.type){case"mousemove":Z=32,le.buttons===void 0?(N=3,le.button!==void 0&&(N=le.button<3?le.button:3)):N=1&le.buttons?0:4&le.buttons?1:2&le.buttons?2:3;break;case"mouseup":Z=0,N=le.button<3?le.button:3;break;case"mousedown":Z=1,N=le.button<3?le.button:3;break;case"wheel":if(re._customWheelEventHandler&&re._customWheelEventHandler(le)===!1||re.viewport.getLinesScrolled(le)===0)return!1;Z=le.deltaY<0?0:1,N=4;break;default:return!1}return!(Z===void 0||N===void 0||N>4)&&re.coreMouseService.triggerMouseEvent({col:ue.col,row:ue.row,x:ue.x,y:ue.y,button:N,action:Z,ctrl:le.ctrlKey,alt:le.altKey,shift:le.shiftKey})}const Y={mouseup:null,wheel:null,mousedrag:null,mousemove:null},oe={mouseup:le=>(X(le),le.buttons||(this._document.removeEventListener("mouseup",Y.mouseup),Y.mousedrag&&this._document.removeEventListener("mousemove",Y.mousedrag)),this.cancel(le)),wheel:le=>(X(le),this.cancel(le,!0)),mousedrag:le=>{le.buttons&&X(le)},mousemove:le=>{le.buttons||X(le)}};this.register(this.coreMouseService.onProtocolChange(le=>{le?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(le)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&le?Y.mousemove||(F.addEventListener("mousemove",oe.mousemove),Y.mousemove=oe.mousemove):(F.removeEventListener("mousemove",Y.mousemove),Y.mousemove=null),16&le?Y.wheel||(F.addEventListener("wheel",oe.wheel,{passive:!1}),Y.wheel=oe.wheel):(F.removeEventListener("wheel",Y.wheel),Y.wheel=null),2&le?Y.mouseup||(Y.mouseup=oe.mouseup):(this._document.removeEventListener("mouseup",Y.mouseup),Y.mouseup=null),4&le?Y.mousedrag||(Y.mousedrag=oe.mousedrag):(this._document.removeEventListener("mousemove",Y.mousedrag),Y.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,u.addDisposableDomListener)(F,"mousedown",le=>{if(le.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(le))return X(le),Y.mouseup&&this._document.addEventListener("mouseup",Y.mouseup),Y.mousedrag&&this._document.addEventListener("mousemove",Y.mousedrag),this.cancel(le)})),this.register((0,u.addDisposableDomListener)(F,"wheel",le=>{if(!Y.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(le)===!1)return!1;if(!this.buffer.hasScrollback){const ue=this.viewport.getLinesScrolled(le);if(ue===0)return;const N=V.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(le.deltaY<0?"A":"B");let Z="";for(let ie=0;ie<Math.abs(ue);ie++)Z+=N;return this.coreService.triggerDataEvent(Z,!0),this.cancel(le,!0)}return this.viewport.handleWheel(le)?this.cancel(le):void 0}},{passive:!1})),this.register((0,u.addDisposableDomListener)(F,"touchstart",le=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(le),this.cancel(le)},{passive:!0})),this.register((0,u.addDisposableDomListener)(F,"touchmove",le=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(le)?void 0:this.cancel(le)},{passive:!1}))}refresh(re,F){this._renderService?.refreshRows(re,F)}updateCursorStyle(re){this._selectionService?.shouldColumnSelect(re)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(re,F,X=0){X===1?(super.scrollLines(re,F,X),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(re)}paste(re){(0,c.paste)(re,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(re){this._customKeyEventHandler=re}attachCustomWheelEventHandler(re){this._customWheelEventHandler=re}registerLinkProvider(re){return this._linkProviderService.registerLinkProvider(re)}registerCharacterJoiner(re){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const F=this._characterJoinerService.register(re);return this.refresh(0,this.rows-1),F}deregisterCharacterJoiner(re){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(re)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(re){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+re)}registerDecoration(re){return this._decorationService.registerDecoration(re)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(re,F,X){this._selectionService.setSelection(re,F,X)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(re,F){this._selectionService?.selectLines(re,F)}_keyDown(re){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(re)===!1)return!1;const F=this.browser.isMac&&this.options.macOptionIsMeta&&re.altKey;if(!F&&!this._compositionHelper.keydown(re))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;F||re.key!=="Dead"&&re.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const X=(0,q.evaluateKeyboardEvent)(re,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(re),X.type===3||X.type===2){const Y=this.rows-1;return this.scrollLines(X.type===2?-Y:Y),this.cancel(re,!0)}return X.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,re)||(X.cancel&&this.cancel(re,!0),!X.key||!!(re.key&&!re.ctrlKey&&!re.altKey&&!re.metaKey&&re.key.length===1&&re.key.charCodeAt(0)>=65&&re.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(X.key!==V.C0.ETX&&X.key!==V.C0.CR||(this.textarea.value=""),this._onKey.fire({key:X.key,domEvent:re}),this._showCursor(),this.coreService.triggerDataEvent(X.key,!0),!this.optionsService.rawOptions.screenReaderMode||re.altKey||re.ctrlKey?this.cancel(re,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(re,F){const X=re.isMac&&!this.options.macOptionIsMeta&&F.altKey&&!F.ctrlKey&&!F.metaKey||re.isWindows&&F.altKey&&F.ctrlKey&&!F.metaKey||re.isWindows&&F.getModifierState("AltGraph");return F.type==="keypress"?X:X&&(!F.keyCode||F.keyCode>47)}_keyUp(re){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(re)===!1||(function(F){return F.keyCode===16||F.keyCode===17||F.keyCode===18}(re)||this.focus(),this.updateCursorStyle(re),this._keyPressHandled=!1)}_keyPress(re){let F;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(re)===!1)return!1;if(this.cancel(re),re.charCode)F=re.charCode;else if(re.which===null||re.which===void 0)F=re.keyCode;else{if(re.which===0||re.charCode===0)return!1;F=re.which}return!(!F||(re.altKey||re.ctrlKey||re.metaKey)&&!this._isThirdLevelShift(this.browser,re)||(F=String.fromCharCode(F),this._onKey.fire({key:F,domEvent:re}),this._showCursor(),this.coreService.triggerDataEvent(F,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(re){if(re.data&&re.inputType==="insertText"&&(!re.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const F=re.data;return this.coreService.triggerDataEvent(F,!0),this.cancel(re),!0}return!1}resize(re,F){re!==this.cols||F!==this.rows?super.resize(re,F):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(re,F){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let re=1;re<this.rows;re++)this.buffer.lines.push(this.buffer.getBlankLine(K.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const re=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=re,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(V.C0.ESC+"[I"):this.coreService.triggerDataEvent(V.C0.ESC+"[O")}_reportWindowsOptions(re){if(this._renderService)switch(re){case U.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const F=this._renderService.dimensions.css.canvas.width.toFixed(0),X=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${V.C0.ESC}[4;${X};${F}t`);break;case U.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const Y=this._renderService.dimensions.css.cell.width.toFixed(0),oe=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${V.C0.ESC}[6;${oe};${Y}t`)}}cancel(re,F){if(this.options.cancelEvents||F)return re.preventDefault(),re.stopPropagation(),!1}}a.Terminal=te},9924:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TimeBasedDebouncer=void 0,a.TimeBasedDebouncer=class{constructor(l,c=1e3){this._renderCallback=l,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,c,u){this._rowCount=u,l=l!==void 0?l:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const d=Date.now();if(d-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=d,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=d-this._lastRefreshMs,f=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,c)}}},1680:function(o,a,l){var c=this&&this.__decorate||function(g,y,_,b){var w,E=arguments.length,S=E<3?y:b===null?b=Object.getOwnPropertyDescriptor(y,_):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(g,y,_,b);else for(var x=g.length-1;x>=0;x--)(w=g[x])&&(S=(E<3?w(S):E>3?w(y,_,S):w(y,_))||S);return E>3&&S&&Object.defineProperty(y,_,S),S},u=this&&this.__param||function(g,y){return function(_,b){y(_,b,g)}};Object.defineProperty(a,"__esModule",{value:!0}),a.Viewport=void 0;const d=l(3656),h=l(4725),f=l(8460),v=l(844),m=l(2585);let p=a.Viewport=class extends v.Disposable{constructor(g,y,_,b,w,E,S,x){super(),this._viewportElement=g,this._scrollArea=y,this._bufferService=_,this._optionsService=b,this._charSizeService=w,this._renderService=E,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,d.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(T=>this._activeBuffer=T.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(T=>this._renderDimensions=T)),this._handleThemeChange(x.colors),this.register(x.onChangeColors(T=>this._handleThemeChange(T))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(g){this._viewportElement.style.backgroundColor=g.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(g){if(g)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const y=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==y&&(this._lastRecordedBufferHeight=y,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const g=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==g&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=g),this._refreshAnimationFrame=null}syncScrollArea(g=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(g);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(g)}_handleScroll(g){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const y=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:y,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const g=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(g*(this._smoothScrollState.target-this._smoothScrollState.origin)),g<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(g,y){const _=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(y<0&&this._viewportElement.scrollTop!==0||y>0&&_<this._lastRecordedBufferHeight)||(g.cancelable&&g.preventDefault(),!1)}handleWheel(g){const y=this._getPixelsScrolled(g);return y!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+y:this._smoothScrollState.target+=y,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=y,this._bubbleScroll(g,y))}scrollLines(g){if(g!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const y=g*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+y,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:g,suppressScrollEvent:!1})}_getPixelsScrolled(g){if(g.deltaY===0||g.shiftKey)return 0;let y=this._applyScrollModifier(g.deltaY,g);return g.deltaMode===WheelEvent.DOM_DELTA_LINE?y*=this._currentRowHeight:g.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(y*=this._currentRowHeight*this._bufferService.rows),y}getBufferElements(g,y){let _,b="";const w=[],E=y??this._bufferService.buffer.lines.length,S=this._bufferService.buffer.lines;for(let x=g;x<E;x++){const T=S.get(x);if(!T)continue;const D=S.get(x+1)?.isWrapped;if(b+=T.translateToString(!D),!D||x===S.length-1){const O=document.createElement("div");O.textContent=b,w.push(O),b.length>0&&(_=O),b=""}}return{bufferElements:w,cursorElement:_}}getLinesScrolled(g){if(g.deltaY===0||g.shiftKey)return 0;let y=this._applyScrollModifier(g.deltaY,g);return g.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(y/=this._currentRowHeight+0,this._wheelPartialScroll+=y,y=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):g.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(y*=this._bufferService.rows),y}_applyScrollModifier(g,y){const _=this._optionsService.rawOptions.fastScrollModifier;return _==="alt"&&y.altKey||_==="ctrl"&&y.ctrlKey||_==="shift"&&y.shiftKey?g*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:g*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(g){this._lastTouchY=g.touches[0].pageY}handleTouchMove(g){const y=this._lastTouchY-g.touches[0].pageY;return this._lastTouchY=g.touches[0].pageY,y!==0&&(this._viewportElement.scrollTop+=y,this._bubbleScroll(g,y))}};a.Viewport=p=c([u(2,m.IBufferService),u(3,m.IOptionsService),u(4,h.ICharSizeService),u(5,h.IRenderService),u(6,h.ICoreBrowserService),u(7,h.IThemeService)],p)},3107:function(o,a,l){var c=this&&this.__decorate||function(m,p,g,y){var _,b=arguments.length,w=b<3?p:y===null?y=Object.getOwnPropertyDescriptor(p,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,p,g,y);else for(var E=m.length-1;E>=0;E--)(_=m[E])&&(w=(b<3?_(w):b>3?_(p,g,w):_(p,g))||w);return b>3&&w&&Object.defineProperty(p,g,w),w},u=this&&this.__param||function(m,p){return function(g,y){p(g,y,m)}};Object.defineProperty(a,"__esModule",{value:!0}),a.BufferDecorationRenderer=void 0;const d=l(4725),h=l(844),f=l(2585);let v=a.BufferDecorationRenderer=class extends h.Disposable{constructor(m,p,g,y,_){super(),this._screenElement=m,this._bufferService=p,this._coreBrowserService=g,this._decorationService=y,this._renderService=_,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(b=>this._removeDecoration(b))),this.register((0,h.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const m of this._decorationService.decorations)this._renderDecoration(m);this._dimensionsChanged=!1}_renderDecoration(m){this._refreshStyle(m),this._dimensionsChanged&&this._refreshXPosition(m)}_createElement(m){const p=this._coreBrowserService.mainDocument.createElement("div");p.classList.add("xterm-decoration"),p.classList.toggle("xterm-decoration-top-layer",m?.options?.layer==="top"),p.style.width=`${Math.round((m.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,p.style.height=(m.options.height||1)*this._renderService.dimensions.css.cell.height+"px",p.style.top=(m.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",p.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const g=m.options.x??0;return g&&g>this._bufferService.cols&&(p.style.display="none"),this._refreshXPosition(m,p),p}_refreshStyle(m){const p=m.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)m.element&&(m.element.style.display="none",m.onRenderEmitter.fire(m.element));else{let g=this._decorationElements.get(m);g||(g=this._createElement(m),m.element=g,this._decorationElements.set(m,g),this._container.appendChild(g),m.onDispose(()=>{this._decorationElements.delete(m),g.remove()})),g.style.top=p*this._renderService.dimensions.css.cell.height+"px",g.style.display=this._altBufferIsActive?"none":"block",m.onRenderEmitter.fire(g)}}_refreshXPosition(m,p=m.element){if(!p)return;const g=m.options.x??0;(m.options.anchor||"left")==="right"?p.style.right=g?g*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=g?g*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(m){this._decorationElements.get(m)?.remove(),this._decorationElements.delete(m),m.dispose()}};a.BufferDecorationRenderer=v=c([u(1,f.IBufferService),u(2,d.ICoreBrowserService),u(3,f.IDecorationService),u(4,d.IRenderService)],v)},5871:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorZoneStore=void 0,a.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const c of this._zones)if(c.color===l.options.overviewRulerOptions.color&&c.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,l.marker.line))return;if(this._lineAdjacentToZone(c,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(c,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,c){return c>=l.startBufferLine&&c<=l.endBufferLine}_lineAdjacentToZone(l,c,u){return c>=l.startBufferLine-this._linePadding[u||"full"]&&c<=l.endBufferLine+this._linePadding[u||"full"]}_addLineToZone(l,c){l.startBufferLine=Math.min(l.startBufferLine,c),l.endBufferLine=Math.max(l.endBufferLine,c)}}},5744:function(o,a,l){var c=this&&this.__decorate||function(_,b,w,E){var S,x=arguments.length,T=x<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,w):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(_,b,w,E);else for(var D=_.length-1;D>=0;D--)(S=_[D])&&(T=(x<3?S(T):x>3?S(b,w,T):S(b,w))||T);return x>3&&T&&Object.defineProperty(b,w,T),T},u=this&&this.__param||function(_,b){return function(w,E){b(w,E,_)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OverviewRulerRenderer=void 0;const d=l(5871),h=l(4725),f=l(844),v=l(2585),m={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},g={full:0,left:0,center:0,right:0};let y=a.OverviewRulerRenderer=class extends f.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(_,b,w,E,S,x,T){super(),this._viewportElement=_,this._screenElement=b,this._bufferService=w,this._decorationService=E,this._renderService=S,this._optionsService=x,this._coreBrowserService=T,this._colorZoneStore=new d.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const D=this._canvas.getContext("2d");if(!D)throw new Error("Ctx cannot be null");this._ctx=D,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,f.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const _=Math.floor(this._canvas.width/3),b=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=_,p.center=b,p.right=_,this._refreshDrawHeightConstants(),g.full=0,g.left=0,g.center=p.left,g.right=p.left+p.center}_refreshDrawHeightConstants(){m.full=Math.round(2*this._coreBrowserService.dpr);const _=this._canvas.height/this._bufferService.buffer.lines.length,b=Math.round(Math.max(Math.min(_,12),6)*this._coreBrowserService.dpr);m.left=b,m.center=b,m.right=b}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const b of this._decorationService.decorations)this._colorZoneStore.addDecoration(b);this._ctx.lineWidth=1;const _=this._colorZoneStore.zones;for(const b of _)b.position!=="full"&&this._renderColorZone(b);for(const b of _)b.position==="full"&&this._renderColorZone(b);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(_){this._ctx.fillStyle=_.color,this._ctx.fillRect(g[_.position||"full"],Math.round((this._canvas.height-1)*(_.startBufferLine/this._bufferService.buffers.active.lines.length)-m[_.position||"full"]/2),p[_.position||"full"],Math.round((this._canvas.height-1)*((_.endBufferLine-_.startBufferLine)/this._bufferService.buffers.active.lines.length)+m[_.position||"full"]))}_queueRefresh(_,b){this._shouldUpdateDimensions=_||this._shouldUpdateDimensions,this._shouldUpdateAnchor=b||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};a.OverviewRulerRenderer=y=c([u(2,v.IBufferService),u(3,v.IDecorationService),u(4,h.IRenderService),u(5,v.IOptionsService),u(6,h.ICoreBrowserService)],y)},2950:function(o,a,l){var c=this&&this.__decorate||function(m,p,g,y){var _,b=arguments.length,w=b<3?p:y===null?y=Object.getOwnPropertyDescriptor(p,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,p,g,y);else for(var E=m.length-1;E>=0;E--)(_=m[E])&&(w=(b<3?_(w):b>3?_(p,g,w):_(p,g))||w);return b>3&&w&&Object.defineProperty(p,g,w),w},u=this&&this.__param||function(m,p){return function(g,y){p(g,y,m)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CompositionHelper=void 0;const d=l(4725),h=l(2585),f=l(2584);let v=a.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(m,p,g,y,_,b){this._textarea=m,this._compositionView=p,this._bufferService=g,this._optionsService=y,this._coreService=_,this._renderService=b,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(m){this._compositionView.textContent=m.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(m){if(this._isComposing||this._isSendingComposition){if(m.keyCode===229||m.keyCode===16||m.keyCode===17||m.keyCode===18)return!1;this._finalizeComposition(!1)}return m.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(m){if(this._compositionView.classList.remove("active"),this._isComposing=!1,m){const p={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let g;this._isSendingComposition=!1,p.start+=this._dataAlreadySent.length,g=this._isComposing?this._textarea.value.substring(p.start,p.end):this._textarea.value.substring(p.start),g.length>0&&this._coreService.triggerDataEvent(g,!0)}},0)}else{this._isSendingComposition=!1;const p=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(p,!0)}}_handleAnyTextareaChanges(){const m=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const p=this._textarea.value,g=p.replace(m,"");this._dataAlreadySent=g,p.length>m.length?this._coreService.triggerDataEvent(g,!0):p.length<m.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):p.length===m.length&&p!==m&&this._coreService.triggerDataEvent(p,!0)}},0)}updateCompositionElements(m){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const p=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),g=this._renderService.dimensions.css.cell.height,y=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,_=p*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=_+"px",this._compositionView.style.top=y+"px",this._compositionView.style.height=g+"px",this._compositionView.style.lineHeight=g+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const b=this._compositionView.getBoundingClientRect();this._textarea.style.left=_+"px",this._textarea.style.top=y+"px",this._textarea.style.width=Math.max(b.width,1)+"px",this._textarea.style.height=Math.max(b.height,1)+"px",this._textarea.style.lineHeight=b.height+"px"}m||setTimeout(()=>this.updateCompositionElements(!0),0)}}};a.CompositionHelper=v=c([u(2,h.IBufferService),u(3,h.IOptionsService),u(4,h.ICoreService),u(5,d.IRenderService)],v)},9806:(o,a)=>{function l(c,u,d){const h=d.getBoundingClientRect(),f=c.getComputedStyle(d),v=parseInt(f.getPropertyValue("padding-left")),m=parseInt(f.getPropertyValue("padding-top"));return[u.clientX-h.left-v,u.clientY-h.top-m]}Object.defineProperty(a,"__esModule",{value:!0}),a.getCoords=a.getCoordsRelativeToElement=void 0,a.getCoordsRelativeToElement=l,a.getCoords=function(c,u,d,h,f,v,m,p,g){if(!v)return;const y=l(c,u,d);return y?(y[0]=Math.ceil((y[0]+(g?m/2:0))/m),y[1]=Math.ceil(y[1]/p),y[0]=Math.min(Math.max(y[0],1),h+(g?1:0)),y[1]=Math.min(Math.max(y[1],1),f),y):void 0}},9504:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.moveToCellSequence=void 0;const c=l(2584);function u(p,g,y,_){const b=p-d(p,y),w=g-d(g,y),E=Math.abs(b-w)-function(S,x,T){let D=0;const O=S-d(S,T),R=x-d(x,T);for(let P=0;P<Math.abs(O-R);P++){const A=h(S,x)==="A"?-1:1;T.buffer.lines.get(O+A*P)?.isWrapped&&D++}return D}(p,g,y);return m(E,v(h(p,g),_))}function d(p,g){let y=0,_=g.buffer.lines.get(p),b=_?.isWrapped;for(;b&&p>=0&&p<g.rows;)y++,_=g.buffer.lines.get(--p),b=_?.isWrapped;return y}function h(p,g){return p>g?"A":"B"}function f(p,g,y,_,b,w){let E=p,S=g,x="";for(;E!==y||S!==_;)E+=b?1:-1,b&&E>w.cols-1?(x+=w.buffer.translateBufferLineToString(S,!1,p,E),E=0,p=0,S++):!b&&E<0&&(x+=w.buffer.translateBufferLineToString(S,!1,0,p+1),E=w.cols-1,p=E,S--);return x+w.buffer.translateBufferLineToString(S,!1,p,E)}function v(p,g){const y=g?"O":"[";return c.C0.ESC+y+p}function m(p,g){p=Math.floor(p);let y="";for(let _=0;_<p;_++)y+=g;return y}a.moveToCellSequence=function(p,g,y,_){const b=y.buffer.x,w=y.buffer.y;if(!y.buffer.hasScrollback)return function(x,T,D,O,R,P){return u(T,O,R,P).length===0?"":m(f(x,T,x,T-d(T,R),!1,R).length,v("D",P))}(b,w,0,g,y,_)+u(w,g,y,_)+function(x,T,D,O,R,P){let A;A=u(T,O,R,P).length>0?O-d(O,R):T;const H=O,K=function(V,q,I,$,j,U){let J;return J=u(I,$,j,U).length>0?$-d($,j):q,V<I&&J<=$||V>=I&&J<$?"C":"D"}(x,T,D,O,R,P);return m(f(x,A,D,H,K==="C",R).length,v(K,P))}(b,w,p,g,y,_);let E;if(w===g)return E=b>p?"D":"C",m(Math.abs(b-p),v(E,_));E=w>g?"D":"C";const S=Math.abs(w-g);return m(function(x,T){return T.cols-x}(w>g?p:b,y)+(S-1)*y.cols+1+((w>g?b:p)-1),v(E,_))}},1296:function(o,a,l){var c=this&&this.__decorate||function(P,A,H,K){var V,q=arguments.length,I=q<3?A:K===null?K=Object.getOwnPropertyDescriptor(A,H):K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(P,A,H,K);else for(var $=P.length-1;$>=0;$--)(V=P[$])&&(I=(q<3?V(I):q>3?V(A,H,I):V(A,H))||I);return q>3&&I&&Object.defineProperty(A,H,I),I},u=this&&this.__param||function(P,A){return function(H,K){A(H,K,P)}};Object.defineProperty(a,"__esModule",{value:!0}),a.DomRenderer=void 0;const d=l(3787),h=l(2550),f=l(2223),v=l(6171),m=l(6052),p=l(4725),g=l(8055),y=l(8460),_=l(844),b=l(2585),w="xterm-dom-renderer-owner-",E="xterm-rows",S="xterm-fg-",x="xterm-bg-",T="xterm-focus",D="xterm-selection";let O=1,R=a.DomRenderer=class extends _.Disposable{constructor(P,A,H,K,V,q,I,$,j,U,J,ne,te){super(),this._terminal=P,this._document=A,this._element=H,this._screenElement=K,this._viewportElement=V,this._helperContainer=q,this._linkifier2=I,this._charSizeService=j,this._optionsService=U,this._bufferService=J,this._coreBrowserService=ne,this._themeService=te,this._terminalClass=O++,this._rowElements=[],this._selectionRenderModel=(0,m.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new y.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(E),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(D),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,v.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(me=>this._injectCss(me))),this._injectCss(this._themeService.colors),this._rowFactory=$.createInstance(d.DomRendererRowFactory,document),this._element.classList.add(w+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(me=>this._handleLinkHover(me))),this.register(this._linkifier2.onHideLinkUnderline(me=>this._handleLinkLeave(me))),this.register((0,_.toDisposable)(()=>{this._element.classList.remove(w+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const P=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*P,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*P),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/P),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/P),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const H of this._rowElements)H.style.width=`${this.dimensions.css.canvas.width}px`,H.style.height=`${this.dimensions.css.cell.height}px`,H.style.lineHeight=`${this.dimensions.css.cell.height}px`,H.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const A=`${this._terminalSelector} .${E} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=A,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(P){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let A=`${this._terminalSelector} .${E} { color: ${P.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;A+=`${this._terminalSelector} .${E} .xterm-dim { color: ${g.color.multiplyOpacity(P.foreground,.5).css};}`,A+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const H=`blink_underline_${this._terminalClass}`,K=`blink_bar_${this._terminalClass}`,V=`blink_block_${this._terminalClass}`;A+=`@keyframes ${H} { 50% {  border-bottom-style: hidden; }}`,A+=`@keyframes ${K} { 50% {  box-shadow: none; }}`,A+=`@keyframes ${V} { 0% {  background-color: ${P.cursor.css};  color: ${P.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${P.cursor.css}; }}`,A+=`${this._terminalSelector} .${E}.${T} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${H} 1s step-end infinite;}${this._terminalSelector} .${E}.${T} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${K} 1s step-end infinite;}${this._terminalSelector} .${E}.${T} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${V} 1s step-end infinite;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-block { background-color: ${P.cursor.css}; color: ${P.cursorAccent.css};}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${P.cursor.css} !important; color: ${P.cursorAccent.css} !important;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${P.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${P.cursor.css} inset;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${P.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,A+=`${this._terminalSelector} .${D} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${D} div { position: absolute; background-color: ${P.selectionBackgroundOpaque.css};}${this._terminalSelector} .${D} div { position: absolute; background-color: ${P.selectionInactiveBackgroundOpaque.css};}`;for(const[q,I]of P.ansi.entries())A+=`${this._terminalSelector} .${S}${q} { color: ${I.css}; }${this._terminalSelector} .${S}${q}.xterm-dim { color: ${g.color.multiplyOpacity(I,.5).css}; }${this._terminalSelector} .${x}${q} { background-color: ${I.css}; }`;A+=`${this._terminalSelector} .${S}${f.INVERTED_DEFAULT_COLOR} { color: ${g.color.opaque(P.background).css}; }${this._terminalSelector} .${S}${f.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${g.color.multiplyOpacity(g.color.opaque(P.background),.5).css}; }${this._terminalSelector} .${x}${f.INVERTED_DEFAULT_COLOR} { background-color: ${P.foreground.css}; }`,this._themeStyleElement.textContent=A}_setDefaultSpacing(){const P=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${P}px`,this._rowFactory.defaultSpacing=P}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(P,A){for(let H=this._rowElements.length;H<=A;H++){const K=this._document.createElement("div");this._rowContainer.appendChild(K),this._rowElements.push(K)}for(;this._rowElements.length>A;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(P,A){this._refreshRowElements(P,A),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(T),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(T),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(P,A,H){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(P,A,H),this.renderRows(0,this._bufferService.rows-1),!P||!A)return;this._selectionRenderModel.update(this._terminal,P,A,H);const K=this._selectionRenderModel.viewportStartRow,V=this._selectionRenderModel.viewportEndRow,q=this._selectionRenderModel.viewportCappedStartRow,I=this._selectionRenderModel.viewportCappedEndRow;if(q>=this._bufferService.rows||I<0)return;const $=this._document.createDocumentFragment();if(H){const j=P[0]>A[0];$.appendChild(this._createSelectionElement(q,j?A[0]:P[0],j?P[0]:A[0],I-q+1))}else{const j=K===q?P[0]:0,U=q===V?A[0]:this._bufferService.cols;$.appendChild(this._createSelectionElement(q,j,U));const J=I-q-1;if($.appendChild(this._createSelectionElement(q+1,0,this._bufferService.cols,J)),q!==I){const ne=V===I?A[0]:this._bufferService.cols;$.appendChild(this._createSelectionElement(I,0,ne))}}this._selectionContainer.appendChild($)}_createSelectionElement(P,A,H,K=1){const V=this._document.createElement("div"),q=A*this.dimensions.css.cell.width;let I=this.dimensions.css.cell.width*(H-A);return q+I>this.dimensions.css.canvas.width&&(I=this.dimensions.css.canvas.width-q),V.style.height=K*this.dimensions.css.cell.height+"px",V.style.top=P*this.dimensions.css.cell.height+"px",V.style.left=`${q}px`,V.style.width=`${I}px`,V}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const P of this._rowElements)P.replaceChildren()}renderRows(P,A){const H=this._bufferService.buffer,K=H.ybase+H.y,V=Math.min(H.x,this._bufferService.cols-1),q=this._optionsService.rawOptions.cursorBlink,I=this._optionsService.rawOptions.cursorStyle,$=this._optionsService.rawOptions.cursorInactiveStyle;for(let j=P;j<=A;j++){const U=j+H.ydisp,J=this._rowElements[j],ne=H.lines.get(U);if(!J||!ne)break;J.replaceChildren(...this._rowFactory.createRow(ne,U,U===K,I,$,V,q,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${w}${this._terminalClass}`}_handleLinkHover(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,!0)}_handleLinkLeave(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,!1)}_setCellUnderline(P,A,H,K,V,q){H<0&&(P=0),K<0&&(A=0);const I=this._bufferService.rows-1;H=Math.max(Math.min(H,I),0),K=Math.max(Math.min(K,I),0),V=Math.min(V,this._bufferService.cols);const $=this._bufferService.buffer,j=$.ybase+$.y,U=Math.min($.x,V-1),J=this._optionsService.rawOptions.cursorBlink,ne=this._optionsService.rawOptions.cursorStyle,te=this._optionsService.rawOptions.cursorInactiveStyle;for(let me=H;me<=K;++me){const re=me+$.ydisp,F=this._rowElements[me],X=$.lines.get(re);if(!F||!X)break;F.replaceChildren(...this._rowFactory.createRow(X,re,re===j,ne,te,U,J,this.dimensions.css.cell.width,this._widthCache,q?me===H?P:0:-1,q?(me===K?A:V)-1:-1))}}};a.DomRenderer=R=c([u(7,b.IInstantiationService),u(8,p.ICharSizeService),u(9,b.IOptionsService),u(10,b.IBufferService),u(11,p.ICoreBrowserService),u(12,p.IThemeService)],R)},3787:function(o,a,l){var c=this&&this.__decorate||function(E,S,x,T){var D,O=arguments.length,R=O<3?S:T===null?T=Object.getOwnPropertyDescriptor(S,x):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(E,S,x,T);else for(var P=E.length-1;P>=0;P--)(D=E[P])&&(R=(O<3?D(R):O>3?D(S,x,R):D(S,x))||R);return O>3&&R&&Object.defineProperty(S,x,R),R},u=this&&this.__param||function(E,S){return function(x,T){S(x,T,E)}};Object.defineProperty(a,"__esModule",{value:!0}),a.DomRendererRowFactory=void 0;const d=l(2223),h=l(643),f=l(511),v=l(2585),m=l(8055),p=l(4725),g=l(4269),y=l(6171),_=l(3734);let b=a.DomRendererRowFactory=class{constructor(E,S,x,T,D,O,R){this._document=E,this._characterJoinerService=S,this._optionsService=x,this._coreBrowserService=T,this._coreService=D,this._decorationService=O,this._themeService=R,this._workCell=new f.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(E,S,x){this._selectionStart=E,this._selectionEnd=S,this._columnSelectMode=x}createRow(E,S,x,T,D,O,R,P,A,H,K){const V=[],q=this._characterJoinerService.getJoinedCharacters(S),I=this._themeService.colors;let $,j=E.getNoBgTrimmedLength();x&&j<O+1&&(j=O+1);let U=0,J="",ne=0,te=0,me=0,re=!1,F=0,X=!1,Y=0;const oe=[],le=H!==-1&&K!==-1;for(let ue=0;ue<j;ue++){E.loadCell(ue,this._workCell);let N=this._workCell.getWidth();if(N===0)continue;let Z=!1,ie=ue,W=this._workCell;if(q.length>0&&ue===q[0][0]){Z=!0;const B=q.shift();W=new g.JoinedCellData(this._workCell,E.translateToString(!0,B[0],B[1]),B[1]-B[0]),ie=B[1]-1,N=W.getWidth()}const z=this._isCellInSelection(ue,S),ae=x&&ue===O,ce=le&&ue>=H&&ue<=K;let ge=!1;this._decorationService.forEachDecorationAtCell(ue,S,void 0,B=>{ge=!0});let de=W.getChars()||h.WHITESPACE_CELL_CHAR;if(de===" "&&(W.isUnderline()||W.isOverline())&&(de=" "),Y=N*P-A.get(de,W.isBold(),W.isItalic()),$){if(U&&(z&&X||!z&&!X&&W.bg===ne)&&(z&&X&&I.selectionForeground||W.fg===te)&&W.extended.ext===me&&ce===re&&Y===F&&!ae&&!Z&&!ge){W.isInvisible()?J+=h.WHITESPACE_CELL_CHAR:J+=de,U++;continue}U&&($.textContent=J),$=this._document.createElement("span"),U=0,J=""}else $=this._document.createElement("span");if(ne=W.bg,te=W.fg,me=W.extended.ext,re=ce,F=Y,X=z,Z&&O>=ue&&O<=ie&&(O=ue),!this._coreService.isCursorHidden&&ae&&this._coreService.isCursorInitialized){if(oe.push("xterm-cursor"),this._coreBrowserService.isFocused)R&&oe.push("xterm-cursor-blink"),oe.push(T==="bar"?"xterm-cursor-bar":T==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(D)switch(D){case"outline":oe.push("xterm-cursor-outline");break;case"block":oe.push("xterm-cursor-block");break;case"bar":oe.push("xterm-cursor-bar");break;case"underline":oe.push("xterm-cursor-underline")}}if(W.isBold()&&oe.push("xterm-bold"),W.isItalic()&&oe.push("xterm-italic"),W.isDim()&&oe.push("xterm-dim"),J=W.isInvisible()?h.WHITESPACE_CELL_CHAR:W.getChars()||h.WHITESPACE_CELL_CHAR,W.isUnderline()&&(oe.push(`xterm-underline-${W.extended.underlineStyle}`),J===" "&&(J=" "),!W.isUnderlineColorDefault()))if(W.isUnderlineColorRGB())$.style.textDecorationColor=`rgb(${_.AttributeData.toColorRGB(W.getUnderlineColor()).join(",")})`;else{let B=W.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&W.isBold()&&B<8&&(B+=8),$.style.textDecorationColor=I.ansi[B].css}W.isOverline()&&(oe.push("xterm-overline"),J===" "&&(J=" ")),W.isStrikethrough()&&oe.push("xterm-strikethrough"),ce&&($.style.textDecoration="underline");let fe=W.getFgColor(),we=W.getFgColorMode(),_e=W.getBgColor(),Ae=W.getBgColorMode();const ze=!!W.isInverse();if(ze){const B=fe;fe=_e,_e=B;const Q=we;we=Ae,Ae=Q}let Ne,ft,G,M=!1;switch(this._decorationService.forEachDecorationAtCell(ue,S,void 0,B=>{B.options.layer!=="top"&&M||(B.backgroundColorRGB&&(Ae=50331648,_e=B.backgroundColorRGB.rgba>>8&16777215,Ne=B.backgroundColorRGB),B.foregroundColorRGB&&(we=50331648,fe=B.foregroundColorRGB.rgba>>8&16777215,ft=B.foregroundColorRGB),M=B.options.layer==="top")}),!M&&z&&(Ne=this._coreBrowserService.isFocused?I.selectionBackgroundOpaque:I.selectionInactiveBackgroundOpaque,_e=Ne.rgba>>8&16777215,Ae=50331648,M=!0,I.selectionForeground&&(we=50331648,fe=I.selectionForeground.rgba>>8&16777215,ft=I.selectionForeground)),M&&oe.push("xterm-decoration-top"),Ae){case 16777216:case 33554432:G=I.ansi[_e],oe.push(`xterm-bg-${_e}`);break;case 50331648:G=m.channels.toColor(_e>>16,_e>>8&255,255&_e),this._addStyle($,`background-color:#${w((_e>>>0).toString(16),"0",6)}`);break;default:ze?(G=I.foreground,oe.push(`xterm-bg-${d.INVERTED_DEFAULT_COLOR}`)):G=I.background}switch(Ne||W.isDim()&&(Ne=m.color.multiplyOpacity(G,.5)),we){case 16777216:case 33554432:W.isBold()&&fe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(fe+=8),this._applyMinimumContrast($,G,I.ansi[fe],W,Ne,void 0)||oe.push(`xterm-fg-${fe}`);break;case 50331648:const B=m.channels.toColor(fe>>16&255,fe>>8&255,255&fe);this._applyMinimumContrast($,G,B,W,Ne,ft)||this._addStyle($,`color:#${w(fe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast($,G,I.foreground,W,Ne,ft)||ze&&oe.push(`xterm-fg-${d.INVERTED_DEFAULT_COLOR}`)}oe.length&&($.className=oe.join(" "),oe.length=0),ae||Z||ge?$.textContent=J:U++,Y!==this.defaultSpacing&&($.style.letterSpacing=`${Y}px`),V.push($),ue=ie}return $&&U&&($.textContent=J),V}_applyMinimumContrast(E,S,x,T,D,O){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,y.treatGlyphAsBackgroundColor)(T.getCode()))return!1;const R=this._getContrastCache(T);let P;if(D||O||(P=R.getColor(S.rgba,x.rgba)),P===void 0){const A=this._optionsService.rawOptions.minimumContrastRatio/(T.isDim()?2:1);P=m.color.ensureContrastRatio(D||S,O||x,A),R.setColor((D||S).rgba,(O||x).rgba,P??null)}return!!P&&(this._addStyle(E,`color:${P.css}`),!0)}_getContrastCache(E){return E.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(E,S){E.setAttribute("style",`${E.getAttribute("style")||""}${S};`)}_isCellInSelection(E,S){const x=this._selectionStart,T=this._selectionEnd;return!(!x||!T)&&(this._columnSelectMode?x[0]<=T[0]?E>=x[0]&&S>=x[1]&&E<T[0]&&S<=T[1]:E<x[0]&&S>=x[1]&&E>=T[0]&&S<=T[1]:S>x[1]&&S<T[1]||x[1]===T[1]&&S===x[1]&&E>=x[0]&&E<T[0]||x[1]<T[1]&&S===T[1]&&E<T[0]||x[1]<T[1]&&S===x[1]&&E>=x[0])}};function w(E,S,x){for(;E.length<x;)E=S+E;return E}a.DomRendererRowFactory=b=c([u(1,p.ICharacterJoinerService),u(2,v.IOptionsService),u(3,p.ICoreBrowserService),u(4,v.ICoreService),u(5,v.IDecorationService),u(6,p.IThemeService)],b)},2550:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WidthCache=void 0,a.WidthCache=class{constructor(l,c){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const u=l.createElement("span");u.classList.add("xterm-char-measure-element");const d=l.createElement("span");d.classList.add("xterm-char-measure-element"),d.style.fontWeight="bold";const h=l.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontStyle="italic";const f=l.createElement("span");f.classList.add("xterm-char-measure-element"),f.style.fontWeight="bold",f.style.fontStyle="italic",this._measureElements=[u,d,h,f],this._container.appendChild(u),this._container.appendChild(d),this._container.appendChild(h),this._container.appendChild(f),c.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,c,u,d){l===this._font&&c===this._fontSize&&u===this._weight&&d===this._weightBold||(this._font=l,this._fontSize=c,this._weight=u,this._weightBold=d,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${u}`,this._measureElements[1].style.fontWeight=`${d}`,this._measureElements[2].style.fontWeight=`${u}`,this._measureElements[3].style.fontWeight=`${d}`,this.clear())}get(l,c,u){let d=0;if(!c&&!u&&l.length===1&&(d=l.charCodeAt(0))<256){if(this._flat[d]!==-9999)return this._flat[d];const v=this._measure(l,0);return v>0&&(this._flat[d]=v),v}let h=l;c&&(h+="B"),u&&(h+="I");let f=this._holey.get(h);if(f===void 0){let v=0;c&&(v|=1),u&&(v|=2),f=this._measure(l,v),f>0&&this._holey.set(h,f)}return f}_measure(l,c){const u=this._measureElements[c];return u.textContent=l.repeat(32),u.offsetWidth/32}}},2223:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TEXT_BASELINE=a.DIM_OPACITY=a.INVERTED_DEFAULT_COLOR=void 0;const c=l(6114);a.INVERTED_DEFAULT_COLOR=257,a.DIM_OPACITY=.5,a.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(o,a)=>{function l(u){return 57508<=u&&u<=57558}function c(u){return u>=128512&&u<=128591||u>=127744&&u<=128511||u>=128640&&u<=128767||u>=9728&&u<=9983||u>=9984&&u<=10175||u>=65024&&u<=65039||u>=129280&&u<=129535||u>=127462&&u<=127487}Object.defineProperty(a,"__esModule",{value:!0}),a.computeNextVariantOffset=a.createRenderDimensions=a.treatGlyphAsBackgroundColor=a.allowRescaling=a.isEmoji=a.isRestrictedPowerlineGlyph=a.isPowerlineGlyph=a.throwIfFalsy=void 0,a.throwIfFalsy=function(u){if(!u)throw new Error("value must not be falsy");return u},a.isPowerlineGlyph=l,a.isRestrictedPowerlineGlyph=function(u){return 57520<=u&&u<=57527},a.isEmoji=c,a.allowRescaling=function(u,d,h,f){return d===1&&h>Math.ceil(1.5*f)&&u!==void 0&&u>255&&!c(u)&&!l(u)&&!function(v){return 57344<=v&&v<=63743}(u)},a.treatGlyphAsBackgroundColor=function(u){return l(u)||function(d){return 9472<=d&&d<=9631}(u)},a.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},a.computeNextVariantOffset=function(u,d,h=0){return(u-(2*Math.round(d)-h))%(2*Math.round(d))}},6052:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createSelectionRenderModel=void 0;class l{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(u,d,h,f=!1){if(this.selectionStart=d,this.selectionEnd=h,!d||!h||d[0]===h[0]&&d[1]===h[1])return void this.clear();const v=u.buffers.active.ydisp,m=d[1]-v,p=h[1]-v,g=Math.max(m,0),y=Math.min(p,u.rows-1);g>=u.rows||y<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=f,this.viewportStartRow=m,this.viewportEndRow=p,this.viewportCappedStartRow=g,this.viewportCappedEndRow=y,this.startCol=d[0],this.endCol=h[0])}isCellSelected(u,d,h){return!!this.hasSelection&&(h-=u.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?d>=this.startCol&&h>=this.viewportCappedStartRow&&d<this.endCol&&h<=this.viewportCappedEndRow:d<this.startCol&&h>=this.viewportCappedStartRow&&d>=this.endCol&&h<=this.viewportCappedEndRow:h>this.viewportStartRow&&h<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&h===this.viewportStartRow&&d>=this.startCol&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&h===this.viewportEndRow&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&h===this.viewportStartRow&&d>=this.startCol)}}a.createSelectionRenderModel=function(){return new l}},456:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SelectionModel=void 0,a.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,c=this.selectionEnd;return!(!l||!c)&&(l[1]>c[1]||l[1]===c[1]&&l[0]>c[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(o,a,l){var c=this&&this.__decorate||function(y,_,b,w){var E,S=arguments.length,x=S<3?_:w===null?w=Object.getOwnPropertyDescriptor(_,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,_,b,w);else for(var T=y.length-1;T>=0;T--)(E=y[T])&&(x=(S<3?E(x):S>3?E(_,b,x):E(_,b))||x);return S>3&&x&&Object.defineProperty(_,b,x),x},u=this&&this.__param||function(y,_){return function(b,w){_(b,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CharSizeService=void 0;const d=l(2585),h=l(8460),f=l(844);let v=a.CharSizeService=class extends f.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(y,_,b){super(),this._optionsService=b,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new g(this._optionsService))}catch{this._measureStrategy=this.register(new p(y,_,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const y=this._measureStrategy.measure();y.width===this.width&&y.height===this.height||(this.width=y.width,this.height=y.height,this._onCharSizeChange.fire())}};a.CharSizeService=v=c([u(2,d.IOptionsService)],v);class m extends f.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(_,b){_!==void 0&&_>0&&b!==void 0&&b>0&&(this._result.width=_,this._result.height=b)}}class p extends m{constructor(_,b,w){super(),this._document=_,this._parentElement=b,this._optionsService=w,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class g extends m{constructor(_){super(),this._optionsService=_,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const b=this._ctx.measureText("W");if(!("width"in b&&"fontBoundingBoxAscent"in b&&"fontBoundingBoxDescent"in b))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const _=this._ctx.measureText("W");return this._validateAndSet(_.width,_.fontBoundingBoxAscent+_.fontBoundingBoxDescent),this._result}}},4269:function(o,a,l){var c=this&&this.__decorate||function(g,y,_,b){var w,E=arguments.length,S=E<3?y:b===null?b=Object.getOwnPropertyDescriptor(y,_):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(g,y,_,b);else for(var x=g.length-1;x>=0;x--)(w=g[x])&&(S=(E<3?w(S):E>3?w(y,_,S):w(y,_))||S);return E>3&&S&&Object.defineProperty(y,_,S),S},u=this&&this.__param||function(g,y){return function(_,b){y(_,b,g)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CharacterJoinerService=a.JoinedCellData=void 0;const d=l(3734),h=l(643),f=l(511),v=l(2585);class m extends d.AttributeData{constructor(y,_,b){super(),this.content=0,this.combinedData="",this.fg=y.fg,this.bg=y.bg,this.combinedData=_,this._width=b}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(y){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}a.JoinedCellData=m;let p=a.CharacterJoinerService=class P6{constructor(y){this._bufferService=y,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(y){const _={id:this._nextCharacterJoinerId++,handler:y};return this._characterJoiners.push(_),_.id}deregister(y){for(let _=0;_<this._characterJoiners.length;_++)if(this._characterJoiners[_].id===y)return this._characterJoiners.splice(_,1),!0;return!1}getJoinedCharacters(y){if(this._characterJoiners.length===0)return[];const _=this._bufferService.buffer.lines.get(y);if(!_||_.length===0)return[];const b=[],w=_.translateToString(!0);let E=0,S=0,x=0,T=_.getFg(0),D=_.getBg(0);for(let O=0;O<_.getTrimmedLength();O++)if(_.loadCell(O,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==T||this._workCell.bg!==D){if(O-E>1){const R=this._getJoinedRanges(w,x,S,_,E);for(let P=0;P<R.length;P++)b.push(R[P])}E=O,x=S,T=this._workCell.fg,D=this._workCell.bg}S+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-E>1){const O=this._getJoinedRanges(w,x,S,_,E);for(let R=0;R<O.length;R++)b.push(O[R])}return b}_getJoinedRanges(y,_,b,w,E){const S=y.substring(_,b);let x=[];try{x=this._characterJoiners[0].handler(S)}catch(T){console.error(T)}for(let T=1;T<this._characterJoiners.length;T++)try{const D=this._characterJoiners[T].handler(S);for(let O=0;O<D.length;O++)P6._mergeRanges(x,D[O])}catch(D){console.error(D)}return this._stringRangesToCellRanges(x,w,E),x}_stringRangesToCellRanges(y,_,b){let w=0,E=!1,S=0,x=y[w];if(x){for(let T=b;T<this._bufferService.cols;T++){const D=_.getWidth(T),O=_.getString(T).length||h.WHITESPACE_CELL_CHAR.length;if(D!==0){if(!E&&x[0]<=S&&(x[0]=T,E=!0),x[1]<=S){if(x[1]=T,x=y[++w],!x)break;x[0]<=S?(x[0]=T,E=!0):E=!1}S+=O}}x&&(x[1]=this._bufferService.cols)}}static _mergeRanges(y,_){let b=!1;for(let w=0;w<y.length;w++){const E=y[w];if(b){if(_[1]<=E[0])return y[w-1][1]=_[1],y;if(_[1]<=E[1])return y[w-1][1]=Math.max(_[1],E[1]),y.splice(w,1),y;y.splice(w,1),w--}else{if(_[1]<=E[0])return y.splice(w,0,_),y;if(_[1]<=E[1])return E[0]=Math.min(_[0],E[0]),y;_[0]<E[1]&&(E[0]=Math.min(_[0],E[0]),b=!0)}}return b?y[y.length-1][1]=_[1]:y.push(_),y}};a.CharacterJoinerService=p=c([u(0,v.IBufferService)],p)},5114:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoreBrowserService=void 0;const c=l(844),u=l(8460),d=l(3656);class h extends c.Disposable{constructor(m,p,g){super(),this._textarea=m,this._window=p,this.mainDocument=g,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new f(this._window),this._onDprChange=this.register(new u.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new u.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(y=>this._screenDprMonitor.setWindow(y))),this.register((0,u.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(m){this._window!==m&&(this._window=m,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}a.CoreBrowserService=h;class f extends c.Disposable{constructor(m){super(),this._parentWindow=m,this._windowResizeListener=this.register(new c.MutableDisposable),this._onDprChange=this.register(new u.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,c.toDisposable)(()=>this.clearListener()))}setWindow(m){this._parentWindow=m,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,d.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.LinkProviderService=void 0;const c=l(844);class u extends c.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,c.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(h){return this.linkProviders.push(h),{dispose:()=>{const f=this.linkProviders.indexOf(h);f!==-1&&this.linkProviders.splice(f,1)}}}}a.LinkProviderService=u},8934:function(o,a,l){var c=this&&this.__decorate||function(v,m,p,g){var y,_=arguments.length,b=_<3?m:g===null?g=Object.getOwnPropertyDescriptor(m,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(v,m,p,g);else for(var w=v.length-1;w>=0;w--)(y=v[w])&&(b=(_<3?y(b):_>3?y(m,p,b):y(m,p))||b);return _>3&&b&&Object.defineProperty(m,p,b),b},u=this&&this.__param||function(v,m){return function(p,g){m(p,g,v)}};Object.defineProperty(a,"__esModule",{value:!0}),a.MouseService=void 0;const d=l(4725),h=l(9806);let f=a.MouseService=class{constructor(v,m){this._renderService=v,this._charSizeService=m}getCoords(v,m,p,g,y){return(0,h.getCoords)(window,v,m,p,g,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,y)}getMouseReportCoords(v,m){const p=(0,h.getCoordsRelativeToElement)(window,v,m);if(this._charSizeService.hasValidSize)return p[0]=Math.min(Math.max(p[0],0),this._renderService.dimensions.css.canvas.width-1),p[1]=Math.min(Math.max(p[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(p[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(p[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(p[0]),y:Math.floor(p[1])}}};a.MouseService=f=c([u(0,d.IRenderService),u(1,d.ICharSizeService)],f)},3230:function(o,a,l){var c=this&&this.__decorate||function(y,_,b,w){var E,S=arguments.length,x=S<3?_:w===null?w=Object.getOwnPropertyDescriptor(_,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,_,b,w);else for(var T=y.length-1;T>=0;T--)(E=y[T])&&(x=(S<3?E(x):S>3?E(_,b,x):E(_,b))||x);return S>3&&x&&Object.defineProperty(_,b,x),x},u=this&&this.__param||function(y,_){return function(b,w){_(b,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.RenderService=void 0;const d=l(6193),h=l(4725),f=l(8460),v=l(844),m=l(7226),p=l(2585);let g=a.RenderService=class extends v.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(y,_,b,w,E,S,x,T){super(),this._rowCount=y,this._charSizeService=w,this._renderer=this.register(new v.MutableDisposable),this._pausedResizeTask=new m.DebouncedIdleTask,this._observerDisposable=this.register(new v.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new f.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new f.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new f.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new d.RenderDebouncer((D,O)=>this._renderRows(D,O),x),this.register(this._renderDebouncer),this.register(x.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(S.onResize(()=>this._fullRefresh())),this.register(S.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(b.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(E.onDecorationRegistered(()=>this._fullRefresh())),this.register(E.onDecorationRemoved(()=>this._fullRefresh())),this.register(b.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(S.cols,S.rows),this._fullRefresh()})),this.register(b.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(S.buffer.y,S.buffer.y,!0))),this.register(T.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(x.window,_),this.register(x.onWindowChange(D=>this._registerIntersectionObserver(D,_)))}_registerIntersectionObserver(y,_){if("IntersectionObserver"in y){const b=new y.IntersectionObserver(w=>this._handleIntersectionChange(w[w.length-1]),{threshold:0});b.observe(_),this._observerDisposable.value=(0,v.toDisposable)(()=>b.disconnect())}}_handleIntersectionChange(y){this._isPaused=y.isIntersecting===void 0?y.intersectionRatio===0:!y.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(y,_,b=!1){this._isPaused?this._needsFullRefresh=!0:(b||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(y,_,this._rowCount))}_renderRows(y,_){this._renderer.value&&(y=Math.min(y,this._rowCount-1),_=Math.min(_,this._rowCount-1),this._renderer.value.renderRows(y,_),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:y,end:_}),this._onRender.fire({start:y,end:_}),this._isNextRenderRedrawOnly=!0)}resize(y,_){this._rowCount=_,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(y){this._renderer.value=y,this._renderer.value&&(this._renderer.value.onRequestRedraw(_=>this.refreshRows(_.start,_.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(y){return this._renderDebouncer.addRefreshCallback(y)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(y,_){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(y,_)):this._renderer.value.handleResize(y,_),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(y,_,b){this._selectionState.start=y,this._selectionState.end=_,this._selectionState.columnSelectMode=b,this._renderer.value?.handleSelectionChanged(y,_,b)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};a.RenderService=g=c([u(2,p.IOptionsService),u(3,h.ICharSizeService),u(4,p.IDecorationService),u(5,p.IBufferService),u(6,h.ICoreBrowserService),u(7,h.IThemeService)],g)},9312:function(o,a,l){var c=this&&this.__decorate||function(x,T,D,O){var R,P=arguments.length,A=P<3?T:O===null?O=Object.getOwnPropertyDescriptor(T,D):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(x,T,D,O);else for(var H=x.length-1;H>=0;H--)(R=x[H])&&(A=(P<3?R(A):P>3?R(T,D,A):R(T,D))||A);return P>3&&A&&Object.defineProperty(T,D,A),A},u=this&&this.__param||function(x,T){return function(D,O){T(D,O,x)}};Object.defineProperty(a,"__esModule",{value:!0}),a.SelectionService=void 0;const d=l(9806),h=l(9504),f=l(456),v=l(4725),m=l(8460),p=l(844),g=l(6114),y=l(4841),_=l(511),b=l(2585),w=" ",E=new RegExp(w,"g");let S=a.SelectionService=class extends p.Disposable{constructor(x,T,D,O,R,P,A,H,K){super(),this._element=x,this._screenElement=T,this._linkifier=D,this._bufferService=O,this._coreService=R,this._mouseService=P,this._optionsService=A,this._renderService=H,this._coreBrowserService=K,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new _.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new m.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new m.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new m.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=V=>this._handleMouseMove(V),this._mouseUpListener=V=>this._handleMouseUp(V),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(V=>this._handleTrim(V)),this.register(this._bufferService.buffers.onBufferActivate(V=>this._handleBufferActivate(V))),this.enable(),this._model=new f.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,p.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const x=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!x||!T||x[0]===T[0]&&x[1]===T[1])}get selectionText(){const x=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;if(!x||!T)return"";const D=this._bufferService.buffer,O=[];if(this._activeSelectionMode===3){if(x[0]===T[0])return"";const R=x[0]<T[0]?x[0]:T[0],P=x[0]<T[0]?T[0]:x[0];for(let A=x[1];A<=T[1];A++){const H=D.translateBufferLineToString(A,!0,R,P);O.push(H)}}else{const R=x[1]===T[1]?T[0]:void 0;O.push(D.translateBufferLineToString(x[1],!0,x[0],R));for(let P=x[1]+1;P<=T[1]-1;P++){const A=D.lines.get(P),H=D.translateBufferLineToString(P,!0);A?.isWrapped?O[O.length-1]+=H:O.push(H)}if(x[1]!==T[1]){const P=D.lines.get(T[1]),A=D.translateBufferLineToString(T[1],!0,0,T[0]);P&&P.isWrapped?O[O.length-1]+=A:O.push(A)}}return O.map(R=>R.replace(E," ")).join(g.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(x){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),g.isLinux&&x&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(x){const T=this._getMouseBufferCoords(x),D=this._model.finalSelectionStart,O=this._model.finalSelectionEnd;return!!(D&&O&&T)&&this._areCoordsInSelection(T,D,O)}isCellInSelection(x,T){const D=this._model.finalSelectionStart,O=this._model.finalSelectionEnd;return!(!D||!O)&&this._areCoordsInSelection([x,T],D,O)}_areCoordsInSelection(x,T,D){return x[1]>T[1]&&x[1]<D[1]||T[1]===D[1]&&x[1]===T[1]&&x[0]>=T[0]&&x[0]<D[0]||T[1]<D[1]&&x[1]===D[1]&&x[0]<D[0]||T[1]<D[1]&&x[1]===T[1]&&x[0]>=T[0]}_selectWordAtCursor(x,T){const D=this._linkifier.currentLink?.link?.range;if(D)return this._model.selectionStart=[D.start.x-1,D.start.y-1],this._model.selectionStartLength=(0,y.getRangeLength)(D,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const O=this._getMouseBufferCoords(x);return!!O&&(this._selectWordAt(O,T),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(x,T){this._model.clearSelection(),x=Math.max(x,0),T=Math.min(T,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,x],this._model.selectionEnd=[this._bufferService.cols,T],this.refresh(),this._onSelectionChange.fire()}_handleTrim(x){this._model.handleTrim(x)&&this.refresh()}_getMouseBufferCoords(x){const T=this._mouseService.getCoords(x,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(T)return T[0]--,T[1]--,T[1]+=this._bufferService.buffer.ydisp,T}_getMouseEventScrollAmount(x){let T=(0,d.getCoordsRelativeToElement)(this._coreBrowserService.window,x,this._screenElement)[1];const D=this._renderService.dimensions.css.canvas.height;return T>=0&&T<=D?0:(T>D&&(T-=D),T=Math.min(Math.max(T,-50),50),T/=50,T/Math.abs(T)+Math.round(14*T))}shouldForceSelection(x){return g.isMac?x.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:x.shiftKey}handleMouseDown(x){if(this._mouseDownTimeStamp=x.timeStamp,(x.button!==2||!this.hasSelection)&&x.button===0){if(!this._enabled){if(!this.shouldForceSelection(x))return;x.stopPropagation()}x.preventDefault(),this._dragScrollAmount=0,this._enabled&&x.shiftKey?this._handleIncrementalClick(x):x.detail===1?this._handleSingleClick(x):x.detail===2?this._handleDoubleClick(x):x.detail===3&&this._handleTripleClick(x),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(x){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(x))}_handleSingleClick(x){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(x)?3:0,this._model.selectionStart=this._getMouseBufferCoords(x),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const T=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);T&&T.length!==this._model.selectionStart[0]&&T.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(x){this._selectWordAtCursor(x,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(x){const T=this._getMouseBufferCoords(x);T&&(this._activeSelectionMode=2,this._selectLineAt(T[1]))}shouldColumnSelect(x){return x.altKey&&!(g.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(x){if(x.stopImmediatePropagation(),!this._model.selectionStart)return;const T=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(x),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(x),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const D=this._bufferService.buffer;if(this._model.selectionEnd[1]<D.lines.length){const O=D.lines.get(this._model.selectionEnd[1]);O&&O.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}T&&T[0]===this._model.selectionEnd[0]&&T[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const x=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(x.ydisp+this._bufferService.rows,x.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=x.ydisp),this.refresh()}}_handleMouseUp(x){const T=x.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&T<500&&x.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const D=this._mouseService.getCoords(x,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(D&&D[0]!==void 0&&D[1]!==void 0){const O=(0,h.moveToCellSequence)(D[0]-1,D[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(O,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const x=this._model.finalSelectionStart,T=this._model.finalSelectionEnd,D=!(!x||!T||x[0]===T[0]&&x[1]===T[1]);D?x&&T&&(this._oldSelectionStart&&this._oldSelectionEnd&&x[0]===this._oldSelectionStart[0]&&x[1]===this._oldSelectionStart[1]&&T[0]===this._oldSelectionEnd[0]&&T[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(x,T,D)):this._oldHasSelection&&this._fireOnSelectionChange(x,T,D)}_fireOnSelectionChange(x,T,D){this._oldSelectionStart=x,this._oldSelectionEnd=T,this._oldHasSelection=D,this._onSelectionChange.fire()}_handleBufferActivate(x){this.clearSelection(),this._trimListener.dispose(),this._trimListener=x.activeBuffer.lines.onTrim(T=>this._handleTrim(T))}_convertViewportColToCharacterIndex(x,T){let D=T;for(let O=0;T>=O;O++){const R=x.loadCell(O,this._workCell).getChars().length;this._workCell.getWidth()===0?D--:R>1&&T!==O&&(D+=R-1)}return D}setSelection(x,T,D){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[x,T],this._model.selectionStartLength=D,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(x){this._isClickInSelection(x)||(this._selectWordAtCursor(x,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(x,T,D=!0,O=!0){if(x[0]>=this._bufferService.cols)return;const R=this._bufferService.buffer,P=R.lines.get(x[1]);if(!P)return;const A=R.translateBufferLineToString(x[1],!1);let H=this._convertViewportColToCharacterIndex(P,x[0]),K=H;const V=x[0]-H;let q=0,I=0,$=0,j=0;if(A.charAt(H)===" "){for(;H>0&&A.charAt(H-1)===" ";)H--;for(;K<A.length&&A.charAt(K+1)===" ";)K++}else{let ne=x[0],te=x[0];P.getWidth(ne)===0&&(q++,ne--),P.getWidth(te)===2&&(I++,te++);const me=P.getString(te).length;for(me>1&&(j+=me-1,K+=me-1);ne>0&&H>0&&!this._isCharWordSeparator(P.loadCell(ne-1,this._workCell));){P.loadCell(ne-1,this._workCell);const re=this._workCell.getChars().length;this._workCell.getWidth()===0?(q++,ne--):re>1&&($+=re-1,H-=re-1),H--,ne--}for(;te<P.length&&K+1<A.length&&!this._isCharWordSeparator(P.loadCell(te+1,this._workCell));){P.loadCell(te+1,this._workCell);const re=this._workCell.getChars().length;this._workCell.getWidth()===2?(I++,te++):re>1&&(j+=re-1,K+=re-1),K++,te++}}K++;let U=H+V-q+$,J=Math.min(this._bufferService.cols,K-H+q+I-$-j);if(T||A.slice(H,K).trim()!==""){if(D&&U===0&&P.getCodePoint(0)!==32){const ne=R.lines.get(x[1]-1);if(ne&&P.isWrapped&&ne.getCodePoint(this._bufferService.cols-1)!==32){const te=this._getWordAt([this._bufferService.cols-1,x[1]-1],!1,!0,!1);if(te){const me=this._bufferService.cols-te.start;U-=me,J+=me}}}if(O&&U+J===this._bufferService.cols&&P.getCodePoint(this._bufferService.cols-1)!==32){const ne=R.lines.get(x[1]+1);if(ne?.isWrapped&&ne.getCodePoint(0)!==32){const te=this._getWordAt([0,x[1]+1],!1,!1,!0);te&&(J+=te.length)}}return{start:U,length:J}}}_selectWordAt(x,T){const D=this._getWordAt(x,T);if(D){for(;D.start<0;)D.start+=this._bufferService.cols,x[1]--;this._model.selectionStart=[D.start,x[1]],this._model.selectionStartLength=D.length}}_selectToWordAt(x){const T=this._getWordAt(x,!0);if(T){let D=x[1];for(;T.start<0;)T.start+=this._bufferService.cols,D--;if(!this._model.areSelectionValuesReversed())for(;T.start+T.length>this._bufferService.cols;)T.length-=this._bufferService.cols,D++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?T.start:T.start+T.length,D]}}_isCharWordSeparator(x){return x.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(x.getChars())>=0}_selectLineAt(x){const T=this._bufferService.buffer.getWrappedRangeForLine(x),D={start:{x:0,y:T.first},end:{x:this._bufferService.cols-1,y:T.last}};this._model.selectionStart=[0,T.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,y.getRangeLength)(D,this._bufferService.cols)}};a.SelectionService=S=c([u(3,b.IBufferService),u(4,b.ICoreService),u(5,v.IMouseService),u(6,b.IOptionsService),u(7,v.IRenderService),u(8,v.ICoreBrowserService)],S)},4725:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ILinkProviderService=a.IThemeService=a.ICharacterJoinerService=a.ISelectionService=a.IRenderService=a.IMouseService=a.ICoreBrowserService=a.ICharSizeService=void 0;const c=l(8343);a.ICharSizeService=(0,c.createDecorator)("CharSizeService"),a.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),a.IMouseService=(0,c.createDecorator)("MouseService"),a.IRenderService=(0,c.createDecorator)("RenderService"),a.ISelectionService=(0,c.createDecorator)("SelectionService"),a.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),a.IThemeService=(0,c.createDecorator)("ThemeService"),a.ILinkProviderService=(0,c.createDecorator)("LinkProviderService")},6731:function(o,a,l){var c=this&&this.__decorate||function(S,x,T,D){var O,R=arguments.length,P=R<3?x:D===null?D=Object.getOwnPropertyDescriptor(x,T):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(S,x,T,D);else for(var A=S.length-1;A>=0;A--)(O=S[A])&&(P=(R<3?O(P):R>3?O(x,T,P):O(x,T))||P);return R>3&&P&&Object.defineProperty(x,T,P),P},u=this&&this.__param||function(S,x){return function(T,D){x(T,D,S)}};Object.defineProperty(a,"__esModule",{value:!0}),a.ThemeService=a.DEFAULT_ANSI_COLORS=void 0;const d=l(7239),h=l(8055),f=l(8460),v=l(844),m=l(2585),p=h.css.toColor("#ffffff"),g=h.css.toColor("#000000"),y=h.css.toColor("#ffffff"),_=h.css.toColor("#000000"),b={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};a.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const S=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],x=[0,95,135,175,215,255];for(let T=0;T<216;T++){const D=x[T/36%6|0],O=x[T/6%6|0],R=x[T%6];S.push({css:h.channels.toCss(D,O,R),rgba:h.channels.toRgba(D,O,R)})}for(let T=0;T<24;T++){const D=8+10*T;S.push({css:h.channels.toCss(D,D,D),rgba:h.channels.toRgba(D,D,D)})}return S})());let w=a.ThemeService=class extends v.Disposable{get colors(){return this._colors}constructor(S){super(),this._optionsService=S,this._contrastCache=new d.ColorContrastCache,this._halfContrastCache=new d.ColorContrastCache,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:p,background:g,cursor:y,cursorAccent:_,selectionForeground:void 0,selectionBackgroundTransparent:b,selectionBackgroundOpaque:h.color.blend(g,b),selectionInactiveBackgroundTransparent:b,selectionInactiveBackgroundOpaque:h.color.blend(g,b),ansi:a.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(S={}){const x=this._colors;if(x.foreground=E(S.foreground,p),x.background=E(S.background,g),x.cursor=E(S.cursor,y),x.cursorAccent=E(S.cursorAccent,_),x.selectionBackgroundTransparent=E(S.selectionBackground,b),x.selectionBackgroundOpaque=h.color.blend(x.background,x.selectionBackgroundTransparent),x.selectionInactiveBackgroundTransparent=E(S.selectionInactiveBackground,x.selectionBackgroundTransparent),x.selectionInactiveBackgroundOpaque=h.color.blend(x.background,x.selectionInactiveBackgroundTransparent),x.selectionForeground=S.selectionForeground?E(S.selectionForeground,h.NULL_COLOR):void 0,x.selectionForeground===h.NULL_COLOR&&(x.selectionForeground=void 0),h.color.isOpaque(x.selectionBackgroundTransparent)&&(x.selectionBackgroundTransparent=h.color.opacity(x.selectionBackgroundTransparent,.3)),h.color.isOpaque(x.selectionInactiveBackgroundTransparent)&&(x.selectionInactiveBackgroundTransparent=h.color.opacity(x.selectionInactiveBackgroundTransparent,.3)),x.ansi=a.DEFAULT_ANSI_COLORS.slice(),x.ansi[0]=E(S.black,a.DEFAULT_ANSI_COLORS[0]),x.ansi[1]=E(S.red,a.DEFAULT_ANSI_COLORS[1]),x.ansi[2]=E(S.green,a.DEFAULT_ANSI_COLORS[2]),x.ansi[3]=E(S.yellow,a.DEFAULT_ANSI_COLORS[3]),x.ansi[4]=E(S.blue,a.DEFAULT_ANSI_COLORS[4]),x.ansi[5]=E(S.magenta,a.DEFAULT_ANSI_COLORS[5]),x.ansi[6]=E(S.cyan,a.DEFAULT_ANSI_COLORS[6]),x.ansi[7]=E(S.white,a.DEFAULT_ANSI_COLORS[7]),x.ansi[8]=E(S.brightBlack,a.DEFAULT_ANSI_COLORS[8]),x.ansi[9]=E(S.brightRed,a.DEFAULT_ANSI_COLORS[9]),x.ansi[10]=E(S.brightGreen,a.DEFAULT_ANSI_COLORS[10]),x.ansi[11]=E(S.brightYellow,a.DEFAULT_ANSI_COLORS[11]),x.ansi[12]=E(S.brightBlue,a.DEFAULT_ANSI_COLORS[12]),x.ansi[13]=E(S.brightMagenta,a.DEFAULT_ANSI_COLORS[13]),x.ansi[14]=E(S.brightCyan,a.DEFAULT_ANSI_COLORS[14]),x.ansi[15]=E(S.brightWhite,a.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){const T=Math.min(x.ansi.length-16,S.extendedAnsi.length);for(let D=0;D<T;D++)x.ansi[D+16]=E(S.extendedAnsi[D],a.DEFAULT_ANSI_COLORS[D+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let x=0;x<this._restoreColors.ansi.length;++x)this._colors.ansi[x]=this._restoreColors.ansi[x]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function E(S,x){if(S!==void 0)try{return h.css.toColor(S)}catch{}return x}a.ThemeService=w=c([u(0,m.IOptionsService)],w)},6349:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CircularList=void 0;const c=l(8460),u=l(844);class d extends u.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;const v=new Array(f);for(let m=0;m<Math.min(f,this.length);m++)v[m]=this._array[this._getCyclicIndex(m)];this._array=v,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let v=this._length;v<f;v++)this._array[v]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,v){this._array[this._getCyclicIndex(f)]=v}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,v,...m){if(v){for(let p=f;p<this._length-v;p++)this._array[this._getCyclicIndex(p)]=this._array[this._getCyclicIndex(p+v)];this._length-=v,this.onDeleteEmitter.fire({index:f,amount:v})}for(let p=this._length-1;p>=f;p--)this._array[this._getCyclicIndex(p+m.length)]=this._array[this._getCyclicIndex(p)];for(let p=0;p<m.length;p++)this._array[this._getCyclicIndex(f+p)]=m[p];if(m.length&&this.onInsertEmitter.fire({index:f,amount:m.length}),this._length+m.length>this._maxLength){const p=this._length+m.length-this._maxLength;this._startIndex+=p,this._length=this._maxLength,this.onTrimEmitter.fire(p)}else this._length+=m.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,v,m){if(!(v<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+m<0)throw new Error("Cannot shift elements in list beyond index 0");if(m>0){for(let g=v-1;g>=0;g--)this.set(f+g+m,this.get(f+g));const p=f+v+m-this._length;if(p>0)for(this._length+=p;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let p=0;p<v;p++)this.set(f+p+m,this.get(f+p))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}a.CircularList=d},1439:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.clone=void 0,a.clone=function l(c,u=5){if(typeof c!="object")return c;const d=Array.isArray(c)?[]:{};for(const h in c)d[h]=u<=1?c[h]:c[h]&&l(c[h],u-1);return d}},8055:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.contrastRatio=a.toPaddedHex=a.rgba=a.rgb=a.css=a.color=a.channels=a.NULL_COLOR=void 0;let l=0,c=0,u=0,d=0;var h,f,v,m,p;function g(_){const b=_.toString(16);return b.length<2?"0"+b:b}function y(_,b){return _<b?(b+.05)/(_+.05):(_+.05)/(b+.05)}a.NULL_COLOR={css:"#00000000",rgba:0},function(_){_.toCss=function(b,w,E,S){return S!==void 0?`#${g(b)}${g(w)}${g(E)}${g(S)}`:`#${g(b)}${g(w)}${g(E)}`},_.toRgba=function(b,w,E,S=255){return(b<<24|w<<16|E<<8|S)>>>0},_.toColor=function(b,w,E,S){return{css:_.toCss(b,w,E,S),rgba:_.toRgba(b,w,E,S)}}}(h||(a.channels=h={})),function(_){function b(w,E){return d=Math.round(255*E),[l,c,u]=p.toChannels(w.rgba),{css:h.toCss(l,c,u,d),rgba:h.toRgba(l,c,u,d)}}_.blend=function(w,E){if(d=(255&E.rgba)/255,d===1)return{css:E.css,rgba:E.rgba};const S=E.rgba>>24&255,x=E.rgba>>16&255,T=E.rgba>>8&255,D=w.rgba>>24&255,O=w.rgba>>16&255,R=w.rgba>>8&255;return l=D+Math.round((S-D)*d),c=O+Math.round((x-O)*d),u=R+Math.round((T-R)*d),{css:h.toCss(l,c,u),rgba:h.toRgba(l,c,u)}},_.isOpaque=function(w){return(255&w.rgba)==255},_.ensureContrastRatio=function(w,E,S){const x=p.ensureContrastRatio(w.rgba,E.rgba,S);if(x)return h.toColor(x>>24&255,x>>16&255,x>>8&255)},_.opaque=function(w){const E=(255|w.rgba)>>>0;return[l,c,u]=p.toChannels(E),{css:h.toCss(l,c,u),rgba:E}},_.opacity=b,_.multiplyOpacity=function(w,E){return d=255&w.rgba,b(w,d*E/255)},_.toColorRGB=function(w){return[w.rgba>>24&255,w.rgba>>16&255,w.rgba>>8&255]}}(f||(a.color=f={})),function(_){let b,w;try{const E=document.createElement("canvas");E.width=1,E.height=1;const S=E.getContext("2d",{willReadFrequently:!0});S&&(b=S,b.globalCompositeOperation="copy",w=b.createLinearGradient(0,0,1,1))}catch{}_.toColor=function(E){if(E.match(/#[\da-f]{3,8}/i))switch(E.length){case 4:return l=parseInt(E.slice(1,2).repeat(2),16),c=parseInt(E.slice(2,3).repeat(2),16),u=parseInt(E.slice(3,4).repeat(2),16),h.toColor(l,c,u);case 5:return l=parseInt(E.slice(1,2).repeat(2),16),c=parseInt(E.slice(2,3).repeat(2),16),u=parseInt(E.slice(3,4).repeat(2),16),d=parseInt(E.slice(4,5).repeat(2),16),h.toColor(l,c,u,d);case 7:return{css:E,rgba:(parseInt(E.slice(1),16)<<8|255)>>>0};case 9:return{css:E,rgba:parseInt(E.slice(1),16)>>>0}}const S=E.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return l=parseInt(S[1]),c=parseInt(S[2]),u=parseInt(S[3]),d=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),h.toColor(l,c,u,d);if(!b||!w)throw new Error("css.toColor: Unsupported css format");if(b.fillStyle=w,b.fillStyle=E,typeof b.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(b.fillRect(0,0,1,1),[l,c,u,d]=b.getImageData(0,0,1,1).data,d!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:h.toRgba(l,c,u,d),css:E}}}(v||(a.css=v={})),function(_){function b(w,E,S){const x=w/255,T=E/255,D=S/255;return .2126*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(D<=.03928?D/12.92:Math.pow((D+.055)/1.055,2.4))}_.relativeLuminance=function(w){return b(w>>16&255,w>>8&255,255&w)},_.relativeLuminance2=b}(m||(a.rgb=m={})),function(_){function b(E,S,x){const T=E>>24&255,D=E>>16&255,O=E>>8&255;let R=S>>24&255,P=S>>16&255,A=S>>8&255,H=y(m.relativeLuminance2(R,P,A),m.relativeLuminance2(T,D,O));for(;H<x&&(R>0||P>0||A>0);)R-=Math.max(0,Math.ceil(.1*R)),P-=Math.max(0,Math.ceil(.1*P)),A-=Math.max(0,Math.ceil(.1*A)),H=y(m.relativeLuminance2(R,P,A),m.relativeLuminance2(T,D,O));return(R<<24|P<<16|A<<8|255)>>>0}function w(E,S,x){const T=E>>24&255,D=E>>16&255,O=E>>8&255;let R=S>>24&255,P=S>>16&255,A=S>>8&255,H=y(m.relativeLuminance2(R,P,A),m.relativeLuminance2(T,D,O));for(;H<x&&(R<255||P<255||A<255);)R=Math.min(255,R+Math.ceil(.1*(255-R))),P=Math.min(255,P+Math.ceil(.1*(255-P))),A=Math.min(255,A+Math.ceil(.1*(255-A))),H=y(m.relativeLuminance2(R,P,A),m.relativeLuminance2(T,D,O));return(R<<24|P<<16|A<<8|255)>>>0}_.blend=function(E,S){if(d=(255&S)/255,d===1)return S;const x=S>>24&255,T=S>>16&255,D=S>>8&255,O=E>>24&255,R=E>>16&255,P=E>>8&255;return l=O+Math.round((x-O)*d),c=R+Math.round((T-R)*d),u=P+Math.round((D-P)*d),h.toRgba(l,c,u)},_.ensureContrastRatio=function(E,S,x){const T=m.relativeLuminance(E>>8),D=m.relativeLuminance(S>>8);if(y(T,D)<x){if(D<T){const P=b(E,S,x),A=y(T,m.relativeLuminance(P>>8));if(A<x){const H=w(E,S,x);return A>y(T,m.relativeLuminance(H>>8))?P:H}return P}const O=w(E,S,x),R=y(T,m.relativeLuminance(O>>8));if(R<x){const P=b(E,S,x);return R>y(T,m.relativeLuminance(P>>8))?O:P}return O}},_.reduceLuminance=b,_.increaseLuminance=w,_.toChannels=function(E){return[E>>24&255,E>>16&255,E>>8&255,255&E]}}(p||(a.rgba=p={})),a.toPaddedHex=g,a.contrastRatio=y},8969:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoreTerminal=void 0;const c=l(844),u=l(2585),d=l(4348),h=l(7866),f=l(744),v=l(7302),m=l(6975),p=l(8460),g=l(1753),y=l(1480),_=l(7994),b=l(9282),w=l(5435),E=l(5981),S=l(2660);let x=!1;class T extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new p.EventEmitter),this._onScroll.event(O=>{this._onScrollApi?.fire(O.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(O){for(const R in O)this.optionsService.options[R]=O[R]}constructor(O){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new p.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new p.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new p.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new p.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new p.EventEmitter),this._instantiationService=new d.InstantiationService,this.optionsService=this.register(new v.OptionsService(O)),this._instantiationService.setService(u.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(u.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(u.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(m.CoreService)),this._instantiationService.setService(u.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(g.CoreMouseService)),this._instantiationService.setService(u.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(y.UnicodeService)),this._instantiationService.setService(u.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(_.CharsetService),this._instantiationService.setService(u.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(u.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new w.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,p.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,p.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,p.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,p.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new E.WriteBuffer((R,P)=>this._inputHandler.parse(R,P))),this.register((0,p.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(O,R){this._writeBuffer.write(O,R)}writeSync(O,R){this._logService.logLevel<=u.LogLevelEnum.WARN&&!x&&(this._logService.warn("writeSync is unreliable and will be removed soon."),x=!0),this._writeBuffer.writeSync(O,R)}input(O,R=!0){this.coreService.triggerDataEvent(O,R)}resize(O,R){isNaN(O)||isNaN(R)||(O=Math.max(O,f.MINIMUM_COLS),R=Math.max(R,f.MINIMUM_ROWS),this._bufferService.resize(O,R))}scroll(O,R=!1){this._bufferService.scroll(O,R)}scrollLines(O,R,P){this._bufferService.scrollLines(O,R,P)}scrollPages(O){this.scrollLines(O*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(O){const R=O-this._bufferService.buffer.ydisp;R!==0&&this.scrollLines(R)}registerEscHandler(O,R){return this._inputHandler.registerEscHandler(O,R)}registerDcsHandler(O,R){return this._inputHandler.registerDcsHandler(O,R)}registerCsiHandler(O,R){return this._inputHandler.registerCsiHandler(O,R)}registerOscHandler(O,R){return this._inputHandler.registerOscHandler(O,R)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let O=!1;const R=this.optionsService.rawOptions.windowsPty;R&&R.buildNumber!==void 0&&R.buildNumber!==void 0?O=R.backend==="conpty"&&R.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(O=!0),O?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const O=[];O.push(this.onLineFeed(b.updateWindowsModeWrappedState.bind(null,this._bufferService))),O.push(this.registerCsiHandler({final:"H"},()=>((0,b.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const R of O)R.dispose()})}}}a.CoreTerminal=T},8460:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.runAndSubscribe=a.forwardEvent=a.EventEmitter=void 0,a.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===l)return void this._listeners.splice(c,1)}}})),this._event}fire(l,c){const u=[];for(let d=0;d<this._listeners.length;d++)u.push(this._listeners[d]);for(let d=0;d<u.length;d++)u[d].call(void 0,l,c)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},a.forwardEvent=function(l,c){return l(u=>c.fire(u))},a.runAndSubscribe=function(l,c){return c(void 0),l(u=>c(u))}},5435:function(o,a,l){var c=this&&this.__decorate||function(q,I,$,j){var U,J=arguments.length,ne=J<3?I:j===null?j=Object.getOwnPropertyDescriptor(I,$):j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ne=Reflect.decorate(q,I,$,j);else for(var te=q.length-1;te>=0;te--)(U=q[te])&&(ne=(J<3?U(ne):J>3?U(I,$,ne):U(I,$))||ne);return J>3&&ne&&Object.defineProperty(I,$,ne),ne},u=this&&this.__param||function(q,I){return function($,j){I($,j,q)}};Object.defineProperty(a,"__esModule",{value:!0}),a.InputHandler=a.WindowsOptionsReportType=void 0;const d=l(2584),h=l(7116),f=l(2015),v=l(844),m=l(482),p=l(8437),g=l(8460),y=l(643),_=l(511),b=l(3734),w=l(2585),E=l(1480),S=l(6242),x=l(6351),T=l(5941),D={"(":0,")":1,"*":2,"+":3,"-":1,".":2},O=131072;function R(q,I){if(q>24)return I.setWinLines||!1;switch(q){case 1:return!!I.restoreWin;case 2:return!!I.minimizeWin;case 3:return!!I.setWinPosition;case 4:return!!I.setWinSizePixels;case 5:return!!I.raiseWin;case 6:return!!I.lowerWin;case 7:return!!I.refreshWin;case 8:return!!I.setWinSizeChars;case 9:return!!I.maximizeWin;case 10:return!!I.fullscreenWin;case 11:return!!I.getWinState;case 13:return!!I.getWinPosition;case 14:return!!I.getWinSizePixels;case 15:return!!I.getScreenSizePixels;case 16:return!!I.getCellSizePixels;case 18:return!!I.getWinSizeChars;case 19:return!!I.getScreenSizeChars;case 20:return!!I.getIconTitle;case 21:return!!I.getWinTitle;case 22:return!!I.pushTitle;case 23:return!!I.popTitle;case 24:return!!I.setWinLines}return!1}var P;(function(q){q[q.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",q[q.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(P||(a.WindowsOptionsReportType=P={}));let A=0;class H extends v.Disposable{getAttrData(){return this._curAttrData}constructor(I,$,j,U,J,ne,te,me,re=new f.EscapeSequenceParser){super(),this._bufferService=I,this._charsetService=$,this._coreService=j,this._logService=U,this._optionsService=J,this._oscLinkService=ne,this._coreMouseService=te,this._unicodeService=me,this._parser=re,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new m.StringToUtf32,this._utf8Decoder=new m.Utf8ToUtf32,this._workCell=new _.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new g.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new g.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new g.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new g.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new g.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new g.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new g.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new g.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new g.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new g.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new g.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new g.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new g.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new K(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(F=>this._activeBuffer=F.activeBuffer)),this._parser.setCsiHandlerFallback((F,X)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(F),params:X.toArray()})}),this._parser.setEscHandlerFallback(F=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(F)})}),this._parser.setExecuteHandlerFallback(F=>{this._logService.debug("Unknown EXECUTE code: ",{code:F})}),this._parser.setOscHandlerFallback((F,X,Y)=>{this._logService.debug("Unknown OSC code: ",{identifier:F,action:X,data:Y})}),this._parser.setDcsHandlerFallback((F,X,Y)=>{X==="HOOK"&&(Y=Y.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(F),action:X,payload:Y})}),this._parser.setPrintHandler((F,X,Y)=>this.print(F,X,Y)),this._parser.registerCsiHandler({final:"@"},F=>this.insertChars(F)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},F=>this.scrollLeft(F)),this._parser.registerCsiHandler({final:"A"},F=>this.cursorUp(F)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},F=>this.scrollRight(F)),this._parser.registerCsiHandler({final:"B"},F=>this.cursorDown(F)),this._parser.registerCsiHandler({final:"C"},F=>this.cursorForward(F)),this._parser.registerCsiHandler({final:"D"},F=>this.cursorBackward(F)),this._parser.registerCsiHandler({final:"E"},F=>this.cursorNextLine(F)),this._parser.registerCsiHandler({final:"F"},F=>this.cursorPrecedingLine(F)),this._parser.registerCsiHandler({final:"G"},F=>this.cursorCharAbsolute(F)),this._parser.registerCsiHandler({final:"H"},F=>this.cursorPosition(F)),this._parser.registerCsiHandler({final:"I"},F=>this.cursorForwardTab(F)),this._parser.registerCsiHandler({final:"J"},F=>this.eraseInDisplay(F,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},F=>this.eraseInDisplay(F,!0)),this._parser.registerCsiHandler({final:"K"},F=>this.eraseInLine(F,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},F=>this.eraseInLine(F,!0)),this._parser.registerCsiHandler({final:"L"},F=>this.insertLines(F)),this._parser.registerCsiHandler({final:"M"},F=>this.deleteLines(F)),this._parser.registerCsiHandler({final:"P"},F=>this.deleteChars(F)),this._parser.registerCsiHandler({final:"S"},F=>this.scrollUp(F)),this._parser.registerCsiHandler({final:"T"},F=>this.scrollDown(F)),this._parser.registerCsiHandler({final:"X"},F=>this.eraseChars(F)),this._parser.registerCsiHandler({final:"Z"},F=>this.cursorBackwardTab(F)),this._parser.registerCsiHandler({final:"`"},F=>this.charPosAbsolute(F)),this._parser.registerCsiHandler({final:"a"},F=>this.hPositionRelative(F)),this._parser.registerCsiHandler({final:"b"},F=>this.repeatPrecedingCharacter(F)),this._parser.registerCsiHandler({final:"c"},F=>this.sendDeviceAttributesPrimary(F)),this._parser.registerCsiHandler({prefix:">",final:"c"},F=>this.sendDeviceAttributesSecondary(F)),this._parser.registerCsiHandler({final:"d"},F=>this.linePosAbsolute(F)),this._parser.registerCsiHandler({final:"e"},F=>this.vPositionRelative(F)),this._parser.registerCsiHandler({final:"f"},F=>this.hVPosition(F)),this._parser.registerCsiHandler({final:"g"},F=>this.tabClear(F)),this._parser.registerCsiHandler({final:"h"},F=>this.setMode(F)),this._parser.registerCsiHandler({prefix:"?",final:"h"},F=>this.setModePrivate(F)),this._parser.registerCsiHandler({final:"l"},F=>this.resetMode(F)),this._parser.registerCsiHandler({prefix:"?",final:"l"},F=>this.resetModePrivate(F)),this._parser.registerCsiHandler({final:"m"},F=>this.charAttributes(F)),this._parser.registerCsiHandler({final:"n"},F=>this.deviceStatus(F)),this._parser.registerCsiHandler({prefix:"?",final:"n"},F=>this.deviceStatusPrivate(F)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},F=>this.softReset(F)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},F=>this.setCursorStyle(F)),this._parser.registerCsiHandler({final:"r"},F=>this.setScrollRegion(F)),this._parser.registerCsiHandler({final:"s"},F=>this.saveCursor(F)),this._parser.registerCsiHandler({final:"t"},F=>this.windowOptions(F)),this._parser.registerCsiHandler({final:"u"},F=>this.restoreCursor(F)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},F=>this.insertColumns(F)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},F=>this.deleteColumns(F)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},F=>this.selectProtected(F)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},F=>this.requestMode(F,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},F=>this.requestMode(F,!1)),this._parser.setExecuteHandler(d.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(d.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(d.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(d.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(d.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(d.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(d.C1.IND,()=>this.index()),this._parser.setExecuteHandler(d.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(d.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new S.OscHandler(F=>(this.setTitle(F),this.setIconName(F),!0))),this._parser.registerOscHandler(1,new S.OscHandler(F=>this.setIconName(F))),this._parser.registerOscHandler(2,new S.OscHandler(F=>this.setTitle(F))),this._parser.registerOscHandler(4,new S.OscHandler(F=>this.setOrReportIndexedColor(F))),this._parser.registerOscHandler(8,new S.OscHandler(F=>this.setHyperlink(F))),this._parser.registerOscHandler(10,new S.OscHandler(F=>this.setOrReportFgColor(F))),this._parser.registerOscHandler(11,new S.OscHandler(F=>this.setOrReportBgColor(F))),this._parser.registerOscHandler(12,new S.OscHandler(F=>this.setOrReportCursorColor(F))),this._parser.registerOscHandler(104,new S.OscHandler(F=>this.restoreIndexedColor(F))),this._parser.registerOscHandler(110,new S.OscHandler(F=>this.restoreFgColor(F))),this._parser.registerOscHandler(111,new S.OscHandler(F=>this.restoreBgColor(F))),this._parser.registerOscHandler(112,new S.OscHandler(F=>this.restoreCursorColor(F))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const F in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:F},()=>this.selectCharset("("+F)),this._parser.registerEscHandler({intermediates:")",final:F},()=>this.selectCharset(")"+F)),this._parser.registerEscHandler({intermediates:"*",final:F},()=>this.selectCharset("*"+F)),this._parser.registerEscHandler({intermediates:"+",final:F},()=>this.selectCharset("+"+F)),this._parser.registerEscHandler({intermediates:"-",final:F},()=>this.selectCharset("-"+F)),this._parser.registerEscHandler({intermediates:".",final:F},()=>this.selectCharset("."+F)),this._parser.registerEscHandler({intermediates:"/",final:F},()=>this.selectCharset("/"+F));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(F=>(this._logService.error("Parsing error: ",F),F)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new x.DcsHandler((F,X)=>this.requestStatusString(F,X)))}_preserveStack(I,$,j,U){this._parseStack.paused=!0,this._parseStack.cursorStartX=I,this._parseStack.cursorStartY=$,this._parseStack.decodedLength=j,this._parseStack.position=U}_logSlowResolvingAsync(I){this._logService.logLevel<=w.LogLevelEnum.WARN&&Promise.race([I,new Promise(($,j)=>setTimeout(()=>j("#SLOW_TIMEOUT"),5e3))]).catch($=>{if($!=="#SLOW_TIMEOUT")throw $;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(I,$){let j,U=this._activeBuffer.x,J=this._activeBuffer.y,ne=0;const te=this._parseStack.paused;if(te){if(j=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,$))return this._logSlowResolvingAsync(j),j;U=this._parseStack.cursorStartX,J=this._parseStack.cursorStartY,this._parseStack.paused=!1,I.length>O&&(ne=this._parseStack.position+O)}if(this._logService.logLevel<=w.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof I=="string"?` "${I}"`:` "${Array.prototype.map.call(I,F=>String.fromCharCode(F)).join("")}"`),typeof I=="string"?I.split("").map(F=>F.charCodeAt(0)):I),this._parseBuffer.length<I.length&&this._parseBuffer.length<O&&(this._parseBuffer=new Uint32Array(Math.min(I.length,O))),te||this._dirtyRowTracker.clearRange(),I.length>O)for(let F=ne;F<I.length;F+=O){const X=F+O<I.length?F+O:I.length,Y=typeof I=="string"?this._stringDecoder.decode(I.substring(F,X),this._parseBuffer):this._utf8Decoder.decode(I.subarray(F,X),this._parseBuffer);if(j=this._parser.parse(this._parseBuffer,Y))return this._preserveStack(U,J,Y,F),this._logSlowResolvingAsync(j),j}else if(!te){const F=typeof I=="string"?this._stringDecoder.decode(I,this._parseBuffer):this._utf8Decoder.decode(I,this._parseBuffer);if(j=this._parser.parse(this._parseBuffer,F))return this._preserveStack(U,J,F,0),this._logSlowResolvingAsync(j),j}this._activeBuffer.x===U&&this._activeBuffer.y===J||this._onCursorMove.fire();const me=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),re=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);re<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(re,this._bufferService.rows-1),Math.min(me,this._bufferService.rows-1))}print(I,$,j){let U,J;const ne=this._charsetService.charset,te=this._optionsService.rawOptions.screenReaderMode,me=this._bufferService.cols,re=this._coreService.decPrivateModes.wraparound,F=this._coreService.modes.insertMode,X=this._curAttrData;let Y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&j-$>0&&Y.getWidth(this._activeBuffer.x-1)===2&&Y.setCellFromCodepoint(this._activeBuffer.x-1,0,1,X);let oe=this._parser.precedingJoinState;for(let le=$;le<j;++le){if(U=I[le],U<127&&ne){const ie=ne[String.fromCharCode(U)];ie&&(U=ie.charCodeAt(0))}const ue=this._unicodeService.charProperties(U,oe);J=E.UnicodeService.extractWidth(ue);const N=E.UnicodeService.extractShouldJoin(ue),Z=N?E.UnicodeService.extractWidth(oe):0;if(oe=ue,te&&this._onA11yChar.fire((0,m.stringFromCodePoint)(U)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+J-Z>me){if(re){const ie=Y;let W=this._activeBuffer.x-Z;for(this._activeBuffer.x=Z,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),Y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),Z>0&&Y instanceof p.BufferLine&&Y.copyCellsFrom(ie,W,0,Z,!1);W<me;)ie.setCellFromCodepoint(W++,0,1,X)}else if(this._activeBuffer.x=me-1,J===2)continue}if(N&&this._activeBuffer.x){const ie=Y.getWidth(this._activeBuffer.x-1)?1:2;Y.addCodepointToCell(this._activeBuffer.x-ie,U,J);for(let W=J-Z;--W>=0;)Y.setCellFromCodepoint(this._activeBuffer.x++,0,0,X)}else if(F&&(Y.insertCells(this._activeBuffer.x,J-Z,this._activeBuffer.getNullCell(X)),Y.getWidth(me-1)===2&&Y.setCellFromCodepoint(me-1,y.NULL_CELL_CODE,y.NULL_CELL_WIDTH,X)),Y.setCellFromCodepoint(this._activeBuffer.x++,U,J,X),J>0)for(;--J;)Y.setCellFromCodepoint(this._activeBuffer.x++,0,0,X)}this._parser.precedingJoinState=oe,this._activeBuffer.x<me&&j-$>0&&Y.getWidth(this._activeBuffer.x)===0&&!Y.hasContent(this._activeBuffer.x)&&Y.setCellFromCodepoint(this._activeBuffer.x,0,1,X),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(I,$){return I.final!=="t"||I.prefix||I.intermediates?this._parser.registerCsiHandler(I,$):this._parser.registerCsiHandler(I,j=>!R(j.params[0],this._optionsService.rawOptions.windowOptions)||$(j))}registerDcsHandler(I,$){return this._parser.registerDcsHandler(I,new x.DcsHandler($))}registerEscHandler(I,$){return this._parser.registerEscHandler(I,$)}registerOscHandler(I,$){return this._parser.registerOscHandler(I,new S.OscHandler($))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);I.hasWidth(this._activeBuffer.x)&&!I.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const I=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-I),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(I=this._bufferService.cols-1){this._activeBuffer.x=Math.min(I,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(I,$){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=I,this._activeBuffer.y=this._activeBuffer.scrollTop+$):(this._activeBuffer.x=I,this._activeBuffer.y=$),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(I,$){this._restrictCursor(),this._setCursor(this._activeBuffer.x+I,this._activeBuffer.y+$)}cursorUp(I){const $=this._activeBuffer.y-this._activeBuffer.scrollTop;return $>=0?this._moveCursor(0,-Math.min($,I.params[0]||1)):this._moveCursor(0,-(I.params[0]||1)),!0}cursorDown(I){const $=this._activeBuffer.scrollBottom-this._activeBuffer.y;return $>=0?this._moveCursor(0,Math.min($,I.params[0]||1)):this._moveCursor(0,I.params[0]||1),!0}cursorForward(I){return this._moveCursor(I.params[0]||1,0),!0}cursorBackward(I){return this._moveCursor(-(I.params[0]||1),0),!0}cursorNextLine(I){return this.cursorDown(I),this._activeBuffer.x=0,!0}cursorPrecedingLine(I){return this.cursorUp(I),this._activeBuffer.x=0,!0}cursorCharAbsolute(I){return this._setCursor((I.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(I){return this._setCursor(I.length>=2?(I.params[1]||1)-1:0,(I.params[0]||1)-1),!0}charPosAbsolute(I){return this._setCursor((I.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(I){return this._moveCursor(I.params[0]||1,0),!0}linePosAbsolute(I){return this._setCursor(this._activeBuffer.x,(I.params[0]||1)-1),!0}vPositionRelative(I){return this._moveCursor(0,I.params[0]||1),!0}hVPosition(I){return this.cursorPosition(I),!0}tabClear(I){const $=I.params[0];return $===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:$===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(I){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let $=I.params[0]||1;for(;$--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(I){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let $=I.params[0]||1;for(;$--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(I){const $=I.params[0];return $===1&&(this._curAttrData.bg|=536870912),$!==2&&$!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(I,$,j,U=!1,J=!1){const ne=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);ne.replaceCells($,j,this._activeBuffer.getNullCell(this._eraseAttrData()),J),U&&(ne.isWrapped=!1)}_resetBufferLine(I,$=!1){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);j&&(j.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),$),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+I),j.isWrapped=!1)}eraseInDisplay(I,$=!1){let j;switch(this._restrictCursor(this._bufferService.cols),I.params[0]){case 0:for(j=this._activeBuffer.y,this._dirtyRowTracker.markDirty(j),this._eraseInBufferLine(j++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,$);j<this._bufferService.rows;j++)this._resetBufferLine(j,$);this._dirtyRowTracker.markDirty(j);break;case 1:for(j=this._activeBuffer.y,this._dirtyRowTracker.markDirty(j),this._eraseInBufferLine(j,0,this._activeBuffer.x+1,!0,$),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(j+1).isWrapped=!1);j--;)this._resetBufferLine(j,$);this._dirtyRowTracker.markDirty(0);break;case 2:for(j=this._bufferService.rows,this._dirtyRowTracker.markDirty(j-1);j--;)this._resetBufferLine(j,$);this._dirtyRowTracker.markDirty(0);break;case 3:const U=this._activeBuffer.lines.length-this._bufferService.rows;U>0&&(this._activeBuffer.lines.trimStart(U),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-U,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-U,0),this._onScroll.fire(0))}return!0}eraseInLine(I,$=!1){switch(this._restrictCursor(this._bufferService.cols),I.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,$);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,$);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,$)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(I){this._restrictCursor();let $=I.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=this._activeBuffer.ybase+this._activeBuffer.y,U=this._bufferService.rows-1-this._activeBuffer.scrollBottom,J=this._bufferService.rows-1+this._activeBuffer.ybase-U+1;for(;$--;)this._activeBuffer.lines.splice(J-1,1),this._activeBuffer.lines.splice(j,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(I){this._restrictCursor();let $=I.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=this._activeBuffer.ybase+this._activeBuffer.y;let U;for(U=this._bufferService.rows-1-this._activeBuffer.scrollBottom,U=this._bufferService.rows-1+this._activeBuffer.ybase-U;$--;)this._activeBuffer.lines.splice(j,1),this._activeBuffer.lines.splice(U,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(I){this._restrictCursor();const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return $&&($.insertCells(this._activeBuffer.x,I.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(I){this._restrictCursor();const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return $&&($.deleteCells(this._activeBuffer.x,I.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(I){let $=I.params[0]||1;for(;$--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(I){let $=I.params[0]||1;for(;$--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(p.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const $=I.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);U.deleteCells(0,$,this._activeBuffer.getNullCell(this._eraseAttrData())),U.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const $=I.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);U.insertCells(0,$,this._activeBuffer.getNullCell(this._eraseAttrData())),U.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const $=I.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);U.insertCells(this._activeBuffer.x,$,this._activeBuffer.getNullCell(this._eraseAttrData())),U.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const $=I.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);U.deleteCells(this._activeBuffer.x,$,this._activeBuffer.getNullCell(this._eraseAttrData())),U.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(I){this._restrictCursor();const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return $&&($.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(I.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(I){const $=this._parser.precedingJoinState;if(!$)return!0;const j=I.params[0]||1,U=E.UnicodeService.extractWidth($),J=this._activeBuffer.x-U,ne=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(J),te=new Uint32Array(ne.length*j);let me=0;for(let F=0;F<ne.length;){const X=ne.codePointAt(F)||0;te[me++]=X,F+=X>65535?2:1}let re=me;for(let F=1;F<j;++F)te.copyWithin(re,0,me),re+=me;return this.print(te,0,re),!0}sendDeviceAttributesPrimary(I){return I.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(d.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(d.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(I){return I.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(d.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(d.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(I.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(d.C0.ESC+"[>83;40003;0c")),!0}_is(I){return(this._optionsService.rawOptions.termName+"").indexOf(I)===0}setMode(I){for(let $=0;$<I.length;$++)switch(I.params[$]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(I){for(let $=0;$<I.length;$++)switch(I.params[$]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(I){for(let $=0;$<I.length;$++)switch(I.params[$]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(I){for(let $=0;$<I.length;$++)switch(I.params[$]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),I.params[$]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(I,$){const j=this._coreService.decPrivateModes,{activeProtocol:U,activeEncoding:J}=this._coreMouseService,ne=this._coreService,{buffers:te,cols:me}=this._bufferService,{active:re,alt:F}=te,X=this._optionsService.rawOptions,Y=N=>N?1:2,oe=I.params[0];return le=oe,ue=$?oe===2?4:oe===4?Y(ne.modes.insertMode):oe===12?3:oe===20?Y(X.convertEol):0:oe===1?Y(j.applicationCursorKeys):oe===3?X.windowOptions.setWinLines?me===80?2:me===132?1:0:0:oe===6?Y(j.origin):oe===7?Y(j.wraparound):oe===8?3:oe===9?Y(U==="X10"):oe===12?Y(X.cursorBlink):oe===25?Y(!ne.isCursorHidden):oe===45?Y(j.reverseWraparound):oe===66?Y(j.applicationKeypad):oe===67?4:oe===1e3?Y(U==="VT200"):oe===1002?Y(U==="DRAG"):oe===1003?Y(U==="ANY"):oe===1004?Y(j.sendFocus):oe===1005?4:oe===1006?Y(J==="SGR"):oe===1015?4:oe===1016?Y(J==="SGR_PIXELS"):oe===1048?1:oe===47||oe===1047||oe===1049?Y(re===F):oe===2004?Y(j.bracketedPasteMode):0,ne.triggerDataEvent(`${d.C0.ESC}[${$?"":"?"}${le};${ue}$y`),!0;var le,ue}_updateAttrColor(I,$,j,U,J){return $===2?(I|=50331648,I&=-16777216,I|=b.AttributeData.fromColorRGB([j,U,J])):$===5&&(I&=-50331904,I|=33554432|255&j),I}_extractColor(I,$,j){const U=[0,0,-1,0,0,0];let J=0,ne=0;do{if(U[ne+J]=I.params[$+ne],I.hasSubParams($+ne)){const te=I.getSubParams($+ne);let me=0;do U[1]===5&&(J=1),U[ne+me+1+J]=te[me];while(++me<te.length&&me+ne+1+J<U.length);break}if(U[1]===5&&ne+J>=2||U[1]===2&&ne+J>=5)break;U[1]&&(J=1)}while(++ne+$<I.length&&ne+J<U.length);for(let te=2;te<U.length;++te)U[te]===-1&&(U[te]=0);switch(U[0]){case 38:j.fg=this._updateAttrColor(j.fg,U[1],U[3],U[4],U[5]);break;case 48:j.bg=this._updateAttrColor(j.bg,U[1],U[3],U[4],U[5]);break;case 58:j.extended=j.extended.clone(),j.extended.underlineColor=this._updateAttrColor(j.extended.underlineColor,U[1],U[3],U[4],U[5])}return ne}_processUnderline(I,$){$.extended=$.extended.clone(),(!~I||I>5)&&(I=1),$.extended.underlineStyle=I,$.fg|=268435456,I===0&&($.fg&=-268435457),$.updateExtended()}_processSGR0(I){I.fg=p.DEFAULT_ATTR_DATA.fg,I.bg=p.DEFAULT_ATTR_DATA.bg,I.extended=I.extended.clone(),I.extended.underlineStyle=0,I.extended.underlineColor&=-67108864,I.updateExtended()}charAttributes(I){if(I.length===1&&I.params[0]===0)return this._processSGR0(this._curAttrData),!0;const $=I.length;let j;const U=this._curAttrData;for(let J=0;J<$;J++)j=I.params[J],j>=30&&j<=37?(U.fg&=-50331904,U.fg|=16777216|j-30):j>=40&&j<=47?(U.bg&=-50331904,U.bg|=16777216|j-40):j>=90&&j<=97?(U.fg&=-50331904,U.fg|=16777224|j-90):j>=100&&j<=107?(U.bg&=-50331904,U.bg|=16777224|j-100):j===0?this._processSGR0(U):j===1?U.fg|=134217728:j===3?U.bg|=67108864:j===4?(U.fg|=268435456,this._processUnderline(I.hasSubParams(J)?I.getSubParams(J)[0]:1,U)):j===5?U.fg|=536870912:j===7?U.fg|=67108864:j===8?U.fg|=1073741824:j===9?U.fg|=2147483648:j===2?U.bg|=134217728:j===21?this._processUnderline(2,U):j===22?(U.fg&=-134217729,U.bg&=-134217729):j===23?U.bg&=-67108865:j===24?(U.fg&=-268435457,this._processUnderline(0,U)):j===25?U.fg&=-536870913:j===27?U.fg&=-67108865:j===28?U.fg&=-1073741825:j===29?U.fg&=2147483647:j===39?(U.fg&=-67108864,U.fg|=16777215&p.DEFAULT_ATTR_DATA.fg):j===49?(U.bg&=-67108864,U.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):j===38||j===48||j===58?J+=this._extractColor(I,J,U):j===53?U.bg|=1073741824:j===55?U.bg&=-1073741825:j===59?(U.extended=U.extended.clone(),U.extended.underlineColor=-1,U.updateExtended()):j===100?(U.fg&=-67108864,U.fg|=16777215&p.DEFAULT_ATTR_DATA.fg,U.bg&=-67108864,U.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",j);return!0}deviceStatus(I){switch(I.params[0]){case 5:this._coreService.triggerDataEvent(`${d.C0.ESC}[0n`);break;case 6:const $=this._activeBuffer.y+1,j=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[${$};${j}R`)}return!0}deviceStatusPrivate(I){if(I.params[0]===6){const $=this._activeBuffer.y+1,j=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[?${$};${j}R`)}return!0}softReset(I){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(I){const $=I.params[0]||1;switch($){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const j=$%2==1;return this._optionsService.options.cursorBlink=j,!0}setScrollRegion(I){const $=I.params[0]||1;let j;return(I.length<2||(j=I.params[1])>this._bufferService.rows||j===0)&&(j=this._bufferService.rows),j>$&&(this._activeBuffer.scrollTop=$-1,this._activeBuffer.scrollBottom=j-1,this._setCursor(0,0)),!0}windowOptions(I){if(!R(I.params[0],this._optionsService.rawOptions.windowOptions))return!0;const $=I.length>1?I.params[1]:0;switch(I.params[0]){case 14:$!==2&&this._onRequestWindowsOptionsReport.fire(P.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(P.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${d.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:$!==0&&$!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),$!==0&&$!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:$!==0&&$!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),$!==0&&$!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(I){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(I){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(I){return this._windowTitle=I,this._onTitleChange.fire(I),!0}setIconName(I){return this._iconName=I,!0}setOrReportIndexedColor(I){const $=[],j=I.split(";");for(;j.length>1;){const U=j.shift(),J=j.shift();if(/^\d+$/.exec(U)){const ne=parseInt(U);if(V(ne))if(J==="?")$.push({type:0,index:ne});else{const te=(0,T.parseColor)(J);te&&$.push({type:1,index:ne,color:te})}}}return $.length&&this._onColor.fire($),!0}setHyperlink(I){const $=I.split(";");return!($.length<2)&&($[1]?this._createHyperlink($[0],$[1]):!$[0]&&this._finishHyperlink())}_createHyperlink(I,$){this._getCurrentLinkId()&&this._finishHyperlink();const j=I.split(":");let U;const J=j.findIndex(ne=>ne.startsWith("id="));return J!==-1&&(U=j[J].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:U,uri:$}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(I,$){const j=I.split(";");for(let U=0;U<j.length&&!($>=this._specialColors.length);++U,++$)if(j[U]==="?")this._onColor.fire([{type:0,index:this._specialColors[$]}]);else{const J=(0,T.parseColor)(j[U]);J&&this._onColor.fire([{type:1,index:this._specialColors[$],color:J}])}return!0}setOrReportFgColor(I){return this._setOrReportSpecialColor(I,0)}setOrReportBgColor(I){return this._setOrReportSpecialColor(I,1)}setOrReportCursorColor(I){return this._setOrReportSpecialColor(I,2)}restoreIndexedColor(I){if(!I)return this._onColor.fire([{type:2}]),!0;const $=[],j=I.split(";");for(let U=0;U<j.length;++U)if(/^\d+$/.exec(j[U])){const J=parseInt(j[U]);V(J)&&$.push({type:2,index:J})}return $.length&&this._onColor.fire($),!0}restoreFgColor(I){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(I){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(I){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(I){return I.length!==2?(this.selectDefaultCharset(),!0):(I[0]==="/"||this._charsetService.setgCharset(D[I[0]],h.CHARSETS[I[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const I=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,I,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(I){return this._charsetService.setgLevel(I),!0}screenAlignmentPattern(){const I=new _.CellData;I.content=4194373,I.fg=this._curAttrData.fg,I.bg=this._curAttrData.bg,this._setCursor(0,0);for(let $=0;$<this._bufferService.rows;++$){const j=this._activeBuffer.ybase+this._activeBuffer.y+$,U=this._activeBuffer.lines.get(j);U&&(U.fill(I),U.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(I,$){const j=this._bufferService.buffer,U=this._optionsService.rawOptions;return(J=>(this._coreService.triggerDataEvent(`${d.C0.ESC}${J}${d.C0.ESC}\\`),!0))(I==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:I==='"p'?'P1$r61;1"p':I==="r"?`P1$r${j.scrollTop+1};${j.scrollBottom+1}r`:I==="m"?"P1$r0m":I===" q"?`P1$r${{block:2,underline:4,bar:6}[U.cursorStyle]-(U.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(I,$){this._dirtyRowTracker.markRangeDirty(I,$)}}a.InputHandler=H;let K=class{constructor(q){this._bufferService=q,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(q){q<this.start?this.start=q:q>this.end&&(this.end=q)}markRangeDirty(q,I){q>I&&(A=q,q=I,I=A),q<this.start&&(this.start=q),I>this.end&&(this.end=I)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function V(q){return 0<=q&&q<256}K=c([u(0,w.IBufferService)],K)},844:(o,a)=>{function l(c){for(const u of c)u.dispose();c.length=0}Object.defineProperty(a,"__esModule",{value:!0}),a.getDisposeArrayDisposable=a.disposeArray=a.toDisposable=a.MutableDisposable=a.Disposable=void 0,a.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const u=this._disposables.indexOf(c);u!==-1&&this._disposables.splice(u,1)}},a.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(c){this._isDisposed||c===this._value||(this._value?.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},a.toDisposable=function(c){return{dispose:c}},a.disposeArray=l,a.getDisposeArrayDisposable=function(c){return{dispose:()=>l(c)}}},1505:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FourKeyMap=a.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(u,d,h){this._data[u]||(this._data[u]={}),this._data[u][d]=h}get(u,d){return this._data[u]?this._data[u][d]:void 0}clear(){this._data={}}}a.TwoKeyMap=l,a.FourKeyMap=class{constructor(){this._data=new l}set(c,u,d,h,f){this._data.get(c,u)||this._data.set(c,u,new l),this._data.get(c,u).set(d,h,f)}get(c,u,d,h){return this._data.get(c,u)?.get(d,h)}clear(){this._data.clear()}}},6114:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isChromeOS=a.isLinux=a.isWindows=a.isIphone=a.isIpad=a.isMac=a.getSafariVersion=a.isSafari=a.isLegacyEdge=a.isFirefox=a.isNode=void 0,a.isNode=typeof xt<"u"&&"title"in xt;const l=a.isNode?"node":navigator.userAgent,c=a.isNode?"node":navigator.platform;a.isFirefox=l.includes("Firefox"),a.isLegacyEdge=l.includes("Edge"),a.isSafari=/^((?!chrome|android).)*safari/i.test(l),a.getSafariVersion=function(){if(!a.isSafari)return 0;const u=l.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},a.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),a.isIpad=c==="iPad",a.isIphone=c==="iPhone",a.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),a.isLinux=c.indexOf("Linux")>=0,a.isChromeOS=/\bCrOS\b/.test(l)},6106:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SortedList=void 0;let l=0;a.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(l=this._search(this._getKey(c)),this._array.splice(l,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;const u=this._getKey(c);if(u===void 0||(l=this._search(u),l===-1)||this._getKey(this._array[l])!==u)return!1;do if(this._array[l]===c)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===u);return!1}*getKeyIterator(c){if(this._array.length!==0&&(l=this._search(c),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===c))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===c)}forEachByKey(c,u){if(this._array.length!==0&&(l=this._search(c),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===c))do u(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===c)}values(){return[...this._array].values()}_search(c){let u=0,d=this._array.length-1;for(;d>=u;){let h=u+d>>1;const f=this._getKey(this._array[h]);if(f>c)d=h-1;else{if(!(f<c)){for(;h>0&&this._getKey(this._array[h-1])===c;)h--;return h}u=h+1}}return u}}},7226:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DebouncedIdleTask=a.IdleTaskQueue=a.PriorityTaskQueue=void 0;const c=l(6114);class u{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let v=0,m=0,p=f.timeRemaining(),g=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),m=Math.max(v,m),g=f.timeRemaining(),1.5*m>g)return p-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(p-v))}ms`),void this._start();p=g}this.clear()}}class d extends u{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){const v=Date.now()+f;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}a.PriorityTaskQueue=d,a.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:d,a.DebouncedIdleTask=class{constructor(){this._queue=new a.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.updateWindowsModeWrappedState=void 0;const c=l(643);a.updateWindowsModeWrappedState=function(u){const d=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),h=d?.get(u.cols-1),f=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);f&&h&&(f.isWrapped=h[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&h[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ExtendedAttrs=a.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){const d=new l;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}a.AttributeData=l;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}get underlineVariantOffset(){const d=(3758096384&this._ext)>>29;return d<0?4294967288^d:d}set underlineVariantOffset(d){this._ext&=536870911,this._ext|=d<<29&3758096384}constructor(d=0,h=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=h}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}a.ExtendedAttrs=c},9092:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Buffer=a.MAX_BUFFER_SIZE=void 0;const c=l(6349),u=l(7226),d=l(3734),h=l(8437),f=l(4634),v=l(511),m=l(643),p=l(4863),g=l(7116);a.MAX_BUFFER_SIZE=4294967295,a.Buffer=class{constructor(y,_,b){this._hasScrollback=y,this._optionsService=_,this._bufferService=b,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=g.DEFAULT_CHARSET,this.markers=[],this._nullCell=v.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,m.NULL_CELL_CODE]),this._whitespaceCell=v.CellData.fromCharData([0,m.WHITESPACE_CELL_CHAR,m.WHITESPACE_CELL_WIDTH,m.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new u.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(y){return y?(this._nullCell.fg=y.fg,this._nullCell.bg=y.bg,this._nullCell.extended=y.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new d.ExtendedAttrs),this._nullCell}getWhitespaceCell(y){return y?(this._whitespaceCell.fg=y.fg,this._whitespaceCell.bg=y.bg,this._whitespaceCell.extended=y.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new d.ExtendedAttrs),this._whitespaceCell}getBlankLine(y,_){return new h.BufferLine(this._bufferService.cols,this.getNullCell(y),_)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const y=this.ybase+this.y-this.ydisp;return y>=0&&y<this._rows}_getCorrectBufferLength(y){if(!this._hasScrollback)return y;const _=y+this._optionsService.rawOptions.scrollback;return _>a.MAX_BUFFER_SIZE?a.MAX_BUFFER_SIZE:_}fillViewportRows(y){if(this.lines.length===0){y===void 0&&(y=h.DEFAULT_ATTR_DATA);let _=this._rows;for(;_--;)this.lines.push(this.getBlankLine(y))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(y,_){const b=this.getNullCell(h.DEFAULT_ATTR_DATA);let w=0;const E=this._getCorrectBufferLength(_);if(E>this.lines.maxLength&&(this.lines.maxLength=E),this.lines.length>0){if(this._cols<y)for(let x=0;x<this.lines.length;x++)w+=+this.lines.get(x).resize(y,b);let S=0;if(this._rows<_)for(let x=this._rows;x<_;x++)this.lines.length<_+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(y,b)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(y,b)));else for(let x=this._rows;x>_;x--)this.lines.length>_+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(E<this.lines.maxLength){const x=this.lines.length-E;x>0&&(this.lines.trimStart(x),this.ybase=Math.max(this.ybase-x,0),this.ydisp=Math.max(this.ydisp-x,0),this.savedY=Math.max(this.savedY-x,0)),this.lines.maxLength=E}this.x=Math.min(this.x,y-1),this.y=Math.min(this.y,_-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,y-1),this.scrollTop=0}if(this.scrollBottom=_-1,this._isReflowEnabled&&(this._reflow(y,_),this._cols>y))for(let S=0;S<this.lines.length;S++)w+=+this.lines.get(S).resize(y,b);this._cols=y,this._rows=_,this._memoryCleanupQueue.clear(),w>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let y=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,y=!1);let _=0;for(;this._memoryCleanupPosition<this.lines.length;)if(_+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),_>100)return!0;return y}get _isReflowEnabled(){const y=this._optionsService.rawOptions.windowsPty;return y&&y.buildNumber?this._hasScrollback&&y.backend==="conpty"&&y.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(y,_){this._cols!==y&&(y>this._cols?this._reflowLarger(y,_):this._reflowSmaller(y,_))}_reflowLarger(y,_){const b=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,y,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(b.length>0){const w=(0,f.reflowLargerCreateNewLayout)(this.lines,b);(0,f.reflowLargerApplyNewLayout)(this.lines,w.layout),this._reflowLargerAdjustViewport(y,_,w.countRemoved)}}_reflowLargerAdjustViewport(y,_,b){const w=this.getNullCell(h.DEFAULT_ATTR_DATA);let E=b;for(;E-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<_&&this.lines.push(new h.BufferLine(y,w))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-b,0)}_reflowSmaller(y,_){const b=this.getNullCell(h.DEFAULT_ATTR_DATA),w=[];let E=0;for(let S=this.lines.length-1;S>=0;S--){let x=this.lines.get(S);if(!x||!x.isWrapped&&x.getTrimmedLength()<=y)continue;const T=[x];for(;x.isWrapped&&S>0;)x=this.lines.get(--S),T.unshift(x);const D=this.ybase+this.y;if(D>=S&&D<S+T.length)continue;const O=T[T.length-1].getTrimmedLength(),R=(0,f.reflowSmallerGetNewLineLengths)(T,this._cols,y),P=R.length-T.length;let A;A=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+P):Math.max(0,this.lines.length-this.lines.maxLength+P);const H=[];for(let j=0;j<P;j++){const U=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);H.push(U)}H.length>0&&(w.push({start:S+T.length+E,newLines:H}),E+=H.length),T.push(...H);let K=R.length-1,V=R[K];V===0&&(K--,V=R[K]);let q=T.length-P-1,I=O;for(;q>=0;){const j=Math.min(I,V);if(T[K]===void 0)break;if(T[K].copyCellsFrom(T[q],I-j,V-j,j,!0),V-=j,V===0&&(K--,V=R[K]),I-=j,I===0){q--;const U=Math.max(q,0);I=(0,f.getWrappedLineTrimmedLength)(T,U,this._cols)}}for(let j=0;j<T.length;j++)R[j]<y&&T[j].setCell(R[j],b);let $=P-A;for(;$-- >0;)this.ybase===0?this.y<_-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+E)-_&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+P,this.ybase+_-1)}if(w.length>0){const S=[],x=[];for(let K=0;K<this.lines.length;K++)x.push(this.lines.get(K));const T=this.lines.length;let D=T-1,O=0,R=w[O];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+E);let P=0;for(let K=Math.min(this.lines.maxLength-1,T+E-1);K>=0;K--)if(R&&R.start>D+P){for(let V=R.newLines.length-1;V>=0;V--)this.lines.set(K--,R.newLines[V]);K++,S.push({index:D+1,amount:R.newLines.length}),P+=R.newLines.length,R=w[++O]}else this.lines.set(K,x[D--]);let A=0;for(let K=S.length-1;K>=0;K--)S[K].index+=A,this.lines.onInsertEmitter.fire(S[K]),A+=S[K].amount;const H=Math.max(0,T+E-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}}translateBufferLineToString(y,_,b=0,w){const E=this.lines.get(y);return E?E.translateToString(_,b,w):""}getWrappedRangeForLine(y){let _=y,b=y;for(;_>0&&this.lines.get(_).isWrapped;)_--;for(;b+1<this.lines.length&&this.lines.get(b+1).isWrapped;)b++;return{first:_,last:b}}setupTabStops(y){for(y!=null?this.tabs[y]||(y=this.prevStop(y)):(this.tabs={},y=0);y<this._cols;y+=this._optionsService.rawOptions.tabStopWidth)this.tabs[y]=!0}prevStop(y){for(y==null&&(y=this.x);!this.tabs[--y]&&y>0;);return y>=this._cols?this._cols-1:y<0?0:y}nextStop(y){for(y==null&&(y=this.x);!this.tabs[++y]&&y<this._cols;);return y>=this._cols?this._cols-1:y<0?0:y}clearMarkers(y){this._isClearing=!0;for(let _=0;_<this.markers.length;_++)this.markers[_].line===y&&(this.markers[_].dispose(),this.markers.splice(_--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let y=0;y<this.markers.length;y++)this.markers[y].dispose(),this.markers.splice(y--,1);this._isClearing=!1}addMarker(y){const _=new p.Marker(y);return this.markers.push(_),_.register(this.lines.onTrim(b=>{_.line-=b,_.line<0&&_.dispose()})),_.register(this.lines.onInsert(b=>{_.line>=b.index&&(_.line+=b.amount)})),_.register(this.lines.onDelete(b=>{_.line>=b.index&&_.line<b.index+b.amount&&_.dispose(),_.line>b.index&&(_.line-=b.amount)})),_.register(_.onDispose(()=>this._removeMarker(_))),_}_removeMarker(y){this._isClearing||this.markers.splice(this.markers.indexOf(y),1)}}},8437:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferLine=a.DEFAULT_ATTR_DATA=void 0;const c=l(3734),u=l(511),d=l(643),h=l(482);a.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let f=0;class v{constructor(p,g,y=!1){this.isWrapped=y,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*p);const _=g||u.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]);for(let b=0;b<p;++b)this.setCell(b,_);this.length=p}get(p){const g=this._data[3*p+0],y=2097151&g;return[this._data[3*p+1],2097152&g?this._combined[p]:y?(0,h.stringFromCodePoint)(y):"",g>>22,2097152&g?this._combined[p].charCodeAt(this._combined[p].length-1):y]}set(p,g){this._data[3*p+1]=g[d.CHAR_DATA_ATTR_INDEX],g[d.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[p]=g[1],this._data[3*p+0]=2097152|p|g[d.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*p+0]=g[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|g[d.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(p){return this._data[3*p+0]>>22}hasWidth(p){return 12582912&this._data[3*p+0]}getFg(p){return this._data[3*p+1]}getBg(p){return this._data[3*p+2]}hasContent(p){return 4194303&this._data[3*p+0]}getCodePoint(p){const g=this._data[3*p+0];return 2097152&g?this._combined[p].charCodeAt(this._combined[p].length-1):2097151&g}isCombined(p){return 2097152&this._data[3*p+0]}getString(p){const g=this._data[3*p+0];return 2097152&g?this._combined[p]:2097151&g?(0,h.stringFromCodePoint)(2097151&g):""}isProtected(p){return 536870912&this._data[3*p+2]}loadCell(p,g){return f=3*p,g.content=this._data[f+0],g.fg=this._data[f+1],g.bg=this._data[f+2],2097152&g.content&&(g.combinedData=this._combined[p]),268435456&g.bg&&(g.extended=this._extendedAttrs[p]),g}setCell(p,g){2097152&g.content&&(this._combined[p]=g.combinedData),268435456&g.bg&&(this._extendedAttrs[p]=g.extended),this._data[3*p+0]=g.content,this._data[3*p+1]=g.fg,this._data[3*p+2]=g.bg}setCellFromCodepoint(p,g,y,_){268435456&_.bg&&(this._extendedAttrs[p]=_.extended),this._data[3*p+0]=g|y<<22,this._data[3*p+1]=_.fg,this._data[3*p+2]=_.bg}addCodepointToCell(p,g,y){let _=this._data[3*p+0];2097152&_?this._combined[p]+=(0,h.stringFromCodePoint)(g):2097151&_?(this._combined[p]=(0,h.stringFromCodePoint)(2097151&_)+(0,h.stringFromCodePoint)(g),_&=-2097152,_|=2097152):_=g|4194304,y&&(_&=-12582913,_|=y<<22),this._data[3*p+0]=_}insertCells(p,g,y){if((p%=this.length)&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,y),g<this.length-p){const _=new u.CellData;for(let b=this.length-p-g-1;b>=0;--b)this.setCell(p+g+b,this.loadCell(p+b,_));for(let b=0;b<g;++b)this.setCell(p+b,y)}else for(let _=p;_<this.length;++_)this.setCell(_,y);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,y)}deleteCells(p,g,y){if(p%=this.length,g<this.length-p){const _=new u.CellData;for(let b=0;b<this.length-p-g;++b)this.setCell(p+b,this.loadCell(p+g+b,_));for(let b=this.length-g;b<this.length;++b)this.setCell(b,y)}else for(let _=p;_<this.length;++_)this.setCell(_,y);p&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,y),this.getWidth(p)!==0||this.hasContent(p)||this.setCellFromCodepoint(p,0,1,y)}replaceCells(p,g,y,_=!1){if(_)for(p&&this.getWidth(p-1)===2&&!this.isProtected(p-1)&&this.setCellFromCodepoint(p-1,0,1,y),g<this.length&&this.getWidth(g-1)===2&&!this.isProtected(g)&&this.setCellFromCodepoint(g,0,1,y);p<g&&p<this.length;)this.isProtected(p)||this.setCell(p,y),p++;else for(p&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,y),g<this.length&&this.getWidth(g-1)===2&&this.setCellFromCodepoint(g,0,1,y);p<g&&p<this.length;)this.setCell(p++,y)}resize(p,g){if(p===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const y=3*p;if(p>this.length){if(this._data.buffer.byteLength>=4*y)this._data=new Uint32Array(this._data.buffer,0,y);else{const _=new Uint32Array(y);_.set(this._data),this._data=_}for(let _=this.length;_<p;++_)this.setCell(_,g)}else{this._data=this._data.subarray(0,y);const _=Object.keys(this._combined);for(let w=0;w<_.length;w++){const E=parseInt(_[w],10);E>=p&&delete this._combined[E]}const b=Object.keys(this._extendedAttrs);for(let w=0;w<b.length;w++){const E=parseInt(b[w],10);E>=p&&delete this._extendedAttrs[E]}}return this.length=p,4*y*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const p=new Uint32Array(this._data.length);return p.set(this._data),this._data=p,1}return 0}fill(p,g=!1){if(g)for(let y=0;y<this.length;++y)this.isProtected(y)||this.setCell(y,p);else{this._combined={},this._extendedAttrs={};for(let y=0;y<this.length;++y)this.setCell(y,p)}}copyFrom(p){this.length!==p.length?this._data=new Uint32Array(p._data):this._data.set(p._data),this.length=p.length,this._combined={};for(const g in p._combined)this._combined[g]=p._combined[g];this._extendedAttrs={};for(const g in p._extendedAttrs)this._extendedAttrs[g]=p._extendedAttrs[g];this.isWrapped=p.isWrapped}clone(){const p=new v(0);p._data=new Uint32Array(this._data),p.length=this.length;for(const g in this._combined)p._combined[g]=this._combined[g];for(const g in this._extendedAttrs)p._extendedAttrs[g]=this._extendedAttrs[g];return p.isWrapped=this.isWrapped,p}getTrimmedLength(){for(let p=this.length-1;p>=0;--p)if(4194303&this._data[3*p+0])return p+(this._data[3*p+0]>>22);return 0}getNoBgTrimmedLength(){for(let p=this.length-1;p>=0;--p)if(4194303&this._data[3*p+0]||50331648&this._data[3*p+2])return p+(this._data[3*p+0]>>22);return 0}copyCellsFrom(p,g,y,_,b){const w=p._data;if(b)for(let S=_-1;S>=0;S--){for(let x=0;x<3;x++)this._data[3*(y+S)+x]=w[3*(g+S)+x];268435456&w[3*(g+S)+2]&&(this._extendedAttrs[y+S]=p._extendedAttrs[g+S])}else for(let S=0;S<_;S++){for(let x=0;x<3;x++)this._data[3*(y+S)+x]=w[3*(g+S)+x];268435456&w[3*(g+S)+2]&&(this._extendedAttrs[y+S]=p._extendedAttrs[g+S])}const E=Object.keys(p._combined);for(let S=0;S<E.length;S++){const x=parseInt(E[S],10);x>=g&&(this._combined[x-g+y]=p._combined[x])}}translateToString(p,g,y,_){g=g??0,y=y??this.length,p&&(y=Math.min(y,this.getTrimmedLength())),_&&(_.length=0);let b="";for(;g<y;){const w=this._data[3*g+0],E=2097151&w,S=2097152&w?this._combined[g]:E?(0,h.stringFromCodePoint)(E):d.WHITESPACE_CELL_CHAR;if(b+=S,_)for(let x=0;x<S.length;++x)_.push(g);g+=w>>22||1}return _&&_.push(g),b}}a.BufferLine=v},4841:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getRangeLength=void 0,a.getRangeLength=function(l,c){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return c*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(o,a)=>{function l(c,u,d){if(u===c.length-1)return c[u].getTrimmedLength();const h=!c[u].hasContent(d-1)&&c[u].getWidth(d-1)===1,f=c[u+1].getWidth(0)===2;return h&&f?d-1:d}Object.defineProperty(a,"__esModule",{value:!0}),a.getWrappedLineTrimmedLength=a.reflowSmallerGetNewLineLengths=a.reflowLargerApplyNewLayout=a.reflowLargerCreateNewLayout=a.reflowLargerGetLinesToRemove=void 0,a.reflowLargerGetLinesToRemove=function(c,u,d,h,f){const v=[];for(let m=0;m<c.length-1;m++){let p=m,g=c.get(++p);if(!g.isWrapped)continue;const y=[c.get(m)];for(;p<c.length&&g.isWrapped;)y.push(g),g=c.get(++p);if(h>=m&&h<p){m+=y.length-1;continue}let _=0,b=l(y,_,u),w=1,E=0;for(;w<y.length;){const x=l(y,w,u),T=x-E,D=d-b,O=Math.min(T,D);y[_].copyCellsFrom(y[w],E,b,O,!1),b+=O,b===d&&(_++,b=0),E+=O,E===x&&(w++,E=0),b===0&&_!==0&&y[_-1].getWidth(d-1)===2&&(y[_].copyCellsFrom(y[_-1],d-1,b++,1,!1),y[_-1].setCell(d-1,f))}y[_].replaceCells(b,d,f);let S=0;for(let x=y.length-1;x>0&&(x>_||y[x].getTrimmedLength()===0);x--)S++;S>0&&(v.push(m+y.length-S),v.push(S)),m+=y.length-1}return v},a.reflowLargerCreateNewLayout=function(c,u){const d=[];let h=0,f=u[h],v=0;for(let m=0;m<c.length;m++)if(f===m){const p=u[++h];c.onDeleteEmitter.fire({index:m-v,amount:p}),m+=p-1,v+=p,f=u[++h]}else d.push(m);return{layout:d,countRemoved:v}},a.reflowLargerApplyNewLayout=function(c,u){const d=[];for(let h=0;h<u.length;h++)d.push(c.get(u[h]));for(let h=0;h<d.length;h++)c.set(h,d[h]);c.length=u.length},a.reflowSmallerGetNewLineLengths=function(c,u,d){const h=[],f=c.map((g,y)=>l(c,y,u)).reduce((g,y)=>g+y);let v=0,m=0,p=0;for(;p<f;){if(f-p<d){h.push(f-p);break}v+=d;const g=l(c,m,u);v>g&&(v-=g,m++);const y=c[m].getWidth(v-1)===2;y&&v--;const _=y?d-1:d;h.push(_),p+=_}return h},a.getWrappedLineTrimmedLength=l},5295:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferSet=void 0;const c=l(8460),u=l(844),d=l(9092);class h extends u.Disposable{constructor(v,m){super(),this._optionsService=v,this._bufferService=m,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new d.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new d.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(v,m){this._normal.resize(v,m),this._alt.resize(v,m),this.setupTabStops(v)}setupTabStops(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)}}a.BufferSet=h},511:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CellData=void 0;const c=l(482),u=l(643),d=l(3734);class h extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(v){const m=new h;return m.setFromCharData(v),m}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let m=!1;if(v[u.CHAR_DATA_CHAR_INDEX].length>2)m=!0;else if(v[u.CHAR_DATA_CHAR_INDEX].length===2){const p=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=p&&p<=56319){const g=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=g&&g<=57343?this.content=1024*(p-55296)+g-56320+65536|v[u.CHAR_DATA_WIDTH_INDEX]<<22:m=!0}else m=!0}else this.content=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[u.CHAR_DATA_WIDTH_INDEX]<<22;m&&(this.combinedData=v[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}a.CellData=h},643:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WHITESPACE_CELL_CODE=a.WHITESPACE_CELL_WIDTH=a.WHITESPACE_CELL_CHAR=a.NULL_CELL_CODE=a.NULL_CELL_WIDTH=a.NULL_CELL_CHAR=a.CHAR_DATA_CODE_INDEX=a.CHAR_DATA_WIDTH_INDEX=a.CHAR_DATA_CHAR_INDEX=a.CHAR_DATA_ATTR_INDEX=a.DEFAULT_EXT=a.DEFAULT_ATTR=a.DEFAULT_COLOR=void 0,a.DEFAULT_COLOR=0,a.DEFAULT_ATTR=256|a.DEFAULT_COLOR<<9,a.DEFAULT_EXT=0,a.CHAR_DATA_ATTR_INDEX=0,a.CHAR_DATA_CHAR_INDEX=1,a.CHAR_DATA_WIDTH_INDEX=2,a.CHAR_DATA_CODE_INDEX=3,a.NULL_CELL_CHAR="",a.NULL_CELL_WIDTH=1,a.NULL_CELL_CODE=0,a.WHITESPACE_CELL_CHAR=" ",a.WHITESPACE_CELL_WIDTH=1,a.WHITESPACE_CELL_CODE=32},4863:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Marker=void 0;const c=l(8460),u=l(844);class d{get id(){return this._id}constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=d._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,u.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}a.Marker=d,d._nextId=1},7116:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DEFAULT_CHARSET=a.CHARSETS=void 0,a.CHARSETS={},a.DEFAULT_CHARSET=a.CHARSETS.B,a.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},a.CHARSETS.A={"#":"£"},a.CHARSETS.B=void 0,a.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},a.CHARSETS.C=a.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},a.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},a.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},a.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},a.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},a.CHARSETS.E=a.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},a.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},a.CHARSETS.H=a.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},a.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(o,a)=>{var l,c,u;Object.defineProperty(a,"__esModule",{value:!0}),a.C1_ESCAPED=a.C1=a.C0=void 0,function(d){d.NUL="\0",d.SOH="",d.STX="",d.ETX="",d.EOT="",d.ENQ="",d.ACK="",d.BEL="\x07",d.BS="\b",d.HT="	",d.LF=`
`,d.VT="\v",d.FF="\f",d.CR="\r",d.SO="",d.SI="",d.DLE="",d.DC1="",d.DC2="",d.DC3="",d.DC4="",d.NAK="",d.SYN="",d.ETB="",d.CAN="",d.EM="",d.SUB="",d.ESC="\x1B",d.FS="",d.GS="",d.RS="",d.US="",d.SP=" ",d.DEL=""}(l||(a.C0=l={})),function(d){d.PAD="",d.HOP="",d.BPH="",d.NBH="",d.IND="",d.NEL="",d.SSA="",d.ESA="",d.HTS="",d.HTJ="",d.VTS="",d.PLD="",d.PLU="",d.RI="",d.SS2="",d.SS3="",d.DCS="",d.PU1="",d.PU2="",d.STS="",d.CCH="",d.MW="",d.SPA="",d.EPA="",d.SOS="",d.SGCI="",d.SCI="",d.CSI="",d.ST="",d.OSC="",d.PM="",d.APC=""}(c||(a.C1=c={})),function(d){d.ST=`${l.ESC}\\`}(u||(a.C1_ESCAPED=u={}))},7399:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.evaluateKeyboardEvent=void 0;const c=l(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};a.evaluateKeyboardEvent=function(d,h,f,v){const m={type:0,cancel:!1,key:void 0},p=(d.shiftKey?1:0)|(d.altKey?2:0)|(d.ctrlKey?4:0)|(d.metaKey?8:0);switch(d.keyCode){case 0:d.key==="UIKeyInputUpArrow"?m.key=h?c.C0.ESC+"OA":c.C0.ESC+"[A":d.key==="UIKeyInputLeftArrow"?m.key=h?c.C0.ESC+"OD":c.C0.ESC+"[D":d.key==="UIKeyInputRightArrow"?m.key=h?c.C0.ESC+"OC":c.C0.ESC+"[C":d.key==="UIKeyInputDownArrow"&&(m.key=h?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:m.key=d.ctrlKey?"\b":c.C0.DEL,d.altKey&&(m.key=c.C0.ESC+m.key);break;case 9:if(d.shiftKey){m.key=c.C0.ESC+"[Z";break}m.key=c.C0.HT,m.cancel=!0;break;case 13:m.key=d.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,m.cancel=!0;break;case 27:m.key=c.C0.ESC,d.altKey&&(m.key=c.C0.ESC+c.C0.ESC),m.cancel=!0;break;case 37:if(d.metaKey)break;p?(m.key=c.C0.ESC+"[1;"+(p+1)+"D",m.key===c.C0.ESC+"[1;3D"&&(m.key=c.C0.ESC+(f?"b":"[1;5D"))):m.key=h?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(d.metaKey)break;p?(m.key=c.C0.ESC+"[1;"+(p+1)+"C",m.key===c.C0.ESC+"[1;3C"&&(m.key=c.C0.ESC+(f?"f":"[1;5C"))):m.key=h?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(d.metaKey)break;p?(m.key=c.C0.ESC+"[1;"+(p+1)+"A",f||m.key!==c.C0.ESC+"[1;3A"||(m.key=c.C0.ESC+"[1;5A")):m.key=h?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(d.metaKey)break;p?(m.key=c.C0.ESC+"[1;"+(p+1)+"B",f||m.key!==c.C0.ESC+"[1;3B"||(m.key=c.C0.ESC+"[1;5B")):m.key=h?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:d.shiftKey||d.ctrlKey||(m.key=c.C0.ESC+"[2~");break;case 46:m.key=p?c.C0.ESC+"[3;"+(p+1)+"~":c.C0.ESC+"[3~";break;case 36:m.key=p?c.C0.ESC+"[1;"+(p+1)+"H":h?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:m.key=p?c.C0.ESC+"[1;"+(p+1)+"F":h?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:d.shiftKey?m.type=2:d.ctrlKey?m.key=c.C0.ESC+"[5;"+(p+1)+"~":m.key=c.C0.ESC+"[5~";break;case 34:d.shiftKey?m.type=3:d.ctrlKey?m.key=c.C0.ESC+"[6;"+(p+1)+"~":m.key=c.C0.ESC+"[6~";break;case 112:m.key=p?c.C0.ESC+"[1;"+(p+1)+"P":c.C0.ESC+"OP";break;case 113:m.key=p?c.C0.ESC+"[1;"+(p+1)+"Q":c.C0.ESC+"OQ";break;case 114:m.key=p?c.C0.ESC+"[1;"+(p+1)+"R":c.C0.ESC+"OR";break;case 115:m.key=p?c.C0.ESC+"[1;"+(p+1)+"S":c.C0.ESC+"OS";break;case 116:m.key=p?c.C0.ESC+"[15;"+(p+1)+"~":c.C0.ESC+"[15~";break;case 117:m.key=p?c.C0.ESC+"[17;"+(p+1)+"~":c.C0.ESC+"[17~";break;case 118:m.key=p?c.C0.ESC+"[18;"+(p+1)+"~":c.C0.ESC+"[18~";break;case 119:m.key=p?c.C0.ESC+"[19;"+(p+1)+"~":c.C0.ESC+"[19~";break;case 120:m.key=p?c.C0.ESC+"[20;"+(p+1)+"~":c.C0.ESC+"[20~";break;case 121:m.key=p?c.C0.ESC+"[21;"+(p+1)+"~":c.C0.ESC+"[21~";break;case 122:m.key=p?c.C0.ESC+"[23;"+(p+1)+"~":c.C0.ESC+"[23~";break;case 123:m.key=p?c.C0.ESC+"[24;"+(p+1)+"~":c.C0.ESC+"[24~";break;default:if(!d.ctrlKey||d.shiftKey||d.altKey||d.metaKey)if(f&&!v||!d.altKey||d.metaKey)!f||d.altKey||d.ctrlKey||d.shiftKey||!d.metaKey?d.key&&!d.ctrlKey&&!d.altKey&&!d.metaKey&&d.keyCode>=48&&d.key.length===1?m.key=d.key:d.key&&d.ctrlKey&&(d.key==="_"&&(m.key=c.C0.US),d.key==="@"&&(m.key=c.C0.NUL)):d.keyCode===65&&(m.type=1);else{const g=u[d.keyCode],y=g?.[d.shiftKey?1:0];if(y)m.key=c.C0.ESC+y;else if(d.keyCode>=65&&d.keyCode<=90){const _=d.ctrlKey?d.keyCode-64:d.keyCode+32;let b=String.fromCharCode(_);d.shiftKey&&(b=b.toUpperCase()),m.key=c.C0.ESC+b}else if(d.keyCode===32)m.key=c.C0.ESC+(d.ctrlKey?c.C0.NUL:" ");else if(d.key==="Dead"&&d.code.startsWith("Key")){let _=d.code.slice(3,4);d.shiftKey||(_=_.toLowerCase()),m.key=c.C0.ESC+_,m.cancel=!0}}else d.keyCode>=65&&d.keyCode<=90?m.key=String.fromCharCode(d.keyCode-64):d.keyCode===32?m.key=c.C0.NUL:d.keyCode>=51&&d.keyCode<=55?m.key=String.fromCharCode(d.keyCode-51+27):d.keyCode===56?m.key=c.C0.DEL:d.keyCode===219?m.key=c.C0.ESC:d.keyCode===220?m.key=c.C0.FS:d.keyCode===221&&(m.key=c.C0.GS)}return m}},482:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Utf8ToUtf32=a.StringToUtf32=a.utf32ToString=a.stringFromCodePoint=void 0,a.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},a.utf32ToString=function(l,c=0,u=l.length){let d="";for(let h=c;h<u;++h){let f=l[h];f>65535?(f-=65536,d+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):d+=String.fromCharCode(f)}return d},a.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,c){const u=l.length;if(!u)return 0;let d=0,h=0;if(this._interim){const f=l.charCodeAt(h++);56320<=f&&f<=57343?c[d++]=1024*(this._interim-55296)+f-56320+65536:(c[d++]=this._interim,c[d++]=f),this._interim=0}for(let f=h;f<u;++f){const v=l.charCodeAt(f);if(55296<=v&&v<=56319){if(++f>=u)return this._interim=v,d;const m=l.charCodeAt(f);56320<=m&&m<=57343?c[d++]=1024*(v-55296)+m-56320+65536:(c[d++]=v,c[d++]=m)}else v!==65279&&(c[d++]=v)}return d}},a.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,c){const u=l.length;if(!u)return 0;let d,h,f,v,m=0,p=0,g=0;if(this.interim[0]){let b=!1,w=this.interim[0];w&=(224&w)==192?31:(240&w)==224?15:7;let E,S=0;for(;(E=63&this.interim[++S])&&S<4;)w<<=6,w|=E;const x=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,T=x-S;for(;g<T;){if(g>=u)return 0;if(E=l[g++],(192&E)!=128){g--,b=!0;break}this.interim[S++]=E,w<<=6,w|=63&E}b||(x===2?w<128?g--:c[m++]=w:x===3?w<2048||w>=55296&&w<=57343||w===65279||(c[m++]=w):w<65536||w>1114111||(c[m++]=w)),this.interim.fill(0)}const y=u-4;let _=g;for(;_<u;){for(;!(!(_<y)||128&(d=l[_])||128&(h=l[_+1])||128&(f=l[_+2])||128&(v=l[_+3]));)c[m++]=d,c[m++]=h,c[m++]=f,c[m++]=v,_+=4;if(d=l[_++],d<128)c[m++]=d;else if((224&d)==192){if(_>=u)return this.interim[0]=d,m;if(h=l[_++],(192&h)!=128){_--;continue}if(p=(31&d)<<6|63&h,p<128){_--;continue}c[m++]=p}else if((240&d)==224){if(_>=u)return this.interim[0]=d,m;if(h=l[_++],(192&h)!=128){_--;continue}if(_>=u)return this.interim[0]=d,this.interim[1]=h,m;if(f=l[_++],(192&f)!=128){_--;continue}if(p=(15&d)<<12|(63&h)<<6|63&f,p<2048||p>=55296&&p<=57343||p===65279)continue;c[m++]=p}else if((248&d)==240){if(_>=u)return this.interim[0]=d,m;if(h=l[_++],(192&h)!=128){_--;continue}if(_>=u)return this.interim[0]=d,this.interim[1]=h,m;if(f=l[_++],(192&f)!=128){_--;continue}if(_>=u)return this.interim[0]=d,this.interim[1]=h,this.interim[2]=f,m;if(v=l[_++],(192&v)!=128){_--;continue}if(p=(7&d)<<18|(63&h)<<12|(63&f)<<6|63&v,p<65536||p>1114111)continue;c[m++]=p}}return m}}},225:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeV6=void 0;const c=l(1480),u=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],d=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let h;a.UnicodeV6=class{constructor(){if(this.version="6",!h){h=new Uint8Array(65536),h.fill(1),h[0]=0,h.fill(0,1,32),h.fill(0,127,160),h.fill(2,4352,4448),h[9001]=2,h[9002]=2,h.fill(2,11904,42192),h[12351]=1,h.fill(2,44032,55204),h.fill(2,63744,64256),h.fill(2,65040,65050),h.fill(2,65072,65136),h.fill(2,65280,65377),h.fill(2,65504,65511);for(let f=0;f<u.length;++f)h.fill(0,u[f][0],u[f][1]+1)}}wcwidth(f){return f<32?0:f<127?1:f<65536?h[f]:function(v,m){let p,g=0,y=m.length-1;if(v<m[0][0]||v>m[y][1])return!1;for(;y>=g;)if(p=g+y>>1,v>m[p][1])g=p+1;else{if(!(v<m[p][0]))return!0;y=p-1}return!1}(f,d)?0:f>=131072&&f<=196605||f>=196608&&f<=262141?2:1}charProperties(f,v){let m=this.wcwidth(f),p=m===0&&v!==0;if(p){const g=c.UnicodeService.extractWidth(v);g===0?p=!1:g>m&&(m=g)}return c.UnicodeService.createPropertyValue(0,m,p)}}},5981:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WriteBuffer=void 0;const c=l(8460),u=l(844);class d extends u.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,v){if(v!==void 0&&this._syncCalls>v)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let m;for(this._isSyncWriting=!0;m=this._writeBuffer.shift();){this._action(m);const p=this._callbacks.shift();p&&p()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,v){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(v),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(v)}_innerWrite(f=0,v=!0){const m=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const p=this._writeBuffer[this._bufferOffset],g=this._action(p,v);if(g){const _=b=>Date.now()-m>=12?setTimeout(()=>this._innerWrite(0,b)):this._innerWrite(m,b);return void g.catch(b=>(queueMicrotask(()=>{throw b}),Promise.resolve(!1))).then(_)}const y=this._callbacks[this._bufferOffset];if(y&&y(),this._bufferOffset++,this._pendingData-=p.length,Date.now()-m>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}a.WriteBuffer=d},5941:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.toRgbString=a.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function u(d,h){const f=d.toString(16),v=f.length<2?"0"+f:f;switch(h){case 4:return f[0];case 8:return v;case 12:return(v+v).slice(0,3);default:return v+v}}a.parseColor=function(d){if(!d)return;let h=d.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const f=l.exec(h);if(f){const v=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/v*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/v*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/v*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),c.exec(h)&&[3,6,9,12].includes(h.length))){const f=h.length/3,v=[0,0,0];for(let m=0;m<3;++m){const p=parseInt(h.slice(f*m,f*m+f),16);v[m]=f===1?p<<4:f===2?p:f===3?p>>4:p>>8}return v}},a.toRgbString=function(d,h=16){const[f,v,m]=d;return`rgb:${u(f,h)}/${u(v,h)}/${u(m,h)}`}},5770:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PAYLOAD_LIMIT=void 0,a.PAYLOAD_LIMIT=1e7},6351:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DcsHandler=a.DcsParser=void 0;const c=l(482),u=l(8742),d=l(5770),h=[];a.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(v,m){this._handlers[v]===void 0&&(this._handlers[v]=[]);const p=this._handlers[v];return p.push(m),{dispose:()=>{const g=p.indexOf(m);g!==-1&&p.splice(g,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}reset(){if(this._active.length)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(v,m){if(this.reset(),this._ident=v,this._active=this._handlers[v]||h,this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].hook(m);else this._handlerFb(this._ident,"HOOK",m)}put(v,m,p){if(this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].put(v,m,p);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(v,m,p))}unhook(v,m=!0){if(this._active.length){let p=!1,g=this._active.length-1,y=!1;if(this._stack.paused&&(g=this._stack.loopPosition-1,p=m,y=this._stack.fallThrough,this._stack.paused=!1),!y&&p===!1){for(;g>=0&&(p=this._active[g].unhook(v),p!==!0);g--)if(p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=g,this._stack.fallThrough=!1,p;g--}for(;g>=0;g--)if(p=this._active[g].unhook(!1),p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=g,this._stack.fallThrough=!0,p}else this._handlerFb(this._ident,"UNHOOK",v);this._active=h,this._ident=0}};const f=new u.Params;f.addParam(0),a.DcsHandler=class{constructor(v){this._handler=v,this._data="",this._params=f,this._hitLimit=!1}hook(v){this._params=v.length>1||v.params[0]?v.clone():f,this._data="",this._hitLimit=!1}put(v,m,p){this._hitLimit||(this._data+=(0,c.utf32ToString)(v,m,p),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(v){let m=!1;if(this._hitLimit)m=!1;else if(v&&(m=this._handler(this._data,this._params),m instanceof Promise))return m.then(p=>(this._params=f,this._data="",this._hitLimit=!1,p));return this._params=f,this._data="",this._hitLimit=!1,m}}},2015:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.EscapeSequenceParser=a.VT500_TRANSITION_TABLE=a.TransitionTable=void 0;const c=l(844),u=l(8742),d=l(6242),h=l(6351);class f{constructor(g){this.table=new Uint8Array(g)}setDefault(g,y){this.table.fill(g<<4|y)}add(g,y,_,b){this.table[y<<8|g]=_<<4|b}addMany(g,y,_,b){for(let w=0;w<g.length;w++)this.table[y<<8|g[w]]=_<<4|b}}a.TransitionTable=f;const v=160;a.VT500_TRANSITION_TABLE=function(){const p=new f(4095),g=Array.apply(null,Array(256)).map((S,x)=>x),y=(S,x)=>g.slice(S,x),_=y(32,127),b=y(0,24);b.push(25),b.push.apply(b,y(28,32));const w=y(0,14);let E;for(E in p.setDefault(1,0),p.addMany(_,0,2,0),w)p.addMany([24,26,153,154],E,3,0),p.addMany(y(128,144),E,3,0),p.addMany(y(144,152),E,3,0),p.add(156,E,0,0),p.add(27,E,11,1),p.add(157,E,4,8),p.addMany([152,158,159],E,0,7),p.add(155,E,11,3),p.add(144,E,11,9);return p.addMany(b,0,3,0),p.addMany(b,1,3,1),p.add(127,1,0,1),p.addMany(b,8,0,8),p.addMany(b,3,3,3),p.add(127,3,0,3),p.addMany(b,4,3,4),p.add(127,4,0,4),p.addMany(b,6,3,6),p.addMany(b,5,3,5),p.add(127,5,0,5),p.addMany(b,2,3,2),p.add(127,2,0,2),p.add(93,1,4,8),p.addMany(_,8,5,8),p.add(127,8,5,8),p.addMany([156,27,24,26,7],8,6,0),p.addMany(y(28,32),8,0,8),p.addMany([88,94,95],1,0,7),p.addMany(_,7,0,7),p.addMany(b,7,0,7),p.add(156,7,0,0),p.add(127,7,0,7),p.add(91,1,11,3),p.addMany(y(64,127),3,7,0),p.addMany(y(48,60),3,8,4),p.addMany([60,61,62,63],3,9,4),p.addMany(y(48,60),4,8,4),p.addMany(y(64,127),4,7,0),p.addMany([60,61,62,63],4,0,6),p.addMany(y(32,64),6,0,6),p.add(127,6,0,6),p.addMany(y(64,127),6,0,0),p.addMany(y(32,48),3,9,5),p.addMany(y(32,48),5,9,5),p.addMany(y(48,64),5,0,6),p.addMany(y(64,127),5,7,0),p.addMany(y(32,48),4,9,5),p.addMany(y(32,48),1,9,2),p.addMany(y(32,48),2,9,2),p.addMany(y(48,127),2,10,0),p.addMany(y(48,80),1,10,0),p.addMany(y(81,88),1,10,0),p.addMany([89,90,92],1,10,0),p.addMany(y(96,127),1,10,0),p.add(80,1,11,9),p.addMany(b,9,0,9),p.add(127,9,0,9),p.addMany(y(28,32),9,0,9),p.addMany(y(32,48),9,9,12),p.addMany(y(48,60),9,8,10),p.addMany([60,61,62,63],9,9,10),p.addMany(b,11,0,11),p.addMany(y(32,128),11,0,11),p.addMany(y(28,32),11,0,11),p.addMany(b,10,0,10),p.add(127,10,0,10),p.addMany(y(28,32),10,0,10),p.addMany(y(48,60),10,8,10),p.addMany([60,61,62,63],10,0,11),p.addMany(y(32,48),10,9,12),p.addMany(b,12,0,12),p.add(127,12,0,12),p.addMany(y(28,32),12,0,12),p.addMany(y(32,48),12,9,12),p.addMany(y(48,64),12,0,11),p.addMany(y(64,127),12,12,13),p.addMany(y(64,127),10,12,13),p.addMany(y(64,127),9,12,13),p.addMany(b,13,13,13),p.addMany(_,13,13,13),p.add(127,13,0,13),p.addMany([27,156,24,26],13,14,0),p.add(v,0,2,0),p.add(v,8,5,8),p.add(v,6,0,6),p.add(v,11,0,11),p.add(v,13,13,13),p}();class m extends c.Disposable{constructor(g=a.VT500_TRANSITION_TABLE){super(),this._transitions=g,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new u.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(y,_,b)=>{},this._executeHandlerFb=y=>{},this._csiHandlerFb=(y,_)=>{},this._escHandlerFb=y=>{},this._errorHandlerFb=y=>y,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new d.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(g,y=[64,126]){let _=0;if(g.prefix){if(g.prefix.length>1)throw new Error("only one byte as prefix supported");if(_=g.prefix.charCodeAt(0),_&&60>_||_>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(g.intermediates){if(g.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let w=0;w<g.intermediates.length;++w){const E=g.intermediates.charCodeAt(w);if(32>E||E>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");_<<=8,_|=E}}if(g.final.length!==1)throw new Error("final must be a single byte");const b=g.final.charCodeAt(0);if(y[0]>b||b>y[1])throw new Error(`final must be in range ${y[0]} .. ${y[1]}`);return _<<=8,_|=b,_}identToString(g){const y=[];for(;g;)y.push(String.fromCharCode(255&g)),g>>=8;return y.reverse().join("")}setPrintHandler(g){this._printHandler=g}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(g,y){const _=this._identifier(g,[48,126]);this._escHandlers[_]===void 0&&(this._escHandlers[_]=[]);const b=this._escHandlers[_];return b.push(y),{dispose:()=>{const w=b.indexOf(y);w!==-1&&b.splice(w,1)}}}clearEscHandler(g){this._escHandlers[this._identifier(g,[48,126])]&&delete this._escHandlers[this._identifier(g,[48,126])]}setEscHandlerFallback(g){this._escHandlerFb=g}setExecuteHandler(g,y){this._executeHandlers[g.charCodeAt(0)]=y}clearExecuteHandler(g){this._executeHandlers[g.charCodeAt(0)]&&delete this._executeHandlers[g.charCodeAt(0)]}setExecuteHandlerFallback(g){this._executeHandlerFb=g}registerCsiHandler(g,y){const _=this._identifier(g);this._csiHandlers[_]===void 0&&(this._csiHandlers[_]=[]);const b=this._csiHandlers[_];return b.push(y),{dispose:()=>{const w=b.indexOf(y);w!==-1&&b.splice(w,1)}}}clearCsiHandler(g){this._csiHandlers[this._identifier(g)]&&delete this._csiHandlers[this._identifier(g)]}setCsiHandlerFallback(g){this._csiHandlerFb=g}registerDcsHandler(g,y){return this._dcsParser.registerHandler(this._identifier(g),y)}clearDcsHandler(g){this._dcsParser.clearHandler(this._identifier(g))}setDcsHandlerFallback(g){this._dcsParser.setHandlerFallback(g)}registerOscHandler(g,y){return this._oscParser.registerHandler(g,y)}clearOscHandler(g){this._oscParser.clearHandler(g)}setOscHandlerFallback(g){this._oscParser.setHandlerFallback(g)}setErrorHandler(g){this._errorHandler=g}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(g,y,_,b,w){this._parseStack.state=g,this._parseStack.handlers=y,this._parseStack.handlerPos=_,this._parseStack.transition=b,this._parseStack.chunkPos=w}parse(g,y,_){let b,w=0,E=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(_===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const x=this._parseStack.handlers;let T=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(_===!1&&T>-1){for(;T>=0&&(b=x[T](this._params),b!==!0);T--)if(b instanceof Promise)return this._parseStack.handlerPos=T,b}this._parseStack.handlers=[];break;case 4:if(_===!1&&T>-1){for(;T>=0&&(b=x[T](),b!==!0);T--)if(b instanceof Promise)return this._parseStack.handlerPos=T,b}this._parseStack.handlers=[];break;case 6:if(w=g[this._parseStack.chunkPos],b=this._dcsParser.unhook(w!==24&&w!==26,_),b)return b;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(w=g[this._parseStack.chunkPos],b=this._oscParser.end(w!==24&&w!==26,_),b)return b;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let x=S;x<y;++x){switch(w=g[x],E=this._transitions.table[this.currentState<<8|(w<160?w:v)],E>>4){case 2:for(let P=x+1;;++P){if(P>=y||(w=g[P])<32||w>126&&w<v){this._printHandler(g,x,P),x=P-1;break}if(++P>=y||(w=g[P])<32||w>126&&w<v){this._printHandler(g,x,P),x=P-1;break}if(++P>=y||(w=g[P])<32||w>126&&w<v){this._printHandler(g,x,P),x=P-1;break}if(++P>=y||(w=g[P])<32||w>126&&w<v){this._printHandler(g,x,P),x=P-1;break}}break;case 3:this._executeHandlers[w]?this._executeHandlers[w]():this._executeHandlerFb(w),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:x,code:w,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const T=this._csiHandlers[this._collect<<8|w];let D=T?T.length-1:-1;for(;D>=0&&(b=T[D](this._params),b!==!0);D--)if(b instanceof Promise)return this._preserveStack(3,T,D,E,x),b;D<0&&this._csiHandlerFb(this._collect<<8|w,this._params),this.precedingJoinState=0;break;case 8:do switch(w){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(w-48)}while(++x<y&&(w=g[x])>47&&w<60);x--;break;case 9:this._collect<<=8,this._collect|=w;break;case 10:const O=this._escHandlers[this._collect<<8|w];let R=O?O.length-1:-1;for(;R>=0&&(b=O[R](),b!==!0);R--)if(b instanceof Promise)return this._preserveStack(4,O,R,E,x),b;R<0&&this._escHandlerFb(this._collect<<8|w),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|w,this._params);break;case 13:for(let P=x+1;;++P)if(P>=y||(w=g[P])===24||w===26||w===27||w>127&&w<v){this._dcsParser.put(g,x,P),x=P-1;break}break;case 14:if(b=this._dcsParser.unhook(w!==24&&w!==26),b)return this._preserveStack(6,[],0,E,x),b;w===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let P=x+1;;P++)if(P>=y||(w=g[P])<32||w>127&&w<v){this._oscParser.put(g,x,P),x=P-1;break}break;case 6:if(b=this._oscParser.end(w!==24&&w!==26),b)return this._preserveStack(5,[],0,E,x),b;w===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&E}}}a.EscapeSequenceParser=m},6242:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OscHandler=a.OscParser=void 0;const c=l(5770),u=l(482),d=[];a.OscParser=class{constructor(){this._state=0,this._active=d,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,f){this._handlers[h]===void 0&&(this._handlers[h]=[]);const v=this._handlers[h];return v.push(f),{dispose:()=>{const m=v.indexOf(f);m!==-1&&v.splice(m,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=d,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||d,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,f,v){if(this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].put(h,f,v);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(h,f,v))}start(){this.reset(),this._state=1}put(h,f,v){if(this._state!==3){if(this._state===1)for(;f<v;){const m=h[f++];if(m===59){this._state=2,this._start();break}if(m<48||57<m)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+m-48}this._state===2&&v-f>0&&this._put(h,f,v)}}end(h,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let v=!1,m=this._active.length-1,p=!1;if(this._stack.paused&&(m=this._stack.loopPosition-1,v=f,p=this._stack.fallThrough,this._stack.paused=!1),!p&&v===!1){for(;m>=0&&(v=this._active[m].end(h),v!==!0);m--)if(v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!1,v;m--}for(;m>=0;m--)if(v=this._active[m].end(!1),v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!0,v}else this._handlerFb(this._id,"END",h);this._active=d,this._id=-1,this._state=0}}},a.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,f,v){this._hitLimit||(this._data+=(0,u.utf32ToString)(h,f,v),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let f=!1;if(this._hitLimit)f=!1;else if(h&&(f=this._handler(this._data),f instanceof Promise))return f.then(v=>(this._data="",this._hitLimit=!1,v));return this._data="",this._hitLimit=!1,f}}},8742:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Params=void 0;const l=2147483647;class c{static fromArray(d){const h=new c;if(!d.length)return h;for(let f=Array.isArray(d[0])?1:0;f<d.length;++f){const v=d[f];if(Array.isArray(v))for(let m=0;m<v.length;++m)h.addSubParam(v[m]);else h.addParam(v)}return h}constructor(d=32,h=32){if(this.maxLength=d,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(d),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(d),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const d=new c(this.maxLength,this.maxSubParamsLength);return d.params.set(this.params),d.length=this.length,d._subParams.set(this._subParams),d._subParamsLength=this._subParamsLength,d._subParamsIdx.set(this._subParamsIdx),d._rejectDigits=this._rejectDigits,d._rejectSubDigits=this._rejectSubDigits,d._digitIsSub=this._digitIsSub,d}toArray(){const d=[];for(let h=0;h<this.length;++h){d.push(this.params[h]);const f=this._subParamsIdx[h]>>8,v=255&this._subParamsIdx[h];v-f>0&&d.push(Array.prototype.slice.call(this._subParams,f,v))}return d}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(d){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=d>l?l:d}}addSubParam(d){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=d>l?l:d,this._subParamsIdx[this.length-1]++}}hasSubParams(d){return(255&this._subParamsIdx[d])-(this._subParamsIdx[d]>>8)>0}getSubParams(d){const h=this._subParamsIdx[d]>>8,f=255&this._subParamsIdx[d];return f-h>0?this._subParams.subarray(h,f):null}getSubParamsAll(){const d={};for(let h=0;h<this.length;++h){const f=this._subParamsIdx[h]>>8,v=255&this._subParamsIdx[h];v-f>0&&(d[h]=this._subParams.slice(f,v))}return d}addDigit(d){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const f=this._digitIsSub?this._subParams:this.params,v=f[h-1];f[h-1]=~v?Math.min(10*v+d,l):d}}a.Params=c},5741:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.AddonManager=void 0,a.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,c){const u={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(u),c.dispose=()=>this._wrappedAddonDispose(u),c.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let c=-1;for(let u=0;u<this._addons.length;u++)if(this._addons[u]===l){c=u;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(c,1)}}},8771:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferApiView=void 0;const c=l(3785),u=l(511);a.BufferApiView=class{constructor(d,h){this._buffer=d,this.type=h}init(d){return this._buffer=d,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(d){const h=this._buffer.lines.get(d);if(h)return new c.BufferLineApiView(h)}getNullCell(){return new u.CellData}}},3785:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferLineApiView=void 0;const c=l(511);a.BufferLineApiView=class{constructor(u){this._line=u}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(u,d){if(!(u<0||u>=this._line.length))return d?(this._line.loadCell(u,d),d):this._line.loadCell(u,new c.CellData)}translateToString(u,d,h){return this._line.translateToString(u,d,h)}}},8285:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferNamespaceApi=void 0;const c=l(8771),u=l(8460),d=l(844);class h extends d.Disposable{constructor(v){super(),this._core=v,this._onBufferChange=this.register(new u.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}a.BufferNamespaceApi=h},7975:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ParserApi=void 0,a.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,c){return this._core.registerCsiHandler(l,u=>c(u.toArray()))}addCsiHandler(l,c){return this.registerCsiHandler(l,c)}registerDcsHandler(l,c){return this._core.registerDcsHandler(l,(u,d)=>c(u,d.toArray()))}addDcsHandler(l,c){return this.registerDcsHandler(l,c)}registerEscHandler(l,c){return this._core.registerEscHandler(l,c)}addEscHandler(l,c){return this.registerEscHandler(l,c)}registerOscHandler(l,c){return this._core.registerOscHandler(l,c)}addOscHandler(l,c){return this.registerOscHandler(l,c)}}},7090:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeApi=void 0,a.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(o,a,l){var c=this&&this.__decorate||function(p,g,y,_){var b,w=arguments.length,E=w<3?g:_===null?_=Object.getOwnPropertyDescriptor(g,y):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(p,g,y,_);else for(var S=p.length-1;S>=0;S--)(b=p[S])&&(E=(w<3?b(E):w>3?b(g,y,E):b(g,y))||E);return w>3&&E&&Object.defineProperty(g,y,E),E},u=this&&this.__param||function(p,g){return function(y,_){g(y,_,p)}};Object.defineProperty(a,"__esModule",{value:!0}),a.BufferService=a.MINIMUM_ROWS=a.MINIMUM_COLS=void 0;const d=l(8460),h=l(844),f=l(5295),v=l(2585);a.MINIMUM_COLS=2,a.MINIMUM_ROWS=1;let m=a.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(p){super(),this.isUserScrolling=!1,this._onResize=this.register(new d.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new d.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(p.rawOptions.cols||0,a.MINIMUM_COLS),this.rows=Math.max(p.rawOptions.rows||0,a.MINIMUM_ROWS),this.buffers=this.register(new f.BufferSet(p,this))}resize(p,g){this.cols=p,this.rows=g,this.buffers.resize(p,g),this._onResize.fire({cols:p,rows:g})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(p,g=!1){const y=this.buffer;let _;_=this._cachedBlankLine,_&&_.length===this.cols&&_.getFg(0)===p.fg&&_.getBg(0)===p.bg||(_=y.getBlankLine(p,g),this._cachedBlankLine=_),_.isWrapped=g;const b=y.ybase+y.scrollTop,w=y.ybase+y.scrollBottom;if(y.scrollTop===0){const E=y.lines.isFull;w===y.lines.length-1?E?y.lines.recycle().copyFrom(_):y.lines.push(_.clone()):y.lines.splice(w+1,0,_.clone()),E?this.isUserScrolling&&(y.ydisp=Math.max(y.ydisp-1,0)):(y.ybase++,this.isUserScrolling||y.ydisp++)}else{const E=w-b+1;y.lines.shiftElements(b+1,E-1,-1),y.lines.set(w,_.clone())}this.isUserScrolling||(y.ydisp=y.ybase),this._onScroll.fire(y.ydisp)}scrollLines(p,g,y){const _=this.buffer;if(p<0){if(_.ydisp===0)return;this.isUserScrolling=!0}else p+_.ydisp>=_.ybase&&(this.isUserScrolling=!1);const b=_.ydisp;_.ydisp=Math.max(Math.min(_.ydisp+p,_.ybase),0),b!==_.ydisp&&(g||this._onScroll.fire(_.ydisp))}};a.BufferService=m=c([u(0,v.IOptionsService)],m)},7994:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CharsetService=void 0,a.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,c){this._charsets[l]=c,this.glevel===l&&(this.charset=c)}}},1753:function(o,a,l){var c=this&&this.__decorate||function(_,b,w,E){var S,x=arguments.length,T=x<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,w):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(_,b,w,E);else for(var D=_.length-1;D>=0;D--)(S=_[D])&&(T=(x<3?S(T):x>3?S(b,w,T):S(b,w))||T);return x>3&&T&&Object.defineProperty(b,w,T),T},u=this&&this.__param||function(_,b){return function(w,E){b(w,E,_)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CoreMouseService=void 0;const d=l(2585),h=l(8460),f=l(844),v={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:_=>_.button!==4&&_.action===1&&(_.ctrl=!1,_.alt=!1,_.shift=!1,!0)},VT200:{events:19,restrict:_=>_.action!==32},DRAG:{events:23,restrict:_=>_.action!==32||_.button!==3},ANY:{events:31,restrict:_=>!0}};function m(_,b){let w=(_.ctrl?16:0)|(_.shift?4:0)|(_.alt?8:0);return _.button===4?(w|=64,w|=_.action):(w|=3&_.button,4&_.button&&(w|=64),8&_.button&&(w|=128),_.action===32?w|=32:_.action!==0||b||(w|=3)),w}const p=String.fromCharCode,g={DEFAULT:_=>{const b=[m(_,!1)+32,_.col+32,_.row+32];return b[0]>255||b[1]>255||b[2]>255?"":`\x1B[M${p(b[0])}${p(b[1])}${p(b[2])}`},SGR:_=>{const b=_.action===0&&_.button!==4?"m":"M";return`\x1B[<${m(_,!0)};${_.col};${_.row}${b}`},SGR_PIXELS:_=>{const b=_.action===0&&_.button!==4?"m":"M";return`\x1B[<${m(_,!0)};${_.x};${_.y}${b}`}};let y=a.CoreMouseService=class extends f.Disposable{constructor(_,b){super(),this._bufferService=_,this._coreService=b,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const w of Object.keys(v))this.addProtocol(w,v[w]);for(const w of Object.keys(g))this.addEncoding(w,g[w]);this.reset()}addProtocol(_,b){this._protocols[_]=b}addEncoding(_,b){this._encodings[_]=b}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(_){if(!this._protocols[_])throw new Error(`unknown protocol "${_}"`);this._activeProtocol=_,this._onProtocolChange.fire(this._protocols[_].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(_){if(!this._encodings[_])throw new Error(`unknown encoding "${_}"`);this._activeEncoding=_}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(_){if(_.col<0||_.col>=this._bufferService.cols||_.row<0||_.row>=this._bufferService.rows||_.button===4&&_.action===32||_.button===3&&_.action!==32||_.button!==4&&(_.action===2||_.action===3)||(_.col++,_.row++,_.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,_,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(_))return!1;const b=this._encodings[this._activeEncoding](_);return b&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(b):this._coreService.triggerDataEvent(b,!0)),this._lastEvent=_,!0}explainEvents(_){return{down:!!(1&_),up:!!(2&_),drag:!!(4&_),move:!!(8&_),wheel:!!(16&_)}}_equalEvents(_,b,w){if(w){if(_.x!==b.x||_.y!==b.y)return!1}else if(_.col!==b.col||_.row!==b.row)return!1;return _.button===b.button&&_.action===b.action&&_.ctrl===b.ctrl&&_.alt===b.alt&&_.shift===b.shift}};a.CoreMouseService=y=c([u(0,d.IBufferService),u(1,d.ICoreService)],y)},6975:function(o,a,l){var c=this&&this.__decorate||function(y,_,b,w){var E,S=arguments.length,x=S<3?_:w===null?w=Object.getOwnPropertyDescriptor(_,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,_,b,w);else for(var T=y.length-1;T>=0;T--)(E=y[T])&&(x=(S<3?E(x):S>3?E(_,b,x):E(_,b))||x);return S>3&&x&&Object.defineProperty(_,b,x),x},u=this&&this.__param||function(y,_){return function(b,w){_(b,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CoreService=void 0;const d=l(1439),h=l(8460),f=l(844),v=l(2585),m=Object.freeze({insertMode:!1}),p=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let g=a.CoreService=class extends f.Disposable{constructor(y,_,b){super(),this._bufferService=y,this._logService=_,this._optionsService=b,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,d.clone)(m),this.decPrivateModes=(0,d.clone)(p)}reset(){this.modes=(0,d.clone)(m),this.decPrivateModes=(0,d.clone)(p)}triggerDataEvent(y,_=!1){if(this._optionsService.rawOptions.disableStdin)return;const b=this._bufferService.buffer;_&&this._optionsService.rawOptions.scrollOnUserInput&&b.ybase!==b.ydisp&&this._onRequestScrollToBottom.fire(),_&&this._onUserInput.fire(),this._logService.debug(`sending data "${y}"`,()=>y.split("").map(w=>w.charCodeAt(0))),this._onData.fire(y)}triggerBinaryEvent(y){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${y}"`,()=>y.split("").map(_=>_.charCodeAt(0))),this._onBinary.fire(y))}};a.CoreService=g=c([u(0,v.IBufferService),u(1,v.ILogService),u(2,v.IOptionsService)],g)},9074:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DecorationService=void 0;const c=l(8055),u=l(8460),d=l(844),h=l(6106);let f=0,v=0;class m extends d.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(y=>y?.marker.line),this._onDecorationRegistered=this.register(new u.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new u.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,d.toDisposable)(()=>this.reset()))}registerDecoration(y){if(y.marker.isDisposed)return;const _=new p(y);if(_){const b=_.marker.onDispose(()=>_.dispose());_.onDispose(()=>{_&&(this._decorations.delete(_)&&this._onDecorationRemoved.fire(_),b.dispose())}),this._decorations.insert(_),this._onDecorationRegistered.fire(_)}return _}reset(){for(const y of this._decorations.values())y.dispose();this._decorations.clear()}*getDecorationsAtCell(y,_,b){let w=0,E=0;for(const S of this._decorations.getKeyIterator(_))w=S.options.x??0,E=w+(S.options.width??1),y>=w&&y<E&&(!b||(S.options.layer??"bottom")===b)&&(yield S)}forEachDecorationAtCell(y,_,b,w){this._decorations.forEachByKey(_,E=>{f=E.options.x??0,v=f+(E.options.width??1),y>=f&&y<v&&(!b||(E.options.layer??"bottom")===b)&&w(E)})}}a.DecorationService=m;class p extends d.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(y){super(),this.options=y,this.onRenderEmitter=this.register(new u.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=y.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.InstantiationService=a.ServiceCollection=void 0;const c=l(2585),u=l(8343);class d{constructor(...f){this._entries=new Map;for(const[v,m]of f)this.set(v,m)}set(f,v){const m=this._entries.get(f);return this._entries.set(f,v),m}forEach(f){for(const[v,m]of this._entries.entries())f(v,m)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}a.ServiceCollection=d,a.InstantiationService=class{constructor(){this._services=new d,this._services.set(c.IInstantiationService,this)}setService(h,f){this._services.set(h,f)}getService(h){return this._services.get(h)}createInstance(h,...f){const v=(0,u.getServiceDependencies)(h).sort((g,y)=>g.index-y.index),m=[];for(const g of v){const y=this._services.get(g.id);if(!y)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${g.id}.`);m.push(y)}const p=v.length>0?v[0].index:f.length;if(f.length!==p)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${p+1} conflicts with ${f.length} static arguments`);return new h(...f,...m)}}},7866:function(o,a,l){var c=this&&this.__decorate||function(p,g,y,_){var b,w=arguments.length,E=w<3?g:_===null?_=Object.getOwnPropertyDescriptor(g,y):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(p,g,y,_);else for(var S=p.length-1;S>=0;S--)(b=p[S])&&(E=(w<3?b(E):w>3?b(g,y,E):b(g,y))||E);return w>3&&E&&Object.defineProperty(g,y,E),E},u=this&&this.__param||function(p,g){return function(y,_){g(y,_,p)}};Object.defineProperty(a,"__esModule",{value:!0}),a.traceCall=a.setTraceLogger=a.LogService=void 0;const d=l(844),h=l(2585),f={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let v,m=a.LogService=class extends d.Disposable{get logLevel(){return this._logLevel}constructor(p){super(),this._optionsService=p,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),v=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(p){for(let g=0;g<p.length;g++)typeof p[g]=="function"&&(p[g]=p[g]())}_log(p,g,y){this._evalLazyOptionalParams(y),p.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+g,...y)}trace(p,...g){this._logLevel<=h.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,p,g)}debug(p,...g){this._logLevel<=h.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,p,g)}info(p,...g){this._logLevel<=h.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,p,g)}warn(p,...g){this._logLevel<=h.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,p,g)}error(p,...g){this._logLevel<=h.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,p,g)}};a.LogService=m=c([u(0,h.IOptionsService)],m),a.setTraceLogger=function(p){v=p},a.traceCall=function(p,g,y){if(typeof y.value!="function")throw new Error("not supported");const _=y.value;y.value=function(...b){if(v.logLevel!==h.LogLevelEnum.TRACE)return _.apply(this,b);v.trace(`GlyphRenderer#${_.name}(${b.map(E=>JSON.stringify(E)).join(", ")})`);const w=_.apply(this,b);return v.trace(`GlyphRenderer#${_.name} return`,w),w}}},7302:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OptionsService=a.DEFAULT_OPTIONS=void 0;const c=l(8460),u=l(844),d=l(6114);a.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:d.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends u.Disposable{constructor(m){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const p={...a.DEFAULT_OPTIONS};for(const g in m)if(g in p)try{const y=m[g];p[g]=this._sanitizeAndValidateOption(g,y)}catch(y){console.error(y)}this.rawOptions=p,this.options={...p},this._setupOptions(),this.register((0,u.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(m,p){return this.onOptionChange(g=>{g===m&&p(this.rawOptions[m])})}onMultipleOptionChange(m,p){return this.onOptionChange(g=>{m.indexOf(g)!==-1&&p()})}_setupOptions(){const m=g=>{if(!(g in a.DEFAULT_OPTIONS))throw new Error(`No option with key "${g}"`);return this.rawOptions[g]},p=(g,y)=>{if(!(g in a.DEFAULT_OPTIONS))throw new Error(`No option with key "${g}"`);y=this._sanitizeAndValidateOption(g,y),this.rawOptions[g]!==y&&(this.rawOptions[g]=y,this._onOptionChange.fire(g))};for(const g in this.rawOptions){const y={get:m.bind(this,g),set:p.bind(this,g)};Object.defineProperty(this.options,g,y)}}_sanitizeAndValidateOption(m,p){switch(m){case"cursorStyle":if(p||(p=a.DEFAULT_OPTIONS[m]),!function(g){return g==="block"||g==="underline"||g==="bar"}(p))throw new Error(`"${p}" is not a valid value for ${m}`);break;case"wordSeparator":p||(p=a.DEFAULT_OPTIONS[m]);break;case"fontWeight":case"fontWeightBold":if(typeof p=="number"&&1<=p&&p<=1e3)break;p=h.includes(p)?p:a.DEFAULT_OPTIONS[m];break;case"cursorWidth":p=Math.floor(p);case"lineHeight":case"tabStopWidth":if(p<1)throw new Error(`${m} cannot be less than 1, value: ${p}`);break;case"minimumContrastRatio":p=Math.max(1,Math.min(21,Math.round(10*p)/10));break;case"scrollback":if((p=Math.min(p,4294967295))<0)throw new Error(`${m} cannot be less than 0, value: ${p}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(p<=0)throw new Error(`${m} cannot be less than or equal to 0, value: ${p}`);break;case"rows":case"cols":if(!p&&p!==0)throw new Error(`${m} must be numeric, value: ${p}`);break;case"windowsPty":p=p??{}}return p}}a.OptionsService=f},2660:function(o,a,l){var c=this&&this.__decorate||function(f,v,m,p){var g,y=arguments.length,_=y<3?v:p===null?p=Object.getOwnPropertyDescriptor(v,m):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,v,m,p);else for(var b=f.length-1;b>=0;b--)(g=f[b])&&(_=(y<3?g(_):y>3?g(v,m,_):g(v,m))||_);return y>3&&_&&Object.defineProperty(v,m,_),_},u=this&&this.__param||function(f,v){return function(m,p){v(m,p,f)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OscLinkService=void 0;const d=l(2585);let h=a.OscLinkService=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){const v=this._bufferService.buffer;if(f.id===void 0){const b=v.addMarker(v.ybase+v.y),w={data:f,id:this._nextId++,lines:[b]};return b.onDispose(()=>this._removeMarkerFromLink(w,b)),this._dataByLinkId.set(w.id,w),w.id}const m=f,p=this._getEntryIdKey(m),g=this._entriesWithId.get(p);if(g)return this.addLineToLink(g.id,v.ybase+v.y),g.id;const y=v.addMarker(v.ybase+v.y),_={id:this._nextId++,key:this._getEntryIdKey(m),data:m,lines:[y]};return y.onDispose(()=>this._removeMarkerFromLink(_,y)),this._entriesWithId.set(_.key,_),this._dataByLinkId.set(_.id,_),_.id}addLineToLink(f,v){const m=this._dataByLinkId.get(f);if(m&&m.lines.every(p=>p.line!==v)){const p=this._bufferService.buffer.addMarker(v);m.lines.push(p),p.onDispose(()=>this._removeMarkerFromLink(m,p))}}getLinkData(f){return this._dataByLinkId.get(f)?.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,v){const m=f.lines.indexOf(v);m!==-1&&(f.lines.splice(m,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};a.OscLinkService=h=c([u(0,d.IBufferService)],h)},8343:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createDecorator=a.getServiceDependencies=a.serviceRegistry=void 0;const l="di$target",c="di$dependencies";a.serviceRegistry=new Map,a.getServiceDependencies=function(u){return u[c]||[]},a.createDecorator=function(u){if(a.serviceRegistry.has(u))return a.serviceRegistry.get(u);const d=function(h,f,v){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(m,p,g){p[l]===p?p[c].push({id:m,index:g}):(p[c]=[{id:m,index:g}],p[l]=p)})(d,h,v)};return d.toString=()=>u,a.serviceRegistry.set(u,d),d}},2585:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.IDecorationService=a.IUnicodeService=a.IOscLinkService=a.IOptionsService=a.ILogService=a.LogLevelEnum=a.IInstantiationService=a.ICharsetService=a.ICoreService=a.ICoreMouseService=a.IBufferService=void 0;const c=l(8343);var u;a.IBufferService=(0,c.createDecorator)("BufferService"),a.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),a.ICoreService=(0,c.createDecorator)("CoreService"),a.ICharsetService=(0,c.createDecorator)("CharsetService"),a.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(d){d[d.TRACE=0]="TRACE",d[d.DEBUG=1]="DEBUG",d[d.INFO=2]="INFO",d[d.WARN=3]="WARN",d[d.ERROR=4]="ERROR",d[d.OFF=5]="OFF"}(u||(a.LogLevelEnum=u={})),a.ILogService=(0,c.createDecorator)("LogService"),a.IOptionsService=(0,c.createDecorator)("OptionsService"),a.IOscLinkService=(0,c.createDecorator)("OscLinkService"),a.IUnicodeService=(0,c.createDecorator)("UnicodeService"),a.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeService=void 0;const c=l(8460),u=l(225);class d{static extractShouldJoin(f){return(1&f)!=0}static extractWidth(f){return f>>1&3}static extractCharKind(f){return f>>3}static createPropertyValue(f,v,m=!1){return(16777215&f)<<3|(3&v)<<1|(m?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const f=new u.UnicodeV6;this.register(f),this._active=f.version,this._activeProvider=f}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(f){if(!this._providers[f])throw new Error(`unknown Unicode version "${f}"`);this._active=f,this._activeProvider=this._providers[f],this._onChange.fire(f)}register(f){this._providers[f.version]=f}wcwidth(f){return this._activeProvider.wcwidth(f)}getStringCellWidth(f){let v=0,m=0;const p=f.length;for(let g=0;g<p;++g){let y=f.charCodeAt(g);if(55296<=y&&y<=56319){if(++g>=p)return v+this.wcwidth(y);const w=f.charCodeAt(g);56320<=w&&w<=57343?y=1024*(y-55296)+w-56320+65536:v+=this.wcwidth(w)}const _=this.charProperties(y,m);let b=d.extractWidth(_);d.extractShouldJoin(_)&&(b-=d.extractWidth(m)),v+=b,m=_}return v}charProperties(f,v){return this._activeProvider.charProperties(f,v)}}a.UnicodeService=d}},n={};function s(o){var a=n[o];if(a!==void 0)return a.exports;var l=n[o]={exports:{}};return r[o].call(l.exports,l,l.exports,s),l.exports}var i={};return(()=>{var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const a=s(9042),l=s(3236),c=s(844),u=s(5741),d=s(8285),h=s(7975),f=s(7090),v=["cols","rows"];class m extends c.Disposable{constructor(g){super(),this._core=this.register(new l.Terminal(g)),this._addonManager=this.register(new u.AddonManager),this._publicOptions={...this._core.options};const y=b=>this._core.options[b],_=(b,w)=>{this._checkReadonlyOptions(b),this._core.options[b]=w};for(const b in this._core.options){const w={get:y.bind(this,b),set:_.bind(this,b)};Object.defineProperty(this._publicOptions,b,w)}}_checkReadonlyOptions(g){if(v.includes(g))throw new Error(`Option "${g}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new d.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const g=this._core.coreService.decPrivateModes;let y="none";switch(this._core.coreMouseService.activeProtocol){case"X10":y="x10";break;case"VT200":y="vt200";break;case"DRAG":y="drag";break;case"ANY":y="any"}return{applicationCursorKeysMode:g.applicationCursorKeys,applicationKeypadMode:g.applicationKeypad,bracketedPasteMode:g.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:y,originMode:g.origin,reverseWraparoundMode:g.reverseWraparound,sendFocusMode:g.sendFocus,wraparoundMode:g.wraparound}}get options(){return this._publicOptions}set options(g){for(const y in g)this._publicOptions[y]=g[y]}blur(){this._core.blur()}focus(){this._core.focus()}input(g,y=!0){this._core.input(g,y)}resize(g,y){this._verifyIntegers(g,y),this._core.resize(g,y)}open(g){this._core.open(g)}attachCustomKeyEventHandler(g){this._core.attachCustomKeyEventHandler(g)}attachCustomWheelEventHandler(g){this._core.attachCustomWheelEventHandler(g)}registerLinkProvider(g){return this._core.registerLinkProvider(g)}registerCharacterJoiner(g){return this._checkProposedApi(),this._core.registerCharacterJoiner(g)}deregisterCharacterJoiner(g){this._checkProposedApi(),this._core.deregisterCharacterJoiner(g)}registerMarker(g=0){return this._verifyIntegers(g),this._core.registerMarker(g)}registerDecoration(g){return this._checkProposedApi(),this._verifyPositiveIntegers(g.x??0,g.width??0,g.height??0),this._core.registerDecoration(g)}hasSelection(){return this._core.hasSelection()}select(g,y,_){this._verifyIntegers(g,y,_),this._core.select(g,y,_)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(g,y){this._verifyIntegers(g,y),this._core.selectLines(g,y)}dispose(){super.dispose()}scrollLines(g){this._verifyIntegers(g),this._core.scrollLines(g)}scrollPages(g){this._verifyIntegers(g),this._core.scrollPages(g)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(g){this._verifyIntegers(g),this._core.scrollToLine(g)}clear(){this._core.clear()}write(g,y){this._core.write(g,y)}writeln(g,y){this._core.write(g),this._core.write(`\r
`,y)}paste(g){this._core.paste(g)}refresh(g,y){this._verifyIntegers(g,y),this._core.refresh(g,y)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(g){this._addonManager.loadAddon(this,g)}static get strings(){return a}_verifyIntegers(...g){for(const y of g)if(y===1/0||isNaN(y)||y%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...g){for(const y of g)if(y&&(y===1/0||isNaN(y)||y%1!=0||y<0))throw new Error("This API only accepts positive integers")}}o.Terminal=m})(),i})())})(R6);var JSe=R6.exports;const YSe=getComputedStyle(document.documentElement),Pt=t=>YSe.getPropertyValue(t)||void 0;function w0(t){return{cursor:Pt("--codeia-elements-terminal-cursorColor"),cursorAccent:Pt("--codeia-elements-terminal-cursorColorAccent"),foreground:Pt("--codeia-elements-terminal-textColor"),background:Pt("--codeia-elements-terminal-backgroundColor"),selectionBackground:Pt("--codeia-elements-terminal-selection-backgroundColor"),selectionForeground:Pt("--codeia-elements-terminal-selection-textColor"),selectionInactiveBackground:Pt("--codeia-elements-terminal-selection-backgroundColorInactive"),black:Pt("--codeia-elements-terminal-color-black"),red:Pt("--codeia-elements-terminal-color-red"),green:Pt("--codeia-elements-terminal-color-green"),yellow:Pt("--codeia-elements-terminal-color-yellow"),blue:Pt("--codeia-elements-terminal-color-blue"),magenta:Pt("--codeia-elements-terminal-color-magenta"),cyan:Pt("--codeia-elements-terminal-color-cyan"),white:Pt("--codeia-elements-terminal-color-white"),brightBlack:Pt("--codeia-elements-terminal-color-brightBlack"),brightRed:Pt("--codeia-elements-terminal-color-brightRed"),brightGreen:Pt("--codeia-elements-terminal-color-brightGreen"),brightYellow:Pt("--codeia-elements-terminal-color-brightYellow"),brightBlue:Pt("--codeia-elements-terminal-color-brightBlue"),brightMagenta:Pt("--codeia-elements-terminal-color-brightMagenta"),brightCyan:Pt("--codeia-elements-terminal-color-brightCyan"),brightWhite:Pt("--codeia-elements-terminal-color-brightWhite"),...t}}const ZSe=en("Terminal"),XP=k.memo(k.forwardRef(({className:t,theme:e,readonly:r,id:n,onTerminalReady:s,onTerminalResize:i},o)=>{const a=k.useRef(null),l=k.useRef();return k.useEffect(()=>{const c=a.current,u=new KSe.FitAddon,d=new qSe.WebLinksAddon,h=new JSe.Terminal({cursorBlink:!0,convertEol:!0,disableStdin:r,theme:w0(r?{cursor:"#00000000"}:{}),fontSize:12,fontFamily:"Menlo, courier-new, courier, monospace"});l.current=h,h.loadAddon(u),h.loadAddon(d),h.open(c);const f=new ResizeObserver(()=>{u.fit(),i?.(h.cols,h.rows)});return f.observe(c),ZSe.debug(`Attach [${n}]`),s?.(h),()=>{f.disconnect(),h.dispose()}},[]),k.useEffect(()=>{const c=l.current;c.options.theme=w0(r?{cursor:"#00000000"}:{}),c.options.disableStdin=r},[e,r]),k.useImperativeHandle(o,()=>({reloadStyles:()=>{const c=l.current;c.options.theme=w0(r?{cursor:"#00000000"}:{})}}),[]),C.jsx("div",{className:t,ref:a})})),XSe=en("Terminal"),QP=3,kw=25,QSe=k.memo(()=>{const t=at(Ie.showTerminal),e=at(up),r=k.useRef([]),n=k.useRef(null),s=k.useRef(!1),[i,o]=k.useState(0),[a,l]=k.useState(1),c=()=>{a<QP&&(l(a+1),o(a))};return k.useEffect(()=>{const{current:u}=n;if(!u)return;const d=u.isCollapsed();!t&&!d?u.collapse():t&&d&&u.resize(kw),s.current=!1},[t]),k.useEffect(()=>{const u=hae.on("toggleTerminal",()=>{s.current=!0}),d=up.subscribe(()=>{for(const h of Object.values(r.current))h?.reloadStyles()});return()=>{u(),d()}},[]),C.jsx(Cu,{ref:n,defaultSize:t?kw:0,minSize:10,collapsible:!0,onExpand:()=>{s.current||Ie.toggleTerminal(!0)},onCollapse:()=>{s.current||Ie.toggleTerminal(!1)},children:C.jsx("div",{className:"h-full",children:C.jsxs("div",{className:"bg-codeia-elements-terminals-background h-full flex flex-col",children:[C.jsxs("div",{className:"flex items-center bg-codeia-elements-background-depth-2 border-y border-codeia-elements-borderColor gap-1.5 min-h-[34px] p-2",children:[Array.from({length:a+1},(u,d)=>{const h=i===d;return C.jsx(Re.Fragment,{children:d==0?C.jsxs("button",{className:Te("flex items-center text-sm cursor-pointer gap-1.5 px-3 py-2 h-full whitespace-nowrap rounded-full",{"bg-codeia-elements-terminals-buttonBackground text-codeia-elements-textSecondary hover:text-codeia-elements-textPrimary":h,"bg-codeia-elements-background-depth-2 text-codeia-elements-textSecondary hover:bg-codeia-elements-terminals-buttonBackground":!h}),onClick:()=>o(d),children:[C.jsx("div",{className:"i-ph:terminal-window-duotone text-lg"}),"CodeIA Terminal"]},d):C.jsx(Re.Fragment,{children:C.jsxs("button",{className:Te("flex items-center text-sm cursor-pointer gap-1.5 px-3 py-2 h-full whitespace-nowrap rounded-full",{"bg-codeia-elements-terminals-buttonBackground text-codeia-elements-textPrimary":h,"bg-codeia-elements-background-depth-2 text-codeia-elements-textSecondary hover:bg-codeia-elements-terminals-buttonBackground":!h}),onClick:()=>o(d),children:[C.jsx("div",{className:"i-ph:terminal-window-duotone text-lg"}),"Terminal ",a>1&&d]},d)})},d)}),a<QP&&C.jsx(hr,{icon:"i-ph:plus",size:"md",onClick:c}),C.jsx(hr,{className:"ml-auto",icon:"i-ph:caret-down",title:"Close",size:"md",onClick:()=>Ie.toggleTerminal(!1)})]}),Array.from({length:a+1},(u,d)=>{const h=i===d;return XSe.debug(`Starting codeia terminal [${d}]`),d==0?C.jsx(XP,{id:`terminal_${d}`,className:Te("h-full overflow-hidden modern-scrollbar-invert",{hidden:!h}),ref:f=>{r.current.push(f)},onTerminalReady:f=>Ie.attachCodeiaTerminal(f),onTerminalResize:(f,v)=>Ie.onTerminalResize(f,v),theme:e},d):C.jsx(XP,{id:`terminal_${d}`,className:Te("modern-scrollbar h-full overflow-hidden",{hidden:!h}),ref:f=>{r.current.push(f)},onTerminalReady:f=>Ie.attachTerminal(f),onTerminalResize:(f,v)=>Ie.onTerminalResize(f,v),theme:e},d)})]})})})});async function e1e(t,e,r,n){if(!t||typeof t.internal?.textSearch!="function"){console.error("WebContainer instance not available or internal searchText method is missing/not a function.");return}const s={...r,folders:[lc]},i=(o,a)=>{const l=[];a.forEach(c=>{const u=c.preview.text.split(`
`);c.ranges.forEach(d=>{let h="(Preview line not found)",f=-1;if(c.preview.matches.length>0){const v=c.preview.matches[0].startLineNumber;f=d.startLineNumber-v}f>=0&&f<u.length?h=u[f]:h=u[0]??"(Preview unavailable)",l.push({path:o,lineNumber:d.startLineNumber,previewText:h,matchCharStart:d.startColumn,matchCharEnd:d.endColumn})})}),l.length>0&&n(l)};try{await t.internal.textSearch(e,s,i)}catch(o){console.error("Error during internal text search:",o)}}function t1e(t){return t.reduce((e,r)=>(e[r.path]||(e[r.path]=[]),e[r.path].push(r),e),{})}function r1e(){const[t,e]=k.useState(""),[r,n]=k.useState([]),[s,i]=k.useState(!1),[o,a]=k.useState({}),[l,c]=k.useState(!1),u=k.useMemo(()=>t1e(r),[r]);k.useEffect(()=>{if(r.length>0){const v={};Object.keys(u).forEach(m=>{v[m]=!0}),a(v)}},[u,r]);const d=k.useCallback(async v=>{if(!v.trim()){n([]),i(!1),a({}),c(!1);return}i(!0),n([]),a({}),c(!0);const m=300,p=Date.now();try{const g=await Ui;await e1e(g,v,{homeDir:lc,includes:["**/*.*"],excludes:["**/node_modules/**","**/package-lock.json","**/.git/**","**/dist/**","**/*.lock"],gitignore:!0,requireGit:!1,globalIgnoreFiles:!0,ignoreSymlinks:!1,resultLimit:500,isRegex:!1,caseSensitive:!1,isWordMatch:!1},b=>{n(w=>[...w,...b])})}catch(g){console.error("Failed to initiate search:",g)}finally{const g=Date.now()-p;g<m?setTimeout(()=>i(!1),m-g):i(!1)}},[]),h=k.useCallback(Cg(d,300),[d]);k.useEffect(()=>{h(t)},[t,h]);const f=(v,m)=>{Ie.setSelectedFile(v);const p=typeof m=="number"?Math.max(0,m-1):void 0;Ie.setCurrentDocumentScrollPosition({line:p,column:0})};return C.jsxs("div",{className:"flex flex-col h-full bg-codeia-elements-background-depth-2",children:[C.jsx("div",{className:"flex items-center py-3 px-3",children:C.jsx("div",{className:"relative flex-1",children:C.jsx("input",{type:"text",value:t,onChange:v=>e(v.target.value),placeholder:"Search",className:"w-full px-2 py-1 rounded-md bg-codeia-elements-background-depth-3 text-codeia-elements-textPrimary placeholder-codeia-elements-textTertiary focus:outline-none transition-all"})})}),C.jsxs("div",{className:"flex-1 overflow-auto py-2",children:[s&&C.jsxs("div",{className:"flex items-center justify-center h-32 text-codeia-elements-textTertiary",children:[C.jsx("div",{className:"i-ph:circle-notch animate-spin mr-2"})," Searching..."]}),!s&&l&&r.length===0&&t.trim()!==""&&C.jsx("div",{className:"flex items-center justify-center h-32 text-gray-500",children:"No results found."}),!s&&Object.keys(u).map(v=>C.jsxs("div",{className:"mb-2",children:[C.jsxs("button",{className:"flex gap-2 items-center w-full text-left py-1 px-2 text-codeia-elements-textSecondary bg-transparent hover:bg-codeia-elements-background-depth-3 group",onClick:()=>a(m=>({...m,[v]:!m[v]})),children:[C.jsx("span",{className:" i-ph:caret-down-thin w-3 h-3 text-codeia-elements-textSecondary transition-transform",style:{transform:o[v]?"rotate(180deg)":void 0}}),C.jsx("span",{className:"font-normal text-sm",children:v.split("/").pop()}),C.jsx("span",{className:"h-5.5 w-5.5 flex items-center justify-center text-xs ml-auto bg-codeia-elements-item-backgroundAccent text-codeia-elements-item-contentAccent rounded-full",children:u[v].length})]}),o[v]&&C.jsx("div",{className:"",children:u[v].map((m,p)=>{const y=m.matchCharStart<=7,_=y?0:m.matchCharStart-7,b=m.previewText.slice(_),w=y?m.matchCharStart:7,E=y?m.matchCharEnd:7+(m.matchCharEnd-m.matchCharStart);return C.jsx("div",{className:"hover:bg-codeia-elements-background-depth-3 cursor-pointer transition-colors pl-6 py-1",onClick:()=>f(m.path,m.lineNumber),children:C.jsxs("pre",{className:"font-mono text-xs text-codeia-elements-textTertiary truncate",children:[!y&&C.jsx("span",{children:"..."}),b.slice(0,w),C.jsx("span",{className:"bg-codeia-elements-item-backgroundAccent text-codeia-elements-item-contentAccent rounded px-1",children:b.slice(w,E)}),b.slice(E)]})},p)})})]},v))]})]})}function n1e(t){const e=k.useRef({value:t,previous:t});return k.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var z1="Checkbox",[s1e,ake]=Gs(z1),[i1e,o1e]=s1e(z1),I6=k.forwardRef((t,e)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:i,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...d}=t,[h,f]=k.useState(null),v=Wt(e,b=>f(b)),m=k.useRef(!1),p=h?u||!!h.closest("form"):!0,[g=!1,y]=hh({prop:s,defaultProp:i,onChange:c}),_=k.useRef(g);return k.useEffect(()=>{const b=h?.form;if(b){const w=()=>y(_.current);return b.addEventListener("reset",w),()=>b.removeEventListener("reset",w)}},[h,y]),C.jsxs(i1e,{scope:r,state:g,disabled:a,children:[C.jsx(pt.button,{type:"button",role:"checkbox","aria-checked":Zi(g)?"mixed":g,"aria-required":o,"data-state":M6(g),"data-disabled":a?"":void 0,disabled:a,value:l,...d,ref:v,onKeyDown:Ue(t.onKeyDown,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:Ue(t.onClick,b=>{y(w=>Zi(w)?!0:!w),p&&(m.current=b.isPropagationStopped(),m.current||b.stopPropagation())})}),p&&C.jsx(a1e,{control:h,bubbles:!m.current,name:n,value:l,checked:g,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Zi(i)?!1:i})]})});I6.displayName=z1;var O6="CheckboxIndicator",D6=k.forwardRef((t,e)=>{const{__scopeCheckbox:r,forceMount:n,...s}=t,i=o1e(O6,r);return C.jsx(is,{present:n||Zi(i.state)||i.state===!0,children:C.jsx(pt.span,{"data-state":M6(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});D6.displayName=O6;var a1e=t=>{const{control:e,checked:r,bubbles:n=!0,defaultChecked:s,...i}=t,o=k.useRef(null),a=n1e(r),l=X4(e);k.useEffect(()=>{const u=o.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(a!==r&&f){const v=new Event("click",{bubbles:n});u.indeterminate=Zi(r),f.call(u,Zi(r)?!1:r),u.dispatchEvent(v)}},[a,r,n]);const c=k.useRef(Zi(r)?!1:r);return C.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??c.current,...i,tabIndex:-1,ref:o,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Zi(t){return t==="indeterminate"}function M6(t){return Zi(t)?"indeterminate":t?"checked":"unchecked"}var l1e=I6,c1e=D6;/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1e=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),d1e=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),e2=t=>{const e=d1e(t);return e.charAt(0).toUpperCase()+e.slice(1)},L6=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var h1e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1e=k.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...a},l)=>k.createElement("svg",{ref:l,...h1e,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:L6("lucide",s),...a},[...o.map(([c,u])=>k.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p1e=(t,e)=>{const r=k.forwardRef(({className:n,...s},i)=>k.createElement(f1e,{ref:i,iconNode:e,className:L6(`lucide-${u1e(e2(t))}`,`lucide-${t}`,n),...s}));return r.displayName=e2(t),r};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1e=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],g1e=p1e("check",m1e),Tw=k.forwardRef(({className:t,...e},r)=>C.jsx(l1e,{ref:r,className:Te("peer h-4 w-4 shrink-0 rounded-sm border transition-colors","bg-transparent dark:bg-transparent","border-gray-400 dark:border-gray-600","focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:ring-purple-500 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-950","disabled:cursor-not-allowed disabled:opacity-50","data-[state=checked]:bg-purple-500 dark:data-[state=checked]:bg-purple-500","data-[state=checked]:border-purple-500 dark:data-[state=checked]:border-purple-500","data-[state=checked]:text-white",t),...e,children:C.jsx(c1e,{className:"flex items-center justify-center text-current",children:C.jsx(g1e,{className:"h-3 w-3"})})}));Tw.displayName="Checkbox";function v1e(){const[t,e]=k.useState([]),[r,n]=k.useState(new Set),[s,i]=k.useState("all"),[o,a]=k.useState("");k.useEffect(()=>{const m=()=>{const g=[],y=Ie.files.get();Object.entries(y).forEach(([_,b])=>{b&&(b.type==="file"&&b.isLocked?g.push({path:_,type:"file"}):b.type==="folder"&&b.isLocked&&g.push({path:_,type:"folder"}))}),e(g)};m();const p=setInterval(m,5e3);return()=>clearInterval(p)},[]);const l=t.filter(m=>!(s==="files"&&m.type!=="file"||s==="folders"&&m.type!=="folder"||o&&!m.path.toLowerCase().includes(o.toLowerCase()))).sort((m,p)=>m.path.localeCompare(p.path)),c=m=>{const p=new Set(r);p.has(m)?p.delete(m):p.add(m),n(p)},u=m=>{if(m===!0){const p=new Set(l.map(g=>g.path));n(p)}else n(new Set)},d=()=>{if(r.size===0){De.error("No items selected to unlock.");return}let m=0;r.forEach(p=>{const g=t.find(y=>y.path===p);g&&(g.type==="file"?Ie.unlockFile(p):Ie.unlockFolder(p),m++)}),m>0&&(De.success(`Unlocked ${m} selected item(s).`),n(new Set))},h=l.length>0&&r.size===l.length,f=r.size>0&&r.size<l.length,v=h?!0:f?"indeterminate":!1;return C.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[C.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-codeia-elements-borderColor",children:[C.jsxs("div",{className:"relative flex-1",children:[C.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-codeia-elements-textTertiary i-ph:magnifying-glass text-xs pointer-events-none"}),C.jsx("input",{type:"text",placeholder:"Search...",className:"w-full text-xs pl-6 pr-2 py-0.5 h-6 bg-codeia-elements-background-depth-2 text-codeia-elements-textPrimary rounded border border-codeia-elements-borderColor focus:outline-none",value:o,onChange:m=>a(m.target.value),style:{minWidth:0}})]}),C.jsxs("select",{className:"text-xs px-1 py-0.5 h-6 bg-codeia-elements-background-depth-2 text-codeia-elements-textPrimary rounded border border-codeia-elements-borderColor focus:outline-none",value:s,onChange:m=>i(m.target.value),children:[C.jsx("option",{value:"all",children:"All"}),C.jsx("option",{value:"files",children:"Files"}),C.jsx("option",{value:"folders",children:"Folders"})]})]}),C.jsxs("div",{className:"flex items-center justify-between px-2 py-1 text-xs text-codeia-elements-textSecondary",children:[C.jsxs("div",{children:[C.jsx(Tw,{checked:v,onCheckedChange:u,className:"w-3 h-3 rounded border-codeia-elements-borderColor mr-2","aria-label":"Select all items",disabled:l.length===0}),C.jsx("span",{children:"All"})]}),r.size>0&&C.jsx("button",{className:"ml-auto px-2 py-0.5 rounded bg-codeia-elements-button-secondary-background hover:bg-codeia-elements-button-secondary-backgroundHover text-codeia-elements-button-secondary-text text-xs flex items-center gap-1",onClick:d,title:"Unlock all selected items",children:"Unlock all"}),C.jsx("div",{})]}),C.jsx("div",{className:"flex-1 overflow-auto modern-scrollbar px-1 py-1",children:l.length===0?C.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-codeia-elements-textTertiary text-xs gap-2",children:[C.jsx("span",{className:"i-ph:lock-open-duotone text-lg opacity-50"}),C.jsx("span",{children:"No locked items found"})]}):C.jsx("ul",{className:"space-y-1",children:l.map(m=>C.jsxs("li",{className:Te("text-codeia-elements-textTertiary flex items-center gap-2 px-2 py-1 rounded hover:bg-codeia-elements-background-depth-2 transition-colors group",r.has(m.path)?"bg-codeia-elements-background-depth-2":""),children:[C.jsx(Tw,{checked:r.has(m.path),onCheckedChange:()=>c(m.path),className:"w-3 h-3 rounded border-codeia-elements-borderColor","aria-labelledby":`item-label-${m.path}`}),C.jsx("span",{className:Te("shrink-0 text-codeia-elements-textTertiary text-xs",m.type==="file"?"i-ph:file-text-duotone":"i-ph:folder-duotone")}),C.jsx("span",{id:`item-label-${m.path}`,className:"truncate flex-1 text-xs",title:m.path,children:m.path.replace("/home/project/","")}),C.jsx("span",{className:Te("inline-flex items-center px-1 rounded-sm text-xs","bg-red-500/10 text-red-500")}),C.jsx("button",{className:"flex items-center px-1 py-0.5 text-xs rounded bg-transparent hover:bg-codeia-elements-background-depth-3",onClick:()=>{m.type==="file"?Ie.unlockFile(m.path):Ie.unlockFolder(m.path),De.success(`${m.path.replace("/home/project/","")} unlocked`)},title:"Unlock",children:C.jsx("span",{className:"i-ph:lock-open text-xs"})})]},m.path))})}),C.jsx("div",{className:"px-2 py-1 border-t border-codeia-elements-borderColor bg-codeia-elements-background-depth-2 text-xs text-codeia-elements-textTertiary flex justify-between items-center",children:C.jsxs("div",{children:[l.length," item(s) • ",r.size," selected"]})})]})}const y1e=100-kw,_1e={tabSize:2},b1e=k.memo(({files:t,unsavedFiles:e,editorDocument:r,selectedFile:n,isStreaming:s,fileHistory:i,onFileSelect:o,onEditorChange:a,onEditorScroll:l,onFileSave:c,onFileReset:u})=>{ec.trace("EditorPanel");const d=at(up),h=at(Ie.showTerminal),f=k.useMemo(()=>{if(r)return r.filePath.split("/")},[r]),v=k.useMemo(()=>!r||!e?!1:e instanceof Set&&e.has(r.filePath),[r,e]);return C.jsxs(_w,{direction:"vertical",children:[C.jsx(Cu,{defaultSize:h?y1e:100,minSize:20,children:C.jsxs(_w,{direction:"horizontal",children:[C.jsx(Cu,{defaultSize:20,minSize:15,collapsible:!0,className:"border-r border-codeia-elements-borderColor",children:C.jsx("div",{className:"h-full",children:C.jsxs(Qbe,{defaultValue:"files",className:"flex flex-col h-full",children:[C.jsx(BP,{className:"w-full text-sm font-medium text-codeia-elements-textSecondary px-1",children:C.jsx("div",{className:"h-full flex-shrink-0 flex items-center justify-between w-full",children:C.jsxs(ewe,{className:"h-full flex-shrink-0 flex items-center",children:[C.jsx(d0,{value:"files",className:Te("h-full bg-transparent hover:bg-codeia-elements-background-depth-3 py-0.5 px-2 rounded-lg text-sm font-medium text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary data-[state=active]:text-codeia-elements-textPrimary"),children:"Files"}),C.jsx(d0,{value:"search",className:Te("h-full bg-transparent hover:bg-codeia-elements-background-depth-3 py-0.5 px-2 rounded-lg text-sm font-medium text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary data-[state=active]:text-codeia-elements-textPrimary"),children:"Search"}),C.jsx(d0,{value:"locks",className:Te("h-full bg-transparent hover:bg-codeia-elements-background-depth-3 py-0.5 px-2 rounded-lg text-sm font-medium text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary data-[state=active]:text-codeia-elements-textPrimary"),children:"Locks"})]})})}),C.jsx(h0,{value:"files",className:"flex-grow overflow-auto focus-visible:outline-none",children:C.jsx(E6,{className:"h-full",files:t,hideRoot:!0,unsavedFiles:e,fileHistory:i,rootFolder:lc,selectedFile:n,onFileSelect:o})}),C.jsx(h0,{value:"search",className:"flex-grow overflow-auto focus-visible:outline-none",children:C.jsx(r1e,{})}),C.jsx(h0,{value:"locks",className:"flex-grow overflow-auto focus-visible:outline-none",children:C.jsx(v1e,{})})]})})}),C.jsx(bw,{}),C.jsxs(Cu,{className:"flex flex-col",defaultSize:80,minSize:20,children:[C.jsx(BP,{className:"overflow-x-auto",children:f?.length&&C.jsxs("div",{className:"flex items-center flex-1 text-sm",children:[C.jsx(WSe,{pathSegments:f,files:t,onFileSelect:o}),v&&C.jsxs("div",{className:"flex gap-1 ml-auto -mr-1.5",children:[C.jsxs(vw,{onClick:c,children:[C.jsx("div",{className:"i-ph:floppy-disk-duotone"}),"Save"]}),C.jsxs(vw,{onClick:u,children:[C.jsx("div",{className:"i-ph:clock-counter-clockwise-duotone"}),"Reset"]})]})]})}),C.jsx("div",{className:"h-full flex-1 overflow-hidden modern-scrollbar",children:C.jsx(o4,{theme:d,editable:!s&&r!==void 0,settings:_1e,doc:r,autoFocusOnDocumentChange:!twe(),onScroll:l,onChange:a,onSave:c})})]})]})}),C.jsx(bw,{}),C.jsx(QSe,{})]})}),w1e=k.memo(({activePreviewIndex:t,setActivePreviewIndex:e,isDropdownOpen:r,setIsDropdownOpen:n,setHasSelectedPreview:s,previews:i})=>{const o=k.useRef(null),a=i.map((l,c)=>({...l,index:c})).sort((l,c)=>l.port-c.port);return k.useEffect(()=>{const l=c=>{o.current&&!o.current.contains(c.target)&&n(!1)};return r?window.addEventListener("mousedown",l):window.removeEventListener("mousedown",l),()=>{window.removeEventListener("mousedown",l)}},[r]),C.jsxs("div",{className:"relative z-port-dropdown",ref:o,children:[C.jsxs("button",{className:"flex items-center group-focus-within:text-codeia-elements-preview-addressBar-text bg-white group-focus-within:bg-codeia-elements-preview-addressBar-background dark:bg-codeia-elements-preview-addressBar-backgroundHover rounded-full px-2 py-1 gap-1.5",onClick:()=>n(!r),children:[C.jsx("span",{className:"i-ph:plug text-base"}),i.length>0&&t>=0&&t<i.length?C.jsx("span",{className:"text-xs font-medium",children:i[t].port}):null]}),r&&C.jsxs("div",{className:"absolute left-0 mt-2 bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor rounded shadow-sm min-w-[140px] dropdown-animation",children:[C.jsx("div",{className:"px-4 py-2 border-b border-codeia-elements-borderColor text-sm font-semibold text-codeia-elements-textPrimary",children:"Ports"}),a.map(l=>C.jsx("div",{className:"flex items-center px-4 py-2 cursor-pointer hover:bg-codeia-elements-item-backgroundActive",onClick:()=>{e(l.index),n(!1),s(!0)},children:C.jsx("span",{className:t===l.index?"text-codeia-elements-item-contentAccent":"text-codeia-elements-item-contentDefault group-hover:text-codeia-elements-item-contentActive",children:l.port})},l.port))]})]})}),x1e=k.memo(({isSelectionMode:t,setIsSelectionMode:e,containerRef:r})=>{const[n,s]=k.useState(!1),[i,o]=k.useState(null),[a,l]=k.useState(null),c=k.useRef(null),u=k.useRef(null);k.useEffect(()=>()=>{u.current&&(u.current.pause(),u.current.srcObject=null,u.current.remove(),u.current=null),c.current&&(c.current.getTracks().forEach(m=>m.stop()),c.current=null)},[]);const d=async()=>{if(!c.current)try{const m=await navigator.mediaDevices.getDisplayMedia({audio:!1,video:{displaySurface:"window",preferCurrentTab:!0,surfaceSwitching:"include",systemAudio:"exclude"}});if(m.addEventListener("inactive",()=>{u.current&&(u.current.pause(),u.current.srcObject=null,u.current.remove(),u.current=null),c.current&&(c.current.getTracks().forEach(p=>p.stop()),c.current=null),e(!1),o(null),l(null),s(!1)}),c.current=m,!u.current){const p=document.createElement("video");p.style.opacity="0",p.style.position="fixed",p.style.pointerEvents="none",p.style.zIndex="-1",document.body.appendChild(p),u.current=p}u.current.srcObject=m,await u.current.play()}catch(m){console.error("Failed to initialize stream:",m),e(!1),De.error("Failed to initialize screen capture")}return c.current},h=k.useCallback(async()=>{if(!(!t||!i||!a||!r.current)){s(!0);try{if(!await d()||!u.current)return;await new Promise(V=>setTimeout(V,300));const p=document.createElement("canvas");p.width=u.current.videoWidth,p.height=u.current.videoHeight;const g=p.getContext("2d");if(!g)throw new Error("Failed to get temporary canvas context");g.drawImage(u.current,0,0);const y=u.current.videoWidth/window.innerWidth,_=u.current.videoHeight/window.innerHeight,b=window.scrollX,w=window.scrollY+40,E=r.current.getBoundingClientRect(),S=-9,x=-14,T=Math.round((E.left+Math.min(i.x,a.x)+b+S)*y),D=Math.round((E.top+Math.min(i.y,a.y)+w+x)*_),O=Math.round(Math.abs(a.x-i.x)*y),R=Math.round(Math.abs(a.y-i.y)*_),P=document.createElement("canvas");P.width=Math.round(Math.abs(a.x-i.x)),P.height=Math.round(Math.abs(a.y-i.y));const A=P.getContext("2d");if(!A)throw new Error("Failed to get canvas context");A.drawImage(p,T,D,O,R,0,0,P.width,P.height);const H=await new Promise((V,q)=>{P.toBlob(I=>{I?V(I):q(new Error("Failed to create blob"))},"image/png")}),K=new FileReader;K.onload=V=>{const q=V.target?.result;if(document.querySelector("textarea")){const $=window.__BOLT_SET_UPLOADED_FILES__,j=window.__BOLT_SET_IMAGE_DATA_LIST__,U=window.__BOLT_UPLOADED_FILES__||[],J=window.__BOLT_IMAGE_DATA_LIST__||[];if($&&j){const ne=new File([H],"screenshot.png",{type:"image/png"});$([...U,ne]),j([...J,q]),De.success("Screenshot captured and added to chat")}else De.error("Could not add screenshot to chat")}},K.readAsDataURL(H)}catch(m){console.error("Failed to capture screenshot:",m),De.error("Failed to capture screenshot"),c.current&&(c.current.getTracks().forEach(p=>p.stop()),c.current=null)}finally{s(!1),o(null),l(null),e(!1)}}},[t,i,a,r,e]),f=k.useCallback(m=>{if(m.preventDefault(),m.stopPropagation(),!t)return;const p=m.currentTarget.getBoundingClientRect(),g=m.clientX-p.left,y=m.clientY-p.top;o({x:g,y}),l({x:g,y})},[t]),v=k.useCallback(m=>{if(m.preventDefault(),m.stopPropagation(),!t||!i)return;const p=m.currentTarget.getBoundingClientRect(),g=m.clientX-p.left,y=m.clientY-p.top;l({x:g,y})},[t,i]);return t?C.jsx("div",{className:"absolute inset-0 cursor-crosshair",onMouseDown:f,onMouseMove:v,onMouseUp:h,onMouseLeave:()=>{i&&o(null)},style:{backgroundColor:n?"transparent":"rgba(0, 0, 0, 0.1)",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"all",opacity:n?0:1,zIndex:50,transition:"opacity 0.1s ease-in-out"},children:i&&a&&!n&&C.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-200 bg-opacity-20",style:{left:Math.min(i.x,a.x),top:Math.min(i.y,a.y),width:Math.abs(a.x-i.x),height:Math.abs(a.y-i.y)}})}):null});var W1="Dialog",[N6,lke]=Gs(W1),[S1e,os]=N6(W1),B6=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=k.useRef(null),l=k.useRef(null),[c=!1,u]=hh({prop:n,defaultProp:s,onChange:i});return C.jsx(S1e,{scope:e,triggerRef:a,contentRef:l,contentId:ua(),titleId:ua(),descriptionId:ua(),open:c,onOpenChange:u,onOpenToggle:k.useCallback(()=>u(d=>!d),[u]),modal:o,children:r})};B6.displayName=W1;var F6="DialogTrigger",E1e=k.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=os(F6,r),i=Wt(e,s.triggerRef);return C.jsx(pt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":J1(s.open),...n,ref:i,onClick:Ue(t.onClick,s.onOpenToggle)})});E1e.displayName=F6;var K1="DialogPortal",[C1e,j6]=N6(K1,{forceMount:void 0}),$6=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:s}=t,i=os(K1,e);return C.jsx(C1e,{scope:e,forceMount:r,children:k.Children.map(n,o=>C.jsx(is,{present:r||i.open,children:C.jsx(M1,{asChild:!0,container:s,children:o})}))})};$6.displayName=K1;var Zm="DialogOverlay",U6=k.forwardRef((t,e)=>{const r=j6(Zm,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=os(Zm,t.__scopeDialog);return i.modal?C.jsx(is,{present:n||i.open,children:C.jsx(k1e,{...s,ref:e})}):null});U6.displayName=Zm;var k1e=k.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=os(Zm,r);return C.jsx(L1,{as:Zl,allowPinchZoom:!0,shards:[s.contentRef],children:C.jsx(pt.div,{"data-state":J1(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),Ca="DialogContent",H6=k.forwardRef((t,e)=>{const r=j6(Ca,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=os(Ca,t.__scopeDialog);return C.jsx(is,{present:n||i.open,children:i.modal?C.jsx(T1e,{...s,ref:e}):C.jsx(A1e,{...s,ref:e})})});H6.displayName=Ca;var T1e=k.forwardRef((t,e)=>{const r=os(Ca,t.__scopeDialog),n=k.useRef(null),s=Wt(e,r.contentRef,n);return k.useEffect(()=>{const i=n.current;if(i)return h$(i)},[]),C.jsx(V6,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ue(t.onCloseAutoFocus,i=>{i.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Ue(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:Ue(t.onFocusOutside,i=>i.preventDefault())})}),A1e=k.forwardRef((t,e)=>{const r=os(Ca,t.__scopeDialog),n=k.useRef(!1),s=k.useRef(!1);return C.jsx(V6,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{t.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||r.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{t.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;r.triggerRef.current?.contains(o)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),V6=k.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=os(Ca,r),l=k.useRef(null),c=Wt(e,l);return J4(),C.jsxs(C.Fragment,{children:[C.jsx(I1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:C.jsx(av,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":J1(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),C.jsxs(C.Fragment,{children:[C.jsx(R1e,{titleId:a.titleId}),C.jsx(I1e,{contentRef:l,descriptionId:a.descriptionId})]})]})}),q1="DialogTitle",G6=k.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=os(q1,r);return C.jsx(pt.h2,{id:s.titleId,...n,ref:e})});G6.displayName=q1;var z6="DialogDescription",W6=k.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=os(z6,r);return C.jsx(pt.p,{id:s.descriptionId,...n,ref:e})});W6.displayName=z6;var K6="DialogClose",q6=k.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=os(K6,r);return C.jsx(pt.button,{type:"button",...n,ref:e,onClick:Ue(t.onClick,()=>s.onOpenChange(!1))})});q6.displayName=K6;function J1(t){return t?"open":"closed"}var J6="DialogTitleWarning",[cke,Y6]=Abe(J6,{contentName:Ca,titleName:q1,docsSlug:"dialog"}),R1e=({titleId:t})=>{const e=Y6(J6),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return k.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},P1e="DialogDescriptionWarning",I1e=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Y6(P1e).contentName}}.`;return k.useEffect(()=>{const s=t.current?.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},ip=B6,op=$6,ap=U6,lp=H6,Z6=G6,O1e=W6,cp=q6;const t2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,r2=di,X6=(t,e)=>r=>{var n;if(e?.variants==null)return r2(t,r?.class,r?.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=r?.[c],d=i?.[c];if(u===null)return null;const h=t2(u)||t2(d);return s[c][h]}),a=r&&Object.entries(r).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(v=>{let[m,p]=v;return Array.isArray(p)?p.includes({...i,...a}[m]):{...i,...a}[m]===p})?[...c,d,h]:c},[]);return r2(t,o,l,r?.class,r?.className)},D1e=X6("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-codeia-elements-borderColor disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-codeia-elements-background text-codeia-elements-textPrimary hover:bg-codeia-elements-background-depth-2",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-codeia-elements-borderColor bg-transparent hover:bg-codeia-elements-background-depth-2 hover:text-codeia-elements-textPrimary text-codeia-elements-textPrimary dark:border-codeia-elements-borderColorActive",secondary:"bg-codeia-elements-background-depth-1 text-codeia-elements-textPrimary hover:bg-codeia-elements-background-depth-2",ghost:"hover:bg-codeia-elements-background-depth-1 hover:text-codeia-elements-textPrimary",link:"text-codeia-elements-textPrimary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Aw=k.forwardRef(({className:t,variant:e,size:r,_asChild:n=!1,...s},i)=>C.jsx("button",{className:Te(D1e({variant:e,size:r}),t),ref:i,...s}));Aw.displayName="Button";k.memo(({type:t,children:e,onClick:r,disabled:n})=>C.jsx("button",{className:Te("inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-colors",t==="primary"?"bg-purple-500 text-white hover:bg-purple-600 dark:bg-purple-500 dark:hover:bg-purple-600":t==="secondary"?"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-gray-100":"bg-transparent text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-500/10"),onClick:r,disabled:n,children:e}));const M1e=k.memo(({className:t,children:e,...r})=>C.jsx(Z6,{className:Te("text-lg font-medium text-codeia-elements-textPrimary flex items-center gap-2",t),...r,children:e})),L1e=k.memo(({className:t,children:e,...r})=>C.jsx(O1e,{className:Te("text-sm text-codeia-elements-textSecondary mt-1",t),...r,children:e})),Xm={duration:.15,ease:ho},N1e={closed:{opacity:0,transition:Xm},open:{opacity:1,transition:Xm}},B1e={closed:{x:"-50%",y:"-40%",scale:.96,opacity:0,transition:Xm},open:{x:"-50%",y:"-50%",scale:1,opacity:1,transition:Xm}},F1e=k.memo(({children:t,className:e,showCloseButton:r=!0,onClose:n,onBackdrop:s})=>C.jsxs(op,{children:[C.jsx(ap,{asChild:!0,children:C.jsx(mt.div,{className:Te("fixed inset-0 z-[9999] bg-black/70 dark:bg-black/80 backdrop-blur-sm"),initial:"closed",animate:"open",exit:"closed",variants:N1e,onClick:s})}),C.jsx(lp,{asChild:!0,children:C.jsx(mt.div,{className:Te("fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-950 rounded-lg shadow-xl border border-codeia-elements-borderColor z-[9999] w-[520px] focus:outline-none",e),initial:"closed",animate:"open",exit:"closed",variants:B1e,children:C.jsxs("div",{className:"flex flex-col",children:[t,r&&C.jsx(cp,{asChild:!0,onClick:n,children:C.jsx(hr,{icon:"i-ph:x",className:"absolute top-3 right-3 text-codeia-elements-textTertiary hover:text-codeia-elements-textSecondary"})})]})})})]}));var Y1={},Qm={exports:{}};Qm.exports;(function(t,e){var r=200,n="__lodash_hash_undefined__",s=1,i=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",h="[object Error]",f="[object Function]",v="[object GeneratorFunction]",m="[object Map]",p="[object Number]",g="[object Null]",y="[object Object]",_="[object Promise]",b="[object Proxy]",w="[object RegExp]",E="[object Set]",S="[object String]",x="[object Symbol]",T="[object Undefined]",D="[object WeakMap]",O="[object ArrayBuffer]",R="[object DataView]",P="[object Float32Array]",A="[object Float64Array]",H="[object Int8Array]",K="[object Int16Array]",V="[object Int32Array]",q="[object Uint8Array]",I="[object Uint8ClampedArray]",$="[object Uint16Array]",j="[object Uint32Array]",U=/[\\^$.*+?()[\]{}|]/g,J=/^\[object .+?Constructor\]$/,ne=/^(?:0|[1-9]\d*)$/,te={};te[P]=te[A]=te[H]=te[K]=te[V]=te[q]=te[I]=te[$]=te[j]=!0,te[a]=te[l]=te[O]=te[u]=te[R]=te[d]=te[h]=te[f]=te[m]=te[p]=te[y]=te[w]=te[E]=te[S]=te[D]=!1;var me=typeof $t=="object"&&$t&&$t.Object===Object&&$t,re=typeof self=="object"&&self&&self.Object===Object&&self,F=me||re||Function("return this")(),X=e&&!e.nodeType&&e,Y=X&&!0&&t&&!t.nodeType&&t,oe=Y&&Y.exports===X,le=oe&&me.process,ue=function(){try{return le&&le.binding&&le.binding("util")}catch{}}(),N=ue&&ue.isTypedArray;function Z(se,pe){for(var Ee=-1,Be=se==null?0:se.length,St=0,Je=[];++Ee<Be;){var Dt=se[Ee];pe(Dt,Ee,se)&&(Je[St++]=Dt)}return Je}function ie(se,pe){for(var Ee=-1,Be=pe.length,St=se.length;++Ee<Be;)se[St+Ee]=pe[Ee];return se}function W(se,pe){for(var Ee=-1,Be=se==null?0:se.length;++Ee<Be;)if(pe(se[Ee],Ee,se))return!0;return!1}function z(se,pe){for(var Ee=-1,Be=Array(se);++Ee<se;)Be[Ee]=pe(Ee);return Be}function ae(se){return function(pe){return se(pe)}}function ce(se,pe){return se.has(pe)}function ge(se,pe){return se?.[pe]}function de(se){var pe=-1,Ee=Array(se.size);return se.forEach(function(Be,St){Ee[++pe]=[St,Be]}),Ee}function fe(se,pe){return function(Ee){return se(pe(Ee))}}function we(se){var pe=-1,Ee=Array(se.size);return se.forEach(function(Be){Ee[++pe]=Be}),Ee}var _e=Array.prototype,Ae=Function.prototype,ze=Object.prototype,Ne=F["__core-js_shared__"],ft=Ae.toString,G=ze.hasOwnProperty,M=function(){var se=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return se?"Symbol(src)_1."+se:""}(),B=ze.toString,Q=RegExp("^"+ft.call(G).replace(U,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),he=oe?F.Buffer:void 0,ye=F.Symbol,be=F.Uint8Array,We=ze.propertyIsEnumerable,bt=_e.splice,it=ye?ye.toStringTag:void 0,gt=Object.getOwnPropertySymbols,dt=he?he.isBuffer:void 0,ko=fe(Object.keys,Object),Ri=Da(F,"DataView"),yc=Da(F,"Map"),mv=Da(F,"Promise"),gv=Da(F,"Set"),vv=Da(F,"WeakMap"),_c=Da(Object,"create"),g8=Ro(Ri),v8=Ro(yc),y8=Ro(mv),_8=Ro(gv),b8=Ro(vv),X1=ye?ye.prototype:void 0,yv=X1?X1.valueOf:void 0;function To(se){var pe=-1,Ee=se==null?0:se.length;for(this.clear();++pe<Ee;){var Be=se[pe];this.set(Be[0],Be[1])}}function w8(){this.__data__=_c?_c(null):{},this.size=0}function x8(se){var pe=this.has(se)&&delete this.__data__[se];return this.size-=pe?1:0,pe}function S8(se){var pe=this.__data__;if(_c){var Ee=pe[se];return Ee===n?void 0:Ee}return G.call(pe,se)?pe[se]:void 0}function E8(se){var pe=this.__data__;return _c?pe[se]!==void 0:G.call(pe,se)}function C8(se,pe){var Ee=this.__data__;return this.size+=this.has(se)?0:1,Ee[se]=_c&&pe===void 0?n:pe,this}To.prototype.clear=w8,To.prototype.delete=x8,To.prototype.get=S8,To.prototype.has=E8,To.prototype.set=C8;function zs(se){var pe=-1,Ee=se==null?0:se.length;for(this.clear();++pe<Ee;){var Be=se[pe];this.set(Be[0],Be[1])}}function k8(){this.__data__=[],this.size=0}function T8(se){var pe=this.__data__,Ee=gh(pe,se);if(Ee<0)return!1;var Be=pe.length-1;return Ee==Be?pe.pop():bt.call(pe,Ee,1),--this.size,!0}function A8(se){var pe=this.__data__,Ee=gh(pe,se);return Ee<0?void 0:pe[Ee][1]}function R8(se){return gh(this.__data__,se)>-1}function P8(se,pe){var Ee=this.__data__,Be=gh(Ee,se);return Be<0?(++this.size,Ee.push([se,pe])):Ee[Be][1]=pe,this}zs.prototype.clear=k8,zs.prototype.delete=T8,zs.prototype.get=A8,zs.prototype.has=R8,zs.prototype.set=P8;function Ao(se){var pe=-1,Ee=se==null?0:se.length;for(this.clear();++pe<Ee;){var Be=se[pe];this.set(Be[0],Be[1])}}function I8(){this.size=0,this.__data__={hash:new To,map:new(yc||zs),string:new To}}function O8(se){var pe=vh(this,se).delete(se);return this.size-=pe?1:0,pe}function D8(se){return vh(this,se).get(se)}function M8(se){return vh(this,se).has(se)}function L8(se,pe){var Ee=vh(this,se),Be=Ee.size;return Ee.set(se,pe),this.size+=Ee.size==Be?0:1,this}Ao.prototype.clear=I8,Ao.prototype.delete=O8,Ao.prototype.get=D8,Ao.prototype.has=M8,Ao.prototype.set=L8;function mh(se){var pe=-1,Ee=se==null?0:se.length;for(this.__data__=new Ao;++pe<Ee;)this.add(se[pe])}function N8(se){return this.__data__.set(se,n),this}function B8(se){return this.__data__.has(se)}mh.prototype.add=mh.prototype.push=N8,mh.prototype.has=B8;function Pi(se){var pe=this.__data__=new zs(se);this.size=pe.size}function F8(){this.__data__=new zs,this.size=0}function j8(se){var pe=this.__data__,Ee=pe.delete(se);return this.size=pe.size,Ee}function $8(se){return this.__data__.get(se)}function U8(se){return this.__data__.has(se)}function H8(se,pe){var Ee=this.__data__;if(Ee instanceof zs){var Be=Ee.__data__;if(!yc||Be.length<r-1)return Be.push([se,pe]),this.size=++Ee.size,this;Ee=this.__data__=new Ao(Be)}return Ee.set(se,pe),this.size=Ee.size,this}Pi.prototype.clear=F8,Pi.prototype.delete=j8,Pi.prototype.get=$8,Pi.prototype.has=U8,Pi.prototype.set=H8;function V8(se,pe){var Ee=yh(se),Be=!Ee&&sU(se),St=!Ee&&!Be&&_v(se),Je=!Ee&&!Be&&!St&&aE(se),Dt=Ee||Be||St||Je,Xt=Dt?z(se.length,String):[],ir=Xt.length;for(var Rt in se)G.call(se,Rt)&&!(Dt&&(Rt=="length"||St&&(Rt=="offset"||Rt=="parent")||Je&&(Rt=="buffer"||Rt=="byteLength"||Rt=="byteOffset")||Q8(Rt,ir)))&&Xt.push(Rt);return Xt}function gh(se,pe){for(var Ee=se.length;Ee--;)if(nE(se[Ee][0],pe))return Ee;return-1}function G8(se,pe,Ee){var Be=pe(se);return yh(se)?Be:ie(Be,Ee(se))}function bc(se){return se==null?se===void 0?T:g:it&&it in Object(se)?Z8(se):nU(se)}function Q1(se){return wc(se)&&bc(se)==a}function eE(se,pe,Ee,Be,St){return se===pe?!0:se==null||pe==null||!wc(se)&&!wc(pe)?se!==se&&pe!==pe:z8(se,pe,Ee,Be,eE,St)}function z8(se,pe,Ee,Be,St,Je){var Dt=yh(se),Xt=yh(pe),ir=Dt?l:Ii(se),Rt=Xt?l:Ii(pe);ir=ir==a?y:ir,Rt=Rt==a?y:Rt;var rn=ir==y,Vn=Rt==y,yr=ir==Rt;if(yr&&_v(se)){if(!_v(pe))return!1;Dt=!0,rn=!1}if(yr&&!rn)return Je||(Je=new Pi),Dt||aE(se)?tE(se,pe,Ee,Be,St,Je):J8(se,pe,ir,Ee,Be,St,Je);if(!(Ee&s)){var xn=rn&&G.call(se,"__wrapped__"),Sn=Vn&&G.call(pe,"__wrapped__");if(xn||Sn){var Oi=xn?se.value():se,Ws=Sn?pe.value():pe;return Je||(Je=new Pi),St(Oi,Ws,Ee,Be,Je)}}return yr?(Je||(Je=new Pi),Y8(se,pe,Ee,Be,St,Je)):!1}function W8(se){if(!oE(se)||tU(se))return!1;var pe=sE(se)?Q:J;return pe.test(Ro(se))}function K8(se){return wc(se)&&iE(se.length)&&!!te[bc(se)]}function q8(se){if(!rU(se))return ko(se);var pe=[];for(var Ee in Object(se))G.call(se,Ee)&&Ee!="constructor"&&pe.push(Ee);return pe}function tE(se,pe,Ee,Be,St,Je){var Dt=Ee&s,Xt=se.length,ir=pe.length;if(Xt!=ir&&!(Dt&&ir>Xt))return!1;var Rt=Je.get(se);if(Rt&&Je.get(pe))return Rt==pe;var rn=-1,Vn=!0,yr=Ee&i?new mh:void 0;for(Je.set(se,pe),Je.set(pe,se);++rn<Xt;){var xn=se[rn],Sn=pe[rn];if(Be)var Oi=Dt?Be(Sn,xn,rn,pe,se,Je):Be(xn,Sn,rn,se,pe,Je);if(Oi!==void 0){if(Oi)continue;Vn=!1;break}if(yr){if(!W(pe,function(Ws,Po){if(!ce(yr,Po)&&(xn===Ws||St(xn,Ws,Ee,Be,Je)))return yr.push(Po)})){Vn=!1;break}}else if(!(xn===Sn||St(xn,Sn,Ee,Be,Je))){Vn=!1;break}}return Je.delete(se),Je.delete(pe),Vn}function J8(se,pe,Ee,Be,St,Je,Dt){switch(Ee){case R:if(se.byteLength!=pe.byteLength||se.byteOffset!=pe.byteOffset)return!1;se=se.buffer,pe=pe.buffer;case O:return!(se.byteLength!=pe.byteLength||!Je(new be(se),new be(pe)));case u:case d:case p:return nE(+se,+pe);case h:return se.name==pe.name&&se.message==pe.message;case w:case S:return se==pe+"";case m:var Xt=de;case E:var ir=Be&s;if(Xt||(Xt=we),se.size!=pe.size&&!ir)return!1;var Rt=Dt.get(se);if(Rt)return Rt==pe;Be|=i,Dt.set(se,pe);var rn=tE(Xt(se),Xt(pe),Be,St,Je,Dt);return Dt.delete(se),rn;case x:if(yv)return yv.call(se)==yv.call(pe)}return!1}function Y8(se,pe,Ee,Be,St,Je){var Dt=Ee&s,Xt=rE(se),ir=Xt.length,Rt=rE(pe),rn=Rt.length;if(ir!=rn&&!Dt)return!1;for(var Vn=ir;Vn--;){var yr=Xt[Vn];if(!(Dt?yr in pe:G.call(pe,yr)))return!1}var xn=Je.get(se);if(xn&&Je.get(pe))return xn==pe;var Sn=!0;Je.set(se,pe),Je.set(pe,se);for(var Oi=Dt;++Vn<ir;){yr=Xt[Vn];var Ws=se[yr],Po=pe[yr];if(Be)var lE=Dt?Be(Po,Ws,yr,pe,se,Je):Be(Ws,Po,yr,se,pe,Je);if(!(lE===void 0?Ws===Po||St(Ws,Po,Ee,Be,Je):lE)){Sn=!1;break}Oi||(Oi=yr=="constructor")}if(Sn&&!Oi){var _h=se.constructor,bh=pe.constructor;_h!=bh&&"constructor"in se&&"constructor"in pe&&!(typeof _h=="function"&&_h instanceof _h&&typeof bh=="function"&&bh instanceof bh)&&(Sn=!1)}return Je.delete(se),Je.delete(pe),Sn}function rE(se){return G8(se,aU,X8)}function vh(se,pe){var Ee=se.__data__;return eU(pe)?Ee[typeof pe=="string"?"string":"hash"]:Ee.map}function Da(se,pe){var Ee=ge(se,pe);return W8(Ee)?Ee:void 0}function Z8(se){var pe=G.call(se,it),Ee=se[it];try{se[it]=void 0;var Be=!0}catch{}var St=B.call(se);return Be&&(pe?se[it]=Ee:delete se[it]),St}var X8=gt?function(se){return se==null?[]:(se=Object(se),Z(gt(se),function(pe){return We.call(se,pe)}))}:lU,Ii=bc;(Ri&&Ii(new Ri(new ArrayBuffer(1)))!=R||yc&&Ii(new yc)!=m||mv&&Ii(mv.resolve())!=_||gv&&Ii(new gv)!=E||vv&&Ii(new vv)!=D)&&(Ii=function(se){var pe=bc(se),Ee=pe==y?se.constructor:void 0,Be=Ee?Ro(Ee):"";if(Be)switch(Be){case g8:return R;case v8:return m;case y8:return _;case _8:return E;case b8:return D}return pe});function Q8(se,pe){return pe=pe??o,!!pe&&(typeof se=="number"||ne.test(se))&&se>-1&&se%1==0&&se<pe}function eU(se){var pe=typeof se;return pe=="string"||pe=="number"||pe=="symbol"||pe=="boolean"?se!=="__proto__":se===null}function tU(se){return!!M&&M in se}function rU(se){var pe=se&&se.constructor,Ee=typeof pe=="function"&&pe.prototype||ze;return se===Ee}function nU(se){return B.call(se)}function Ro(se){if(se!=null){try{return ft.call(se)}catch{}try{return se+""}catch{}}return""}function nE(se,pe){return se===pe||se!==se&&pe!==pe}var sU=Q1(function(){return arguments}())?Q1:function(se){return wc(se)&&G.call(se,"callee")&&!We.call(se,"callee")},yh=Array.isArray;function iU(se){return se!=null&&iE(se.length)&&!sE(se)}var _v=dt||cU;function oU(se,pe){return eE(se,pe)}function sE(se){if(!oE(se))return!1;var pe=bc(se);return pe==f||pe==v||pe==c||pe==b}function iE(se){return typeof se=="number"&&se>-1&&se%1==0&&se<=o}function oE(se){var pe=typeof se;return se!=null&&(pe=="object"||pe=="function")}function wc(se){return se!=null&&typeof se=="object"}var aE=N?ae(N):K8;function aU(se){return iU(se)?V8(se):q8(se)}function lU(){return[]}function cU(){return!1}t.exports=oU})(Qm,Qm.exports);var j1e=Qm.exports,Q6={exports:{}};(function(t,e){var r=function(){var n=function(w,E){var S=236,x=17,T=w,D=i[E],O=null,R=0,P=null,A=[],H={},K=function(F,X){R=T*4+17,O=function(Y){for(var oe=new Array(Y),le=0;le<Y;le+=1){oe[le]=new Array(Y);for(var ue=0;ue<Y;ue+=1)oe[le][ue]=null}return oe}(R),V(0,0),V(R-7,0),V(0,R-7),$(),I(),U(F,X),T>=7&&j(F),P==null&&(P=te(T,D,A)),J(P,X)},V=function(F,X){for(var Y=-1;Y<=7;Y+=1)if(!(F+Y<=-1||R<=F+Y))for(var oe=-1;oe<=7;oe+=1)X+oe<=-1||R<=X+oe||(0<=Y&&Y<=6&&(oe==0||oe==6)||0<=oe&&oe<=6&&(Y==0||Y==6)||2<=Y&&Y<=4&&2<=oe&&oe<=4?O[F+Y][X+oe]=!0:O[F+Y][X+oe]=!1)},q=function(){for(var F=0,X=0,Y=0;Y<8;Y+=1){K(!0,Y);var oe=a.getLostPoint(H);(Y==0||F>oe)&&(F=oe,X=Y)}return X},I=function(){for(var F=8;F<R-8;F+=1)O[F][6]==null&&(O[F][6]=F%2==0);for(var X=8;X<R-8;X+=1)O[6][X]==null&&(O[6][X]=X%2==0)},$=function(){for(var F=a.getPatternPosition(T),X=0;X<F.length;X+=1)for(var Y=0;Y<F.length;Y+=1){var oe=F[X],le=F[Y];if(O[oe][le]==null)for(var ue=-2;ue<=2;ue+=1)for(var N=-2;N<=2;N+=1)ue==-2||ue==2||N==-2||N==2||ue==0&&N==0?O[oe+ue][le+N]=!0:O[oe+ue][le+N]=!1}},j=function(F){for(var X=a.getBCHTypeNumber(T),Y=0;Y<18;Y+=1){var oe=!F&&(X>>Y&1)==1;O[Math.floor(Y/3)][Y%3+R-8-3]=oe}for(var Y=0;Y<18;Y+=1){var oe=!F&&(X>>Y&1)==1;O[Y%3+R-8-3][Math.floor(Y/3)]=oe}},U=function(F,X){for(var Y=D<<3|X,oe=a.getBCHTypeInfo(Y),le=0;le<15;le+=1){var ue=!F&&(oe>>le&1)==1;le<6?O[le][8]=ue:le<8?O[le+1][8]=ue:O[R-15+le][8]=ue}for(var le=0;le<15;le+=1){var ue=!F&&(oe>>le&1)==1;le<8?O[8][R-le-1]=ue:le<9?O[8][15-le-1+1]=ue:O[8][15-le-1]=ue}O[R-8][8]=!F},J=function(F,X){for(var Y=-1,oe=R-1,le=7,ue=0,N=a.getMaskFunction(X),Z=R-1;Z>0;Z-=2)for(Z==6&&(Z-=1);;){for(var ie=0;ie<2;ie+=1)if(O[oe][Z-ie]==null){var W=!1;ue<F.length&&(W=(F[ue]>>>le&1)==1);var z=N(oe,Z-ie);z&&(W=!W),O[oe][Z-ie]=W,le-=1,le==-1&&(ue+=1,le=7)}if(oe+=Y,oe<0||R<=oe){oe-=Y,Y=-Y;break}}},ne=function(F,X){for(var Y=0,oe=0,le=0,ue=new Array(X.length),N=new Array(X.length),Z=0;Z<X.length;Z+=1){var ie=X[Z].dataCount,W=X[Z].totalCount-ie;oe=Math.max(oe,ie),le=Math.max(le,W),ue[Z]=new Array(ie);for(var z=0;z<ue[Z].length;z+=1)ue[Z][z]=255&F.getBuffer()[z+Y];Y+=ie;var ae=a.getErrorCorrectPolynomial(W),ce=c(ue[Z],ae.getLength()-1),ge=ce.mod(ae);N[Z]=new Array(ae.getLength()-1);for(var z=0;z<N[Z].length;z+=1){var de=z+ge.getLength()-N[Z].length;N[Z][z]=de>=0?ge.getAt(de):0}}for(var fe=0,z=0;z<X.length;z+=1)fe+=X[z].totalCount;for(var we=new Array(fe),_e=0,z=0;z<oe;z+=1)for(var Z=0;Z<X.length;Z+=1)z<ue[Z].length&&(we[_e]=ue[Z][z],_e+=1);for(var z=0;z<le;z+=1)for(var Z=0;Z<X.length;Z+=1)z<N[Z].length&&(we[_e]=N[Z][z],_e+=1);return we},te=function(F,X,Y){for(var oe=u.getRSBlocks(F,X),le=d(),ue=0;ue<Y.length;ue+=1){var N=Y[ue];le.put(N.getMode(),4),le.put(N.getLength(),a.getLengthInBits(N.getMode(),F)),N.write(le)}for(var Z=0,ue=0;ue<oe.length;ue+=1)Z+=oe[ue].dataCount;if(le.getLengthInBits()>Z*8)throw"code length overflow. ("+le.getLengthInBits()+">"+Z*8+")";for(le.getLengthInBits()+4<=Z*8&&le.put(0,4);le.getLengthInBits()%8!=0;)le.putBit(!1);for(;!(le.getLengthInBits()>=Z*8||(le.put(S,8),le.getLengthInBits()>=Z*8));)le.put(x,8);return ne(le,oe)};H.addData=function(F,X){X=X||"Byte";var Y=null;switch(X){case"Numeric":Y=h(F);break;case"Alphanumeric":Y=f(F);break;case"Byte":Y=v(F);break;case"Kanji":Y=m(F);break;default:throw"mode:"+X}A.push(Y),P=null},H.isDark=function(F,X){if(F<0||R<=F||X<0||R<=X)throw F+","+X;return O[F][X]},H.getModuleCount=function(){return R},H.make=function(){if(T<1){for(var F=1;F<40;F++){for(var X=u.getRSBlocks(F,D),Y=d(),oe=0;oe<A.length;oe++){var le=A[oe];Y.put(le.getMode(),4),Y.put(le.getLength(),a.getLengthInBits(le.getMode(),F)),le.write(Y)}for(var ue=0,oe=0;oe<X.length;oe++)ue+=X[oe].dataCount;if(Y.getLengthInBits()<=ue*8)break}T=F}K(!1,q())},H.createTableTag=function(F,X){F=F||2,X=typeof X>"u"?F*4:X;var Y="";Y+='<table style="',Y+=" border-width: 0px; border-style: none;",Y+=" border-collapse: collapse;",Y+=" padding: 0px; margin: "+X+"px;",Y+='">',Y+="<tbody>";for(var oe=0;oe<H.getModuleCount();oe+=1){Y+="<tr>";for(var le=0;le<H.getModuleCount();le+=1)Y+='<td style="',Y+=" border-width: 0px; border-style: none;",Y+=" border-collapse: collapse;",Y+=" padding: 0px; margin: 0px;",Y+=" width: "+F+"px;",Y+=" height: "+F+"px;",Y+=" background-color: ",Y+=H.isDark(oe,le)?"#000000":"#ffffff",Y+=";",Y+='"/>';Y+="</tr>"}return Y+="</tbody>",Y+="</table>",Y},H.createSvgTag=function(F,X,Y,oe){var le={};typeof arguments[0]=="object"&&(le=arguments[0],F=le.cellSize,X=le.margin,Y=le.alt,oe=le.title),F=F||2,X=typeof X>"u"?F*4:X,Y=typeof Y=="string"?{text:Y}:Y||{},Y.text=Y.text||null,Y.id=Y.text?Y.id||"qrcode-description":null,oe=typeof oe=="string"?{text:oe}:oe||{},oe.text=oe.text||null,oe.id=oe.text?oe.id||"qrcode-title":null;var ue=H.getModuleCount()*F+X*2,N,Z,ie,W,z="",ae;for(ae="l"+F+",0 0,"+F+" -"+F+",0 0,-"+F+"z ",z+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',z+=le.scalable?"":' width="'+ue+'px" height="'+ue+'px"',z+=' viewBox="0 0 '+ue+" "+ue+'" ',z+=' preserveAspectRatio="xMinYMin meet"',z+=oe.text||Y.text?' role="img" aria-labelledby="'+me([oe.id,Y.id].join(" ").trim())+'"':"",z+=">",z+=oe.text?'<title id="'+me(oe.id)+'">'+me(oe.text)+"</title>":"",z+=Y.text?'<description id="'+me(Y.id)+'">'+me(Y.text)+"</description>":"",z+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',z+='<path d="',ie=0;ie<H.getModuleCount();ie+=1)for(W=ie*F+X,N=0;N<H.getModuleCount();N+=1)H.isDark(ie,N)&&(Z=N*F+X,z+="M"+Z+","+W+ae);return z+='" stroke="transparent" fill="black"/>',z+="</svg>",z},H.createDataURL=function(F,X){F=F||2,X=typeof X>"u"?F*4:X;var Y=H.getModuleCount()*F+X*2,oe=X,le=Y-X;return b(Y,Y,function(ue,N){if(oe<=ue&&ue<le&&oe<=N&&N<le){var Z=Math.floor((ue-oe)/F),ie=Math.floor((N-oe)/F);return H.isDark(ie,Z)?0:1}else return 1})},H.createImgTag=function(F,X,Y){F=F||2,X=typeof X>"u"?F*4:X;var oe=H.getModuleCount()*F+X*2,le="";return le+="<img",le+=' src="',le+=H.createDataURL(F,X),le+='"',le+=' width="',le+=oe,le+='"',le+=' height="',le+=oe,le+='"',Y&&(le+=' alt="',le+=me(Y),le+='"'),le+="/>",le};var me=function(F){for(var X="",Y=0;Y<F.length;Y+=1){var oe=F.charAt(Y);switch(oe){case"<":X+="&lt;";break;case">":X+="&gt;";break;case"&":X+="&amp;";break;case'"':X+="&quot;";break;default:X+=oe;break}}return X},re=function(F){var X=1;F=typeof F>"u"?X*2:F;var Y=H.getModuleCount()*X+F*2,oe=F,le=Y-F,ue,N,Z,ie,W,z={"██":"█","█ ":"▀"," █":"▄","  ":" "},ae={"██":"▀","█ ":"▀"," █":" ","  ":" "},ce="";for(ue=0;ue<Y;ue+=2){for(Z=Math.floor((ue-oe)/X),ie=Math.floor((ue+1-oe)/X),N=0;N<Y;N+=1)W="█",oe<=N&&N<le&&oe<=ue&&ue<le&&H.isDark(Z,Math.floor((N-oe)/X))&&(W=" "),oe<=N&&N<le&&oe<=ue+1&&ue+1<le&&H.isDark(ie,Math.floor((N-oe)/X))?W+=" ":W+="█",ce+=F<1&&ue+1>=le?ae[W]:z[W];ce+=`
`}return Y%2&&F>0?ce.substring(0,ce.length-Y-1)+Array(Y+1).join("▀"):ce.substring(0,ce.length-1)};return H.createASCII=function(F,X){if(F=F||1,F<2)return re(X);F-=1,X=typeof X>"u"?F*2:X;var Y=H.getModuleCount()*F+X*2,oe=X,le=Y-X,ue,N,Z,ie,W=Array(F+1).join("██"),z=Array(F+1).join("  "),ae="",ce="";for(ue=0;ue<Y;ue+=1){for(Z=Math.floor((ue-oe)/F),ce="",N=0;N<Y;N+=1)ie=1,oe<=N&&N<le&&oe<=ue&&ue<le&&H.isDark(Z,Math.floor((N-oe)/F))&&(ie=0),ce+=ie?W:z;for(Z=0;Z<F;Z+=1)ae+=ce+`
`}return ae.substring(0,ae.length-1)},H.renderTo2dContext=function(F,X){X=X||2;for(var Y=H.getModuleCount(),oe=0;oe<Y;oe++)for(var le=0;le<Y;le++)F.fillStyle=H.isDark(oe,le)?"black":"white",F.fillRect(oe*X,le*X,X,X)},H};n.stringToBytesFuncs={default:function(w){for(var E=[],S=0;S<w.length;S+=1){var x=w.charCodeAt(S);E.push(x&255)}return E}},n.stringToBytes=n.stringToBytesFuncs.default,n.createStringToBytes=function(w,E){var S=function(){for(var T=y(w),D=function(){var I=T.read();if(I==-1)throw"eof";return I},O=0,R={};;){var P=T.read();if(P==-1)break;var A=D(),H=D(),K=D(),V=String.fromCharCode(P<<8|A),q=H<<8|K;R[V]=q,O+=1}if(O!=E)throw O+" != "+E;return R}(),x=63;return function(T){for(var D=[],O=0;O<T.length;O+=1){var R=T.charCodeAt(O);if(R<128)D.push(R);else{var P=S[T.charAt(O)];typeof P=="number"?(P&255)==P?D.push(P):(D.push(P>>>8),D.push(P&255)):D.push(x)}}return D}};var s={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},o={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a=function(){var w=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],E=1335,S=7973,x=21522,T={},D=function(O){for(var R=0;O!=0;)R+=1,O>>>=1;return R};return T.getBCHTypeInfo=function(O){for(var R=O<<10;D(R)-D(E)>=0;)R^=E<<D(R)-D(E);return(O<<10|R)^x},T.getBCHTypeNumber=function(O){for(var R=O<<12;D(R)-D(S)>=0;)R^=S<<D(R)-D(S);return O<<12|R},T.getPatternPosition=function(O){return w[O-1]},T.getMaskFunction=function(O){switch(O){case o.PATTERN000:return function(R,P){return(R+P)%2==0};case o.PATTERN001:return function(R,P){return R%2==0};case o.PATTERN010:return function(R,P){return P%3==0};case o.PATTERN011:return function(R,P){return(R+P)%3==0};case o.PATTERN100:return function(R,P){return(Math.floor(R/2)+Math.floor(P/3))%2==0};case o.PATTERN101:return function(R,P){return R*P%2+R*P%3==0};case o.PATTERN110:return function(R,P){return(R*P%2+R*P%3)%2==0};case o.PATTERN111:return function(R,P){return(R*P%3+(R+P)%2)%2==0};default:throw"bad maskPattern:"+O}},T.getErrorCorrectPolynomial=function(O){for(var R=c([1],0),P=0;P<O;P+=1)R=R.multiply(c([1,l.gexp(P)],0));return R},T.getLengthInBits=function(O,R){if(1<=R&&R<10)switch(O){case s.MODE_NUMBER:return 10;case s.MODE_ALPHA_NUM:return 9;case s.MODE_8BIT_BYTE:return 8;case s.MODE_KANJI:return 8;default:throw"mode:"+O}else if(R<27)switch(O){case s.MODE_NUMBER:return 12;case s.MODE_ALPHA_NUM:return 11;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 10;default:throw"mode:"+O}else if(R<41)switch(O){case s.MODE_NUMBER:return 14;case s.MODE_ALPHA_NUM:return 13;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 12;default:throw"mode:"+O}else throw"type:"+R},T.getLostPoint=function(O){for(var R=O.getModuleCount(),P=0,A=0;A<R;A+=1)for(var H=0;H<R;H+=1){for(var K=0,V=O.isDark(A,H),q=-1;q<=1;q+=1)if(!(A+q<0||R<=A+q))for(var I=-1;I<=1;I+=1)H+I<0||R<=H+I||q==0&&I==0||V==O.isDark(A+q,H+I)&&(K+=1);K>5&&(P+=3+K-5)}for(var A=0;A<R-1;A+=1)for(var H=0;H<R-1;H+=1){var $=0;O.isDark(A,H)&&($+=1),O.isDark(A+1,H)&&($+=1),O.isDark(A,H+1)&&($+=1),O.isDark(A+1,H+1)&&($+=1),($==0||$==4)&&(P+=3)}for(var A=0;A<R;A+=1)for(var H=0;H<R-6;H+=1)O.isDark(A,H)&&!O.isDark(A,H+1)&&O.isDark(A,H+2)&&O.isDark(A,H+3)&&O.isDark(A,H+4)&&!O.isDark(A,H+5)&&O.isDark(A,H+6)&&(P+=40);for(var H=0;H<R;H+=1)for(var A=0;A<R-6;A+=1)O.isDark(A,H)&&!O.isDark(A+1,H)&&O.isDark(A+2,H)&&O.isDark(A+3,H)&&O.isDark(A+4,H)&&!O.isDark(A+5,H)&&O.isDark(A+6,H)&&(P+=40);for(var j=0,H=0;H<R;H+=1)for(var A=0;A<R;A+=1)O.isDark(A,H)&&(j+=1);var U=Math.abs(100*j/R/R-50)/5;return P+=U*10,P},T}(),l=function(){for(var w=new Array(256),E=new Array(256),S=0;S<8;S+=1)w[S]=1<<S;for(var S=8;S<256;S+=1)w[S]=w[S-4]^w[S-5]^w[S-6]^w[S-8];for(var S=0;S<255;S+=1)E[w[S]]=S;var x={};return x.glog=function(T){if(T<1)throw"glog("+T+")";return E[T]},x.gexp=function(T){for(;T<0;)T+=255;for(;T>=256;)T-=255;return w[T]},x}();function c(w,E){if(typeof w.length>"u")throw w.length+"/"+E;var S=function(){for(var T=0;T<w.length&&w[T]==0;)T+=1;for(var D=new Array(w.length-T+E),O=0;O<w.length-T;O+=1)D[O]=w[O+T];return D}(),x={};return x.getAt=function(T){return S[T]},x.getLength=function(){return S.length},x.multiply=function(T){for(var D=new Array(x.getLength()+T.getLength()-1),O=0;O<x.getLength();O+=1)for(var R=0;R<T.getLength();R+=1)D[O+R]^=l.gexp(l.glog(x.getAt(O))+l.glog(T.getAt(R)));return c(D,0)},x.mod=function(T){if(x.getLength()-T.getLength()<0)return x;for(var D=l.glog(x.getAt(0))-l.glog(T.getAt(0)),O=new Array(x.getLength()),R=0;R<x.getLength();R+=1)O[R]=x.getAt(R);for(var R=0;R<T.getLength();R+=1)O[R]^=l.gexp(l.glog(T.getAt(R))+D);return c(O,0).mod(T)},x}var u=function(){var w=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],E=function(T,D){var O={};return O.totalCount=T,O.dataCount=D,O},S={},x=function(T,D){switch(D){case i.L:return w[(T-1)*4+0];case i.M:return w[(T-1)*4+1];case i.Q:return w[(T-1)*4+2];case i.H:return w[(T-1)*4+3];default:return}};return S.getRSBlocks=function(T,D){var O=x(T,D);if(typeof O>"u")throw"bad rs block @ typeNumber:"+T+"/errorCorrectionLevel:"+D;for(var R=O.length/3,P=[],A=0;A<R;A+=1)for(var H=O[A*3+0],K=O[A*3+1],V=O[A*3+2],q=0;q<H;q+=1)P.push(E(K,V));return P},S}(),d=function(){var w=[],E=0,S={};return S.getBuffer=function(){return w},S.getAt=function(x){var T=Math.floor(x/8);return(w[T]>>>7-x%8&1)==1},S.put=function(x,T){for(var D=0;D<T;D+=1)S.putBit((x>>>T-D-1&1)==1)},S.getLengthInBits=function(){return E},S.putBit=function(x){var T=Math.floor(E/8);w.length<=T&&w.push(0),x&&(w[T]|=128>>>E%8),E+=1},S},h=function(w){var E=s.MODE_NUMBER,S=w,x={};x.getMode=function(){return E},x.getLength=function(O){return S.length},x.write=function(O){for(var R=S,P=0;P+2<R.length;)O.put(T(R.substring(P,P+3)),10),P+=3;P<R.length&&(R.length-P==1?O.put(T(R.substring(P,P+1)),4):R.length-P==2&&O.put(T(R.substring(P,P+2)),7))};var T=function(O){for(var R=0,P=0;P<O.length;P+=1)R=R*10+D(O.charAt(P));return R},D=function(O){if("0"<=O&&O<="9")return O.charCodeAt(0)-48;throw"illegal char :"+O};return x},f=function(w){var E=s.MODE_ALPHA_NUM,S=w,x={};x.getMode=function(){return E},x.getLength=function(D){return S.length},x.write=function(D){for(var O=S,R=0;R+1<O.length;)D.put(T(O.charAt(R))*45+T(O.charAt(R+1)),11),R+=2;R<O.length&&D.put(T(O.charAt(R)),6)};var T=function(D){if("0"<=D&&D<="9")return D.charCodeAt(0)-48;if("A"<=D&&D<="Z")return D.charCodeAt(0)-65+10;switch(D){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+D}};return x},v=function(w){var E=s.MODE_8BIT_BYTE,S=n.stringToBytes(w),x={};return x.getMode=function(){return E},x.getLength=function(T){return S.length},x.write=function(T){for(var D=0;D<S.length;D+=1)T.put(S[D],8)},x},m=function(w){var E=s.MODE_KANJI,S=n.stringToBytesFuncs.SJIS;if(!S)throw"sjis not supported.";(function(D,O){var R=S(D);if(R.length!=2||(R[0]<<8|R[1])!=O)throw"sjis not supported."})("友",38726);var x=S(w),T={};return T.getMode=function(){return E},T.getLength=function(D){return~~(x.length/2)},T.write=function(D){for(var O=x,R=0;R+1<O.length;){var P=(255&O[R])<<8|255&O[R+1];if(33088<=P&&P<=40956)P-=33088;else if(57408<=P&&P<=60351)P-=49472;else throw"illegal char at "+(R+1)+"/"+P;P=(P>>>8&255)*192+(P&255),D.put(P,13),R+=2}if(R<O.length)throw"illegal char at "+(R+1)},T},p=function(){var w=[],E={};return E.writeByte=function(S){w.push(S&255)},E.writeShort=function(S){E.writeByte(S),E.writeByte(S>>>8)},E.writeBytes=function(S,x,T){x=x||0,T=T||S.length;for(var D=0;D<T;D+=1)E.writeByte(S[D+x])},E.writeString=function(S){for(var x=0;x<S.length;x+=1)E.writeByte(S.charCodeAt(x))},E.toByteArray=function(){return w},E.toString=function(){var S="";S+="[";for(var x=0;x<w.length;x+=1)x>0&&(S+=","),S+=w[x];return S+="]",S},E},g=function(){var w=0,E=0,S=0,x="",T={},D=function(R){x+=String.fromCharCode(O(R&63))},O=function(R){if(!(R<0)){if(R<26)return 65+R;if(R<52)return 97+(R-26);if(R<62)return 48+(R-52);if(R==62)return 43;if(R==63)return 47}throw"n:"+R};return T.writeByte=function(R){for(w=w<<8|R&255,E+=8,S+=1;E>=6;)D(w>>>E-6),E-=6},T.flush=function(){if(E>0&&(D(w<<6-E),w=0,E=0),S%3!=0)for(var R=3-S%3,P=0;P<R;P+=1)x+="="},T.toString=function(){return x},T},y=function(w){var E=w,S=0,x=0,T=0,D={};D.read=function(){for(;T<8;){if(S>=E.length){if(T==0)return-1;throw"unexpected end of file./"+T}var R=E.charAt(S);if(S+=1,R=="=")return T=0,-1;if(R.match(/^\s$/))continue;x=x<<6|O(R.charCodeAt(0)),T+=6}var P=x>>>T-8&255;return T-=8,P};var O=function(R){if(65<=R&&R<=90)return R-65;if(97<=R&&R<=122)return R-97+26;if(48<=R&&R<=57)return R-48+52;if(R==43)return 62;if(R==47)return 63;throw"c:"+R};return D},_=function(w,E){var S=w,x=E,T=new Array(w*E),D={};D.setPixel=function(A,H,K){T[H*S+A]=K},D.write=function(A){A.writeString("GIF87a"),A.writeShort(S),A.writeShort(x),A.writeByte(128),A.writeByte(0),A.writeByte(0),A.writeByte(0),A.writeByte(0),A.writeByte(0),A.writeByte(255),A.writeByte(255),A.writeByte(255),A.writeString(","),A.writeShort(0),A.writeShort(0),A.writeShort(S),A.writeShort(x),A.writeByte(0);var H=2,K=R(H);A.writeByte(H);for(var V=0;K.length-V>255;)A.writeByte(255),A.writeBytes(K,V,255),V+=255;A.writeByte(K.length-V),A.writeBytes(K,V,K.length-V),A.writeByte(0),A.writeString(";")};var O=function(A){var H=A,K=0,V=0,q={};return q.write=function(I,$){if(I>>>$)throw"length over";for(;K+$>=8;)H.writeByte(255&(I<<K|V)),$-=8-K,I>>>=8-K,V=0,K=0;V=I<<K|V,K=K+$},q.flush=function(){K>0&&H.writeByte(V)},q},R=function(A){for(var H=1<<A,K=(1<<A)+1,V=A+1,q=P(),I=0;I<H;I+=1)q.add(String.fromCharCode(I));q.add(String.fromCharCode(H)),q.add(String.fromCharCode(K));var $=p(),j=O($);j.write(H,V);var U=0,J=String.fromCharCode(T[U]);for(U+=1;U<T.length;){var ne=String.fromCharCode(T[U]);U+=1,q.contains(J+ne)?J=J+ne:(j.write(q.indexOf(J),V),q.size()<4095&&(q.size()==1<<V&&(V+=1),q.add(J+ne)),J=ne)}return j.write(q.indexOf(J),V),j.write(K,V),j.flush(),$.toByteArray()},P=function(){var A={},H=0,K={};return K.add=function(V){if(K.contains(V))throw"dup key:"+V;A[V]=H,H+=1},K.size=function(){return H},K.indexOf=function(V){return A[V]},K.contains=function(V){return typeof A[V]<"u"},K};return D},b=function(w,E,S){for(var x=_(w,E),T=0;T<E;T+=1)for(var D=0;D<w;D+=1)x.setPixel(D,T,S(D,T));var O=p();x.write(O);for(var R=g(),P=O.toByteArray(),A=0;A<P.length;A+=1)R.writeByte(P[A]);return R.flush(),"data:image/gif;base64,"+R};return n}();(function(){r.stringToBytesFuncs["UTF-8"]=function(n){function s(i){for(var o=[],a=0;a<i.length;a++){var l=i.charCodeAt(a);l<128?o.push(l):l<2048?o.push(192|l>>6,128|l&63):l<55296||l>=57344?o.push(224|l>>12,128|l>>6&63,128|l&63):(a++,l=65536+((l&1023)<<10|i.charCodeAt(a)&1023),o.push(240|l>>18,128|l>>12&63,128|l>>6&63,128|l&63))}return o}return s(n)}})(),function(n){t.exports=n()}(function(){return r})})(Q6);var $1e=Q6.exports,U1e=$t&&$t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Rw=$t&&$t.__assign||function(){return Rw=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Rw.apply(this,arguments)};Object.defineProperty(Y1,"__esModule",{value:!0});var e8=Y1.QRCode=void 0,H1e=j1e,V1e=$1e,x0=k,G1e=function(t){U1e(e,t);function e(r){var n=t.call(this,r)||this;return n.canvasRef=x0.createRef(),n}return e.prototype.download=function(r,n){if(this.canvasRef.current){var s=void 0;switch(r){case"jpg":s="image/jpeg";break;case"webp":s="image/webp";break;case"png":default:s="image/png";break}var i=this.canvasRef.current.toDataURL(s,1),o=document.createElement("a");o.download=n??"react-qrcode-logo",o.href=i,o.click()}},e.prototype.utf16to8=function(r){var n="",s,i,o=r.length;for(s=0;s<o;s++)i=r.charCodeAt(s),i>=1&&i<=127?n+=r.charAt(s):i>2047?(n+=String.fromCharCode(224|i>>12&15),n+=String.fromCharCode(128|i>>6&63),n+=String.fromCharCode(128|i>>0&63)):(n+=String.fromCharCode(192|i>>6&31),n+=String.fromCharCode(128|i>>0&63));return n},e.prototype.drawRoundedSquare=function(r,n,s,i,o,a,l,c){c.lineWidth=r,c.fillStyle=o,c.strokeStyle=o,s+=r/2,n+=r/2,i-=r,Array.isArray(a)||(a=[a,a,a,a]),a=a.map(function(v){return v=Math.min(v,i/2),v<0?0:v});var u=a[0]||0,d=a[1]||0,h=a[2]||0,f=a[3]||0;c.beginPath(),c.moveTo(n+u,s),c.lineTo(n+i-d,s),d&&c.quadraticCurveTo(n+i,s,n+i,s+d),c.lineTo(n+i,s+i-h),h&&c.quadraticCurveTo(n+i,s+i,n+i-h,s+i),c.lineTo(n+f,s+i),f&&c.quadraticCurveTo(n,s+i,n,s+i-f),c.lineTo(n,s+u),u&&c.quadraticCurveTo(n,s,n+u,s),c.closePath(),c.stroke(),l&&c.fill()},e.prototype.drawPositioningPattern=function(r,n,s,i,o,a,l){l===void 0&&(l=[0,0,0,0]);var c=Math.ceil(n),u,d;typeof l!="number"&&!Array.isArray(l)?(u=l.outer||0,d=l.inner||0):(u=l,d=u);var h,f;typeof a!="string"?(h=a.outer,f=a.inner):(h=a,f=a);var v=i*n+s,m=o*n+s,p=n*7;this.drawRoundedSquare(c,m,v,p,h,u,!1,r),p=n*3,v+=n*2,m+=n*2,this.drawRoundedSquare(c,m,v,p,f,d,!0,r)},e.prototype.isInPositioninZone=function(r,n,s){return s.some(function(i){return n>=i.row&&n<=i.row+7&&r>=i.col&&r<=i.col+7})},e.prototype.transformPixelLengthIntoNumberOfCells=function(r,n){return r/n},e.prototype.isCoordinateInImage=function(r,n,s,i,o,a,l,c){if(c){var u=2,d=this.transformPixelLengthIntoNumberOfCells(o,l),h=this.transformPixelLengthIntoNumberOfCells(a,l),f=this.transformPixelLengthIntoNumberOfCells(s,l)-1,v=this.transformPixelLengthIntoNumberOfCells(i,l)-1;return n>=d-u&&n<=d+f+u&&r>=h-u&&r<=h+v+u}else return!1},e.prototype.shouldComponentUpdate=function(r){return!H1e(this.props,r)},e.prototype.componentDidMount=function(){this.update()},e.prototype.componentDidUpdate=function(){this.update()},e.prototype.update=function(){var r,n=this.props,s=n.value,i=n.ecLevel,o=n.enableCORS,a=n.bgColor,l=n.fgColor,c=n.logoImage,u=n.logoOpacity,d=n.logoOnLoad,h=n.removeQrCodeBehindLogo,f=n.qrStyle,v=n.eyeRadius,m=n.eyeColor,p=n.logoPaddingStyle,g=+this.props.size,y=+this.props.quietZone,_=this.props.logoWidth?+this.props.logoWidth:0,b=this.props.logoHeight?+this.props.logoHeight:0,w=this.props.logoPadding?+this.props.logoPadding:0,E=V1e(0,i);E.addData(this.utf16to8(s)),E.make();var S=(r=this.canvasRef)===null||r===void 0?void 0:r.current,x=S.getContext("2d"),T=g+2*y,D=E.getModuleCount(),O=g/D,R=window.devicePixelRatio||1;S.height=S.width=T*R,x.scale(R,R),x.fillStyle=a,x.fillRect(0,0,T,T);var P=y,A=[{row:0,col:0},{row:0,col:D-7},{row:D-7,col:0}];if(x.strokeStyle=l,f==="dots"){x.fillStyle=l;for(var H=O/2,K=0;K<D;K++)for(var V=0;V<D;V++)E.isDark(K,V)&&!this.isInPositioninZone(K,V,A)&&(x.beginPath(),x.arc(Math.round(V*O)+H+P,Math.round(K*O)+H+P,H/100*75,0,2*Math.PI,!1),x.closePath(),x.fill())}else if(f==="fluid"){for(var H=Math.ceil(O/2),K=0;K<D;K++)for(var V=0;V<D;V++)if(E.isDark(K,V)&&!this.isInPositioninZone(K,V,A)){var q=[!1,!1,!1,!1];K>0&&!E.isDark(K-1,V)&&V>0&&!E.isDark(K,V-1)&&(q[0]=!0),K>0&&!E.isDark(K-1,V)&&V<D-1&&!E.isDark(K,V+1)&&(q[1]=!0),K<D-1&&!E.isDark(K+1,V)&&V<D-1&&!E.isDark(K,V+1)&&(q[2]=!0),K<D-1&&!E.isDark(K+1,V)&&V>0&&!E.isDark(K,V-1)&&(q[3]=!0);var I=Math.ceil((V+1)*O)-Math.floor(V*O),$=Math.ceil((K+1)*O)-Math.floor(K*O);x.fillStyle=l,x.beginPath(),x.arc(Math.round(V*O)+H+P,Math.round(K*O)+H+P,H,0,2*Math.PI,!1),x.closePath(),x.fill(),q[0]||x.fillRect(Math.round(V*O)+P,Math.round(K*O)+P,I/2,$/2),q[1]||x.fillRect(Math.round(V*O)+P+Math.floor(I/2),Math.round(K*O)+P,I/2,$/2),q[2]||x.fillRect(Math.round(V*O)+P+Math.floor(I/2),Math.round(K*O)+P+Math.floor($/2),I/2,$/2),q[3]||x.fillRect(Math.round(V*O)+P,Math.round(K*O)+P+Math.floor($/2),I/2,$/2)}}else for(var K=0;K<D;K++)for(var V=0;V<D;V++)if(E.isDark(K,V)&&!this.isInPositioninZone(K,V,A)){x.fillStyle=l;var I=Math.ceil((V+1)*O)-Math.floor(V*O),$=Math.ceil((K+1)*O)-Math.floor(K*O);x.fillRect(Math.round(V*O)+P,Math.round(K*O)+P,I,$)}for(var j=0;j<3;j++){var U=A[j],K=U.row,V=U.col,J=v,ne=void 0;Array.isArray(J)&&(J=J[j]),typeof J=="number"&&(J=[J,J,J,J]),m?Array.isArray(m)?ne=m[j]:ne=m:ne=l,this.drawPositioningPattern(x,O,P,K,V,ne,J)}if(c){var te=new Image;o&&(te.crossOrigin="Anonymous"),te.onload=function(me){x.save();var re=_||g*.2,F=b||re,X=(g-re)/2,Y=(g-F)/2;if(h||w){x.beginPath(),x.strokeStyle=a,x.fillStyle=a;var oe=re+2*w,le=F+2*w,ue=X+P-w,N=Y+P-w;if(p==="circle"){var Z=ue+oe/2,ie=N+le/2;x.ellipse(Z,ie,oe/2,le/2,0,0,2*Math.PI),x.stroke(),x.fill()}else x.fillRect(ue,N,oe,le)}x.globalAlpha=u,x.drawImage(te,X+P,Y+P,re,F),x.restore(),d&&d(me)},te.src=c}},e.prototype.render=function(){var r,n=+this.props.size+2*+this.props.quietZone;return x0.createElement("canvas",{id:(r=this.props.id)!==null&&r!==void 0?r:"react-qrcode-logo",height:n,width:n,style:Rw({height:n+"px",width:n+"px"},this.props.style),ref:this.canvasRef})},e.defaultProps={value:"https://reactjs.org/",ecLevel:"M",enableCORS:!1,size:150,quietZone:10,bgColor:"#FFFFFF",fgColor:"#000000",logoOpacity:1,qrStyle:"squares",eyeRadius:[0,0,0],logoPaddingStyle:"square"},e}(x0.Component);e8=Y1.QRCode=G1e;const z1e=({open:t,onClose:e})=>{const r=at(gd);return C.jsx(ip,{open:t,onOpenChange:n=>!n&&e(),children:C.jsx(F1e,{className:"text-center !flex-col !mx-auto !text-center !max-w-md",showCloseButton:!0,onClose:e,children:C.jsxs("div",{className:"border !border-codeia-elements-borderColor flex flex-col gap-5 justify-center items-center p-6 bg-codeia-elements-background-depth-2 rounded-md",children:[C.jsx("div",{className:"h-10 w-full invert dark:invert-none"}),C.jsx(M1e,{className:"text-codeia-elements-textTertiary text-lg font-semibold leading-6",children:"Preview on your own mobile device"}),C.jsx(L1e,{className:"bg-codeia-elements-background-depth-3 max-w-sm rounded-md p-1 border border-codeia-elements-borderColor",children:"Scan this QR code with the Expo Go app on your mobile device to open your project."}),C.jsx("div",{className:"my-6 flex flex-col items-center",children:r?C.jsx(e8,{logoImage:"/favicon.svg",removeQrCodeBehindLogo:!0,logoPadding:3,logoHeight:50,logoWidth:50,logoPaddingStyle:"square",style:{borderRadius:16,padding:2,backgroundColor:"#8a5fff"},value:r,size:200}):C.jsx("div",{className:"text-gray-500 text-center",children:"No Expo URL detected."})})]})})})},n2=[{name:"iPhone SE",width:375,height:667,icon:"i-ph:device-mobile",hasFrame:!0,frameType:"mobile"},{name:"iPhone 12/13",width:390,height:844,icon:"i-ph:device-mobile",hasFrame:!0,frameType:"mobile"},{name:"iPhone 12/13 Pro Max",width:428,height:926,icon:"i-ph:device-mobile",hasFrame:!0,frameType:"mobile"},{name:"iPad Mini",width:768,height:1024,icon:"i-ph:device-tablet",hasFrame:!0,frameType:"tablet"},{name:"iPad Air",width:820,height:1180,icon:"i-ph:device-tablet",hasFrame:!0,frameType:"tablet"},{name:'iPad Pro 11"',width:834,height:1194,icon:"i-ph:device-tablet",hasFrame:!0,frameType:"tablet"},{name:'iPad Pro 12.9"',width:1024,height:1366,icon:"i-ph:device-tablet",hasFrame:!0,frameType:"tablet"},{name:"Small Laptop",width:1280,height:800,icon:"i-ph:laptop",hasFrame:!0,frameType:"laptop"},{name:"Laptop",width:1366,height:768,icon:"i-ph:laptop",hasFrame:!0,frameType:"laptop"},{name:"Large Laptop",width:1440,height:900,icon:"i-ph:laptop",hasFrame:!0,frameType:"laptop"},{name:"Desktop",width:1920,height:1080,icon:"i-ph:monitor",hasFrame:!0,frameType:"desktop"},{name:"4K Display",width:3840,height:2160,icon:"i-ph:monitor",hasFrame:!0,frameType:"desktop"}],W1e=k.memo(()=>{const t=k.useRef(null),e=k.useRef(null),r=k.useRef(null),[n,s]=k.useState(0),[i,o]=k.useState(!1),[a,l]=k.useState(!1),c=k.useRef(!1),u=at(Ie.previews),d=u[n],[h,f]=k.useState("/"),[v,m]=k.useState(),[p,g]=k.useState(!1),[y,_]=k.useState(!1),[b,w]=k.useState(37.5),[E,S]=k.useState(0),x=k.useRef({isResizing:!1,side:null,startX:0,startWidthPercent:37.5,windowWidth:window.innerWidth,pointerId:null}),T=1,[D,O]=k.useState(!1),[R,P]=k.useState(n2[0]),[A,H]=k.useState(!1),[K,V]=k.useState(!0),[q,I]=k.useState(!1),$=at(gd),[j,U]=k.useState(!1);k.useEffect(()=>{if(!d){m(void 0),f("/");return}const{baseUrl:Z}=d;m(Z),f("/")},[d]);const J=k.useCallback((Z,ie,W,z)=>ie.port<z[Z].port?W:Z,[]);k.useEffect(()=>{if(u.length>1&&!c.current){const Z=u.reduce(J,0);s(Z)}},[u,J]);const ne=()=>{t.current&&(t.current.src=t.current.src)},te=async()=>{!a&&e.current?await e.current.requestFullscreen():document.fullscreenElement&&await document.exitFullscreen()};k.useEffect(()=>{const Z=()=>{l(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",Z),()=>{document.removeEventListener("fullscreenchange",Z)}},[]);const me=()=>{_(Z=>!Z)},re=(Z,ie)=>{if(!y)return;Z.currentTarget.setPointerCapture(Z.pointerId),document.body.style.userSelect="none",document.body.style.cursor="ew-resize",x.current={isResizing:!0,side:ie,startX:Z.clientX,startWidthPercent:b,windowWidth:window.innerWidth,pointerId:Z.pointerId}},F=({side:Z})=>Z?C.jsx("div",{className:`resize-handle-${Z}`,onPointerDown:ie=>re(ie,Z),style:{position:"absolute",top:0,...Z==="left"?{left:0,marginLeft:"-7px"}:{right:0,marginRight:"-7px"},width:"15px",height:"100%",cursor:"ew-resize",background:"var(--codeia-elements-background-depth-4, rgba(0,0,0,.3))",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",userSelect:"none",touchAction:"none",zIndex:10},onMouseOver:ie=>ie.currentTarget.style.background="var(--codeia-elements-background-depth-4, rgba(0,0,0,.3))",onMouseOut:ie=>ie.currentTarget.style.background="var(--codeia-elements-background-depth-3, rgba(0,0,0,.15))",title:"Drag to resize width",children:C.jsx(X,{})}):null;k.useEffect(()=>{if(!y)return;const Z=z=>{const ae=x.current;if(!ae.isResizing||z.pointerId!==ae.pointerId)return;const ge=(z.clientX-ae.startX)/ae.windowWidth*100*T;let de=ae.startWidthPercent;if(ae.side==="right"?de=ae.startWidthPercent+ge:ae.side==="left"&&(de=ae.startWidthPercent-ge),de=Math.max(10,Math.min(de,90)),w(de),e.current){const fe=e.current.clientWidth,we=Math.round(fe*de/100);S(we);const _e=e.current.querySelector('div[style*="width"]');_e&&(_e.style.width=`${de}%`)}},ie=z=>{const ae=x.current;if(!ae.isResizing||z.pointerId!==ae.pointerId)return;document.querySelectorAll(".resize-handle-left, .resize-handle-right").forEach(ge=>{ge.hasPointerCapture?.(z.pointerId)&&ge.releasePointerCapture(z.pointerId)}),x.current={...x.current,isResizing:!1,side:null,pointerId:null},document.body.style.userSelect="",document.body.style.cursor=""};document.addEventListener("pointermove",Z,{passive:!1}),document.addEventListener("pointerup",ie),document.addEventListener("pointercancel",ie);function W(){document.removeEventListener("pointermove",Z),document.removeEventListener("pointerup",ie),document.removeEventListener("pointercancel",ie),x.current.pointerId!==null&&(document.querySelectorAll(".resize-handle-left, .resize-handle-right").forEach(ae=>{ae.hasPointerCapture?.(x.current.pointerId)&&ae.releasePointerCapture(x.current.pointerId)}),x.current={...x.current,isResizing:!1,side:null,pointerId:null},document.body.style.userSelect="",document.body.style.cursor="")}return W},[y,T]),k.useEffect(()=>{const Z=()=>{if(x.current.windowWidth=window.innerWidth,e.current&&y){const ie=e.current.clientWidth;S(Math.round(ie*b/100))}};if(window.addEventListener("resize",Z),e.current&&y){const ie=e.current.clientWidth;S(Math.round(ie*b/100))}return()=>{window.removeEventListener("resize",Z)}},[y,b]),k.useEffect(()=>{if(e.current&&y){const Z=e.current.clientWidth;S(Math.round(Z*b/100))}},[y]);const X=()=>C.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",pointerEvents:"none"},children:C.jsx("div",{style:{color:"var(--codeia-elements-textSecondary, rgba(0,0,0,0.5))",fontSize:"10px",lineHeight:"5px",userSelect:"none",marginLeft:"1px"},children:"••• •••"})}),Y=Z=>{if(d?.baseUrl){const ie=d.baseUrl.match(/^https?:\/\/([^.]+)\.local-credentialless\.webcontainer-api\.io/);if(ie){const z=`/webcontainer/preview/${ie[1]}`;let ae=Z.width,ce=Z.height;if(A&&(Z.frameType==="mobile"||Z.frameType==="tablet")&&(ae=Z.height,ce=Z.width),K&&Z.hasFrame){const ge=Z.frameType==="mobile"?A?120:40:60,de=Z.frameType==="mobile"?80:A?60:100,fe=window.open("","_blank",`width=${ae+ge},height=${ce+de+40},menubar=no,toolbar=no,location=no,status=no`);if(!fe){console.error("Failed to open new window");return}const we=N(),_e=Z.frameType==="mobile"?"36px":"20px",Ae=Z.frameType==="mobile"?A?"40px 60px":"40px 20px":A?"30px 50px":"50px 30px",ze=A?"50%":"20px",Ne=A?"30px":"50%",ft=A?"translateY(-50%)":"translateX(-50%)",G=A?"8px":Z.frameType==="mobile"?"60px":"80px",M=A?Z.frameType==="mobile"?"60px":"80px":"8px",B=A?"50%":"15px",Q=A?"30px":"50%",he=A?"translateY(50%)":"translateX(50%)",ye=A?"4px":"40px",be=A?"40px":"4px",We=`
            <!DOCTYPE html>
            <html>
            <head>
              <meta charset="utf-8">
              <title>${Z.name} Preview</title>
              <style>
                body {
                  margin: 0;
                  padding: 0;
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  height: 100vh;
                  background: #f0f0f0;
                  overflow: hidden;
                  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
                }
                
                .device-container {
                  position: relative;
                }
                
                .device-name {
                  position: absolute;
                  top: -30px;
                  left: 0;
                  right: 0;
                  text-align: center;
                  font-size: 14px;
                  color: #333;
                }
                
                .device-frame {
                  position: relative;
                  border-radius: ${_e};
                  background: ${we};
                  padding: ${Ae};
                  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                  overflow: hidden;
                }
                
                /* Notch */
                .device-frame:before {
                  content: '';
                  position: absolute;
                  top: ${ze};
                  left: ${Ne};
                  transform: ${ft};
                  width: ${G};
                  height: ${M};
                  background: #333;
                  border-radius: 4px;
                  z-index: 2;
                }
                
                /* Home button */
                .device-frame:after {
                  content: '';
                  position: absolute;
                  bottom: ${B};
                  right: ${Q};
                  transform: ${he};
                  width: ${ye};
                  height: ${be};
                  background: #333;
                  border-radius: 50%;
                  z-index: 2;
                }
                
                iframe {
                  border: none;
                  width: ${ae}px;
                  height: ${ce}px;
                  background: white;
                  display: block;
                }
              </style>
            </head>
            <body>
              <div class="device-container">
                <div class="device-name">${Z.name} ${A?"(Landscape)":"(Portrait)"}</div>
                <div class="device-frame">
                  <iframe src="${z}" sandbox="allow-scripts allow-forms allow-popups allow-modals allow-storage-access-by-user-activation allow-same-origin" allow="cross-origin-isolated"></iframe>
                </div>
              </div>
            </body>
            </html>
          `;fe.document.open(),fe.document.write(We),fe.document.close()}else{const ge=window.open(z,"_blank",`width=${ae},height=${ce},menubar=no,toolbar=no,location=no,status=no`);ge&&ge.focus()}}else console.warn("[Preview] Invalid WebContainer URL:",d.baseUrl)}},oe=()=>{d?.baseUrl&&window.open(d?.baseUrl,"_blank")},le=k.useCallback(()=>{if(!R)return"40px 20px";const Z=R.frameType==="mobile";return A?Z?"40px 60px":"30px 50px":Z?"40px 20px":"50px 30px"},[A,R]),ue=k.useCallback(()=>1,[A,R,b]);k.useEffect(()=>()=>{},[y,q,ue,A,R]);const N=k.useCallback(()=>document.documentElement.classList.contains("dark")||document.documentElement.getAttribute("data-theme")==="dark"||window.matchMedia("(prefers-color-scheme: dark)").matches?"#555":"#111",[]);return k.useEffect(()=>{const Z=window.matchMedia("(prefers-color-scheme: dark)"),ie=()=>{q&&I(!0)};return Z.addEventListener("change",ie),()=>{Z.removeEventListener("change",ie)}},[q]),C.jsxs("div",{ref:e,className:"w-full h-full flex flex-col relative",children:[i&&C.jsx("div",{className:"z-iframe-overlay w-full h-full absolute",onClick:()=>o(!1)}),C.jsxs("div",{className:"bg-codeia-elements-background-depth-2 p-2 flex items-center gap-2",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(hr,{icon:"i-ph:arrow-clockwise",onClick:ne}),C.jsx(hr,{icon:"i-ph:selection",onClick:()=>g(!p),className:p?"bg-codeia-elements-background-depth-3":""})]}),C.jsxs("div",{className:"flex-grow flex items-center gap-1 bg-codeia-elements-preview-addressBar-background border border-codeia-elements-borderColor text-codeia-elements-preview-addressBar-text rounded-full px-1 py-1 text-sm hover:bg-codeia-elements-preview-addressBar-backgroundHover hover:focus-within:bg-codeia-elements-preview-addressBar-backgroundActive focus-within:bg-codeia-elements-preview-addressBar-backgroundActive focus-within-border-codeia-elements-borderColorActive focus-within:text-codeia-elements-preview-addressBar-textActive",children:[C.jsx(w1e,{activePreviewIndex:n,setActivePreviewIndex:s,isDropdownOpen:i,setHasSelectedPreview:Z=>c.current=Z,setIsDropdownOpen:o,previews:u}),C.jsx("input",{title:"URL Path",ref:r,className:"w-full bg-transparent outline-none",type:"text",value:h,onChange:Z=>{f(Z.target.value)},onKeyDown:Z=>{if(Z.key==="Enter"&&d){let ie=h.trim();ie.startsWith("/")||(ie="/"+ie);const W=d.baseUrl+ie;m(W),f(ie),r.current&&r.current.blur()}},disabled:!d})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(hr,{icon:"i-ph:devices",onClick:me,title:y?"Switch to Responsive Mode":"Switch to Device Mode"}),$&&C.jsx(hr,{icon:"i-ph:qr-code",onClick:()=>U(!0),title:"Show QR"}),C.jsx(z1e,{open:j,onClose:()=>U(!1)}),y&&C.jsxs(C.Fragment,{children:[C.jsx(hr,{icon:"i-ph:device-rotate",onClick:()=>H(!A),title:A?"Switch to Portrait":"Switch to Landscape"}),C.jsx(hr,{icon:q?"i-ph:device-mobile":"i-ph:device-mobile-slash",onClick:()=>I(!q),title:q?"Hide Device Frame":"Show Device Frame"})]}),C.jsx(hr,{icon:a?"i-ph:arrows-in":"i-ph:arrows-out",onClick:te,title:a?"Exit Full Screen":"Full Screen"}),C.jsxs("div",{className:"flex items-center relative",children:[C.jsx(hr,{icon:"i-ph:list",onClick:()=>O(!D),title:"New Window Options"}),D&&C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>O(!1)}),C.jsxs("div",{className:"absolute right-0 top-full mt-2 z-50 min-w-[240px] max-h-[400px] overflow-y-auto bg-white dark:bg-black rounded-xl shadow-2xl border border-[#E5E7EB] dark:border-[rgba(255,255,255,0.1)] overflow-hidden",children:[C.jsxs("div",{className:"p-3 border-b border-[#E5E7EB] dark:border-[rgba(255,255,255,0.1)]",children:[C.jsx("div",{className:"flex items-center justify-between mb-2",children:C.jsx("span",{className:"text-sm font-medium text-[#111827] dark:text-gray-300",children:"Window Options"})}),C.jsxs("div",{className:"flex flex-col gap-2",children:[C.jsxs("button",{className:"flex w-full justify-between items-center text-start bg-transparent text-xs text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary",onClick:()=>{oe()},children:[C.jsx("span",{children:"Open in new tab"}),C.jsx("div",{className:"i-ph:arrow-square-out h-5 w-4"})]}),C.jsxs("button",{className:"flex w-full justify-between items-center text-start bg-transparent text-xs text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary",onClick:()=>{if(!d?.baseUrl){console.warn("[Preview] No active preview available");return}const Z=d.baseUrl.match(/^https?:\/\/([^.]+)\.local-credentialless\.webcontainer-api\.io/);if(!Z){console.warn("[Preview] Invalid WebContainer URL:",d.baseUrl);return}const ie=Z[1],W=`/webcontainer/preview/${ie}`;window.open(W,`preview-${ie}`,"width=1280,height=720,menubar=no,toolbar=no,location=no,status=no,resizable=yes")},children:[C.jsx("span",{children:"Open in new window"}),C.jsx("div",{className:"i-ph:browser h-5 w-4"})]}),C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("span",{className:"text-xs text-codeia-elements-textTertiary",children:"Show Device Frame"}),C.jsx("button",{className:`w-10 h-5 rounded-full transition-colors duration-200 ${K?"bg-[#6D28D9]":"bg-gray-300 dark:bg-gray-700"} relative`,onClick:Z=>{Z.stopPropagation(),V(!K)},children:C.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform duration-200 ${K?"transform translate-x-5":""}`})})]}),C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("span",{className:"text-xs text-codeia-elements-textTertiary",children:"Landscape Mode"}),C.jsx("button",{className:`w-10 h-5 rounded-full transition-colors duration-200 ${A?"bg-[#6D28D9]":"bg-gray-300 dark:bg-gray-700"} relative`,onClick:Z=>{Z.stopPropagation(),H(!A)},children:C.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform duration-200 ${A?"transform translate-x-5":""}`})})]})]})]}),n2.map(Z=>C.jsxs("button",{className:"w-full px-4 py-3.5 text-left text-[#111827] dark:text-gray-300 text-sm whitespace-nowrap flex items-center gap-3 group hover:bg-[#F5EEFF] dark:hover:bg-gray-900 bg-white dark:bg-black",onClick:()=>{P(Z),O(!1),Y(Z)},children:[C.jsx("div",{className:`${Z.icon} w-5 h-5 text-[#6B7280] dark:text-gray-400 group-hover:text-[#6D28D9] dark:group-hover:text-[#6D28D9] transition-colors duration-200`}),C.jsxs("div",{className:"flex-grow flex flex-col",children:[C.jsx("span",{className:"font-medium group-hover:text-[#6D28D9] dark:group-hover:text-[#6D28D9] transition-colors duration-200",children:Z.name}),C.jsxs("span",{className:"text-xs text-[#6B7280] dark:text-gray-400 group-hover:text-[#6D28D9] dark:group-hover:text-[#6D28D9] transition-colors duration-200",children:[A&&(Z.frameType==="mobile"||Z.frameType==="tablet")?`${Z.height} × ${Z.width}`:`${Z.width} × ${Z.height}`,Z.hasFrame&&K?" (with frame)":""]})]}),R.name===Z.name&&C.jsx("div",{className:"text-[#6D28D9] dark:text-[#6D28D9]",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:C.jsx("polyline",{points:"20 6 9 17 4 12"})})})]},Z.name))]})]})]})]})]}),C.jsx("div",{className:"flex-1 border-t border-codeia-elements-borderColor flex justify-center items-center overflow-auto",children:C.jsxs("div",{style:{width:y?q?"100%":`${b}%`:"100%",height:"100%",overflow:"auto",background:"var(--codeia-elements-background-depth-1)",position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},children:[d?C.jsxs(C.Fragment,{children:[y&&q?C.jsx("div",{className:"device-wrapper",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",padding:"0",overflow:"auto",transition:"all 0.3s ease",position:"relative"},children:C.jsxs("div",{className:"device-frame-container",style:{position:"relative",borderRadius:R.frameType==="mobile"?"36px":"20px",background:N(),padding:le(),boxShadow:"0 10px 30px rgba(0,0,0,0.2)",overflow:"hidden",transform:"scale(1)",transformOrigin:"center center",transition:"all 0.3s ease",margin:"40px",width:A?`${R.height+(R.frameType==="mobile"?120:60)}px`:`${R.width+(R.frameType==="mobile"?40:60)}px`,height:A?`${R.width+(R.frameType==="mobile"?80:60)}px`:`${R.height+(R.frameType==="mobile"?80:100)}px`},children:[C.jsx("div",{style:{position:"absolute",top:A?"50%":"20px",left:A?"30px":"50%",transform:A?"translateY(-50%)":"translateX(-50%)",width:A?"8px":R.frameType==="mobile"?"60px":"80px",height:A?R.frameType==="mobile"?"60px":"80px":"8px",background:"#333",borderRadius:"4px",zIndex:2}}),C.jsx("div",{style:{position:"absolute",bottom:A?"50%":"15px",right:A?"30px":"50%",transform:A?"translateY(50%)":"translateX(50%)",width:A?"4px":"40px",height:A?"40px":"4px",background:"#333",borderRadius:"50%",zIndex:2}}),C.jsx("iframe",{ref:t,title:"preview",style:{border:"none",width:A?`${R.height}px`:`${R.width}px`,height:A?`${R.width}px`:`${R.height}px`,background:"white",display:"block"},src:v,sandbox:"allow-scripts allow-forms allow-popups allow-modals allow-storage-access-by-user-activation allow-same-origin",allow:"cross-origin-isolated"})]})}):C.jsx("iframe",{ref:t,title:"preview",className:"border-none w-full h-full bg-codeia-elements-background-depth-1",src:v,sandbox:"allow-scripts allow-forms allow-popups allow-modals allow-storage-access-by-user-activation allow-same-origin",allow:"geolocation; ch-ua-full-version-list; cross-origin-isolated; screen-wake-lock; publickey-credentials-get; shared-storage-select-url; ch-ua-arch; bluetooth; compute-pressure; ch-prefers-reduced-transparency; deferred-fetch; usb; ch-save-data; publickey-credentials-create; shared-storage; deferred-fetch-minimal; run-ad-auction; ch-ua-form-factors; ch-downlink; otp-credentials; payment; ch-ua; ch-ua-model; ch-ect; autoplay; camera; private-state-token-issuance; accelerometer; ch-ua-platform-version; idle-detection; private-aggregation; interest-cohort; ch-viewport-height; local-fonts; ch-ua-platform; midi; ch-ua-full-version; xr-spatial-tracking; clipboard-read; gamepad; display-capture; keyboard-map; join-ad-interest-group; ch-width; ch-prefers-reduced-motion; browsing-topics; encrypted-media; gyroscope; serial; ch-rtt; ch-ua-mobile; window-management; unload; ch-dpr; ch-prefers-color-scheme; ch-ua-wow64; attribution-reporting; fullscreen; identity-credentials-get; private-state-token-redemption; hid; ch-ua-bitness; storage-access; sync-xhr; ch-device-memory; ch-viewport-width; picture-in-picture; magnetometer; clipboard-write; microphone"}),C.jsx(x1e,{isSelectionMode:p,setIsSelectionMode:g,containerRef:t})]}):C.jsx("div",{className:"flex w-full h-full justify-center items-center bg-codeia-elements-background-depth-1 text-codeia-elements-textPrimary",children:"No preview available"}),y&&!q&&C.jsxs(C.Fragment,{children:[C.jsxs("div",{style:{position:"absolute",top:"-25px",left:"50%",transform:"translateX(-50%)",background:"var(--codeia-elements-background-depth-3, rgba(0,0,0,0.7))",color:"var(--codeia-elements-textPrimary, white)",padding:"2px 8px",borderRadius:"4px",fontSize:"12px",pointerEvents:"none",opacity:x.current.isResizing?1:0,transition:"opacity 0.3s"},children:[E,"px"]}),C.jsx(F,{side:"left"}),C.jsx(F,{side:"right"})]})]})})]})});function K1e(t){const e=["B","KB","MB","GB","TB"];let r=t,n=0;for(;r>=1024&&n<e.length-1;)r/=1024,n++;return`${r.toFixed(1)} ${e[n]}`}const q1e=X6("inline-flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-codeia-elements-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-codeia-elements-background text-codeia-elements-textPrimary hover:bg-codeia-elements-background/80",secondary:"border-transparent bg-codeia-elements-background text-codeia-elements-textSecondary hover:bg-codeia-elements-background/80",destructive:"border-transparent bg-red-500/10 text-red-500 hover:bg-red-500/20",outline:"text-codeia-elements-textPrimary",primary:"bg-purple-500/10 text-purple-600 dark:text-purple-400",success:"bg-green-500/10 text-green-600 dark:text-green-400",warning:"bg-yellow-500/10 text-yellow-600 dark:text-yellow-400",danger:"bg-red-500/10 text-red-600 dark:text-red-400",info:"bg-blue-500/10 text-blue-600 dark:text-blue-400",subtle:"border border-codeia-elements-borderColor/30 dark:border-codeia-elements-borderColor-dark/30 bg-white/50 dark:bg-codeia-elements-background-depth-4/50 backdrop-blur-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark"},size:{default:"rounded-full px-2.5 py-0.5 text-xs font-semibold",sm:"rounded-full px-1.5 py-0.5 text-xs",md:"rounded-md px-2 py-1 text-xs font-medium",lg:"rounded-md px-2.5 py-1.5 text-sm"}},defaultVariants:{variant:"default",size:"default"}});function Bc({className:t,variant:e,size:r,icon:n,children:s,...i}){return C.jsxs("div",{className:Te(q1e({variant:e,size:r}),t),...i,children:[n&&C.jsx("span",{className:n}),s]})}const t8=k.forwardRef(({className:t,type:e,...r},n)=>C.jsx("input",{type:e,className:Te("flex h-10 w-full rounded-md border border-codeia-elements-border bg-codeia-elements-background px-3 py-2 text-sm ring-offset-codeia-elements-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-codeia-elements-textSecondary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-codeia-elements-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...r}));t8.displayName="Input";var J1e="VisuallyHidden",r8=k.forwardRef((t,e)=>C.jsx(pt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));r8.displayName=J1e;var Y1e=r8,[fv,uke]=Gs("Tooltip",[lv]),Z1=lv(),n8="TooltipProvider",Z1e=700,s2="tooltip.open",[X1e,s8]=fv(n8),i8=t=>{const{__scopeTooltip:e,delayDuration:r=Z1e,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=t,[o,a]=k.useState(!0),l=k.useRef(!1),c=k.useRef(0);return k.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),C.jsx(X1e,{scope:e,isOpenDelayed:o,delayDuration:r,onOpen:k.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:k.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:k.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};i8.displayName=n8;var o8="Tooltip",[dke,pv]=fv(o8),Pw="TooltipTrigger",Q1e=k.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=pv(Pw,r),i=s8(Pw,r),o=Z1(r),a=k.useRef(null),l=Wt(e,a,s.onTriggerChange),c=k.useRef(!1),u=k.useRef(!1),d=k.useCallback(()=>c.current=!1,[]);return k.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),C.jsx(l$,{asChild:!0,...o,children:C.jsx(pt.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:l,onPointerMove:Ue(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Ue(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Ue(t.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Ue(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:Ue(t.onBlur,s.onClose),onClick:Ue(t.onClick,s.onClose)})})});Q1e.displayName=Pw;var eEe="TooltipPortal",[hke,tEe]=fv(eEe,{forceMount:void 0}),Xl="TooltipContent",rEe=k.forwardRef((t,e)=>{const r=tEe(Xl,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=t,o=pv(Xl,t.__scopeTooltip);return C.jsx(is,{present:n||o.open,children:o.disableHoverableContent?C.jsx(a8,{side:s,...i,ref:e}):C.jsx(nEe,{side:s,...i,ref:e})})}),nEe=k.forwardRef((t,e)=>{const r=pv(Xl,t.__scopeTooltip),n=s8(Xl,t.__scopeTooltip),s=k.useRef(null),i=Wt(e,s),[o,a]=k.useState(null),{trigger:l,onClose:c}=r,u=s.current,{onPointerInTransitChange:d}=n,h=k.useCallback(()=>{a(null),d(!1)},[d]),f=k.useCallback((v,m)=>{const p=v.currentTarget,g={x:v.clientX,y:v.clientY},y=aEe(g,p.getBoundingClientRect()),_=lEe(g,y),b=cEe(m.getBoundingClientRect()),w=dEe([..._,...b]);a(w),d(!0)},[d]);return k.useEffect(()=>()=>h(),[h]),k.useEffect(()=>{if(l&&u){const v=p=>f(p,u),m=p=>f(p,l);return l.addEventListener("pointerleave",v),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",v),u.removeEventListener("pointerleave",m)}}},[l,u,f,h]),k.useEffect(()=>{if(o){const v=m=>{const p=m.target,g={x:m.clientX,y:m.clientY},y=l?.contains(p)||u?.contains(p),_=!uEe(g,o);y?h():_&&(h(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,u,o,c,h]),C.jsx(a8,{...t,ref:i})}),[sEe,iEe]=fv(o8,{isInside:!1}),a8=k.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=pv(Xl,r),c=Z1(r),{onClose:u}=l;return k.useEffect(()=>(document.addEventListener(s2,u),()=>document.removeEventListener(s2,u)),[u]),k.useEffect(()=>{if(l.trigger){const d=h=>{h.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),C.jsx(av,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:C.jsxs(c$,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[C.jsx(T4,{children:n}),C.jsx(sEe,{scope:r,isInside:!0,children:C.jsx(Y1e,{id:l.contentId,role:"tooltip",children:s||n})})]})})});rEe.displayName=Xl;var l8="TooltipArrow",oEe=k.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=Z1(r);return iEe(l8,r).isInside?null:C.jsx(u$,{...s,...n,ref:e})});oEe.displayName=l8;function aEe(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function lEe(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function cEe(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function uEe(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>n!=u>n&&r<(c-a)*(n-l)/(u-l)+a&&(s=!s)}return s}function dEe(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),hEe(e)}function hEe(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var fEe=i8;const pEe={default:{container:"py-8 p-6",icon:{container:"w-12 h-12 mb-3",size:"w-6 h-6"},title:"text-base",description:"text-sm mt-1",actions:"mt-4",buttonSize:"default"},compact:{container:"py-4 p-4",icon:{container:"w-10 h-10 mb-2",size:"w-5 h-5"},title:"text-sm",description:"text-xs mt-0.5",actions:"mt-3",buttonSize:"sm"}};function i2({icon:t="i-ph:folder-simple-dashed",title:e,description:r,actionLabel:n,onAction:s,secondaryActionLabel:i,onSecondaryAction:o,className:a,variant:l="default"}){const c=pEe[l],u={whileHover:{scale:1.02},whileTap:{scale:.98}};return C.jsxs("div",{className:Te("flex flex-col items-center justify-center","text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark","bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 rounded-lg",c.container,a),children:[C.jsx("div",{className:Te("rounded-full bg-codeia-elements-background-depth-3 dark:bg-codeia-elements-background-depth-4 flex items-center justify-center",c.icon.container),children:C.jsx("span",{className:Te(t,c.icon.size,"text-codeia-elements-textTertiary dark:text-codeia-elements-textTertiary-dark")})}),C.jsx("p",{className:Te("font-medium",c.title),children:e}),r&&C.jsx("p",{className:Te("text-codeia-elements-textTertiary dark:text-codeia-elements-textTertiary-dark text-center max-w-xs",c.description),children:r}),(n||i)&&C.jsxs("div",{className:Te("flex items-center gap-2",c.actions),children:[n&&s&&C.jsx(mt.div,{...u,children:C.jsx(Aw,{onClick:s,variant:"default",size:c.buttonSize,className:"bg-purple-500 hover:bg-purple-600 text-white",children:n})}),i&&o&&C.jsx(mt.div,{...u,children:C.jsx(Aw,{onClick:o,variant:"outline",size:c.buttonSize,children:i})})]})]})}const c8=k.forwardRef(({className:t,onClear:e,showClearButton:r=!0,iconClassName:n,containerClassName:s,loading:i=!1,...o},a)=>{const l=!!o.value;return C.jsxs("div",{className:Te("relative flex items-center w-full",s),children:[C.jsx("div",{className:Te("absolute left-3 top-1/2 -translate-y-1/2 text-codeia-elements-textTertiary",n),children:i?C.jsx("span",{className:"i-ph:spinner-gap animate-spin w-4 h-4"}):C.jsx("span",{className:"i-ph:magnifying-glass w-4 h-4"})}),C.jsx(t8,{ref:a,className:Te("pl-10",l&&r?"pr-10":"",t),...o}),C.jsx(Hw,{children:l&&r&&C.jsx(mt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},type:"button",onClick:e,className:"absolute right-3 top-1/2 -translate-y-1/2 text-codeia-elements-textTertiary hover:text-codeia-elements-textSecondary p-1 rounded-full hover:bg-codeia-elements-background-depth-2","aria-label":"Clear search",children:C.jsx("span",{className:"i-ph:x w-3.5 h-3.5"})})})]})});c8.displayName="SearchInput";const mEe={online:"bg-green-500",success:"bg-green-500",offline:"bg-red-500",error:"bg-red-500",away:"bg-yellow-500",warning:"bg-yellow-500",busy:"bg-red-500",info:"bg-blue-500",loading:"bg-purple-500"},gEe={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},vEe={sm:"text-xs",md:"text-sm",lg:"text-base"};function yEe({status:t,size:e="md",pulse:r=!1,label:n,className:s}){const i=mEe[t]||"bg-gray-500",o=gEe[e],a=vEe[e];return C.jsxs("div",{className:Te("flex items-center gap-2",s),children:[C.jsx("span",{className:Te("rounded-full relative",i,o),children:r&&C.jsx("span",{className:Te("absolute inset-0 rounded-full animate-ping opacity-75",i)})}),n&&C.jsx("span",{className:Te("text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark",a),children:n})]})}function _Ee({isOpen:t,onClose:e,onPush:r}){const[n,s]=k.useState(""),[i,o]=k.useState(!1),[a,l]=k.useState(!1),[c,u]=k.useState(null),[d,h]=k.useState([]),[f,v]=k.useState([]),[m,p]=k.useState(""),[g,y]=k.useState(!1),[_,b]=k.useState(!1),[w,E]=k.useState(""),[S,x]=k.useState([]);k.useEffect(()=>{if(t){const R=Vf("github_connection");R?.user&&R?.token&&(u(R.user),R.token.trim()&&T(R.token))}},[t]),k.useEffect(()=>{if(d.length===0){v([]);return}if(!m.trim()){v(d);return}const R=m.toLowerCase().trim(),P=d.filter(A=>A.name.toLowerCase().includes(R)||A.description&&A.description.toLowerCase().includes(R)||A.language&&A.language.toLowerCase().includes(R));v(P)},[d,m]);const T=k.useCallback(async R=>{if(!R){ln.logError("No GitHub token available"),De.error("GitHub authentication required");return}try{y(!0),console.log("Fetching GitHub repositories with token:",R.substring(0,5)+"...");let P=[],A=1,H=!0;for(;H;){const K=`https://api.github.com/user/repos?sort=updated&per_page=100&page=${A}&affiliation=owner,organization_member`,V=await fetch(K,{headers:{Accept:"application/vnd.github.v3+json",Authorization:`Bearer ${R.trim()}`}});if(!V.ok){let q={};try{q=await V.json(),console.error("Error response data:",q)}catch(I){q={message:"Could not parse error response"},console.error("Could not parse error response:",I)}if(V.status===401)De.error("GitHub token expired. Please reconnect your account."),Vf("github_connection")&&(localStorage.removeItem("github_connection"),u(null));else if(V.status===403&&V.headers.get("x-ratelimit-remaining")==="0"){const I=V.headers.get("x-ratelimit-reset"),$=I?new Date(parseInt(I)*1e3).toLocaleTimeString():"soon";De.error(`GitHub API rate limit exceeded. Limit resets at ${$}`)}else ln.logError("Failed to fetch GitHub repositories",{status:V.status,statusText:V.statusText,error:q}),De.error(`Failed to fetch repositories: ${q.message||V.statusText}`);return}try{const q=await V.json();P=P.concat(q),q.length<100?H=!1:A+=1}catch(q){console.error("Error parsing JSON response:",q),ln.logError("Failed to parse GitHub repositories response",{parseError:q}),De.error("Failed to parse repository data"),h([]);return}}h(P)}catch(P){console.error("Exception while fetching GitHub repositories:",P),ln.logError("Failed to fetch GitHub repositories",{error:P}),De.error("Failed to fetch recent repositories")}finally{y(!1)}},[]);async function D(R){R.preventDefault();const P=Vf("github_connection");if(!P?.token||!P?.user){De.error("Please connect your GitHub account in Settings > Connections first");return}if(!n.trim()){De.error("Repository name is required");return}l(!0);try{const A=new aB({auth:P.token});try{const{data:q}=await A.repos.get({owner:P.user.login,repo:n});let I=`Repository "${n}" already exists. Do you want to update it? This will add or modify files in the repository.`;if(q.private!==i&&(I+=`

${i?"This will also change the repository from public to private.":"This will also change the repository from private to public."}`),!window.confirm(I)){l(!1);return}}catch(q){if(q instanceof Error&&"status"in q&&q.status!==404)throw q}const H=await r(n,P.user.login,P.token,i);E(H);const K=Ie.files.get(),V=Object.entries(K).filter(([,q])=>q?.type==="file"&&!q.isBinary).map(([q,I])=>({path:pu(q),size:new TextEncoder().encode(I.content||"").length}));x(V),b(!0)}catch(A){console.error("Error pushing to GitHub:",A),De.error("Failed to push to GitHub. Please check your repository name and try again.")}finally{l(!1)}}const O=()=>{s(""),o(!1),b(!1),E(""),e()};return _?C.jsx(ip,{open:t,onOpenChange:R=>!R&&O(),children:C.jsxs(op,{children:[C.jsx(ap,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999]"}),C.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999]",children:C.jsx(mt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"w-[90vw] md:w-[600px] max-h-[85vh] overflow-y-auto",children:C.jsx(lp,{className:"bg-white dark:bg-codeia-elements-background-depth-1 rounded-lg border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark shadow-xl","aria-describedby":"success-dialog-description",children:C.jsxs("div",{className:"p-6 space-y-4",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500/10 flex items-center justify-center text-green-500",children:C.jsx("div",{className:"i-ph:check-circle w-5 h-5"})}),C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark",children:"Successfully pushed to GitHub"}),C.jsx("p",{id:"success-dialog-description",className:"text-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark",children:"Your code is now available on GitHub"})]})]}),C.jsx(cp,{asChild:!0,children:C.jsxs("button",{onClick:O,className:"p-2 rounded-lg transition-all duration-200 ease-in-out bg-transparent text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary dark:text-codeia-elements-textTertiary-dark dark:hover:text-codeia-elements-textPrimary-dark hover:bg-codeia-elements-background-depth-2 dark:hover:bg-codeia-elements-background-depth-3 focus:outline-none focus:ring-2 focus:ring-codeia-elements-borderColor dark:focus:ring-codeia-elements-borderColor-dark",children:[C.jsx("span",{className:"i-ph:x block w-5 h-5","aria-hidden":"true"}),C.jsx("span",{className:"sr-only",children:"Close dialog"})]})})]}),C.jsxs("div",{className:"bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 rounded-lg p-4 text-left border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",children:[C.jsxs("p",{className:"text-sm font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark mb-2 flex items-center gap-2",children:[C.jsx("span",{className:"i-ph:github-logo w-4 h-4 text-purple-500"}),"Repository URL"]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("code",{className:"flex-1 text-sm bg-codeia-elements-background-depth-1 dark:bg-codeia-elements-background-depth-4 px-3 py-2 rounded border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark font-mono",children:w}),C.jsx(mt.button,{onClick:()=>{navigator.clipboard.writeText(w),De.success("URL copied to clipboard")},className:"p-2 text-codeia-elements-textSecondary hover:text-codeia-elements-textPrimary dark:text-codeia-elements-textSecondary-dark dark:hover:text-codeia-elements-textPrimary-dark bg-codeia-elements-background-depth-1 dark:bg-codeia-elements-background-depth-4 rounded-lg border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",whileHover:{scale:1.05},whileTap:{scale:.95},children:C.jsx("div",{className:"i-ph:copy w-4 h-4"})})]})]}),C.jsxs("div",{className:"bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 rounded-lg p-4 border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",children:[C.jsxs("p",{className:"text-sm font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark mb-2 flex items-center gap-2",children:[C.jsx("span",{className:"i-ph:files w-4 h-4 text-purple-500"}),"Pushed Files (",S.length,")"]}),C.jsx("div",{className:"max-h-[200px] overflow-y-auto custom-scrollbar pr-2",children:S.map(R=>C.jsxs("div",{className:"flex items-center justify-between py-1.5 text-sm text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark border-b border-codeia-elements-borderColor/30 dark:border-codeia-elements-borderColor-dark/30 last:border-0",children:[C.jsx("span",{className:"font-mono truncate flex-1 text-xs",children:R.path}),C.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-codeia-elements-background-depth-3 dark:bg-codeia-elements-background-depth-4 text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark ml-2",children:K1e(R.size)})]},R.path))})]}),C.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[C.jsxs(mt.a,{href:w,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 rounded-lg bg-purple-500 text-white hover:bg-purple-600 text-sm inline-flex items-center gap-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[C.jsx("div",{className:"i-ph:github-logo w-4 h-4"}),"View Repository"]}),C.jsxs(mt.button,{onClick:()=>{navigator.clipboard.writeText(w),De.success("URL copied to clipboard")},className:"px-4 py-2 rounded-lg bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark hover:bg-codeia-elements-background-depth-3 dark:hover:bg-codeia-elements-background-depth-4 text-sm inline-flex items-center gap-2 border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",whileHover:{scale:1.02},whileTap:{scale:.98},children:[C.jsx("div",{className:"i-ph:copy w-4 h-4"}),"Copy URL"]}),C.jsx(mt.button,{onClick:O,className:"px-4 py-2 rounded-lg bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark hover:bg-codeia-elements-background-depth-3 dark:hover:bg-codeia-elements-background-depth-4 text-sm border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Close"})]})]})})})})]})}):c?C.jsx(ip,{open:t,onOpenChange:R=>!R&&O(),children:C.jsxs(op,{children:[C.jsx(ap,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999]"}),C.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999]",children:C.jsx(mt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"w-[90vw] md:w-[500px]",children:C.jsx(lp,{className:"bg-white dark:bg-codeia-elements-background-depth-1 rounded-lg border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark shadow-xl","aria-describedby":"push-dialog-description",children:C.jsxs("div",{className:"p-6",children:[C.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[C.jsx(mt.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.1},className:"w-10 h-10 rounded-xl bg-codeia-elements-background-depth-3 flex items-center justify-center text-purple-500",children:C.jsx("div",{className:"i-ph:github-logo w-5 h-5"})}),C.jsxs("div",{children:[C.jsx(Z6,{className:"text-lg font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark",children:"Push to GitHub"}),C.jsx("p",{id:"push-dialog-description",className:"text-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark",children:"Push your code to a new or existing GitHub repository"})]}),C.jsx(cp,{asChild:!0,children:C.jsxs("button",{onClick:O,className:"ml-auto p-2 rounded-lg transition-all duration-200 ease-in-out bg-transparent text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary dark:text-codeia-elements-textTertiary-dark dark:hover:text-codeia-elements-textPrimary-dark hover:bg-codeia-elements-background-depth-2 dark:hover:bg-codeia-elements-background-depth-3 focus:outline-none focus:ring-2 focus:ring-codeia-elements-borderColor dark:focus:ring-codeia-elements-borderColor-dark",children:[C.jsx("span",{className:"i-ph:x block w-5 h-5","aria-hidden":"true"}),C.jsx("span",{className:"sr-only",children:"Close dialog"})]})})]}),C.jsxs("div",{className:"flex items-center gap-3 mb-6 p-4 bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 rounded-lg border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",children:[C.jsxs("div",{className:"relative",children:[C.jsx("img",{src:c.avatar_url,alt:c.login,className:"w-10 h-10 rounded-full"}),C.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-purple-500 flex items-center justify-center text-white",children:C.jsx("div",{className:"i-ph:github-logo w-3 h-3"})})]}),C.jsxs("div",{children:[C.jsx("p",{className:"text-sm font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark",children:c.name||c.login}),C.jsxs("p",{className:"text-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark",children:["@",c.login]})]})]}),C.jsxs("form",{onSubmit:D,className:"space-y-4",children:[C.jsxs("div",{className:"space-y-2",children:[C.jsx("label",{htmlFor:"repoName",className:"text-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark",children:"Repository Name"}),C.jsxs("div",{className:"relative",children:[C.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-codeia-elements-textTertiary dark:text-codeia-elements-textTertiary-dark",children:C.jsx("span",{className:"i-ph:git-branch w-4 h-4"})}),C.jsx("input",{id:"repoName",type:"text",value:n,onChange:R=>s(R.target.value),placeholder:"my-awesome-project",className:"w-full pl-10 px-4 py-2 rounded-lg bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark placeholder-codeia-elements-textTertiary dark:placeholder-codeia-elements-textTertiary-dark focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]})]}),C.jsxs("div",{className:"space-y-2",children:[C.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C.jsx("label",{className:"text-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark",children:"Recent Repositories"}),C.jsxs("span",{className:"text-xs text-codeia-elements-textTertiary dark:text-codeia-elements-textTertiary-dark",children:[f.length," of ",d.length]})]}),C.jsx("div",{className:"mb-2",children:C.jsx(c8,{placeholder:"Search repositories...",value:m,onChange:R=>p(R.target.value),onClear:()=>p(""),className:"bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark text-sm"})}),d.length===0&&!g?C.jsx(i2,{icon:"i-ph:github-logo",title:"No repositories found",description:"We couldn't find any repositories in your GitHub account.",variant:"compact"}):C.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto pr-2 custom-scrollbar",children:f.length===0&&m.trim()!==""?C.jsx(i2,{icon:"i-ph:magnifying-glass",title:"No matching repositories",description:"Try a different search term",variant:"compact"}):f.map(R=>C.jsxs(mt.button,{type:"button",onClick:()=>s(R.name),className:"w-full p-3 text-left rounded-lg bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 hover:bg-codeia-elements-background-depth-3 dark:hover:bg-codeia-elements-background-depth-4 transition-colors group border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark hover:border-purple-500/30",whileHover:{scale:1.01},whileTap:{scale:.99},children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:git-branch w-4 h-4 text-purple-500"}),C.jsx("span",{className:"text-sm font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark group-hover:text-purple-500",children:R.name})]}),R.private&&C.jsx(Bc,{variant:"primary",size:"sm",icon:"i-ph:lock w-3 h-3",children:"Private"})]}),R.description&&C.jsx("p",{className:"mt-1 text-xs text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark line-clamp-2",children:R.description}),C.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[R.language&&C.jsx(Bc,{variant:"subtle",size:"sm",icon:"i-ph:code w-3 h-3",children:R.language}),C.jsx(Bc,{variant:"subtle",size:"sm",icon:"i-ph:star w-3 h-3",children:R.stargazers_count.toLocaleString()}),C.jsx(Bc,{variant:"subtle",size:"sm",icon:"i-ph:git-fork w-3 h-3",children:R.forks_count.toLocaleString()}),C.jsx(Bc,{variant:"subtle",size:"sm",icon:"i-ph:clock w-3 h-3",children:new Date(R.updated_at).toLocaleDateString()})]})]},R.full_name))})]}),g&&C.jsx("div",{className:"flex items-center justify-center py-4",children:C.jsx(yEe,{status:"loading",pulse:!0,label:"Loading repositories..."})}),C.jsxs("div",{className:"p-3 bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 rounded-lg border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("input",{type:"checkbox",id:"private",checked:i,onChange:R=>o(R.target.checked),className:"rounded border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark text-purple-500 focus:ring-purple-500 dark:bg-codeia-elements-background-depth-3"}),C.jsx("label",{htmlFor:"private",className:"text-sm text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark",children:"Make repository private"})]}),C.jsx("p",{className:"text-xs text-codeia-elements-textTertiary dark:text-codeia-elements-textTertiary-dark mt-2 ml-6",children:"Private repositories are only visible to you and people you share them with"})]}),C.jsxs("div",{className:"pt-4 flex gap-2",children:[C.jsx(mt.button,{type:"button",onClick:O,className:"px-4 py-2 rounded-lg bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark hover:bg-codeia-elements-background-depth-3 dark:hover:bg-codeia-elements-background-depth-4 text-sm border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Cancel"}),C.jsx(mt.button,{type:"submit",disabled:a,className:Te("flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 text-sm inline-flex items-center justify-center gap-2",a?"opacity-50 cursor-not-allowed":""),whileHover:a?{}:{scale:1.02},whileTap:a?{}:{scale:.98},children:a?C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"i-ph:spinner-gap animate-spin w-4 h-4"}),"Pushing..."]}):C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"i-ph:github-logo w-4 h-4"}),"Push to GitHub"]})})]})]})]})})})})]})}):C.jsx(ip,{open:t,onOpenChange:R=>!R&&O(),children:C.jsxs(op,{children:[C.jsx(ap,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999]"}),C.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999]",children:C.jsx(mt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"w-[90vw] md:w-[500px]",children:C.jsx(lp,{className:"bg-white dark:bg-codeia-elements-background-depth-1 rounded-lg p-6 border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark shadow-xl","aria-describedby":"connection-required-description",children:C.jsxs("div",{className:"relative text-center space-y-4",children:[C.jsx(cp,{asChild:!0,children:C.jsxs("button",{onClick:O,className:"absolute right-0 top-0 p-2 rounded-lg transition-all duration-200 ease-in-out bg-transparent text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary dark:text-codeia-elements-textTertiary-dark dark:hover:text-codeia-elements-textPrimary-dark hover:bg-codeia-elements-background-depth-2 dark:hover:bg-codeia-elements-background-depth-3 focus:outline-none focus:ring-2 focus:ring-codeia-elements-borderColor dark:focus:ring-codeia-elements-borderColor-dark",children:[C.jsx("span",{className:"i-ph:x block w-5 h-5","aria-hidden":"true"}),C.jsx("span",{className:"sr-only",children:"Close dialog"})]})}),C.jsx(mt.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.1},className:"mx-auto w-16 h-16 rounded-xl bg-codeia-elements-background-depth-3 flex items-center justify-center text-purple-500",children:C.jsx("div",{className:"i-ph:github-logo w-8 h-8"})}),C.jsx("h3",{className:"text-lg font-medium text-codeia-elements-textPrimary dark:text-codeia-elements-textPrimary-dark",children:"GitHub Connection Required"}),C.jsxs("p",{id:"connection-required-description",className:"text-sm text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark max-w-md mx-auto",children:["To push your code to GitHub, you need to connect your GitHub account in Settings ",">"," Connections first."]}),C.jsxs("div",{className:"pt-2 flex justify-center gap-3",children:[C.jsx(mt.button,{className:"px-4 py-2 rounded-lg bg-codeia-elements-background-depth-2 dark:bg-codeia-elements-background-depth-3 text-codeia-elements-textSecondary dark:text-codeia-elements-textSecondary-dark text-sm hover:bg-codeia-elements-background-depth-3 dark:hover:bg-codeia-elements-background-depth-4 border border-codeia-elements-borderColor dark:border-codeia-elements-borderColor-dark",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:O,children:"Close"}),C.jsxs(mt.a,{href:"/settings/connections",className:"px-4 py-2 rounded-lg bg-purple-500 text-white text-sm hover:bg-purple-600 inline-flex items-center gap-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[C.jsx("div",{className:"i-ph:gear"}),"Go to Settings"]})]})]})})})})]})})}const bEe={ease:ho},wEe={left:{value:"code",text:"Code"},middle:{value:"diff",text:"Diff"},right:{value:"preview",text:"Preview"}},xEe={closed:{width:0,transition:{duration:.2,ease:ho}},open:{width:"var(--workbench-width)",transition:{duration:.2,ease:ho}}},SEe=k.memo(({fileHistory:t,onSelectFile:e})=>{const r=Object.entries(t),n=r.length>0,[s,i]=k.useState(""),o=k.useMemo(()=>r.filter(([a])=>a.toLowerCase().includes(s.toLowerCase())),[r,s]);return C.jsx("div",{className:"flex items-center gap-2",children:C.jsx(Py,{className:"relative",children:({open:a})=>C.jsxs(C.Fragment,{children:[C.jsxs(Py.Button,{className:"flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg bg-codeia-elements-background-depth-2 hover:bg-codeia-elements-background-depth-3 transition-colors text-codeia-elements-item-contentDefault",children:[C.jsx("span",{children:"File Changes"}),n&&C.jsx("span",{className:"w-5 h-5 rounded-full bg-accent-500/20 text-accent-500 text-xs flex items-center justify-center border border-accent-500/30",children:r.length})]}),C.jsx(bue,{show:a,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:C.jsxs(Py.Panel,{className:"absolute right-0 z-20 mt-2 w-80 origin-top-right rounded-xl bg-codeia-elements-background-depth-2 shadow-xl border border-codeia-elements-borderColor",children:[C.jsxs("div",{className:"p-2",children:[C.jsxs("div",{className:"relative mx-2 mb-2",children:[C.jsx("input",{type:"text",placeholder:"Search files...",value:s,onChange:l=>i(l.target.value),className:"w-full pl-8 pr-3 py-1.5 text-sm rounded-lg bg-codeia-elements-background-depth-1 border border-codeia-elements-borderColor focus:outline-none focus:ring-2 focus:ring-blue-500/50"}),C.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-codeia-elements-textTertiary",children:C.jsx("div",{className:"i-ph:magnifying-glass"})})]}),C.jsx("div",{className:"max-h-60 overflow-y-auto",children:o.length>0?o.map(([l,c])=>{const u=l.split(".").pop()||"",d=kF(u);return C.jsx("button",{onClick:()=>e(l),className:"w-full px-3 py-2 text-left rounded-md hover:bg-codeia-elements-background-depth-1 transition-colors group bg-transparent",children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsxs("div",{className:"shrink-0 w-5 h-5 text-codeia-elements-textTertiary",children:[["typescript","javascript","jsx","tsx"].includes(d)&&C.jsx("div",{className:"i-ph:file-js"}),["css","scss","less"].includes(d)&&C.jsx("div",{className:"i-ph:paint-brush"}),d==="html"&&C.jsx("div",{className:"i-ph:code"}),d==="json"&&C.jsx("div",{className:"i-ph:brackets-curly"}),d==="python"&&C.jsx("div",{className:"i-ph:file-text"}),d==="markdown"&&C.jsx("div",{className:"i-ph:article"}),["yaml","yml"].includes(d)&&C.jsx("div",{className:"i-ph:file-text"}),d==="sql"&&C.jsx("div",{className:"i-ph:database"}),d==="dockerfile"&&C.jsx("div",{className:"i-ph:cube"}),d==="shell"&&C.jsx("div",{className:"i-ph:terminal"}),!["typescript","javascript","css","html","json","python","markdown","yaml","yml","sql","dockerfile","shell","jsx","tsx","scss","less"].includes(d)&&C.jsx("div",{className:"i-ph:file-text"})]}),C.jsx("div",{className:"flex-1 min-w-0",children:C.jsxs("div",{className:"flex items-center justify-between gap-2",children:[C.jsxs("div",{className:"flex flex-col min-w-0",children:[C.jsx("span",{className:"truncate text-sm font-medium text-codeia-elements-textPrimary",children:l.split("/").pop()}),C.jsx("span",{className:"truncate text-xs text-codeia-elements-textTertiary",children:l})]}),(()=>{const{additions:h,deletions:f}=(()=>{if(!c.originalContent)return{additions:0,deletions:0};const m=c.originalContent.replace(/\r\n/g,`
`),p=c.versions[c.versions.length-1]?.content.replace(/\r\n/g,`
`)||"";return m===p?{additions:0,deletions:0}:$l(m,p,{newlineIsToken:!1,ignoreWhitespace:!0,ignoreCase:!1}).reduce((y,_)=>(_.added&&(y.additions+=_.value.split(`
`).length),_.removed&&(y.deletions+=_.value.split(`
`).length),y),{additions:0,deletions:0})})();return(h>0||f>0)&&C.jsxs("div",{className:"flex items-center gap-1 text-xs shrink-0",children:[h>0&&C.jsxs("span",{className:"text-green-500",children:["+",h]}),f>0&&C.jsxs("span",{className:"text-red-500",children:["-",f]})]})})()]})})]})},l)}):C.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:[C.jsx("div",{className:"w-12 h-12 mb-2 text-codeia-elements-textTertiary",children:C.jsx("div",{className:"i-ph:file-dashed"})}),C.jsx("p",{className:"text-sm font-medium text-codeia-elements-textPrimary",children:s?"No matching files":"No modified files"}),C.jsx("p",{className:"text-xs text-codeia-elements-textTertiary mt-1",children:s?"Try another search":"Changes will appear here as you edit"})]})})]}),n&&C.jsx("div",{className:"border-t border-codeia-elements-borderColor p-2",children:C.jsx("button",{onClick:()=>{navigator.clipboard.writeText(o.map(([l])=>l).join(`
`)),De("File list copied to clipboard",{icon:C.jsx("div",{className:"i-ph:check-circle text-accent-500"})})},className:"w-full flex items-center justify-center gap-2 px-3 py-1.5 text-sm rounded-lg bg-codeia-elements-background-depth-1 hover:bg-codeia-elements-background-depth-3 transition-colors text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary",children:"Copy File List"})})]})})]})})})}),EEe=k.memo(({chatStarted:t,isStreaming:e,actionRunner:r,metadata:n,updateChatMestaData:s})=>{ec.trace("Workbench");const[i,o]=k.useState(!1),[a,l]=k.useState(!1),[c,u]=k.useState({}),d=at(u2(Ie.previews,O=>O.length>0)),h=at(Ie.showWorkbench),f=at(Ie.selectedFile),v=at(Ie.currentDocument),m=at(Ie.unsavedFiles),p=at(Ie.files),g=at(Ie.currentView),y=bae(1024),_=O=>{Ie.currentView.set(O)};k.useEffect(()=>{d&&_("preview")},[d]),k.useEffect(()=>{Ie.setDocuments(p)},[p]);const b=k.useCallback(O=>{Ie.setCurrentDocumentContent(O.content)},[]),w=k.useCallback(O=>{Ie.setCurrentDocumentScrollPosition(O)},[]),E=k.useCallback(O=>{Ie.setSelectedFile(O)},[]),S=k.useCallback(()=>{Ie.saveCurrentDocument().then(()=>{cie().refreshAllPreviews()}).catch(()=>{De.error("Failed to update file content")})},[]),x=k.useCallback(()=>{Ie.resetCurrentDocument()},[]),T=k.useCallback(async()=>{o(!0);try{const O=await window.showDirectoryPicker();await Ie.syncFiles(O),De.success("Files synced successfully")}catch(O){console.error("Error syncing files:",O),De.error("Failed to sync files")}finally{o(!1)}},[]),D=k.useCallback(O=>{Ie.setSelectedFile(O),Ie.currentView.set("diff")},[]);return t&&C.jsxs(mt.div,{initial:"closed",animate:h?"open":"closed",variants:xEe,className:"z-workbench",children:[C.jsx("div",{className:Te("fixed top-[calc(var(--header-height)+1.5rem)] bottom-6 w-[var(--workbench-inner-width)] mr-4 z-0 transition-[left,width] duration-200 codeia-ease-cubic-bezier",{"w-full":y,"left-0":h&&y,"left-[var(--workbench-left)]":h,"left-[100%]":!h}),children:C.jsx("div",{className:"absolute inset-0 px-2 lg:px-6",children:C.jsxs("div",{className:"h-full flex flex-col bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor shadow-sm rounded-lg overflow-hidden",children:[C.jsxs("div",{className:"flex items-center px-3 py-2 border-b border-codeia-elements-borderColor gap-1",children:[C.jsx(Z_e,{selected:g,options:wEe,setSelected:_}),C.jsx("div",{className:"ml-auto"}),g==="code"&&C.jsxs("div",{className:"flex overflow-y-auto",children:[C.jsxs(vw,{className:"mr-1 text-sm",onClick:()=>{Ie.toggleTerminal(!Ie.showTerminal.get())},children:[C.jsx("div",{className:"i-ph:terminal"}),"Toggle Terminal"]}),C.jsxs(d6,{children:[C.jsxs(h6,{className:"text-sm flex items-center gap-1 text-codeia-elements-item-contentDefault bg-transparent enabled:hover:text-codeia-elements-item-contentActive rounded-md p-1 enabled:hover:bg-codeia-elements-item-backgroundActive disabled:cursor-not-allowed",children:[C.jsx("div",{className:"i-ph:box-arrow-up"}),"Sync & Export"]}),C.jsxs(f6,{className:Te("min-w-[240px] z-[250]","bg-white dark:bg-[#141414]","rounded-lg shadow-lg","border border-gray-200/50 dark:border-gray-800/50","animate-in fade-in-0 zoom-in-95","py-1"),sideOffset:5,align:"end",children:[C.jsx(b0,{className:Te("cursor-pointer flex items-center w-full px-4 py-2 text-sm text-codeia-elements-textPrimary hover:bg-codeia-elements-item-backgroundActive gap-2 rounded-md group relative"),onClick:()=>{Ie.downloadZip()},children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:download-simple"}),C.jsx("span",{children:"Download Code"})]})}),C.jsx(b0,{className:Te("cursor-pointer flex items-center w-full px-4 py-2 text-sm text-codeia-elements-textPrimary hover:bg-codeia-elements-item-backgroundActive gap-2 rounded-md group relative"),onClick:T,disabled:i,children:C.jsxs("div",{className:"flex items-center gap-2",children:[i?C.jsx("div",{className:"i-ph:spinner"}):C.jsx("div",{className:"i-ph:cloud-arrow-down"}),C.jsx("span",{children:i?"Syncing...":"Sync Files"})]})}),C.jsx(b0,{className:Te("cursor-pointer flex items-center w-full px-4 py-2 text-sm text-codeia-elements-textPrimary hover:bg-codeia-elements-item-backgroundActive gap-2 rounded-md group relative"),onClick:()=>l(!0),children:C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"i-ph:git-branch"}),"Push to GitHub"]})})]})]})]}),g==="diff"&&C.jsx(SEe,{fileHistory:c,onSelectFile:D}),C.jsx(hr,{icon:"i-ph:x-circle",className:"-mr-1",size:"xl",onClick:()=>{Ie.showWorkbench.set(!1)}})]}),C.jsxs("div",{className:"relative flex-1 overflow-hidden",children:[C.jsx(S0,{initial:{x:"0%"},animate:{x:g==="code"?"0%":"-100%"},children:C.jsx(b1e,{editorDocument:v,isStreaming:e,selectedFile:f,files:p,unsavedFiles:m,fileHistory:c,onFileSelect:E,onEditorScroll:w,onEditorChange:b,onFileSave:S,onFileReset:x})}),C.jsx(S0,{initial:{x:"100%"},animate:{x:g==="diff"?"0%":g==="code"?"100%":"-100%"},children:C.jsx(upe,{fileHistory:c,setFileHistory:u,actionRunner:r})}),C.jsx(S0,{initial:{x:"100%"},animate:{x:g==="preview"?"0%":"100%"},children:C.jsx(W1e,{})})]})]})})}),C.jsx(_Ee,{isOpen:a,onClose:()=>l(!1),onPush:async(O,R,P,A)=>{try{console.log("Dialog onPush called with isPrivate =",A);const H=prompt("Please enter a commit message:","Initial commit")||"Initial commit",K=await Ie.pushToGitHub(O,H,R,P,A);return s&&!n?.gitUrl&&s({...n||{},gitUrl:K}),K}catch(H){throw console.error("Error pushing to GitHub:",H),De.error("Failed to push to GitHub"),H}}})]})}),S0=k.memo(({children:t,...e})=>C.jsx(mt.div,{className:"absolute inset-0",transition:bEe,...e,children:t})),u8=k.memo(({className:t,messages:e,isStreaming:r})=>C.jsx("div",{className:Te("flex flex-col gap-4",t),children:e.map((n,s)=>C.jsxs("div",{className:Te("flex gap-3 p-4 rounded-lg",n.role==="user"?"bg-codeia-elements-bg-depth-2 ml-auto max-w-[80%]":"bg-codeia-elements-bg-depth-1 mr-auto max-w-[80%]"),children:[C.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-codeia-elements-bg-depth-3 flex items-center justify-center",children:n.role==="user"?C.jsx("div",{className:"i-ph:user text-codeia-elements-textSecondary"}):C.jsx("div",{className:"i-ph:robot text-codeia-elements-textSecondary"})}),C.jsxs("div",{className:"flex-1 min-w-0",children:[C.jsx("div",{className:"text-sm text-codeia-elements-textPrimary whitespace-pre-wrap",children:CEe(n.content)}),r&&s===e.length-1&&n.role==="assistant"&&C.jsx("div",{className:"mt-2",children:C.jsx("div",{className:"inline-block w-2 h-4 bg-codeia-elements-textSecondary animate-pulse"})})]})]},n.id||s))}));u8.displayName="Messages";function CEe(t){return typeof t=="string"?t:Array.isArray(t)?t.map(n=>n.text).join(`
`).split(`
`).filter(n=>!n.startsWith("[")).join(`
`).trim()||"[Sin mensaje]":"[Contenido no soportado]"}const d8=k.memo(({show:t,isStreaming:e,disabled:r,onClick:n})=>t?C.jsx("button",{className:Te("absolute right-2 top-2 w-10 h-10 rounded-lg flex items-center justify-center transition-all","bg-codeia-elements-background-depth-3 hover:bg-codeia-elements-background-depth-4","text-codeia-elements-textPrimary hover:text-codeia-elements-textSecondary","disabled:opacity-50 disabled:cursor-not-allowed"),onClick:n,disabled:r,title:e?"Stop":"Send",children:e?C.jsx("div",{className:"i-ph:stop-fill text-lg"}):C.jsx("div",{className:"i-ph:paper-plane-right-fill text-lg"})}):null);d8.displayName="SendButton";const kEe=({provider:t,apiKey:e,setApiKey:r})=>{const[n,s]=k.useState(!1);return C.jsxs("div",{className:"mb-4 p-3 bg-codeia-elements-background-depth-1 rounded-lg border border-codeia-elements-borderColor",children:[C.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C.jsxs("label",{className:"text-sm font-medium text-codeia-elements-textPrimary",children:[t.name," API Key"]}),C.jsx("button",{type:"button",onClick:()=>s(!n),className:"text-xs text-codeia-elements-textSecondary hover:text-codeia-elements-textPrimary",children:n?"Hide":"Show"})]}),C.jsx("input",{type:n?"text":"password",value:e,onChange:i=>r(i.target.value),placeholder:`Enter your ${t.name} API key`,className:Te("w-full px-3 py-2 text-sm bg-codeia-elements-background-depth-2","border border-codeia-elements-borderColor rounded-md","text-codeia-elements-textPrimary placeholder-codeia-elements-textTertiary","focus:outline-none focus:ring-2 focus:ring-codeia-elements-focus focus:border-transparent")})]})},o2=()=>{if(typeof window>"u")return{};try{const t=document.cookie.split("; ").find(e=>e.startsWith("apiKeys="));if(t){const e=t.split("=")[1];return JSON.parse(decodeURIComponent(e))}}catch(t){console.error("Error parsing API keys from cookies:",t)}return{}},TEe="s",AEe="t",REe="u",PEe="v",IEe="w",Fc={BaseChat:TEe,Chat:AEe,PromptEffectContainer:REe,PromptEffectLine:PEe,PromptShine:IEe},OEe=k.memo(({exportChat:t})=>C.jsx(hr,{title:"Export chat",className:"transition-all",onClick:t,children:C.jsx("div",{className:"i-ph:download text-xl"})}));OEe.displayName="ExportChatButton";const DEe=[{text:"Create a mobile web using next.js"}];function MEe(t){return C.jsx("div",{id:"examples",className:"relative flex flex-col gap-9 w-full max-w-3xl mx-auto flex justify-center mt-6",children:C.jsx("div",{className:"flex flex-wrap justify-center gap-2",style:{animation:".25s ease-out 0s 1 _fade-and-move-in_g2ptj_1 forwards"},children:DEe.map((e,r)=>C.jsx("button",{onClick:n=>{t?.(n,e.text)},className:"border border-codeia-elements-borderColor rounded-full bg-gray-50 hover:bg-gray-100 dark:bg-gray-950 dark:hover:bg-gray-900 text-codeia-elements-textSecondary hover:text-codeia-elements-textPrimary px-3 py-1 text-xs transition-theme",children:e.text},r))})})}const h8=k.memo(({files:t,imageDataList:e,onRemove:r})=>t.length===0?null:C.jsx("div",{className:"mb-4",children:C.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((n,s)=>C.jsxs("div",{className:"relative bg-codeia-elements-background-depth-1 border border-codeia-elements-borderColor rounded-lg p-2",children:[n.type.startsWith("image/")&&e[s]&&C.jsx("img",{src:e[s],alt:n.name,className:"w-16 h-16 object-cover rounded"}),C.jsx("div",{className:"text-xs text-codeia-elements-textSecondary mt-1 max-w-20 truncate",children:n.name}),C.jsx(hr,{title:"Remove file",className:"absolute -top-1 -right-1 w-5 h-5 bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor",onClick:()=>r(s),children:C.jsx("div",{className:"i-ph:x text-xs"})})]},s))})}));h8.displayName="FilePreview";const LEe=({model:t,setModel:e,provider:r,setProvider:n,modelList:s,providerList:i,modelLoading:o})=>{const[a,l]=k.useState(""),[c,u]=k.useState(!1),[d,h]=k.useState(-1),f=k.useRef(null),v=k.useRef([]),m=k.useRef(null),[p,g]=k.useState(""),[y,_]=k.useState(!1),[b,w]=k.useState(-1),E=k.useRef(null),S=k.useRef([]),x=k.useRef(null);k.useEffect(()=>{const P=A=>{m.current&&!m.current.contains(A.target)&&(u(!1),l("")),x.current&&!x.current.contains(A.target)&&(_(!1),g(""))};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const T=[...s].filter(P=>P.provider===r?.name&&P.name).filter(P=>P.label.toLowerCase().includes(a.toLowerCase())||P.name.toLowerCase().includes(a.toLowerCase())),D=i.filter(P=>P.name.toLowerCase().includes(p.toLowerCase()));k.useEffect(()=>{h(-1)},[a,c]),k.useEffect(()=>{w(-1)},[p,y]),k.useEffect(()=>{c&&f.current&&f.current.focus()},[c]),k.useEffect(()=>{y&&E.current&&E.current.focus()},[y]);const O=P=>{if(c)switch(P.key){case"ArrowDown":P.preventDefault(),h(A=>A+1>=T.length?0:A+1);break;case"ArrowUp":P.preventDefault(),h(A=>A-1<0?T.length-1:A-1);break;case"Enter":if(P.preventDefault(),d>=0&&d<T.length){const A=T[d];e?.(A.name),u(!1),l("")}break;case"Escape":P.preventDefault(),u(!1),l("");break;case"Tab":!P.shiftKey&&d===T.length-1&&u(!1);break}},R=P=>{if(y)switch(P.key){case"ArrowDown":P.preventDefault(),w(A=>A+1>=D.length?0:A+1);break;case"ArrowUp":P.preventDefault(),w(A=>A-1<0?D.length-1:A-1);break;case"Enter":if(P.preventDefault(),b>=0&&b<D.length){const A=D[b];if(n){n(A);const H=s.find(K=>K.provider===A.name);H&&e&&e(H.name)}_(!1),g("")}break;case"Escape":P.preventDefault(),_(!1),g("");break;case"Tab":!P.shiftKey&&b===D.length-1&&_(!1);break}};return k.useEffect(()=>{d>=0&&v.current[d]&&v.current[d]?.scrollIntoView({block:"nearest"})},[d]),k.useEffect(()=>{b>=0&&S.current[b]&&S.current[b]?.scrollIntoView({block:"nearest"})},[b]),k.useEffect(()=>{if(i.length!==0&&r&&!i.some(P=>P.name===r.name)){const P=i[0];n?.(P);const A=s.find(H=>H.provider===P.name);A&&e?.(A.name)}},[i,r,n,s,e]),i.length===0?C.jsx("div",{className:"mb-2 p-4 rounded-lg border border-codeia-elements-borderColor bg-codeia-elements-prompt-background text-codeia-elements-textPrimary",children:C.jsx("p",{className:"text-center",children:"No providers are currently enabled. Please enable at least one provider in the settings to start using the chat."})}):C.jsxs("div",{className:"flex gap-2 flex-col sm:flex-row",children:[C.jsxs("div",{className:"relative flex w-full",onKeyDown:R,ref:x,children:[C.jsx("div",{className:Te("w-full p-2 rounded-lg border border-codeia-elements-borderColor","bg-codeia-elements-prompt-background text-codeia-elements-textPrimary","focus-within:outline-none focus-within:ring-2 focus-within:ring-codeia-elements-focus","transition-all cursor-pointer",y?"ring-2 ring-codeia-elements-focus":void 0),onClick:()=>_(!y),onKeyDown:P=>{(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),_(!y))},role:"combobox","aria-expanded":y,"aria-controls":"provider-listbox","aria-haspopup":"listbox",tabIndex:0,children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("div",{className:"truncate",children:r?.name||"Select provider"}),C.jsx("div",{className:Te("i-ph:caret-down w-4 h-4 text-codeia-elements-textSecondary opacity-75",y?"rotate-180":void 0)})]})}),y&&C.jsxs("div",{className:"absolute z-20 w-full mt-1 py-1 rounded-lg border border-codeia-elements-borderColor bg-codeia-elements-background-depth-2 shadow-lg",role:"listbox",id:"provider-listbox",children:[C.jsx("div",{className:"px-2 pb-2",children:C.jsxs("div",{className:"relative",children:[C.jsx("input",{ref:E,type:"text",value:p,onChange:P=>g(P.target.value),placeholder:"Search providers...",className:Te("w-full pl-2 py-1.5 rounded-md text-sm","bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor","text-codeia-elements-textPrimary placeholder:text-codeia-elements-textTertiary","focus:outline-none focus:ring-2 focus:ring-codeia-elements-focus","transition-all"),onClick:P=>P.stopPropagation(),role:"searchbox","aria-label":"Search providers"}),C.jsx("div",{className:"absolute left-2.5 top-1/2 -translate-y-1/2",children:C.jsx("span",{className:"i-ph:magnifying-glass text-codeia-elements-textTertiary"})})]})}),C.jsx("div",{className:Te("max-h-60 overflow-y-auto","sm:scrollbar-none","[&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar]:h-2","[&::-webkit-scrollbar-thumb]:bg-codeia-elements-borderColor","[&::-webkit-scrollbar-thumb]:hover:bg-codeia-elements-borderColorHover","[&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-track]:bg-codeia-elements-background-depth-2","[&::-webkit-scrollbar-track]:rounded-full","sm:[&::-webkit-scrollbar]:w-1.5 sm:[&::-webkit-scrollbar]:h-1.5","sm:hover:[&::-webkit-scrollbar-thumb]:bg-codeia-elements-borderColor/50","sm:hover:[&::-webkit-scrollbar-thumb:hover]:bg-codeia-elements-borderColor","sm:[&::-webkit-scrollbar-track]:bg-transparent"),children:D.length===0?C.jsx("div",{className:"px-3 py-2 text-sm text-codeia-elements-textTertiary",children:"No providers found"}):D.map((P,A)=>C.jsx("div",{ref:H=>S.current[A]=H,role:"option","aria-selected":r?.name===P.name,className:Te("px-3 py-2 text-sm cursor-pointer","hover:bg-codeia-elements-background-depth-3","text-codeia-elements-textPrimary","outline-none",r?.name===P.name||b===A?"bg-codeia-elements-background-depth-2":void 0,b===A?"ring-1 ring-inset ring-codeia-elements-focus":void 0),onClick:H=>{if(H.stopPropagation(),n){n(P);const K=s.find(V=>V.provider===P.name);K&&e&&e(K.name)}_(!1),g("")},tabIndex:b===A?0:-1,children:P.name},P.name))})]})]}),C.jsxs("div",{className:"relative flex w-full min-w-[70%]",onKeyDown:O,ref:m,children:[C.jsx("div",{className:Te("w-full p-2 rounded-lg border border-codeia-elements-borderColor","bg-codeia-elements-prompt-background text-codeia-elements-textPrimary","focus-within:outline-none focus-within:ring-2 focus-within:ring-codeia-elements-focus","transition-all cursor-pointer",c?"ring-2 ring-codeia-elements-focus":void 0),onClick:()=>u(!c),onKeyDown:P=>{(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),u(!c))},role:"combobox","aria-expanded":c,"aria-controls":"model-listbox","aria-haspopup":"listbox",tabIndex:0,children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("div",{className:"truncate",children:s.find(P=>P.name===t)?.label||"Select model"}),C.jsx("div",{className:Te("i-ph:caret-down w-4 h-4 text-codeia-elements-textSecondary opacity-75",c?"rotate-180":void 0)})]})}),c&&C.jsxs("div",{className:"absolute z-10 w-full mt-1 py-1 rounded-lg border border-codeia-elements-borderColor bg-codeia-elements-background-depth-2 shadow-lg",role:"listbox",id:"model-listbox",children:[C.jsx("div",{className:"px-2 pb-2",children:C.jsxs("div",{className:"relative",children:[C.jsx("input",{ref:f,type:"text",value:a,onChange:P=>l(P.target.value),placeholder:"Search models...",className:Te("w-full pl-2 py-1.5 rounded-md text-sm","bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor","text-codeia-elements-textPrimary placeholder:text-codeia-elements-textTertiary","focus:outline-none focus:ring-2 focus:ring-codeia-elements-focus","transition-all"),onClick:P=>P.stopPropagation(),role:"searchbox","aria-label":"Search models"}),C.jsx("div",{className:"absolute left-2.5 top-1/2 -translate-y-1/2",children:C.jsx("span",{className:"i-ph:magnifying-glass text-codeia-elements-textTertiary"})})]})}),C.jsx("div",{className:Te("max-h-60 overflow-y-auto","sm:scrollbar-none","[&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar]:h-2","[&::-webkit-scrollbar-thumb]:bg-codeia-elements-borderColor","[&::-webkit-scrollbar-thumb]:hover:bg-codeia-elements-borderColorHover","[&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-track]:bg-codeia-elements-background-depth-2","[&::-webkit-scrollbar-track]:rounded-full","sm:[&::-webkit-scrollbar]:w-1.5 sm:[&::-webkit-scrollbar]:h-1.5","sm:hover:[&::-webkit-scrollbar-thumb]:bg-codeia-elements-borderColor/50","sm:hover:[&::-webkit-scrollbar-thumb:hover]:bg-codeia-elements-borderColor","sm:[&::-webkit-scrollbar-track]:bg-transparent"),children:o==="all"||o===r?.name?C.jsx("div",{className:"px-3 py-2 text-sm text-codeia-elements-textTertiary",children:"Loading..."}):T.length===0?C.jsx("div",{className:"px-3 py-2 text-sm text-codeia-elements-textTertiary",children:"No models found"}):T.map((P,A)=>C.jsx("div",{ref:H=>v.current[A]=H,role:"option","aria-selected":t===P.name,className:Te("px-3 py-2 text-sm cursor-pointer","hover:bg-codeia-elements-background-depth-3","text-codeia-elements-textPrimary","outline-none",t===P.name||d===A?"bg-codeia-elements-background-depth-2":void 0,d===A?"ring-1 ring-inset ring-codeia-elements-focus":void 0),onClick:H=>{H.stopPropagation(),e?.(P.name),u(!1),l("")},tabIndex:d===A?0:-1,children:P.label},A))})]})]})]})},NEe=k.memo(({isListening:t,onStart:e,onStop:r,disabled:n})=>C.jsx(hr,{title:t?"Stop listening":"Start voice input",disabled:n,className:Te("transition-all",t?"text-codeia-elements-icon-error":"text-codeia-elements-textSecondary"),onClick:t?r:e,children:t?C.jsx("div",{className:"i-ph:microphone-slash text-xl animate-pulse"}):C.jsx("div",{className:"i-ph:microphone text-xl"})}));NEe.displayName="SpeechRecognitionButton";const BEe=({setUploadedFiles:t,setImageDataList:e,uploadedFiles:r,imageDataList:n})=>(k.useEffect(()=>{},[r,n]),null);function FEe({alert:t,clearAlert:e,postMessage:r}){const{type:n,title:s,description:i,content:o,url:a,stage:l,buildStatus:c,deployStatus:u}=t,d=l&&(c||u);return C.jsx(Hw,{children:C.jsx(mt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"rounded-lg border border-codeia-elements-borderColor bg-codeia-elements-background-depth-2 p-4 mb-2",children:C.jsxs("div",{className:"flex items-start",children:[C.jsx(mt.div,{className:"flex-shrink-0",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:C.jsx("div",{className:Te("text-xl",n==="success"?"i-ph:check-circle-duotone text-codeia-elements-icon-success":n==="error"?"i-ph:warning-duotone text-codeia-elements-button-danger-text":"i-ph:info-duotone text-codeia-elements-loader-progress")})}),C.jsxs("div",{className:"ml-3 flex-1",children:[C.jsx(mt.h3,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm font-medium text-codeia-elements-textPrimary",children:s}),C.jsxs(mt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"mt-2 text-sm text-codeia-elements-textSecondary",children:[C.jsx("p",{children:i}),d&&C.jsx("div",{className:"mt-4 mb-2",children:C.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx("div",{className:Te("w-6 h-6 rounded-full flex items-center justify-center",c==="running"?"bg-codeia-elements-loader-progress":c==="complete"?"bg-codeia-elements-icon-success":c==="failed"?"bg-codeia-elements-button-danger-background":"bg-codeia-elements-textTertiary"),children:c==="running"?C.jsx("div",{className:"i-svg-spinners:90-ring-with-bg text-white text-xs"}):c==="complete"?C.jsx("div",{className:"i-ph:check text-white text-xs"}):c==="failed"?C.jsx("div",{className:"i-ph:x text-white text-xs"}):C.jsx("span",{className:"text-white text-xs",children:"1"})}),C.jsx("span",{className:"ml-2",children:"Build"})]}),C.jsx("div",{className:Te("h-0.5 w-8",c==="complete"?"bg-codeia-elements-icon-success":"bg-codeia-elements-textTertiary")}),C.jsxs("div",{className:"flex items-center",children:[C.jsx("div",{className:Te("w-6 h-6 rounded-full flex items-center justify-center",u==="running"?"bg-codeia-elements-loader-progress":u==="complete"?"bg-codeia-elements-icon-success":u==="failed"?"bg-codeia-elements-button-danger-background":"bg-codeia-elements-textTertiary"),children:u==="running"?C.jsx("div",{className:"i-svg-spinners:90-ring-with-bg text-white text-xs"}):u==="complete"?C.jsx("div",{className:"i-ph:check text-white text-xs"}):u==="failed"?C.jsx("div",{className:"i-ph:x text-white text-xs"}):C.jsx("span",{className:"text-white text-xs",children:"2"})}),C.jsx("span",{className:"ml-2",children:"Deploy"})]})]})}),o&&C.jsx("div",{className:"text-xs text-codeia-elements-textSecondary p-2 bg-codeia-elements-background-depth-3 rounded mt-4 mb-4",children:o}),a&&n==="success"&&C.jsx("div",{className:"mt-2",children:C.jsxs("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-codeia-elements-item-contentAccent hover:underline flex items-center",children:[C.jsx("span",{className:"mr-1",children:"View deployed site"}),C.jsx("div",{className:"i-ph:arrow-square-out"})]})})]}),C.jsx(mt.div,{className:"mt-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:C.jsxs("div",{className:Te("flex gap-2"),children:[n==="error"&&C.jsxs("button",{onClick:()=>r(`*Fix this deployment error*
\`\`\`
${o||i}
\`\`\`
`),className:Te("px-2 py-1.5 rounded-md text-sm font-medium","bg-codeia-elements-button-primary-background","hover:bg-codeia-elements-button-primary-backgroundHover","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-codeia-elements-button-danger-background","text-codeia-elements-button-primary-text","flex items-center gap-1.5"),children:[C.jsx("div",{className:"i-ph:chat-circle-duotone"}),"Ask CodeIA"]}),C.jsx("button",{onClick:e,className:Te("px-2 py-1.5 rounded-md text-sm font-medium","bg-codeia-elements-button-secondary-background","hover:bg-codeia-elements-button-secondary-backgroundHover","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-codeia-elements-button-secondary-background","text-codeia-elements-button-secondary-text"),children:"Dismiss"})]})})]})]})})})}const f8=k.memo(({alert:t,clearAlert:e,postMessage:r})=>C.jsxs("div",{className:"bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor rounded-lg p-4 mb-4",children:[C.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C.jsx("h4",{className:"font-medium text-codeia-elements-textPrimary",children:t.title}),C.jsx("button",{onClick:e,className:"text-codeia-elements-textSecondary hover:text-codeia-elements-textPrimary",children:C.jsx("div",{className:"i-ph:x text-lg"})})]}),C.jsx("p",{className:"text-sm text-codeia-elements-textSecondary mb-3",children:t.description}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("button",{onClick:()=>r(t.content),className:"px-3 py-1 text-sm bg-codeia-elements-background-depth-3 text-codeia-elements-textPrimary rounded hover:bg-codeia-elements-background-depth-4",children:"Execute"}),C.jsx("button",{onClick:e,className:"px-3 py-1 text-sm bg-codeia-elements-background-depth-1 text-codeia-elements-textSecondary rounded hover:bg-codeia-elements-background-depth-2",children:"Cancel"})]})]}));f8.displayName="ChatAlert";const p8=k.memo(({data:t})=>!t||t.length===0?null:C.jsxs("div",{className:"mb-4 p-3 bg-codeia-elements-background-depth-1 border border-codeia-elements-borderColor rounded-lg",children:[C.jsx("h4",{className:"text-sm font-medium text-codeia-elements-textPrimary mb-2",children:"Progress"}),C.jsx("div",{className:"space-y-2",children:t.map((e,r)=>C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"w-2 h-2 bg-codeia-elements-textSecondary rounded-full"}),C.jsx("span",{className:"text-sm text-codeia-elements-textSecondary",children:e.message||"Processing..."})]},r))})]}));p8.displayName="ProgressCompilation";const m8=k.memo(({alert:t,clearAlert:e,postMessage:r})=>C.jsxs("div",{className:"bg-codeia-elements-background-depth-2 border border-codeia-elements-borderColor rounded-lg p-4 mb-4",children:[C.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C.jsx("h4",{className:"font-medium text-codeia-elements-textPrimary",children:t.title}),C.jsx("button",{onClick:e,className:"text-codeia-elements-textSecondary hover:text-codeia-elements-textPrimary",children:C.jsx("div",{className:"i-ph:x text-lg"})})]}),C.jsx("p",{className:"text-sm text-codeia-elements-textSecondary mb-3",children:t.description}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("button",{onClick:()=>r(t.content),className:"px-3 py-1 text-sm bg-codeia-elements-background-depth-3 text-codeia-elements-textPrimary rounded hover:bg-codeia-elements-background-depth-4",children:"Execute"}),C.jsx("button",{onClick:e,className:"px-3 py-1 text-sm bg-codeia-elements-background-depth-1 text-codeia-elements-textSecondary rounded hover:bg-codeia-elements-background-depth-2",children:"Cancel"})]})]}));m8.displayName="SupabaseChatAlert";const jEe=76,$Ee=Re.forwardRef(({textareaRef:t,showChat:e=!0,chatStarted:r=!1,isStreaming:n=!1,onStreamingChange:s,model:i,setModel:o,provider:a,setProvider:l,providerList:c,input:u="",enhancingPrompt:d,handleInputChange:h,enhancePrompt:f,sendMessage:v,handleStop:m,importChat:p,exportChat:g,uploadedFiles:y=[],setUploadedFiles:_,imageDataList:b=[],setImageDataList:w,messages:E,actionAlert:S,clearAlert:x,deployAlert:T,clearDeployAlert:D,supabaseAlert:O,clearSupabaseAlert:R,data:P,actionRunner:A},H)=>{const K=r?400:200,[V,q]=k.useState(o2()),[I,$]=k.useState([]),[j,U]=k.useState(!1),[J,ne]=k.useState(!1),[te,me]=k.useState(null),[re,F]=k.useState(""),[X,Y]=k.useState("all"),[oe,le]=k.useState([]),ue=at(gd),[N,Z]=k.useState(!1);k.useEffect(()=>{ue&&Z(!0)},[ue]),k.useEffect(()=>{if(P){const ce=P.filter(ge=>typeof ge=="object"&&ge.type==="progress");le(ce)}},[P]),k.useEffect(()=>{console.log(re)},[re]),k.useEffect(()=>{s?.(n)},[n,s]),k.useEffect(()=>{if(typeof window<"u"&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)){const ce=window.SpeechRecognition||window.webkitSpeechRecognition,ge=new ce;ge.continuous=!0,ge.interimResults=!0,ge.onresult=de=>{const fe=Array.from(de.results).map(we=>we[0]).map(we=>we.transcript).join("");F(fe),h&&h({target:{value:fe}})},ge.onerror=de=>{console.error("Speech recognition error:",de.error),ne(!1)},me(ge)}},[]),k.useEffect(()=>{if(typeof window<"u"){let ce={};try{ce=o2(),q(ce)}catch(ge){console.error("Error loading API keys from cookies:",ge),Sr.remove("apiKeys")}Y("all"),fetch("/api/models").then(ge=>ge.json()).then(ge=>{$(ge.modelList)}).catch(ge=>{console.error("Error fetching model list:",ge)}).finally(()=>{Y(void 0)})}},[c,a]);const ie=async(ce,ge)=>{const de={...V,[ce]:ge};q(de),Sr.set("apiKeys",JSON.stringify(de)),Y(ce);let fe=[];try{fe=(await(await fetch(`/api/models/${encodeURIComponent(ce)}`)).json()).modelList}catch(we){console.error("Error loading dynamic models for:",ce,we)}$(we=>[...we.filter(Ae=>Ae.provider!==ce),...fe]),Y(void 0)},W=(ce,ge)=>{console.log("Sending message:",ge||u),console.log("messages:",E),v&&(v(ce,ge),te&&(te.abort(),F(""),ne(!1),h&&h({target:{value:""}})))},z=async ce=>{const ge=ce.clipboardData?.items;if(ge){for(const de of ge)if(de.type.startsWith("image/")){ce.preventDefault();const fe=de.getAsFile();if(fe){const we=new FileReader;we.onload=_e=>{const Ae=_e.target?.result;_?.([...y,fe]),w?.([...b,Ae])},we.readAsDataURL(fe)}break}}},ae=C.jsx("div",{ref:H,className:Te(Fc.BaseChat,"relative flex h-full w-full overflow-hidden"),"data-chat-visible":e,children:C.jsxs("div",{className:"flex flex-col lg:flex-row overflow-y-auto w-full h-full",children:[C.jsxs("div",{className:Te(Fc.Chat,"flex flex-col flex-grow lg:min-w-[var(--chat-min-width)] h-full"),children:[!r&&C.jsxs("div",{id:"intro",className:"mt-[16vh] max-w-chat mx-auto text-center px-4 lg:px-0",children:[C.jsx("h1",{className:"text-3xl lg:text-6xl font-bold text-codeia-elements-textPrimary mb-4 animate-fade-in",children:"Crea código sin ser experto"}),C.jsx("p",{className:"text-md lg:text-xl mb-8 text-codeia-elements-textSecondary animate-fade-in animation-delay-200",children:"Solo explica lo que quieres hacer y deja que la inteligencia artificial te ayude a programar, paso a paso."})]}),C.jsxs(X_,{className:Te("pt-6 px-2 sm:px-6 relative",{"h-full flex flex-col modern-scrollbar":r}),resize:"smooth",initial:"smooth",children:[C.jsx(X_.Content,{className:"flex flex-col gap-4",children:r&&C.jsx(Wa,{children:()=>C.jsx(u8,{className:"flex flex-col w-full flex-1 max-w-chat pb-6 mx-auto z-1",messages:E||[],isStreaming:n})})}),C.jsxs("div",{className:Te("my-auto flex flex-col gap-2 w-full max-w-chat mx-auto z-prompt mb-6",{"sticky bottom-2":r}),children:[C.jsxs("div",{className:"flex flex-col gap-2",children:[T&&C.jsx(FEe,{alert:T,clearAlert:()=>D?.(),postMessage:ce=>{v?.({},ce),R?.()}}),O&&C.jsx(m8,{alert:O,clearAlert:()=>R?.(),postMessage:ce=>{v?.({},ce),R?.()}}),S&&C.jsx(f8,{alert:S,clearAlert:()=>x?.(),postMessage:ce=>{v?.({},ce),x?.()}})]}),C.jsx(UEe,{}),oe&&C.jsx(p8,{data:oe}),C.jsxs("div",{className:Te("relative bg-codeia-elements-background-depth-2 p-3 rounded-lg border border-codeia-elements-borderColor relative w-full max-w-chat mx-auto z-prompt"),children:[C.jsxs("svg",{className:Te(Fc.PromptEffectContainer),children:[C.jsxs("defs",{children:[C.jsxs("linearGradient",{id:"line-gradient",x1:"20%",y1:"0%",x2:"-14%",y2:"10%",gradientUnits:"userSpaceOnUse",gradientTransform:"rotate(-45)",children:[C.jsx("stop",{offset:"0%",stopColor:"#b44aff",stopOpacity:"0%"}),C.jsx("stop",{offset:"40%",stopColor:"#b44aff",stopOpacity:"80%"}),C.jsx("stop",{offset:"50%",stopColor:"#b44aff",stopOpacity:"80%"}),C.jsx("stop",{offset:"100%",stopColor:"#b44aff",stopOpacity:"0%"})]}),C.jsxs("linearGradient",{id:"shine-gradient",children:[C.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0%"}),C.jsx("stop",{offset:"40%",stopColor:"#ffffff",stopOpacity:"80%"}),C.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"80%"}),C.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0%"})]})]}),C.jsx("rect",{className:Te(Fc.PromptEffectLine),pathLength:"100",strokeLinecap:"round"}),C.jsx("rect",{className:Te(Fc.PromptShine),x:"48",y:"24",width:"70",height:"1"})]}),C.jsx("div",{children:!j&&C.jsx(Wa,{children:()=>C.jsxs(C.Fragment,{children:[C.jsx(LEe,{model:i,setModel:o,modelList:I,provider:a,setProvider:l,providerList:c||bg,apiKeys:V,modelLoading:X},a?.name+":"+I.length),(c||[]).length>0&&a&&(!mB.includes(a.name)||a.name==="OpenAILike")&&C.jsx(kEe,{provider:a,apiKey:V[a.name]||"",setApiKey:ce=>{ie(a.name,ce)}})]})})}),C.jsx(h8,{files:y,imageDataList:b,onRemove:ce=>{_?.(y.filter((ge,de)=>de!==ce)),w?.(b.filter((ge,de)=>de!==ce))}}),C.jsx(Wa,{children:()=>C.jsx(BEe,{setUploadedFiles:_||(()=>{}),setImageDataList:w||(()=>{}),uploadedFiles:y,imageDataList:b})}),C.jsxs("div",{className:Te("relative shadow-xs border border-codeia-elements-borderColor backdrop-blur rounded-lg"),children:[C.jsx("textarea",{ref:t,className:Te("w-full pl-4 pt-4 pr-16 outline-none resize-none text-codeia-elements-textPrimary placeholder-codeia-elements-textTertiary bg-transparent text-sm","transition-all duration-200","hover:border-codeia-elements-focus"),onDragEnter:ce=>{ce.preventDefault(),ce.currentTarget.style.border="2px solid #1488fc"},onDragOver:ce=>{ce.preventDefault(),ce.currentTarget.style.border="2px solid #1488fc"},onDragLeave:ce=>{ce.preventDefault(),ce.currentTarget.style.border="1px solid var(--codeia-elements-borderColor)"},onDrop:ce=>{ce.preventDefault(),ce.currentTarget.style.border="1px solid var(--codeia-elements-borderColor)",Array.from(ce.dataTransfer.files).forEach(de=>{if(de.type.startsWith("image/")){const fe=new FileReader;fe.onload=we=>{const _e=we.target?.result;_?.([...y,de]),w?.([...b,_e])},fe.readAsDataURL(de)}})},onKeyDown:ce=>{if(ce.key==="Enter"){if(ce.shiftKey)return;if(ce.preventDefault(),n){m?.();return}if(ce.nativeEvent.isComposing)return;W?.(ce)}},value:u,onChange:ce=>{h?.(ce)},onPaste:z,style:{minHeight:jEe,maxHeight:K},placeholder:"How can CodeIA help you today?",translate:"no"}),C.jsx(Wa,{children:()=>C.jsx(d8,{show:u.length>0||n||y.length>0,isStreaming:n,disabled:!c||c.length===0,onClick:ce=>{if(n){m?.();return}(u.length>0||y.length>0)&&W?.(ce)}})}),C.jsxs("div",{className:"flex justify-between items-center mt-2",children:[C.jsx(hr,{icon:"i-ph:gear","aria-label":"Mostrar configuración del modelo",onClick:()=>U(ce=>!ce),className:"text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary",tooltip:"Mostrar/Ocultar configuración del modelo"}),C.jsx(hr,{icon:"i-ph:sidebar","aria-label":"Mostrar workbench",onClick:()=>Ie.showWorkbench.set(!0),className:"text-codeia-elements-textTertiary hover:text-codeia-elements-textPrimary",tooltip:"Mostrar panel de trabajo"})]})]})]})]})]}),C.jsx("div",{className:"flex flex-col justify-center",children:C.jsx("div",{className:"flex flex-col gap-5",children:!r&&MEe((ce,ge)=>{if(n){m?.();return}W?.(ce,ge)})})})]}),C.jsx(Wa,{children:()=>C.jsx(EEe,{actionRunner:A??{},chatStarted:r,isStreaming:n})})]})});return C.jsx(fEe,{delayDuration:200,children:ae})});function UEe(){const{isAtBottom:t,scrollToBottom:e}=SB();return!t&&C.jsxs("button",{className:"absolute z-50 top-[0%] translate-y-[-100%] text-4xl rounded-lg left-[50%] translate-x-[-50%] px-1.5 py-0.5 flex items-center gap-2 bg-codeia-elements-background-depth-3 border border-codeia-elements-borderColor text-codeia-elements-textPrimary text-sm",onClick:()=>e(),children:["Go to last message",C.jsx("span",{className:"i-ph:arrow-down animate-bounce"})]})}const HEe=qd({enter:"animated fadeInRight",exit:"animated fadeOutRight"}),a2=en("Chat");function VEe(){ec.trace("Chat");const{ready:t,initialMessages:e,storeMessageHistory:r,importChat:n,exportChat:s}=Voe(),i=at(hB);return k.useEffect(()=>{Ie.setReloadedMessages(e.map(o=>o.id))},[e]),C.jsxs(C.Fragment,{children:[t&&C.jsx(zEe,{description:i,initialMessages:e,exportChat:s,storeMessageHistory:r,importChat:n}),C.jsx(_K,{closeButton:({closeToast:o})=>C.jsx("button",{className:"Toastify__close-button",onClick:o,children:C.jsx("div",{className:"i-ph:x text-lg"})}),icon:({type:o})=>{switch(o){case"success":return C.jsx("div",{className:"i-ph:check-bold text-codeia-elements-icon-success text-2xl"});case"error":return C.jsx("div",{className:"i-ph:warning-circle-bold text-codeia-elements-icon-error text-2xl"})}},position:"bottom-right",pauseOnFocusLoss:!0,transition:HEe,autoClose:3e3})]})}const GEe=fB(t=>{const{messages:e,initialMessages:r,isLoading:n,parseMessages:s,storeMessageHistory:i}=t;s(e,n),e.length>r.length&&i(e).catch(o=>De.error(o.message))},50),zEe=k.memo(({description:t,initialMessages:e,storeMessageHistory:r,importChat:n,exportChat:s})=>{const i=k.useRef(null),[o,a]=k.useState(e.length>0),[l,c]=k.useState([]),[u,d]=k.useState([]),[h,f]=l2(),[v,m]=k.useState(!1),p=at(Ie.files),g=at(Ie.alert),y=at(Ie.deployAlert),_=at(Ie.supabaseAlert),{activeProviders:b,promptId:w,contextOptimizationEnabled:E}=wae(),[S,x]=k.useState(()=>Sr.get("selectedModel")||Tse),[T,D]=k.useState(()=>{const fe=Sr.get("selectedProvider");return bg.find(we=>we.name===fe)||Ase}),{showChat:O}=at(Tc),[R,P]=aK(),[A,H]=k.useState({}),{messages:K,isLoading:V,input:q,handleInputChange:I,setInput:$,stop:j,append:U,setMessages:J,reload:ne,error:te,data:me,setData:re}=xG({api:"/api/chat",body:{apiKeys:A,files:p,promptId:w,contextOptimization:E,supabase:{isConnected:!1,hasSelectedProject:!1,credentials:{supabaseUrl:"",anonKey:""}}},sendExtraMessageFields:!0,onError:fe=>{a2.error(`Request failed

`,fe,te),ln.logError("Chat request failed",fe,{component:"Chat",action:"request",error:fe.message}),De.error("There was an error processing your request: "+(fe.message?fe.message:"No details were returned"))},onFinish:(fe,we)=>{const _e=we.usage;re(void 0),_e&&(console.log("Token usage:",_e),ln.logProvider("Chat response completed",{component:"Chat",action:"response",model:S,provider:T.name,usage:_e,messageLength:fe.content.length})),a2.debug("Finished streaming")},initialMessages:e,initialInput:Sr.get(Kh)||""});k.useEffect(()=>{const fe=h.get("prompt");fe&&(f({}),W(),U({role:"user",content:[{type:"text",text:`[Model: ${S}]

[Provider: ${T.name}]

${fe}`}]}))},[S,T,h]);const{enhancingPrompt:F,promptEnhanced:X,enhancePrompt:Y,resetEnhancer:oe}=Joe(),{parsedMessages:le,parseMessages:ue}=qoe(),N=o?400:200;k.useEffect(()=>{Tc.setKey("started",e.length>0)},[]),k.useEffect(()=>{GEe({messages:K,initialMessages:e,isLoading:V,parseMessages:ue,storeMessageHistory:r})},[K,V,ue]);const Z=()=>{const fe=i.current;fe&&(fe.scrollTop=fe.scrollHeight)},ie=()=>{j(),Tc.setKey("aborted",!0),Ie.abortAllActions(),ln.logProvider("Chat response aborted",{component:"Chat",action:"abort",model:S,provider:T.name})};k.useEffect(()=>{const fe=i.current;if(fe){fe.style.height="auto";const we=fe.scrollHeight;fe.style.height=`${Math.min(we,N)}px`,fe.style.overflowY=we>N?"auto":"hidden"}},[q,i]);const W=async()=>{o||(await Promise.all([P("#examples",{opacity:0,display:"none"},{duration:.1}),P("#intro",{opacity:0,flex:1},{duration:.2,ease:ho})]),Tc.setKey("started",!0),a(!0))},z=async(fe,we)=>{const _e=we||q;if(!_e?.trim())return;if(V){ie();return}const Ae=_e;if(W(),!o){m(!0),J([{id:`${new Date().getTime()}`,role:"user",content:[{type:"text",text:`[Model: ${S}]

[Provider: ${T.name}]

${Ae}`},...u.map(Ne=>({type:"image",image:Ne}))]}]),ne(),m(!1),$(""),Sr.remove(Kh),c([]),d([]),oe(),i.current?.blur();return}te!=null&&J(K.slice(0,-1));const ze=Ie.getModifiedFiles();if(Tc.setKey("aborted",!1),ze!==void 0){const Ne=Hoe(ze,`${Date.now()}`);U({role:"user",content:[{type:"text",text:`[Model: ${S}]

[Provider: ${T.name}]

${Ne}${Ae}`},...u.map(ft=>({type:"image",image:ft}))]}),Ie.resetAllFileModifications()}else U({role:"user",content:[{type:"text",text:`[Model: ${S}]

[Provider: ${T.name}]

${Ae}`},...u.map(Ne=>({type:"image",image:Ne}))]});$(""),Sr.remove(Kh),c([]),d([]),oe(),i.current?.blur()},ae=fe=>{I(fe)},ce=k.useCallback(Cg(fe=>{const we=fe.target.value.trim();Sr.set(Kh,we,{expires:30})},1e3),[]);k.useEffect(()=>{const fe=Sr.get("apiKeys");fe&&H(JSON.parse(fe))},[]);const ge=fe=>{x(fe),Sr.set("selectedModel",fe,{expires:30})},de=fe=>{D(fe),Sr.set("selectedProvider",fe.name,{expires:30})};return C.jsx($Ee,{ref:R,textareaRef:i,input:q,showChat:O,chatStarted:o,isStreaming:V||v,enhancingPrompt:F,promptEnhanced:X,sendMessage:z,model:S,setModel:ge,provider:T,setProvider:de,providerList:b,handleInputChange:fe=>{ae(fe),ce(fe)},handleStop:ie,description:t,importChat:n,exportChat:s,messages:K.map((fe,we)=>fe.role==="user"?fe:{...fe,content:le[we]||""}),enhancePrompt:()=>{Y(q,fe=>{$(fe),Z()},S,T,A)},uploadedFiles:l,setUploadedFiles:c,imageDataList:u,setImageDataList:d,actionAlert:g,clearAlert:()=>Ie.clearAlert(),supabaseAlert:_,clearSupabaseAlert:()=>Ie.clearSupabaseAlert(),deployAlert:y,clearDeployAlert:()=>Ie.clearDeployAlert(),data:me})}),WEe="_",KEe="b",qEe="c",JEe="e",YEe="g",ZEe="i",XEe="k",QEe="m",eCe="o",tCe="q",or={rayContainer:WEe,lightRay:KEe,ray1:qEe,ray2:JEe,ray3:YEe,ray4:ZEe,ray5:XEe,ray6:QEe,ray7:eCe,ray8:tCe},rCe=()=>C.jsxs("div",{className:`${or.rayContainer} `,children:[C.jsx("div",{className:`${or.lightRay} ${or.ray1}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray2}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray3}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray4}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray5}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray6}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray7}`}),C.jsx("div",{className:`${or.lightRay} ${or.ray8}`})]}),fke=()=>[{title:"Code IA "},{name:"description",content:"An AI assistant"}];function pke(){return C.jsxs("div",{className:"flex flex-col h-full w-full bg-codeia-elements-background-depth-1",children:[C.jsx(rCe,{}),C.jsx(Wa,{children:()=>C.jsx(VEe,{})})]})}export{rke as A,tke as B,sj as C,Gge as D,xe as E,nye as F,XCe as G,mve as H,Ot as I,KCe as J,fke as K,iw as L,pke as M,H5 as N,Zge as P,Jt as T,YCe as a,eke as b,Qr as c,ZCe as d,nt as e,Rve as f,QCe as g,In as h,_ve as i,qn as j,pve as k,Ave as l,gr as m,Hg as n,Eo as o,qCe as p,Kg as q,pc as r,cve as s,ve as t,al as u,ot as v,lr as w,Mm as x,Fe as y,Yve as z};
